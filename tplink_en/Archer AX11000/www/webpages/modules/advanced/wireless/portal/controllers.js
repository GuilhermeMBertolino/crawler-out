!function(n){n.su.moduleManager.define("portal",{services:["moduleLoader","ajax","device","vtype"],models:["guestPermissionAdv","portalAuthAdv","portalAuthCfg","wireless24g"],stores:["securityStore","portalAuthTypeStore","portalAuthDurationStore"],views:["guestNetworkAdvView"],listeners:{"ev_on_launch":function(e,r,i,s,t,o,u){r=this;"ap"===u.device.getCurrentMode()&&(i.guestNetworkAdvView.guestPermissionsPanel.hide(),i.guestNetworkAdvView.guestNetworkPanel.hide()),this.control({"#login-page-edit-btn":{"ev_button_click":function(e){i.guestNetworkAdvView.logoBrowse.setNormal(),i.guestNetworkAdvView.loginPageEditMsg.show();var t=s.portalAuthAdv.authType.getValue();"simple"==(localStorage.authType=t)?i.guestNetworkAdvView.portalLoginPreview.showPassword():i.guestNetworkAdvView.portalLoginPreview.hidePassword(),s.portalAuthCfg.load({success:function(){var e=s.portalAuthCfg.getData();e.title||s.portalAuthCfg.title.setValue(n.su.CHAR.GUEST_NETWORK.WELCOME),e.content||s.portalAuthCfg.content.setValue(n.su.CHAR.GUEST_NETWORK.TERMS_OF_USE_NOTE),i.guestNetworkAdvView.portalLoginPreview.setTitle(s.portalAuthCfg.title.getValue())}})}},"#restore-default-image":{"ev_button_click":function(e){i.guestNetworkAdvView.portalLoginPreview.restoreDefault()}},"#full-screen-preview":{"ev_button_click":function(e){window.open("./portalPreview.html")}},"#logo-browse":{"ev_file_change":function(e,t){var o;return i.guestNetworkAdvView.logoBrowse.setNormal(),100<i.guestNetworkAdvView.logoBrowse.getFileSize()?(i.guestNetworkAdvView.logoBrowse.setError(n.su.CHAR.GUEST_NETWORK.FILE_SIZE_EXCEEDED),!1):(o=i.guestNetworkAdvView.logoBrowse.getFileName(),1!=(o=u.vtype.validate(o,{vtype:"string_file",extension:["png","jpg"]}))?(i.guestNetworkAdvView.logoBrowse.setError(o),!1):void u.ajax.upload({proxy:"portalLogoUploadProxy",fileId:"logo-browse",success:function(e){r.preView(i.guestNetworkAdvView.logoBrowse.getFile(),"logo-imge")}}))}},"#background-browse":{"ev_file_change":function(e,t){var o;return i.guestNetworkAdvView.backgroundBrowse.setNormal(),2048<i.guestNetworkAdvView.backgroundBrowse.getFileSize()?(i.guestNetworkAdvView.backgroundBrowse.setError(n.su.CHAR.GUEST_NETWORK.FILE_SIZE_EXCEEDED),!1):(o=i.guestNetworkAdvView.backgroundBrowse.getFileName(),1!=(o=u.vtype.validate(o,{vtype:"string_file",extension:["png","jpg"]}))?(i.guestNetworkAdvView.backgroundBrowse.setError(o),!1):void u.ajax.upload({proxy:"portalBackgroundUploadProxy",fileId:"background-browse",success:function(e){r.preView(i.guestNetworkAdvView.backgroundBrowse.getFile(),"background-imge")}}))}},"#portal-submit-button":{"ev_button_click":function(e){s.portalAuthCfg.submit({success:function(){i.guestNetworkAdvView.loginPageEditMsg.hide()}})}},"#portal-cancel-button":{"ev_button_click":function(e){i.guestNetworkAdvView.loginPageEditMsg.hide()}},"#facebook-config-btn":{"ev_button_click":function(e){i.guestNetworkAdvView.facebookCfgCfmMsg.show(),window.open("https://www.facebook.com")}},"#facebook-cfg-cfm-msg":{"ev_msg_ok":function(){location.reload()},"ev_msg_no":function(e,t){t.preventDefault(),window.open("https://www.facebook.com")}}}),this.listen({"models.portalAuthAdv.authType":{"ev_value_change":function(e,t,o){"none"==t?(i.guestNetworkAdvView.portalAuthTypeSimple.show(),i.guestNetworkAdvView.portalAuthTypeFacebook.hide(),s.portalAuthAdv.password.disable(),s.portalAuthAdv.password.hide()):("simple"==t?(i.guestNetworkAdvView.portalAuthTypeSimple.show(),i.guestNetworkAdvView.portalAuthTypeFacebook.hide(),s.portalAuthAdv.password.enable(),s.portalAuthAdv.password):(i.guestNetworkAdvView.portalAuthTypeSimple.hide(),i.guestNetworkAdvView.portalAuthTypeFacebook)).show()}},"models.portalAuthCfg.title":{"ev_value_change":function(e,t,o){i.guestNetworkAdvView.portalLoginPreview.setTitle(t),localStorage.title=t}},"models.portalAuthAdv.redirect":{"ev_value_change":function(e,t,o){"on"==t?(s.portalAuthAdv.redirectUrl.enable(),s.portalAuthAdv.redirectUrl.show()):(s.portalAuthAdv.redirectUrl.disable(),s.portalAuthAdv.redirectUrl.hide())}}}),s.guestPermissionAdv.load({success:function(e){"ap"===u.device.getCurrentMode()&&s.guestPermissionAdv.accessLocal.hide()}}),s.portalAuthAdv.load()}},init:function(e,t,o,r,i,s){}},function(e,r,t,o,i,s){var u="off",a="off",l="off";return{preView:function(e,t){e=e.files[0];if(!e)return!1;var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){"logo-imge"==t&&(r.guestNetworkAdvView.portalLoginPreview.changeLogo(this.result),localStorage.logo=this.result),"background-imge"==t&&(r.guestNetworkAdvView.portalLoginPreview.changeBackground(this.result),localStorage.background=this.result)}},showNote:function(e,t){switch(0===e.disableBy?r.guestNetworkAdvView.guestNetworkNote.setText(n.su.CHAR.GUEST_NETWORK.SWITCH_NOTICE1):r.guestNetworkAdvView.guestNetworkNote.setText(n.su.CHAR.GUEST_NETWORK.SWITCH_NOTICE2),t){case"24G":u=e.disabled;break;case"51G":a=e.disabled;break;case"52G":l=e.disabled}s.device.getIsTriband()?"on"===u&&"on"===a&&"on"===l?r.guestNetworkAdvView.guestNetworkNote.show():r.guestNetworkAdvView.guestNetworkNote.hide():"on"===u&&"on"===a?r.guestNetworkAdvView.guestNetworkNote.show():r.guestNetworkAdvView.guestNetworkNote.hide()}}})}(jQuery);