<script>function init(){var e=$.act(ACT_GET,MANAGEMENT_SERVER,null,null),a=$.act(ACT_GL,WAN_IP_CONN,null,null,["enable","name","X_TP_IfName","connectionType"]),n=$.act(ACT_GL,WAN_PPP_CONN,null,null,["enable","name","X_TP_IfName"]),o=$.act(ACT_GL,WAN_PPTP_CONN,null,null,["enable","name","ifName"]),l=$.act(ACT_GL,WAN_L2TP_CONN,null,null,["enable","name","ifName"]);if(!$.exe()){1==e.enableCWMP?($("#cwmp_on").addClass("selected"),$("#cwmp_off").removeClass("selected")):($("#cwmp_on").removeClass("selected"),$("#cwmp_off").addClass("selected")),1==e.periodicInformEnable?($("#inform_on").addClass("selected"),$("#inform_off").removeClass("selected")):($("#inform_on").removeClass("selected"),$("#inform_off").addClass("selected")),$("#inform_interval").prop("value",e.periodicInformInterval),tmpInformInterval=e.periodicInformInterval,$("#acs_url").prop("value",e.URL),$("#acs_user_name").prop("value",e.username),$("#acs_user_pwd").prop("value",e.password);for(var t=0;t<a.length;t++)if("IP_Routed"==a[t].connectionType&&1==a[t].enable){var _=a[t].name,r=a[t].X_TP_IfName;$("#wanInf").append("<option value='"+r+"' text='"+_+"' >"+_+"</option>")}for(c=0;c<n.length;c++)if(1==n[c].enable){var _=n[c].name,r=n[c].X_TP_IfName;$("#wanInf").append("<option value='"+r+"' text='"+_+"' >"+_+"</option>")}for(c=0;c<o.length;c++)if(1==o[c].enable){var _=o[c].name,r=o[c].ifName;$("#wanInf").append("<option value='"+r+"' text='"+_+"' >"+_+"</option>")}for(var c=0;c<l.length;c++)if(1==l[c].enable){var _=l[c].name,r=l[c].ifName;$("#wanInf").append("<option value='"+r+"' text='"+_+"' >"+_+"</option>")}$('#wanInf option[value="'+e.X_TP_BoundIfName+'"]').prop("selected","selected");var p={};p.refresh=1,$("#wanInf").tpSelect(p),tmpCwmpFlag=e.X_TP_Flag,0!=(16&e.X_TP_Flag)?($("#soap_on").addClass("selected"),$("#soap_off").removeClass("selected")):($("#soap_on").removeClass("selected"),$("#soap_off").addClass("selected")),0!=(128&e.X_TP_Flag)?($("#CR_Auth_en").prop("checked",!1),$("#CR").addClass("nd")):($("#CR_Auth_en").prop("checked",!0),$("#CR").removeClass("nd")),$("#CR_name").prop("value",e.connectionRequestUsername),$("#CR_pwd").prop("value",e.connectionRequestPassword),$("#CR_url").prop("value",e.connectionRequestURL),$("#CR_path").prop("value",e.X_TP_connReqPath),$("#CR_port").prop("value",e.X_TP_ConnReqPort)}}var tmpInformInterval,tmpCwmpFlag;$("#cwmp_on").click(function(){var e=0,a=$.act(ACT_GL,UPNP_PORTMAPPING),n=$.act(ACT_GET,UPNP_CFG),o=$.act(ACT_GET,MANAGEMENT_SERVER);if($.exe(),$.each(a,function(){this.externalPort==o.X_TP_ConnReqPort&&1==n.enable&&(e=1)}),e)return $.alert(CMM_UPNP_CONFLICT_WITH_OVPN),$.removeLoading(),void $.reload();$.addLoading($(this)),$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["EnableCWMP=1"]),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#cwmp_off").click(function(){$.addLoading($(this)),$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["EnableCWMP=0"]),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#inform_on").click(function(){$.addLoading($(this)),$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["PeriodicInformEnable=1"]),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#inform_off").click(function(){$.addLoading($(this)),$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["PeriodicInformEnable=0"]),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#soap_on").click(function(){$.addLoading($(this)),tmpCwmpFlag|=16,$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["X_TP_Flag="+tmpCwmpFlag]),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#soap_off").click(function(){tmpCwmpFlag&=-17,$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["X_TP_Flag="+tmpCwmpFlag]),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#t_save").click(function(){var e=0,a=$.act(ACT_GL,UPNP_PORTMAPPING),n=$.act(ACT_GET,UPNP_CFG),o=$.act(ACT_GET,MANAGEMENT_SERVER);$.exe(),$.addLoading($(this));var l={},t=$("#inform_interval").prop("value");if(!(1==!$.num(t,!0)&&t>0))return $.alert(ERR_NUM_INVAD),void $("#inform_interval").focus().select();if(l.periodicInformInterval=parseInt(t),""==$("#acs_url").prop("value"))return $.alert(ERR_CWMP_URL_INVAD),void((_=$("#acs_url"))&&(_.focus(),_.select()));if(l.URL=$("#acs_url").prop("value"),l.username=$("#acs_user_name").prop("value"),l.password=$("#acs_user_pwd").prop("value"),l.X_TP_BoundIfName=$("#wanInf").data("value"),$("#CR_Auth_en").prop("data-checked")?tmpCwmpFlag&=-129:tmpCwmpFlag|=128,l.X_TP_Flag=tmpCwmpFlag,l.connectionRequestUsername=$("#CR_name").prop("value"),l.connectionRequestPassword=$("#CR_pwd").prop("value"),"/"!=$("#CR_path").prop("value").charAt(0))return $.alert(ERR_CWMP_PATH_INVAD),(_=$("#CR_path"))&&(_.focus(),_.select()),!1;if(l.X_TP_connReqPath=$("#CR_path").prop("value"),$.num($("#CR_port").prop("value"),!0)||!($("#CR_port").prop("value")>=1e3)){$.alert(ERR_CWMP_PORT_INVAD);var _=$("#CR_port");return _&&(_.focus(),_.select()),!1}if(l.X_TP_ConnReqPort=parseInt($("#CR_port").prop("value"),10),$.each(a,function(){this.externalPort==l.X_TP_ConnReqPort&&1==n.enable&&1==o.enableCWMP&&(e=1)}),e)return $.alert(CMM_UPNP_CONFLICT_WITH_OVPN),$.removeLoading(),void $.reload();$.act(ACT_SET,MANAGEMENT_SERVER,null,null,l),$.exe(function(e){$.removeLoading(),e||$.reload()})}),$("#getRPCMethods").click(function(){var e=4|tmpCwmpFlag;$.act(ACT_SET,MANAGEMENT_SERVER,null,null,["X_TP_Flag="+e]),$.exe(function(e){e||$.reload("cwmp.htm")})}),$("#CR_Auth_en").click(function(){$("#CR_Auth_en").prop("data-checked")?$("#CR").removeClass("nd"):$("#CR").addClass("nd")})</script>
<h3 id="et">CWMP Settings</h3>
<div class="content-container">
	<form class="pure-form pure-form-aligned">
		<div class="button-group-container">
			<b class="xxxl" id="t_cwmp">CWMP: </b>
			<ul>
				<li>
					<button id="cwmp_on" class="fst" value="on">On</button>
				</li>
				<li>
					<button id="cwmp_off" class="lst" value="off">Off</button>
				</li>
			</ul>
		</div>
		<div class="button-group-container">
			<b class="xxxl" id="t_inform">Inform: </b>
			<ul>
				<li>
					<button id="inform_on" class="fst" value="on">On</button>
				</li>
				<li>
					<button id="inform_off" class="lst" value="off">Off</button>
				</li>
			</ul>
		</div>
		<br>
		<div>
			<b class="xxxl" id="t_interval">Inform Interval: </b>
			<input class="l" type="text" size="15" id="inform_interval">
			<span id="t_seconds"></span>
		</div>
		<div>
			<b class="xxxl" id="t_acsurl">ACS URL: </b>
			<input class="xl" type="text" size="15" id="acs_url">
		</div>
		<div>
			<b class="xxxl" id="t_acsusername">ACS Username: </b>
			<input class="xl" type="text" size="15" id="acs_user_name">
		</div>
		<div>
			<b class="xxxl" id="t_acspasswd">ACS Password: </b>
			<input class="xl" type="password" size="15" id="acs_user_pwd">
		</div>
		<div>
			<b class="xxxl" id="t_if">Interface used by TR-069 client: </b>
			<select class="xl" id="wanInf">
				<option value="Any_WAN" id="t_anywan">Any_WAN</option>
				<option value="LAN" id="t_lan">LAN</option>
			</select>
		</div>
		<div class="button-group-container">
			<b class="xxxl" id="t_display">Display SOAP messages on serial console: </b>
			<ul>
				<li>
					<button id="soap_on" class="fst" value="on">On</button>
				</li>
				<li>
					<button id="soap_off" class="lst" value="off">Off</button>
				</li>
			</ul>
		</div>
		<br>
		
		<div>
			<input class="xl" type="checkbox" id="CR_Auth_en">
			<label id="t_auth">Connection Request Authentication</label>
		</div>
		<div id="CR">
			<div>
				<b class="xxxl" id="t_cr_name">Username: </b>
				<input class="xl" type="text" size="15" id="CR_name">
			</div>
			<div>
				<b class="xxxl" id="t_cr_pwd">Password: </b>
				<input class="xl" type="password" size="15" id="CR_pwd">
			</div>
			<div>
				<b class="xxxl" id="t_cr_path">Path: </b>
				<input class="xl" type="text" size="15" id="CR_path">
			</div>
			<div>
				<b class="xxxl" id="t_cr_port">Port: </b>
				<input class="xl" type="text" size="15" id="CR_port">
			</div>
			<div>
				<b class="xxxl" id="t_cr_url">URL: </b>
				<input class="xl" type="text" size="15" id="CR_url">
			</div>
		</div>

		<button type="submit" id="getRPCMethods" class="green left l_auto">Get RPC Methods</button>
		<div class="part-separate">
			<button type="submit" id="t_save" class="green T_save">Save</button> 
		</div>
	</form>
</div>
<script>$.tpInit(init)</script>