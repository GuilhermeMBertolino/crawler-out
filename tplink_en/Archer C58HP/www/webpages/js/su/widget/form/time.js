(function(a){a.su.Widget("time",{defaults:{fieldLabel:"",tips:"",cls:"",value:"24:00:00",maxValue:"24:00:00",minValue:"00:00:00",format:"h:m:s",allowBlank:true,widgetName:"time"},create:function(e,c){var d=this;d.each(function(s,m){var r=a(this);if(!r.is("input")){return null}a.extend(this,e,c);var q=c.id||this.id||"textbox-"+parseInt(Math.random()*1000*1000*1000,10).toString();r.attr({id:q});var n='<div class="container widget-container combobox-container time-container '+this.cls+'">';if(this.fieldLabel!==null){n+='<div class="widget-fieldlabel-wrap '+this.labelCls+'">';n+='<label class="widget-fieldlabel time-fieldlabel">'+this.fieldLabel+"</label>";if(this.fieldLabel!==""){n+='<span class="widget-separator">'+this.separator+"</span>"}n+="</div>"}var g=this.format,f=this.format.charAt(1),h=/^[A-Za-z0-9]+$/;if(h.test(f)){}n+='<div class="widget-wrap-outer time-wrap-outer">';var v=g.split(f),t=v.length;m.separator=f;for(var j=0;j<t;j++){var k=v[j],u="",w=24,p=(j===t-1)?"lst":"";switch(k){case"h":u="hour";w=24;break;case"m":u="min";w=60;break;case"s":u="sec";w=60;break}n+='<div class="combobox-container widget-wrap time-wrap '+u+"-container "+p+'">';n+='<div class="combobox-wrap time-wrap '+u+'-wrap">';n+='<input readonly="readonly" class="combobox-text time-text '+u+'-text" maxlength="2" value="'+u+'" data-type="'+k+'" />';n+='<a class="combobox-switch time-switch '+u+'-switch" href="javascript:void(0);">';n+='<span class="icon"></span>';n+="</a>";n+='<div class="combobox-list-wrap time-list-wrap '+u+'-list-wrap" toggleflag="hidden" >';n+='<div class="position-top-left"></div><div class="position-top-center"></div>';n+='<div class="position-center-left"><div class="position-center-right">';n+='<div class="combobox-list-content-wrap">';n+='<ul class="combobox-list time-list '+u+'-list">';for(var x=0;x<w;x++){var o=x.toString().charAt(1)==""?"0"+x:x;n+='<li class="combobox-list time-list" data-index="'+o+'">';n+='<label class="combobox-label time-label" >'+o+"</label>";n+="</li>"}n+="</ul>";n+="</div>";n+="</div></div>";n+='<div class="position-bottom-left"></div><div class="position-bottom-center"></div>';n+="</div>";n+="</div>";n+="</div>";if(j!=t-1){n+='<span class="time-separator">'+f+"</span>"}}if(this.tips!=null&&this.tips!=undefined){n+='<div class="widget-tips textbox-tips '+m.tipsCls+'">';n+='<div class="content tips-content"></div>';n+="</div>"}n+='<div class="widget-error-tips textbox-error-tips '+m.errorTipsCls+'">';n+='<span class="widget-error-tips-delta"></span>';n+='<div class="widget-error-tips-wrap">';n+='<div class="content error-tips-content"></div>';n+="</div>";n+="</div>";n+="</div>";n+="</div>";var l=a(n);r.replaceWith(l);l.append(r.addClass("time-value hidden"))});var b=a(d.parents("div.time-container").get(0));b.delegate("a.time-switch","click",function(h){h.stopPropagation();var g=a(this),f=g.parent("div.time-wrap").find("div.time-list-wrap"),i=f.attr("toggleflag")||"hidden";a("div.combobox-list-wrap").hide().attr("toggleflag","hidden");if(i!="shown"){f.slideDown(150,function(j){a(this).css({display:"block"})}).attr("toggleflag","shown")}else{f.hide().attr("toggleflag","hidden")}});b.delegate("label.time-label","click",function(r){r.stopPropagation();var o=a(this),t=o.attr("data-type"),g=o.parents("div.time-list-wrap"),f=d.closest("div.time-container"),k=d.get(0),w=k.format,n=k.separator;g.find("li.time-list").removeClass("selected");o.parent("li.time-list").addClass("selected");g.hide().attr("toggleflag","hidden");o.closest("div.time-wrap").find("input.time-text").val(o.html());var l=f.find("input.hour-text").val()||"00",j=f.find("input.min-text").val()||"00",x=f.find("input.sec-text").val()||"00";var u=w.split(n),v="";for(var q=0,p=u.length;q<p;q++){var i=u[q];switch(i){case"h":v=v+l+n;break;case"m":v=v+j+n;break;case"s":v=v+x+n;break}}v=v.slice(0,v.length-1);d.val(v)});b.delegate("div.time-wrap.lst label.time-label","click",function(f){d.time("validate")});d.on("ev_validatechange",function(f){f.stopPropagation()});if(d.val()){d.time("setValue",d.val())}d.time("setTips",c.tips);return d},getHour:function(d){var d=d||this,b=d.closest("div.time-container");var c=b.find("input.hour-text");return c.val()},getMin:function(d){var d=d||this,b=d.closest("div.time-container");var c=b.find("input.min-text");return c.val()},getSec:function(d){var d=d||this,c=d.closest("div.time-container");var b=c.find("input.sec-text");return b.val()},setValue:function(i,l){var i=i||this,b=i.closest("div.time-container"),e=i.get(0),k=e.format,f=e.separator,l=l[1];var m=l.split(f),j=k.split(f);for(var h=0,g=j.length;h<g;h++){var d=j[h],c=m[h];switch(d){case"h":b.find("input.hour-text").val(c);var n=b.find("div.hour-container li.time-list").removeClass("selected");n.filter("[data-index="+c+"]").addClass("selected");break;case"m":b.find("input.min-text").val(c);var n=b.find("div.min-container li.time-list").removeClass("selected");n.filter("[data-index="+c+"]").addClass("selected");break;case"s":b.find("input.sec-text").val(c);var n=b.find("div.sec-container li.time-list").removeClass("selected");n.filter("[data-index="+c+"]").addClass("selected");break}}i.val(l);return i},getValue:function(b){var b=b||this;return b.val()},validate:function(d){var d=d||this,f=d.get(0),c=f.validator,e=d.val(),b=true;if(c){return c.call(d,e)}d.trigger("ev_validatechange",b);return b},getContainer:function(b){var b=b||this;return b.closest("div.time-container")}})})(jQuery);