(function(a){a.su.Widget("timeset",{defaults:{fieldLabel:"",cls:"",hour12:true,tips:"",hourExchange:function(b){if(b==0){return[12,"AM"]}if(b==12){return[12,"PM"]}else{if(b<11){return[b,"AM"]}else{return[b%12,"PM"]}}}},create:function(c,k){var h=this;h.each(function(n,p){var l=a(p);a.extend(p,c,k);var o='<div class="container widget-container text-container timeset-container '+this.cls+'">';if(this.fieldLabel!==null){o+='<div class="widget-fieldlabel-wrap '+this.labelCls+'">';o+='<label class="widget-fieldlabel text-fieldlabel">'+this.fieldLabel+"</label>";if(this.fieldLabel!==""){o+='<span class="widget-separator">'+this.separator+"</span>"}o+="</div>"}o+='<div class="widget-wrap-outer text-wrap-outer timeset-wrap-outer">';o+='<div class="timeset-mask hidden"></div>';o+='<div class="widget-wrap text-wrap timeset-wrap">';o+='<span class="text-wrap-before"></span>';o+='<span class="text-wrap timeset-wrap">';o+='<input type="text" class="text-text timeset-text timeset-text-hour" maxLength="2" />';o+="<span>:</span>";o+='<input type="text" class="text-text timeset-text timeset-text-minute" maxLength="2" />';o+='<input class="text-text timeset-text hour12 '+(this.hour12?"inline-block":"hidden")+'" />';o+='<div class="arrow-wrap">';o+='<span class="arrow arrow-up"></span>';o+='<span class="arrow arrow-down"></span>';o+="</div>";o+="</span>";o+='<span class="text-wrap-after"></span>';o+="</div>";if(this.tips!=null&&this.tips!=undefined){o+='<div class="widget-tips textbox-tips '+this.tipsCls+'">';o+='<div class="content tips-content">'+this.tips+"</div>";o+="</div>"}o+="</div>";o+='<div class="widget-error-tips textbox-error-tips '+this.errorTipsCls+'">';o+='<span class="widget-error-tips-delta"></span>';o+='<div class="widget-error-tips-wrap">';o+='<div class="content error-tips-content"></div>';o+="</div>";o+="</div>";o+="</div>";var m=a(o);l.replaceWith(m);m.find("span.timeset-wrap").append(l.addClass("hidden"))});var b=h.closest("div.timeset-container"),f=b.find("input.timeset-text-hour"),j=b.find("input.timeset-text-minute"),d=b.find("input.hour12"),e=0,g=false,i=false;b.delegate("div.widget-wrap","focus",function(l){b.find("div.widget-wrap").addClass("focus")}).delegate("div.widget-wrap","blur",function(l){b.find("div.widget-wrap").removeClass("focus")}).delegate("input.timeset-text-hour","click",function(l){e=0}).delegate("input.timeset-text-hour","blur",function(m){if(f.val()==""){f.val(h.val().split(h.get(0).separator)[0])}var l=0;l=parseInt(f.val());if(l>=0&&l<=9){l="0"+l}if(h.get(0).hour12&&l==0){l=12}f.val(l);h.val(f.val()+":"+j.val());h.trigger("ev_change")}).delegate("input.timeset-text-hour","keydown",function(m){if(!(m.keyCode>=48&&m.keyCode<=57)&&!(m.keyCode>=96&&m.keyCode<=105)&&m.keyCode!=8&&m.keyCode!=46){m.preventDefault();return}if(g){f.val("");g=false}var l=f.val();if(m.keyCode==8||m.keyCode==46||l.length>=2){return}l=l+m.key;l=parseInt(l);if(h.get(0).hour12&&(l>12||l==0)){m.preventDefault();return}if(l>=24){m.preventDefault();return}h.val(l+":"+j.val());h.trigger("ev_change")}).delegate("input.timeset-text-minute","click",function(l){e=1}).delegate("input.timeset-text-minute","blur",function(l){if(j.val()==""){j.val(h.val().split(h.get(0).separator)[1])}var m=0;m=parseInt(j.val());if(m>=0&&m<=9){m="0"+m}j.val(m);h.val(f.val()+":"+j.val());h.trigger("ev_change")}).delegate("input.timeset-text-minute","keydown",function(l){if(!(l.keyCode>=48&&l.keyCode<=57)&&!(l.keyCode>=96&&l.keyCode<=105)&&l.keyCode!=8&&l.keyCode!=46){l.preventDefault();return}if(i){j.val("");i=false}var m=j.val();if(l.keyCode==8||l.keyCode==46||m.length>=2){return}m=m+l.key;m=parseInt(m);if(m>=60){l.preventDefault();return}h.val(f.val()+":"+m);h.trigger("ev_change")}).delegate("input.hour12","keydown",function(l){l.preventDefault();if(l.keyCode==80||l.keyCode==112){d.val("PM");h.trigger("ev_change")}else{if(l.keyCode==65||l.keyCode==97){d.val("AM");h.trigger("ev_change")}}return}).delegate("span.arrow-up","click",function(m){if(b.hasClass("disabled")){return}var l=0,n=0;if(e==0){l=parseInt(f.val());l++;if(h.get(0).hour12&&l>12){l=1}if(!h.get(0).hour12&&l>=24){l=0}if(l>=0&&l<=9){l="0"+l}f.val(l);f.select();g=true;h.val(f.val()+":"+j.val())}else{if(e==1){n=parseInt(j.val());n++;if(n>=60){n=0}if(n>=0&&n<=9){n="0"+n}j.val(n);j.select();i=true;h.val(f.val()+":"+j.val())}}h.trigger("ev_change")}).delegate("span.arrow-down","click",function(m){if(b.hasClass("disabled")){return}var l=0,n=0;if(e==0){l=parseInt(f.val());l--;if(l<=0){l=h.get(0).hour12?12:23}if(l>=0&&l<=9){l="0"+l}f.val(l);f.select();g=true;h.val(f.val()+":"+j.val())}else{if(e==1){n=parseInt(j.val());n--;if(n<=0){n=59}if(n>=0&&n<=9){n="0"+n}j.val(n);j.select();i=true;h.val(f.val()+":"+j.val())}}h.trigger("ev_change")});return h},setValue:function(e,d){var e=e||this,b=e.closest("div.timeset-container"),h=e.get(0),g=h.separator,f=d[1];e.val(f);var c=f.split(g);if(h.hour12){b.find("input.timeset-text-hour").val((h.hourExchange(c[0])[0]<10?("0"+h.hourExchange(c[0])[0]*1):h.hourExchange(c[0])[0]));b.find("input.hour12").val(h.hourExchange(c[0])[1])}else{b.find("input.timeset-text-hour").val(c[0])}b.find("input.timeset-text-minute").val(c[1])},getValue:function(d){var d=d||this,c=d.closest("div.timeset-container"),f=d.get(0),e=f.separator;var b,g=c.find("input.timeset-text-minute").val();if(f.hour12){if(c.find("input.hour12").val()=="AM"){b=(c.find("input.timeset-text-hour").val()==12)?"00":c.find("input.timeset-text-hour").val()}else{b=(c.find("input.timeset-text-hour").val()==12)?12:(c.find("input.timeset-text-hour").val()*1+12)}d.val(b+":"+g)}return d.val()},enable:function(c){var c=c||this,b=c.closest("div.timeset-container");b.removeClass("disabled");b.find("div.timeset-mask").addClass("hidden");c.prop("disabled",false);return c},disable:function(c){var c=c||this,b=c.closest("div.timeset-container");b.addClass("disabled");b.find("div.timeset-mask").removeClass("hidden");c.prop("disabled",true);return c},setTips:function(d,f){var d=d||this,c=d.closest("div.timeset-container"),e=c.find("div.widget-tips div.tips-content"),b=f[1]||"";if(d.get(0)){d.get(0).tips=b}if(a.type(b)==="string"){e.html(b)}return d},showTips:function(){var c=c||this,b=c.closest("div.timeset-container"),d=b.find("div.widget-tips div.tips-content");d.show();d.fadeIn(150)},hideTips:function(){var c=c||this,b=c.closest("div.timeset-container"),d=b.find("div.widget-tips div.tips-content");d.hide();d.css("display","none")}})})(jQuery);