<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WPS</title>
<script src="js/libs/corner.js"></script>
<script src="js/libs/excanvas.js"></script>
<style type="text/css">
	#wps_container{
		position:relative;
		height:100px;
	}
	#wps_disable{
		width:84px;
		height:84px;
		position:absolute;
		left: 50%;
		margin-left: -42px;
		border-radius:42px;
	}
	#wps_button,#wps_mask{
		width:84px;
		height:84px;
		position:absolute;
		left: 50%;
		margin-left: -42px;
		background:#ffcb00;
		color:#fff;
		cursor:pointer;
		border-radius:42px;
		-webkit-border-radius:42px;
		-ms-border-radius:42px;
		-moz-border-radius:42px;
		-o-border-radius:42px;  
	}
	#wps_button.starting{
		background:#4acbd6;
	}
	#wps_button.starting:hover{
		background:#4acbd6;
	}
	#wps_mask.starting{
		background:rgb(165,229,235);
		animation:Breathing 1.5s ease-out infinite alternate;
	}
	#wps_button:hover{
		background:#e8ba46;
	}
	#wps_title{    
		text-align: center;
		position: absolute;
		top: 50%;
		margin-top: -18px;
		width: 100%;
	}
	#wps_title h3{
		font-size:16px;
	}
	#wps_title span{
		font-size:13px;
	}
	@-webkit-keyframes Breathing {
		0% {
			-webkit-transform: scale(1);
		}
		100% {
			-webkit-transform: scale(1.36);
		}
	}
	@keyframes Breathing {
		0% {
			transform: scale(1);
		}
		100% {
			transform: scale(1.36);
		}
	}
	#wps_container .status-container{
		position:absolute;
		top:100px;
	}
</style>
</head>
<body>
<div class="func-container">
	<div id="wps_method_one" >
		<p class="note">
			<span></span>
			<br />
			<span></span>
		</p>
		<div id="wps_container">
			<div id="wps_disable">
			</div>
			<div id="wps_mask">
			</div>
			<div id="wps_button" class="">
				<div id="wps_title">
					<span></span>
					<h3></h3>
				</div>
			</div>
			<input id="push-conn-result" />
		</div>
		<p class="note hidden" id="note_wireless">
			<span class="title note-title"></span>
			<span class="text" id="note_wireless_text"></span>
		</p>
	</div>
	<div id="adv_btn" class="advanced-block part-seperate" type="button">
		<span class="advanced-icon"></span>
		<span class="advanced-text"></span>
	</div>
	<div id="basic_btn" class="basic-block part-seperate" type="button">
		<span class="basic-icon"></span>
		<span class="basic-text"></span>
	</div>
	<div id="pin_cute">
		<input id="pin_cute_type" />
		<div class="ml10" id="router_pin_container">
			<p class="note" id="router_pin_note" ></P>
			<form id="router_pin_form">
				<input id="enable_router_wps" name="wps_label" />
				<input id="router_pin" name="wps_pin" />
				<button id="router_pin_button_generate"></button>
				<button id="router_pin_button_default"></button>
				<div class="custom_loading_ctn">
					<span id="general_loading" class="loading"></span>
				</div>
			</form>
			<p class="note hidden" id="note_pin_lock">
				<span class="title note-title"></span>
				<span id="pin_lock_note" class="note"></span>
			</p>
		</div>
		<div class="ml10" id="client_pin_container">
			<input id="enable_client_wps" />
			<button id="client_pin_button"></button>
			<input id="pin_progress" />
			<button id="pin-cancel-btn" />			
			<div class="inline-block">
				<input id="pin-conn-result" />
			</div>
		</div>
	</div>
	<div id="help_wps"></div>
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(D){$("div.func-container").page({title:$.su.CHAR.WPS.TITLE,help:""});$("div#wps_method_one").panel({title:$.su.CHAR.WPS.TITLE,help:""});$("span#pin_lock_note").html($.su.CHAR.ERROR["00000124"]);var z=$.su.url("/admin/wireless?form=wps_pin");var y=$.su.url("/admin/wireless?form=wps_connect");var B=$.su.url("/admin/wireless?form=syspara_wps");var x=$.su.url("/admin/wireless?form=wireless_2g&form=wireless_5g");var j;var d;var k;var i;var r;var C;var A;var l="";var o="";var q=false;var u="";var w=false;$("span.note-title").html($.su.CHAR.OPERATION.NOTE);$("span#note_wireless_text").html($.su.CHAR.WPS.SWITCH_NOTE);var v=new $.su.Proxy({url:y});a(0);function a(G){j=setInterval(function(){if(w==true){G++}else{G=0}v.read({option:"pbc"},function(H){if(G==60){w=true;b(H,"timeout");$("#wps_title span").text($.su.CHAR.WPS.START);$("#wps_button").css({background:""});$("#wps_disable").css({"z-index":"-1"})}if(H.wps_status!="ok"){b(H);$("#wps_title span").text($.su.CHAR.WPS.START);$("#wps_button").css({background:""});$("#wps_disable").css({"z-index":"-1"})}else{w=true;E.status("setNormal");$("#wps_button").css({background:""});$("#wps_disable").css({"z-index":"-1"});$("#wps_button").addClass("starting");$("#wps_mask").addClass("starting");$("#wps_title span").text($.su.CHAR.WPS.CANCEL)}})},2000)}var n=new $.su.Proxy({url:B});function t(){$("#wps_title span").text($.su.CHAR.WPS.START);$("input#enable_client_wps").textbox("disable");$("input#pin_cute_type").radio("disable");$("input#enable_router_wps").switchbutton("disable");$("#router_pin_note").css({color:"#b2b2b2"});$("button#router_pin_button_generate").button("disable");$("button#router_pin_button_default").button("disable");$("input#router_pin").textbox("disable");$("button#client_pin_button").button("disable");$("#wps_disable").css({"z-index":"9999999"});$("#wps_button").css({background:"#b2b2b2"})}function p(){$("#wps_title span").text($.su.CHAR.WPS.WAIT);$("input#enable_client_wps").textbox("enable");$("input#pin_cute_type").radio("enable");$("input#enable_router_wps").switchbutton("enable");$("#router_pin_note").css({color:"rgb(77,77,77)"});$("button#router_pin_button_generate").button("enable");$("button#router_pin_button_default").button("enable");$("input#router_pin").textbox("enable");$("button#client_pin_button").button("enable")}n.read({},function(G){r=G.wps;if(r=="off"){t();clearInterval(j)}else{s.read({},function(H){C=H.wireless_2g_enable;A=H.wireless_5g_enable;if(C=="off"&&A=="off"){t();$("#note_wireless").removeClass("hidden");clearInterval(j)}else{p();$("#note_wireless").addClass("hidden");if(l=="lock"||o=="lock"){if(u=="on"){q=true;$("#note_pin_lock").removeClass("hidden")}}v.read({},function(L,N,K){if(typeof L=="undefined"){return}timeout=L.wps_timeout;var M=L.available;var J=L.disabled;var I=$("span#note_wireless_text");if(M){if(J=="on"){t();clearInterval(j);$("#note_wireless").removeClass("hidden");I.html($.su.CHAR.WPS.SWITCH_NOTE)}else{$("#note_wireless").addClass("hidden");I.html("")}}else{if(J=="on"){$("#note_wireless").removeClass("hidden");I.html($.su.CHAR.WPS.SWITCH_NOTE)}else{$("#note_wireless").removeClass("hidden");I.html($.su.CHAR.WPS.SWITCH_NOTE2)}t();clearInterval(j)}})}})}});var s=new $.su.Proxy({url:x});$("#wps_method_one p span:eq(0)").text($.su.CHAR.WPS.METHOD_ONE);$("#wps_method_one p span:eq(1)").text($.su.CHAR.WPS.BUTTON_TIPS);$("#wps_title h3").text($.su.CHAR.WPS.WPS);$("#wps_title span").text($.su.CHAR.WPS.WAIT);$("#wps_button").css({background:"#b2b2b2"});$("#wps_disable").css({"z-index":"9999999"});var E=$("#push-conn-result").status({proxy:{url:y}});function g(){E.status("setNormal");clearInterval(j);if($("#wps_button").attr("class").indexOf("starting")>-1){v.read({option:"cancel"},function(){w=false;$("#wps_button").removeClass("starting");$("#wps_mask").removeClass("starting");$("#wps_title span").text($.su.CHAR.WPS.START);a(0)})}else{if($("button#pin-cancel-btn").closest(".widget-container").css("display")!="none"){$("button#pin-cancel-btn").click()}$("#wps_disable").css({"z-index":"9999999"});$("#wps_button").css({background:"#b2b2b2"});$("#wps_title span").text($.su.CHAR.WPS.CONNECTING);v.read({option:"connect"},function(H){$("#wps_disable").css({"z-index":"9999999"});$("#wps_button").css({background:"#b2b2b2"});$("#wps_title span").text($.su.CHAR.WPS.CONNECTING);var G=120*1000;if(H.wps_status=="ok"){w=true;k=0;a(0)}else{b(H)}})}}$("#wps_button").bind("click",g);function b(G){if(w==true){if(G.wps_status=="success"){var H=$.su.CHAR.WPS.RESULT_HEAD+" <b>"+G.mac+"</b> "+$.su.CHAR.WPS.RESULT_END;E.status("setSuccess",H)}if(G.wps_status=="error"){E.status("setFailed",$.su.CHAR.WPS.STATUS_ERROR)}if(G.wps_status=="failed"){E.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_ERROR)}if(G.wps_status=="overlap"){E.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_OVERLAP)}if(G.wps_status=="timeout"){E.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_TIMEOUT)}if(arguments[1]){E.status("setFailed",$.su.CHAR.WPS.NOT_FOUND)}w=false;k=0}$("#wps_button").removeClass("starting");$("#wps_mask").removeClass("starting");$("#wps_title span").text($.su.CHAR.WPS.START)}$("span.advanced-text").html($.su.CHAR.WPS.OTHER);$("span.basic-text").html($.su.CHAR.WPS.OTHER);$("#basic_btn").hide();$("#pin_cute").hide();$("#adv_btn").click(function(){$("#basic_btn").show();$("#pin_cute").show();$(this).hide()});$("#basic_btn").click(function(){$("#adv_btn").show();$("#pin_cute").hide();$(this).hide()});$("#pin_cute_type").radio({fieldLabel:null,columns:3,items:[{boxlabel:$.su.CHAR.WPS.ROUTER_PIN,inputValue:"router",checked:true},{boxlabel:$.su.CHAR.WPS.CLIENT_PIN,inputValue:"client"}]}).on("ev_change",function(I,H,G){if(G=="router"){$("#router_pin_container").show();$("#client_pin_container").hide()}else{if(G=="client"){$("#router_pin_container").hide();$("#client_pin_container").show()}}});$("#client_pin_container").hide();var F=new $.su.Proxy({url:z});var c=new $.su.Proxy({url:z,async:false});$("input#enable_router_wps").switchbutton({fieldLabel:$.su.CHAR.WPS.ENABLE_ROUTER_PIN,proxy:F,autoLoad:false,field:{name:"wps_label"},onHandler:function(){if(q){$("span#note_pin_lock").removeClass("hidden")}},offHandler:function(){$("span#note_pin_lock").addClass("hidden")}});$("input#router_pin").textbox({fieldLabel:$.su.CHAR.WPS.ROUTER_PIN,cls:"inline-block",readOnly:true});$("#general_loading").hide();$("button#router_pin_button_generate").button({cls:"inline-block",text:$.su.CHAR.WPS.GENERAL,handler:function(){$("button#router_pin_button_generate").button("disable");$("#general_loading").fadeIn(150);F.write({option:"generate"},function(G){$("input#router_pin").textbox("setValue",G.wps_pin);$("button#router_pin_button_generate").button("enable");$("#general_loading").fadeOut(150);q=false;$("#note_pin_lock").addClass("hidden")})}});$("button#router_pin_button_default").button({cls:"inline-block",text:$.su.CHAR.WPS.DEFAULT,handler:function(){$("button#router_pin_button_default").button("disable");$("#general_loading").fadeIn(150);F.write({option:"default"},function(G){$("input#router_pin").textbox("setValue",G.wps_pin);$("button#router_pin_button_default").button("enable");$("#general_loading").fadeOut(150)})}});function h(G){v.read({option:"pin"},function(I,K,H){i++;if(typeof I=="undefined"){return}if(I.wps_status=="success"){var J=$.su.CHAR.WPS.RESULT_HEAD+" <b>"+I.mac+"</b> "+$.su.CHAR.WPS.RESULT_END;m.status("setSuccess",J);clearInterval(d);d=false;$("button#client_pin_button").button("enable");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("#pin_progress").progressbar("hide");i=0}else{if(I.wps_status=="ok"){m.status("setLoading","")}else{if(I.wps_status=="error"){m.status("setFailed",$.su.CHAR.WPS.STATUS_PIN_ERROR)}if(I.wps_status=="failed"){m.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_ERROR)}if(I.wps_status=="overlap"){m.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_OVERLAP)}if(I.wps_status=="timeout"){m.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_TIMEOUT)}clearInterval(d);d=false;$("button#client_pin_button").button("enable");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("#pin_progress").progressbar("hide");i=0}}if(i>=120*1000/1000){if(d){clearInterval(d);d=false;$("button#client_pin_button").button("enable");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("#pin_progress").progressbar("hide");m.status("setFailed",$.su.CHAR.WPS.NOT_FOUND);i=0}}})}c.read({},function(G){l=G.lock_2g;o=G.lock_5g;u=G.wps_label});$("form#router_pin_form").form({proxy:F,fields:[{name:"wps_label",mapping:"wps_label"},{name:"wps_pin",mapping:"wps_pin"}],autoLoad:true});var m=$("#pin-conn-result").status({proxy:{url:y}});$("#enable_client_wps").textbox({fieldLabel:$.su.CHAR.WPS.ENABLE_ROUTER_PIN,fieldLabel:$.su.CHAR.WPS.ENTER_CLIENT_PIN,vtype:{vtype:"number",max:99999999},maxLength:8,minLength:8,allowBlank:false,validator:function(G){if(G.toString().length!=8){return $.su.CHAR.ERROR["00000075"]}return true},cls:"no-label-align"});$("button#client_pin_button").button({text:$.su.CHAR.WPS.CONNECT,cls:"inline-block",handler:function(){if($("#wps_button").hasClass("starting")){$("#wps_button").click()}var G=$("input#enable_client_wps").textbox("getValue");if(!$("input#enable_client_wps").textbox("validate")){return false}$("button#client_pin_button").button("disable");v.read({option:"connect",wps_pin:G},function(H){m.status("setNormal");$("#pin_progress").progressbar("show");$("#pin_progress").progressbar("reset");$("#pin_progress").progressbar("animate",0,1,120*1000);$("#pin-cancel-btn").button("getContainer").css("display","inline-block");if(!d){i=0;d=setInterval(h,2000)}else{i=0;clearInterval(d);d=false;d=setInterval(h,2000)}$("button#pin-cancel-btn").button("enable")},function(){m.status("setFailed",$.su.CHAR.WPS.STATUS_PIN_ERROR);$("button#client_pin_button").button("enable");return},function(){})}});$("#pin_progress").progressbar({fieldLabel:null,cls:"inline-block",width:300,height:6,value:0});$("#pin_progress").progressbar("hide");$("button#pin-cancel-btn").button({text:$.su.CHAR.WPS.CANCEL,handler:function(){$("input#enable_client_wps").textbox("enable");$("button#pin-cancel-btn").button("disable");v.read({option:"cancel"},function(G){if(G.wps_status=="cancel"){m.status("setSuccess",$.su.CHAR.WPS.STATUS_CANCEL)}else{m.status("setNormal")}});clearInterval(d);d=false;$("#pin_progress").progressbar("reset");$("#pin_progress").progressbar("hide");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("button#client_pin_button").button("enable")},cls:"inline-block hidden"});$("#router_pin_note").html($.su.CHAR.WPS.ROUTER_PIN_NOTE);$.su.app.runningModule.addUnloadHandler(function(){clearInterval(j);clearInterval(d)});var f=new $.su.Help({container:"div#help_wps",content:["WPS"]})});</script>
</body>
</html>
