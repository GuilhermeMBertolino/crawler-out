<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>access Control</title>
<style type="text/css">
	a.act{
		color: #78AF19;
		margin-right: 10px;
		text-decoration: underline;
	}
</style>
</head>
<body>
<div class="func-container">
	 <div id="access">
	    	<input type="text"  id="enable_access" name="enable" value="" />
	 </div>
	 <div id="guest">
        <input type="text"  id="enable_guest" name="enable" value="" /> 
 	</div>   
    <div id="access_mode_set">
	 	<form id="access_mode_choose">
	 		<input type="text"  id="access_mode" name="access_mode" value="" />
	 	</form>
	 </div>
	<div id="black_mode">
		<div id="black_devices_online">
			<div id="online_black_grid">					
			</div>		
		</div>	
		<div id="black_list">
			<div id="black_grid">					
			</div>
		</div>
	</div>
	<div id="white_mode" style="display:none">
		<div id="white_devices_online">
			<div id="online_white_grid">					
			</div>		
		</div>	
		<div id="white_list">
			<div id="white_grid">					
			</div>
		</div>
	</div>
	<div id="help_access_control"></div>
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(v){var r=$.su.url("/admin/access_control?form=enable");var c=$.su.url("/admin/access_control?form=mode");var h=$.su.url("/admin/access_control?form=black_devices");var f=$.su.url("/admin/access_control?form=guest_network");var s=$.su.url("/admin/access_control?form=black_list");var x=$.su.url("/admin/access_control?form=white_devices");var b=$.su.url("/admin/access_control?form=white_list");var w="";if(window.sysMode=="re"){$("#guest").hide()}else{$("#guest").show()}$("div.func-container").page({title:$.su.CHAR.ACCESS_CTR.ACCESSCTR,help:""});$("div#access").panel({title:$.su.CHAR.ACCESS_CTR.ACCESSCTR,collapsible:false});var l=new $.su.Proxy({url:r});$("input#enable_access").switchbutton({fieldLabel:$.su.CHAR.ACCESS_CTR.ENABLE_ACCESS,proxy:l,cls:"form-inner",field:{name:"enable"}}).on("ev_loadData",function(A,z){w=z.host_mac});$("div#access_mode_set").panel({title:$.su.CHAR.ACCESS_CTR.ACCESS_MODE,collapsible:false});$("input#access_mode").radio({fieldLabel:$.su.CHAR.ACCESS_CTR.DEFAULT_ACCESS_MODE,columns:2,items:[{boxlabel:$.su.CHAR.ACCESS_CTR.BLACK_LIST,inputValue:"black"},{boxlabel:$.su.CHAR.ACCESS_CTR.WHITE_LIST,inputValue:"white"}]});var t=new $.su.Proxy({url:c});$("form#access_mode_choose").form({proxy:t,fields:[{name:"access_mode",mapping:"access_mode"}],submitBtn:"default"}).on("ev_loadData",function(B,A){if(A.access_mode==""||!A.access_mode){$("input#access_mode").radio("setValue","black")}else{if(A.access_mode=="black"){$("div#black_mode").show();$("div#white_mode").hide();var C=n.grid("getStore");C.load()}else{$("div#white_mode").show();$("div#black_mode").hide();var z=o.grid("getStore");z.load()}}});$("div#guest").panel({title:$.su.CHAR.ACCESS_CTR.GUEST_NETWORK,collapsible:false});var m=new $.su.Proxy({url:f});$("input#enable_guest").switchbutton({fieldLabel:$.su.CHAR.ACCESS_CTR.GUEST_NETWORK,proxy:m,cls:"form-inner",field:{name:"enable"}}).on("ev_loadData",function(A,z){d.load()});$("div#black_devices_online").panel({title:$.su.CHAR.ACCESS_CTR.DEVICE_ONLINE,collapsible:false});var y=new $.su.Proxy({url:h});var d=$("div#online_black_grid").grid({store:{proxy:y,fields:[{name:"name"},{name:"ipaddr"},{name:"mac"},{name:"host"},{name:"conn_type"}],autoLoad:true},columns:[{xtype:"checkcolumn",width:32},{text:$.su.CHAR.ACCESS_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.ACCESS_CTR.NAME,width:150,dataIndex:"name"},{text:$.su.CHAR.ACCESS_CTR.IP_ADDRESS,width:120,dataIndex:"ipaddr"},{text:$.su.CHAR.ACCESS_CTR.MAC_ADDRESS,width:150,dataIndex:"mac"},{text:$.su.CHAR.ACCESS_CTR.CONN_TYPE,width:100,dataIndex:"conn_type",renderer:function(z){if(z=="wireless"){return $.su.CHAR.ACCESS_CTR.WIRELESS}else{return $.su.CHAR.ACCESS_CTR.WIRED}}},{text:$.su.CHAR.GRID.MODIFY,dataIndex:"key",renderer:function(B,z){var A='<div class="button-container">';A+='<a href="javascript:void(0);" class="grid-content-btn btn-access-block btn-block" data-index="'+z+'">';A+='<span class="icon"></span>';A+='<span class="text">'+$.su.CHAR.ACCESS_CTR.BLOCK+"</span>";A+="</a>";A+="</div>";return A}}],operation:["refresh",{xtype:"button",text:$.su.CHAR.ACCESS_CTR.BLOCK,iconCls:"btn-block",handler:function(F){var E=d.grid("getSelected");if(E.length==0){return true}var B=d.grid("getStore");var G=[];var A={};A.data=$.su.clone(B.data);keyProperty=B.keyProperty;for(var D=0;D<E.length;D++){var C=E[D];var z=B.getData(C);G.push(z)}G=$.su.json.toJSONString(G);B.remove(E,{operation:"block",data:G},function(I,J){var K=n.grid("getStore");K.load();var H=o.grid("getStore");H.load();d.grid("getStore").load()})}}]}).on("ev_load",function(B,z){var A=$(this);$(z).each(function(C,D){if(D.host=="HOST"){A.grid("disableRow",C)}if(D.guest=="GUEST"&&$("input#enable_guest").switchbutton("getValue")=="on"){A.grid("getStore").removeDataByKey([D.key])}})});d.delegate("a.btn-access-block","click",function(){var C=$(this).attr("data-index"),B=d.grid("getStore"),z=B.keyProperty;var A={};A.data=$.su.clone(B.data);var D=[];var E=A.data[C];key=E[z];D.push(E);E=$.su.json.toJSONString(D);if($(d).find(".grid-content-tr-"+key).hasClass("disabled")){return}if(!key){return}else{B.remove(key,{operation:"block",data:E},function(F,G){var H=n.grid("getStore");H.load();d.grid("getStore").load()},function(){})}delete A});$("div#black_list").panel({title:$.su.CHAR.ACCESS_CTR.DEVICE_IN_BLACK,collapsible:false});var k=new $.su.Proxy({url:s});var i=new $.su.Store({proxy:k,fields:[{name:"name"},{name:"mac"}],autoLoad:true});var n=$("div#black_grid").grid({store:i,paging:{},editor:{content:"default",validator:function(){var C=n.grid("getStore");keyProperty=C.keyProperty;grid_array=C.data;var D=$(n.grid("getEditor"));var A=D.find("input[name=mac]").val();if(w.toUpperCase()==A.toUpperCase()){D.find("input[name=mac]").textbox("setError");$(n.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000064"]);return false}var z=grid_array.length;if($.isArray(grid_array)&&z>0){for(var B=0;B<z;B++){if(D[0].editing){if(grid_array[B].key==D[0].editingId){continue}}var E=grid_array[B];if(E.mac.toUpperCase()==A.toUpperCase()){D.find("input[name=mac]").textbox("setError");$(n.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000051"]);return false}}}return true}},columns:[{xtype:"checkcolumn",width:32},{text:$.su.CHAR.ACCESS_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.ACCESS_CTR.NAME,width:250,dataIndex:"name",editor:{xtype:"textbox",allowBlank:true,vtype:"string_visible_allow_blank",maxLength:32}},{text:$.su.CHAR.ACCESS_CTR.MAC_ADDRESS,width:250,dataIndex:"mac",editor:{xtype:"textbox",allowBlank:false,vtype:"mac",maxLength:17}},{xtype:"settings"}],operation:"prompt|add|delete"}).on({ev_update:function(){var z=d.grid("getStore");z.load()},ev_remove:function(){var z=d.grid("getStore");z.load()}});$("div#white_devices_online").panel({title:$.su.CHAR.ACCESS_CTR.DEVICE_ONLINE,collapsible:false});var j=new $.su.Proxy({url:x});var g=$("div#online_white_grid").grid({store:{proxy:j,fields:[{name:"name"},{name:"ipaddr"},{name:"mac"},{name:"host"},{name:"conn_type"}],autoLoad:true},paging:{},columns:[{text:$.su.CHAR.ACCESS_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.ACCESS_CTR.NAME,width:180,dataIndex:"name"},{text:$.su.CHAR.ACCESS_CTR.IP_ADDRESS,width:120,dataIndex:"ipaddr"},{text:$.su.CHAR.ACCESS_CTR.MAC_ADDRESS,width:150,dataIndex:"mac"},{text:$.su.CHAR.ACCESS_CTR.CONN_TYPE,dataIndex:"conn_type",renderer:function(z){if(z=="wireless"){return $.su.CHAR.ACCESS_CTR.WIRELESS}else{return $.su.CHAR.ACCESS_CTR.WIRED}}}],operation:"refresh"}).on("ev_load",function(B,z){var A=$(this);$(z).each(function(C,D){if(D.guest=="GUEST"){A.grid("getStore").removeDataByKey([D.key])}})});$("div#white_list").panel({title:$.su.CHAR.ACCESS_CTR.DEVICE_IN_WHITE,collapsible:false});var a=new $.su.Proxy({url:b});var u=new $.su.Store({proxy:a,fields:[{name:"name"},{name:"host"},{name:"mac"}],autoLoad:true});var o=$("div#white_grid").grid({store:u,editor:{content:"default",validator:function(){var C=o.grid("getStore");keyProperty=C.keyProperty;grid_array=C.data;var D=$(o.grid("getEditor"));var A=D.find("input[name=mac]").val();var z=grid_array.length;if($.isArray(grid_array)&&z>0){for(var B=0;B<z;B++){if(w==A){D.find("input[name=mac]").textbox("setError");$(o.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000064"]);return false}if(D[0].editing){if(grid_array[B].key==D[0].editingId){continue}}var E=grid_array[B];if(E.mac==A){D.find("input[name=mac]").textbox("setError");$(o.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000051"]);return false}}}return true}},paging:{},columns:[{xtype:"checkcolumn",width:32},{text:$.su.CHAR.ACCESS_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.ACCESS_CTR.NAME,width:250,dataIndex:"name",editor:{xtype:"textbox",allowBlank:true,vtype:"string_visible",maxLength:32}},{text:$.su.CHAR.ACCESS_CTR.MAC_ADDRESS,width:250,dataIndex:"mac",vtype:"mac",maxLength:17,editor:{xtype:"textbox",allowBlank:false,vtype:"mac",maxLength:17}},{xtype:"settings"}],operation:"prompt|add|delete"}).on("ev_load",function(B,z){var A=$(this);$(z).each(function(C,D){if(D.host=="HOST"){A.grid("disableRow",C)}})}).on({ev_update:function(){var z=g.grid("getStore");z.load()},ev_remove:function(){var z=g.grid("getStore");z.load()}});var q;if(window.sysMode=="re"){q=["ACCESS_CONTROL_RE","ACCESS_DEVICE"]}else{q=["ACCESS_CONTROL","ACCESS_DEVICE"]}var p=new $.su.Help({container:"div#help_access_control",content:q})});</script>
</body>
</html>
