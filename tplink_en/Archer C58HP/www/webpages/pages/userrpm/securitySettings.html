<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Parental Control</title>
</head>
<body>
<div class="func-container">
	 <div id="firewall">
	    	<input type="text"  id="enable_spi" name="enable" value="" />
	 </div>
	 <div id="dos_protection">
	 	<form id="dos_setting">
	    	<input type="text"  id="enable_dos" name="enable" value="" />
	    	<span id="enable_dos_tip"></span>
	    	<input type="text"  id="security_icmp" name="icmp_level" value="" />
	    	<input type="text"  id="security_udp" name="udp_level" value="" />
	    	<input type="text"  id="security_syn" name="syn_level" value="" />
	    	<input type="text"  id="wan_ping" name="wan_ping" value="" />
	    	<input type="text"  id="lan_ping" name="lan_ping" value="" />
	    </form>
	 </div>
	 <div id="dos_host_list">
	 	<div id="dosGrid">
	 	</div>
	 </div>
	<div id="help_security_setting"></div>
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(i){var k=$.su.url("/admin/security_settings?form=spi_enable");var m=$.su.url("/admin/security_settings?form=enable");var d=$.su.url("/admin/security_settings?form=dos");var g=$.su.url("/admin/security_settings?form=list");var a=$.su.url("/admin/traffic?form=status");var j=$.su.url("/admin/security_settings?form=dos&form=ping");$("div.func-container").page({title:$.su.CHAR.SECURITY_SETTING.FIREWALL,help:""});$("div#firewall").panel({title:$.su.CHAR.SECURITY_SETTING.FIREWALL,collapsible:false});var n=new $.su.Proxy({url:k});$("input#enable_spi").switchbutton({fieldLabel:$.su.CHAR.SECURITY_SETTING.ENABLE_SPI,labelCls:"xl",cls:"form-inner",proxy:n,field:{name:"enable"}});$("div#dos_protection").panel({title:$.su.CHAR.SECURITY_SETTING.DOS_PROTECTION,collapsible:false});var l=new $.su.Proxy({url:m});$("input#enable_dos").switchbutton({fieldLabel:$.su.CHAR.SECURITY_SETTING.ENABLE_DOS,labelCls:"xl",tips:$.su.CHAR.SECURITY_SETTING.ENABLE_DOS_TIP,tipsCls:"l",proxy:l,field:{name:"enable"}});$("input#security_icmp").combobox({fieldLabel:$.su.CHAR.SECURITY_SETTING.ICMP,labelCls:"xl",items:[{name:$.su.CHAR.SECURITY_SETTING.OFF,cls:"l",value:"off"},{name:$.su.CHAR.SECURITY_SETTING.LOW,cls:"l",value:"low"},{name:$.su.CHAR.SECURITY_SETTING.MIDDLE,cls:"m",value:"middle"},{name:$.su.CHAR.SECURITY_SETTING.HIGH,cls:"m",value:"high"}]});$("input#security_udp").combobox({fieldLabel:$.su.CHAR.SECURITY_SETTING.UDP,labelCls:"xl",items:[{name:$.su.CHAR.SECURITY_SETTING.OFF,cls:"l",value:"off"},{name:$.su.CHAR.SECURITY_SETTING.LOW,cls:"l",value:"low"},{name:$.su.CHAR.SECURITY_SETTING.MIDDLE,cls:"m",value:"middle"},{name:$.su.CHAR.SECURITY_SETTING.HIGH,cls:"m",value:"high"}]});$("input#security_syn").combobox({fieldLabel:$.su.CHAR.SECURITY_SETTING.TCP,labelCls:"xl",items:[{name:$.su.CHAR.SECURITY_SETTING.OFF,cls:"l",value:"off"},{name:$.su.CHAR.SECURITY_SETTING.LOW,cls:"l",value:"low"},{name:$.su.CHAR.SECURITY_SETTING.MIDDLE,cls:"m",value:"middle"},{name:$.su.CHAR.SECURITY_SETTING.HIGH,cls:"m",value:"high"}]});$("input#wan_ping").checkbox({fieldLabel:"",labelCls:"xl",items:[{boxlabel:$.su.CHAR.SECURITY_SETTING.IGNORE,inputValue:"off",uncheckedValue:"on"}]});$("input#lan_ping").checkbox({fieldLabel:"",labelCls:"xl",items:[{boxlabel:$.su.CHAR.SECURITY_SETTING.FORBID,inputValue:"off",uncheckedValue:"on"}]});var c=new $.su.Proxy({url:j});var b=new $.su.Proxy({url:a});$("form#dos_setting").form({proxy:c,fields:[{name:"icmp_level",mapping:"icmp_level"},{name:"udp_level",mapping:"udp_level"},{name:"syn_level",mapping:"syn_level"},{name:"wan_ping",mapping:"wan_ping"},{name:"lan_ping",mapping:"lan_ping"}],submitBtn:"default"}).on("ev_loadData",function(){b.read(null,function(o){if(o.enable=="on"){$("input#enable_dos").switchbutton("enable");$("input#enable_dos").switchbutton("setTips","")}else{$("input#enable_dos").switchbutton("disable");$("input#enable_dos").switchbutton("setTips",$.su.CHAR.SECURITY_SETTING.ENABLE_DOS_TIP)}})});$("div#dos_host_list").panel({title:$.su.CHAR.SECURITY_SETTING.BLOCK_DOS,collapsible:false});var f=new $.su.Proxy({url:g});$("div#dosGrid").grid({store:{proxy:f,fields:[{name:"ipaddr"},{name:"mac"}],autoLoad:true},minLines:0,paging:{},columns:[{xtype:"checkcolumn",width:40},{text:$.su.CHAR.SECURITY_SETTING.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.SECURITY_SETTING.IP_ADDRESS,width:250,dataIndex:"ipaddr"},{text:$.su.CHAR.SECURITY_SETTING.MAC_ADDRESS,dataIndex:"mac"}],operation:[{xtype:"totalCount",cls:"left",fieldLabel:$.su.CHAR.SECURITY_SETTING.HOST_NUMBER},"refresh","delete"]});$.su.app.runningModule.addUnloadHandler(function(){});var h=new $.su.Help({container:"div#help_security_setting",content:["SECURITY_FIREWALL","SECURITY_DOS","SECURITY_LIST"]})});</script>
</body>
</html>