var __slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};!function($,window){var SimpleSlider;SimpleSlider=function(){function SimpleSlider(input,options){var ratio,_this=this;this.maxLimits=Number.MAX_VALUE,this.minLimits=Number.MIN_VALUE,this.input=input,this.defaultOptions={animate:!0,snapMid:!1,classPrefix:null,classSuffix:null,theme:null,highlight:!1},this.settings=$.extend({},this.defaultOptions,options),this.settings.theme&&(this.settings.classSuffix="-"+this.settings.theme),this.input.hide(),this.slider=$("<div>").addClass("slider"+(this.settings.classSuffix||"")).css({position:"relative",userSelect:"none",boxSizing:"border-box"}).insertBefore(this.input),this.input.attr("id")&&this.slider.attr("id",this.input.attr("id")+"-slider"),this.track=this.createDivElement("track").css({width:"100%"}),this.settings.highlight&&(this.highlightTrack=this.createDivElement("highlight-track").css({width:"0"})),this.dragger=this.createDivElement("dragger"),this.slider.css({minHeight:this.dragger.outerHeight(),marginLeft:this.dragger.outerWidth()/2,marginRight:this.dragger.outerWidth()/2}),this.track.css({marginTop:this.track.outerHeight()/-2}),this.settings.highlight&&this.highlightTrack.css({marginTop:this.track.outerHeight()/-2}),this.dragger.css({marginTop:this.dragger.outerHeight()/-2,marginLeft:this.dragger.outerWidth()/-2}),this.track.mousedown(function(e){return _this.trackEvent(e)}),this.settings.highlight&&this.highlightTrack.mousedown(function(e){return _this.trackEvent(e)}),this.dragger.mousedown(function(e){if(1===e.which)return _this.dragging=!0,_this.dragger.addClass("dragging"),_this.domDrag(e.pageX,e.pageY),!1}),$("body").mousemove(function(e){if(_this.dragging)return _this.domDrag(e.pageX,e.pageY),$("body").css({cursor:"pointer"})}).mouseup(function(e){if(_this.dragging)return _this.dragging=!1,_this.dragger.removeClass("dragging"),$("body").css({cursor:"auto"})}),this.pagePos=0,""===this.input.val()?(this.value=this.getRange().min,this.input.val(this.value)):this.value=this.nearestValidValue(this.input.val()),this.setSliderPositionFromValue(this.value),ratio=this.valueToRatio(this.value),this.input.trigger("slider:ready",{value:this.value,ratio:ratio,position:ratio*this.slider.outerWidth(),el:this.slider})}return SimpleSlider.prototype.createDivElement=function(classname){return $("<div>").addClass(classname).css({position:"absolute",top:"50%",userSelect:"none",cursor:"pointer"}).appendTo(this.slider)},SimpleSlider.prototype.setRatio=function(ratio){var value;return ratio=Math.min(1,ratio),ratio=Math.max(0,ratio),value=this.ratioToValue(ratio),this.setSliderPositionFromValue(value),this.valueChanged(value,ratio,"setRatio")},SimpleSlider.prototype.setValue=function(value){var ratio;return value=this.nearestValidValue(value),ratio=this.valueToRatio(value),this.setSliderPositionFromValue(value),this.valueChanged(value,ratio,"setValue")},SimpleSlider.prototype.trackEvent=function(e){if(1===e.which)return this.domDrag(e.pageX,e.pageY,!0),this.dragging=!0,!1},SimpleSlider.prototype.domDrag=function(pageX,pageY,animate){var pagePos,ratio,value;if(null==animate&&(animate=!1),pagePos=pageX-this.slider.offset().left,pagePos=Math.min(this.slider.outerWidth(),pagePos),pagePos=Math.max(0,pagePos),this.pagePos!==pagePos)return this.pagePos=pagePos,ratio=pagePos/this.slider.outerWidth(),(value=this.ratioToValue(ratio))>this.maxLimits?void this.setValue(this.maxLimits):value<this.minLimits?void this.setValue(this.minLimits):(this.valueChanged(value,ratio,"domDrag"),this.settings.snap?this.setSliderPositionFromValue(value,animate):this.setSliderPosition(pagePos,animate))},SimpleSlider.prototype.setSliderPosition=function(position,animate){if(null==animate&&(animate=!1),animate&&this.settings.animate){if(this.dragger.animate({left:position},200),this.settings.highlight)return this.highlightTrack.animate({width:position},200)}else if(this.dragger.css({left:position}),this.settings.highlight)return this.highlightTrack.css({width:position})},SimpleSlider.prototype.setSliderPositionFromValue=function(value,animate){var ratio;return null==animate&&(animate=!1),ratio=this.valueToRatio(value),this.setSliderPosition(ratio*this.slider.outerWidth(),animate)},SimpleSlider.prototype.getRange=function(){return this.settings.allowedValues?{min:Math.min.apply(Math,this.settings.allowedValues),max:Math.max.apply(Math,this.settings.allowedValues)}:this.settings.range?{min:parseFloat(this.settings.range[0]),max:parseFloat(this.settings.range[1])}:{min:0,max:1}},SimpleSlider.prototype.nearestValidValue=function(rawValue){var closest,maxSteps,range,steps;return range=this.getRange(),rawValue=Math.min(range.max,rawValue),rawValue=Math.max(range.min,rawValue),this.settings.allowedValues?(closest=null,$.each(this.settings.allowedValues,function(){if(null===closest||Math.abs(this-rawValue)<Math.abs(closest-rawValue))return closest=this}),closest):this.settings.step?(maxSteps=(range.max-range.min)/this.settings.step,steps=Math.floor((rawValue-range.min)/this.settings.step),(rawValue-range.min)%this.settings.step>this.settings.step/2&&steps<maxSteps&&(steps+=1),steps*this.settings.step+range.min):rawValue},SimpleSlider.prototype.valueToRatio=function(value){var allowedVal,closest,closestIdx,idx,range,_i,_len,_ref;if(this.settings.equalSteps){for(idx=_i=0,_len=(_ref=this.settings.allowedValues).length;_i<_len;idx=++_i)allowedVal=_ref[idx],(void 0===closest||null===closest||Math.abs(allowedVal-value)<Math.abs(closest-value))&&(closest=allowedVal,closestIdx=idx);return this.settings.snapMid?(closestIdx+.5)/this.settings.allowedValues.length:closestIdx/(this.settings.allowedValues.length-1)}return range=this.getRange(),(value-range.min)/(range.max-range.min)},SimpleSlider.prototype.ratioToValue=function(ratio){var idx,range,rawValue,step,steps;return this.settings.equalSteps?(steps=this.settings.allowedValues.length,step=Math.round(ratio*steps-.5),idx=Math.min(step,this.settings.allowedValues.length-1),this.settings.allowedValues[idx]):(range=this.getRange(),rawValue=ratio*(range.max-range.min)+range.min,this.nearestValidValue(rawValue))},SimpleSlider.prototype.valueChanged=function(value,ratio,trigger){var eventData;if(value.toString()!==this.value.toString())return this.value=value,eventData={value:value,ratio:ratio,position:ratio*this.slider.outerWidth(),trigger:trigger,el:this.slider},this.input.val(value).trigger($.Event("change",eventData)).trigger("slider:changed",eventData)},SimpleSlider.prototype.setLimits=function(min,max){this.minLimits=this.nearestValidValue(min),this.maxLimits=this.nearestValidValue(max),this.value>this.maxLimits&&this.setValue(this.maxLimits),this.value<this.minLimits&&this.setValue(this.minLimits)},SimpleSlider}(),$.extend($.fn,{simpleSlider:function(){var params,publicMethods,settingsOrMethod;return settingsOrMethod=arguments[0],params=2<=arguments.length?__slice.call(arguments,1):[],publicMethods=["setRatio","setValue","setLimits"],$(this).each(function(){var obj,settings;return settingsOrMethod&&__indexOf.call(publicMethods,settingsOrMethod)>=0?(obj=$(this).data("slider-object"))[settingsOrMethod].apply(obj,params):(settings=settingsOrMethod,$(this).data("slider-object",new SimpleSlider($(this),settings)))})}}),$(function(){return $("[data-slider]").each(function(){var $el,allowedValues,settings,x;return $el=$(this),settings={},(allowedValues=$el.data("slider-values"))&&(settings.allowedValues=function(){var _i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=allowedValues.split(",")).length;_i<_len;_i++)x=_ref[_i],_results.push(parseFloat(x));return _results}()),$el.data("slider-range")&&(settings.range=$el.data("slider-range").split(",")),$el.data("slider-step")&&(settings.step=$el.data("slider-step")),settings.snap=$el.data("slider-snap"),settings.equalSteps=$el.data("slider-equal-steps"),$el.data("slider-theme")&&(settings.theme=$el.data("slider-theme")),$el.attr("data-slider-highlight")&&(settings.highlight=$el.data("slider-highlight")),null!=$el.data("slider-animate")&&(settings.animate=$el.data("slider-animate")),$el.simpleSlider(settings)})})}(this.jQuery||this.Zepto);