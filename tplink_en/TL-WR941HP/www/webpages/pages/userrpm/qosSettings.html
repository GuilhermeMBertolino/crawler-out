<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>QoS</title>
</head>
<body>
<div class="func-container">
	<div id="qosset">
		<form id="qos-setting">
			<input type="text"  id="enable" name="enable" value="" />
			<div class="widget-container">
				<input type="text"  id="up_band" name="up_band" value="" />
				<input id="up_unit" name="up_unit" />
			</div>
			<div class="widget-container">
				<input type="text"  id="down_band" name="down_band" value="" />
				<input id="down_unit" name="down_unit" />	 
			</div>
			<div  class="widget-container part-seperate">
				<input id="qos_type" name="qos_type" />	 
			</div>
			<div id="qos_adv" class="">
				<input type="text"  id="high" name="high" value="" />
				<input type="text"  id="middle" name="middle" value="" />
				<input type="text"  id="low" name="low" value="" />
			</div>
			<button type="button" id="submit_btn"> </button>
		</form>   	
	</div>
	<div id="qoslist">
		 <div id="high_panel"  class="status-panel qos-panel access-wired-panel access-priority-panel">
	     	<h4 class="status" id="high_status">
	     	</h4>
	     	<div id="access-panel" class="status-panel-main status-panel-main-pad access-panel-left">
		  		<div class="status-access-block wired-block">
		  			<div id="high_list" class="access-client-list">
		  			</div>
		  		</div>
		  		<button id="add_btn_high" class="add_btn" type="button"></button>
		    </div>
	     </div>
	      <div id="middle_panel"  class="status-panel qos-panel access-wired-panel access-priority-panel">
	     	<h4 class="status"  id="middle_status">
	     	</h4>
	     	<div id="access-panel" class="status-panel-main status-panel-main-pad access-panel-left">
		  		<div class="status-access-block wired-block">
		  			<div id="middle_list" class="access-client-list">
		  			</div>
		  		</div>
		  		<button id="add_btn_middle" class="add_btn"  type="button"></button>
		    </div>
	     </div>
	     <div id="low_panel"  class="status-panel qos-panel access-wired-panel  access-priority-panel">
	     	<h4 class="status"   id="low_status">
	     	</h4>
	     	<div id="access-panel" class="status-panel-main status-panel-main-pad access-panel-left">
		  		<div class="status-access-block wired-block">
		  			<div id="low_list" class="access-client-list">
		  			</div>
		  		</div>
		  		<button id="add_btn_low" class="add_btn" type="button"></button>
		    </div>
	     </div>
		<div id="qossetting-warning-msg" class="hidden warning">
			<h4 class="title">
				<span class="icon"></span>
				<span class="text" id="qossetting-warning-text-toomany-items"></span>
			</h4>
		</div>
	</div>
	<div id="bandwidth_control_list">
		<div id="bandwid_grid"></div>
		<div id="bandwid_edit_content">
				<input id="bandwid_source_ip_range" name="source_ip_range"/>
				<span class="qos-bwc-seperator">-</span>
				<input id="bandwid_destination_ip_range" name="destination_ip_range"/>
			<div class="widget-container">
				<input id="bandwid_max_egress" name="max_egress"/>
				<input id="bcl_egress_unit" name="bcl_egress_unit" />
			</div>
			<div class="widget-container">
				<input id="bandwid_max_ingress" name="max_ingress"/>
				<input id="bcl_ingress_unit" name="bcl_ingress_unit" />
			</div>
			<input id="bandwid_enable" name="enable"/>
		</div>
	</div>
	<div id="app_list_content">
	<form id="add_item">
	   <div id="app_list_all_container">
	   	  <input type="text" id="method_rd" name="method" />
	   	  <div id="device_cnt">
	   	  	<input id="device_name" name="device_name">
			<button   type="button"  id="device_view"></button>
			<input id="mac_addr" name="mac">
	   	  </div>
	   	  <div id="phy_cnt"  class="">
	   	  	<input type="text"  id="rule_phy" name="phy" value="" />
	   	  </div>
			<div id="app_cnt"  class="">
				<div id="app_list_container">
				   <input type="hidden" name="rule_app" id="rule_app" />
				</div>
			</div>
	   </div>
	   <input type="hidden" name="priority" id="rule_priority" />
	</form>
	</div>
	<div id="upgrade_alert_cnt">
	 	<div id="upload_loading_msg" class="reboot-loading-msg">
    		      <p id="note" class="reboot-progressbar-text"></p>
	    	      <input id="pro_bar" type="text" />
	    </div>
	</div>
	<div id="device_survey">
 		<div id="device_result">	
		</div>
 	</div>	
	<div id="help_qos"></div>
</div>
<script type="text/javascript">var URL_QOS_STATUS_NEW=$.su.url("/admin/qos?form=enable");var URL_QOS_SET_NEW=$.su.url("/admin/qos?form=settings");var URL_QOS_ADD_NEW=$.su.url("/admin/qos?form=add");var URL_QOS_LIST_NEW=$.su.url("/admin/qos?form=list");var URL_QOS_APP_LIST_NEW=$.su.url("/admin/qos?form=applist");var URL_BWCONTROL_LIST=$.su.url("/admin/qos?form=bandwidth_control_list");var URL_ONLINE_BLACK=$.su.url("/admin/access_control?form=black_devices");var UPGRADE_URL="./data/qos.upgrade.json";var UPGRADE_URL_NEW=$.su.url("/admin/qos?form=upgrade");var SYS_NAT_URL_NEW=$.su.url("/admin/nat?form=setting");var sysNatProxy=new $.su.Proxy({url:SYS_NAT_URL_NEW});var query_proxy=new $.su.Proxy({url:UPGRADE_URL_NEW});var appIdList={};var typeIdList={};var highCount=0;var middleCount=0;var lowCount=0;var scrollCount=3;var usedDeviceItem=[];var usedPhsicalPortItem=[];var usedAppItem=[];var usedCustomItem=[];var wait_time=1000;var max_items=32;var current_items=0;var allowDrag=false;var dragObj={};var doing_list_delete=false;var iptv_enable=false;var IPTV_URL_NEW=$.su.url("/admin/iptv?form=setting");var iptvProxy=new $.su.Proxy({url:IPTV_URL_NEW});var oldAction="";var lanIP=0;var lanMask=0;var lanProxy=new $.su.Proxy({url:$.su.url("/admin/network?form=lan_ipv4")});lanProxy.read({},function(a){lanIP=a.ipaddr;lanMask=a.mask_type.toUpperCase()=="CUSTOM"?a.custom_value:a.mask_type});$(document).ready(function(I){function j(Q,S,P){var O=$("#high").slider("getValue");var N=$("#middle").slider("getValue");var R=$("#low").slider("getValue");if(O-5<N){$("#middle").slider("setValue",O-5);N=$("#middle").slider("getValue")}if(N-5<R){$("#low").slider("setValue",N-5);R=$("#low").slider("getValue")}var e=100;if(Q=="high"){e=100-O-N;$("#low").slider("setRange",[0,e]);e=100-O-R;$("#middle").slider("setRange",[0,e])}if(Q=="middle"){e=100-O-N;$("#low").slider("setRange",[0,e]);e=100-N-R;$("#high").slider("setRange",[0,e])}if(Q=="low"){e=100-R-N;$("#high").slider("setRange",[0,e]);e=100-O-R;$("#middle").slider("setRange",[0,e])}}$("#qos_adv").fieldset({fields:[{name:"low"},{name:"middle"},{name:"high"}]});$("div.func-container").page({title:$.su.CHAR.QOS.TITLE,help:""});$("input#enable").checkbox({fieldLabel:$.su.CHAR.QOS.TITLE,tips:"",items:[{boxlabel:$.su.CHAR.QOS.STATUS,inputValue:"on",uncheckedValue:"off"}]});$("div#qosset").panel({title:$.su.CHAR.QOS.TITLE,collapsible:false});var K=1;var u=1000;var x=100;$("input#up_band").textbox({fieldLabel:$.su.CHAR.QOS.UPBANDWIDTH,inputCls:"m",maxLength:4,vtype:"number",validator:function(N){var e=$("input#up_unit").combobox("getValue");if(e=="mbps"&&(N<K||N>x)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",x.toString());return O}else{if(e=="kbps"&&(N<K||N>u)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",u.toString());return O}}return true},allowBlank:false,cls:"inline-block",textFormat:$.su.format.floatFormat});$("input#up_unit").combobox({fieldLabel:null,inputCls:"s",cls:"inline-block",items:[{value:"mbps",name:$.su.CHAR.QOS.SPEED_M,selected:"selected"},{value:"kbps",name:$.su.CHAR.QOS.SPEED_K}]});$("input#down_band").textbox({fieldLabel:$.su.CHAR.QOS.DOWNBANDWIDTH,inputCls:"m",maxLength:4,cls:"inline-block",vtype:"number",validator:function(N){var e=$("input#down_unit").combobox("getValue");if(e=="mbps"&&(N<K||N>x)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",x.toString());return O}else{if(e=="kbps"&&(N<K||N>u)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",u.toString());return O}}return true},allowBlank:false,textFormat:$.su.format.floatFormat});$("input#down_unit").combobox({fieldLabel:null,inputCls:"s",cls:"inline-block",items:[{value:"mbps",name:$.su.CHAR.QOS.SPEED_M,selected:"selected"},{value:"kbps",name:$.su.CHAR.QOS.SPEED_K}]});$("#qos_adv").fieldset("show");$("input#qos_type").combobox({fieldLabel:$.su.CHAR.QOS.QOS_TYPE,inputCls:"xl",items:[{value:"qos",name:$.su.CHAR.QOS.QOS,selected:"selected"},{value:"bwcontrol",name:$.su.CHAR.QOS.BANDWIDTH_CONTROL}]}).on("ev_change",function(P,N,O){if(O[0]==="qos"){$("#qos_adv").fieldset("show");$("#qoslist").panel("show");$("#bandwidth_control_list").panel("hide")}else{$("#qos_adv").fieldset("hide");$("#qoslist").panel("hide");$("#bandwidth_control_list").panel("show")}});$("input#high").slider({fieldLabel:$.su.CHAR.QOS.HIGH_PRIORITY,minValue:15}).on("ev_change",function(P,N,O){j("high",O,N)});$("input#middle").slider({fieldLabel:$.su.CHAR.QOS.MIDDLE_PRIORITY,minValue:10}).on("ev_change",function(P,N,O){j("middle",O,N)});$("input#low").slider({fieldLabel:$.su.CHAR.QOS.LOW_PRIORITY,minValue:5}).on("ev_change",function(P,N,O){j("low",O,N)});$("#upgrade_alert_cnt").msg({cls:"warning reboot-confirm-size",closeBtn:false,type:"window"});$("#note").html($.su.CHAR.QOS.SERVICE_RESTART);var w=$("#pro_bar").progressbar({fieldLabel:null,cls:"inline",width:300,height:6,value:0});$("#submit_btn").button({text:$.su.CHAR.OPERATION.SAVE,cls:"submit",handler:function(){if(!$("form#qos-setting").form("validate")){return false}$("form#qos-setting").form("submit",{},function(){},null,null,false);w.progressbar("animate",0,1,wait_time,function(){$("#upgrade_alert_cnt").msg("close");$("form#qos-setting").form("prompt",true)});$("#upgrade_alert_cnt").msg("show")}});var o=new $.su.Proxy({url:URL_QOS_SET_NEW});$("form#qos-setting").form({proxy:o,fields:[{name:"enable",mapping:"enable"},{name:"up_band",mapping:"up_band"},{name:"down_band",mapping:"down_band"},{name:"up_unit",mapping:"up_unit"},{name:"down_unit",mapping:"down_unit"},{name:"high",mapping:"high"},{name:"middle",mapping:"middle"},{name:"low",mapping:"low"},{name:"qos_type",mapping:"qos_type"}],submitBtn:"#submit_btn"}).on("ev_loadData",function(O,N){wait_time=N.time*1000||wait_time;$("#high_status").html($.su.CHAR.QOS.HIGH_PRIORITY_LBL+N.high+"%");$("#middle_status").html($.su.CHAR.QOS.MIDDLE_PRIORITY_LBL+N.middle+"%");$("#low_status").html($.su.CHAR.QOS.LOW_PRIORITY_LBL+N.low+"%");if(N.qos_type==="qos"){$("#qos_adv").fieldset("show");$("#qoslist").panel("show");$("#bandwidth_control_list").panel("hide")}else{$("#qos_adv").fieldset("hide");$("#qoslist").panel("hide");$("#bandwidth_control_list").panel("show")}}).one("ev_loadData",function(P,O){enable_app=O.enable_app;enable_phy=O.enable_phy;var N=[];N.push({boxlabel:$.su.CHAR.QOS.BY_DEVICE,inputValue:"device",checked:true});if(enable_app=="on"){N.push({boxlabel:$.su.CHAR.QOS.BY_APP,inputValue:"app"})}if(enable_phy=="on"){N.push({boxlabel:$.su.CHAR.QOS.BY_PHY,inputValue:"phy"})}$("#method_rd").radio({fieldLabel:$.su.CHAR.QOS.TYPE,labelCls:"s",columns:3,allowBlank:false,items:N}).on("ev_change",function(S,Q,R){if(R=="device"){$("#device_cnt").fieldset("show");$("#phy_cnt").fieldset("hide");$("#app_cnt").fieldset("hide")}if(R=="app"){$("#device_cnt").fieldset("hide");$("#phy_cnt").fieldset("hide");$("#app_cnt").fieldset("show");$("#custom_cnt").fieldset("hide")}if(R=="phy"){$("#device_cnt").fieldset("hide");$("#phy_cnt").fieldset("show");$("#app_cnt").fieldset("hide")}$("#app_list_content").msg("setPosition","center","center")})});var L=new $.su.Proxy({url:URL_QOS_ADD_NEW,autoLoad:false});$("div#qoslist").panel({title:$.su.CHAR.QOS.RULE_LIST,collapsible:false});$("#rule_name").textbox({fieldLabel:$.su.CHAR.QOS.NAME,labelCls:"s",vtype:"string_visible_allow_blank",minLength:0,maxLength:32,allowBlank:true});$("input#bandwid_source_ip_range").textbox({fieldLabel:$.su.CHAR.QOS.IP_RANGE,vtype:"ip",allowBlank:false,labelCls:"l",inputCls:"m",cls:"inline-block"});$("input#bandwid_destination_ip_range").textbox({fieldLabel:null,vtype:"ip",allowBlank:false,inputCls:"m",cls:"inline-block"});$("input#bandwid_max_egress").textbox({fieldLabel:$.su.CHAR.QOS.MAX_EGRESS_EDIT,vtype:"number",allowBlank:false,maxLength:4,labelCls:"l",cls:"inline-block",validator:function(N){var e=$("input#bcl_egress_unit").combobox("getValue");if(e=="mbps"&&(N<K||N>x)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",x.toString());return O}else{if(e=="kbps"&&(N<K||N>u)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",u.toString());return O}}return true},textFormat:$.su.format.floatFormat});$("input#bcl_egress_unit").combobox({fieldLabel:null,inputCls:"s",cls:"inline-block",items:[{value:"mbps",name:$.su.CHAR.QOS.SPEED_M,selected:"selected"},{value:"kbps",name:$.su.CHAR.QOS.SPEED_K}]});$("input#bandwid_max_ingress").textbox({fieldLabel:$.su.CHAR.QOS.MAX_INGRESS_EDIT,vtype:"number",allowBlank:false,maxLength:4,labelCls:"l",cls:"inline-block",validator:function(N){var e=$("input#bcl_ingress_unit").combobox("getValue");if(e=="mbps"&&(N<K||N>x)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",x.toString());return O}else{if(e=="kbps"&&(N<K||N>u)){var O=$.su.CHAR.VTYPETEXT.NUMBER_MIN_MAX.replace("%min",K.toString()).replace("%max",u.toString());return O}}return true},textFormat:$.su.format.floatFormat});$("input#bcl_ingress_unit").combobox({fieldLabel:null,inputCls:"s",cls:"inline-block",items:[{value:"mbps",name:$.su.CHAR.QOS.SPEED_M,selected:"selected"},{value:"kbps",name:$.su.CHAR.QOS.SPEED_K}]});$("input#bandwid_enable").checkbox({fieldLabel:"",labelCls:"l",items:[{boxlabel:$.su.CHAR.DHCP_SERVER.ENABLE,inputValue:"on",uncheckedValue:"off",checked:true}]});$("div#bandwidth_control_list").panel({title:$.su.CHAR.QOS.BANDWIDTH_CONTROL_LIST,collapsible:false});var n=new $.su.Proxy({url:URL_BWCONTROL_LIST,});var y=new $.su.Store({proxy:n,fields:[{name:"description"},{name:"max_egress"},{name:"max_ingress"},{name:"enable"},{name:"source_ip_range"},{name:"destination_ip_range"},{name:"bcl_egress_unit"},{name:"bcl_ingress_unit"}],autoLoad:true});var E=$("div#bandwid_grid").grid({store:y,paging:{},editor:{content:"#bandwid_edit_content",fields:[{name:"max_egress"},{name:"max_ingress"},{name:"source_ip_range"},{name:"destination_ip_range"},{name:"enable"},{name:"bcl_egress_unit"},{name:"bcl_ingress_unit"}],validator:function(N,e){var Q=$(E.grid("getEditor"));var O=$("input#bandwid_source_ip_range").textbox("getValue");var P=$("input#bandwid_destination_ip_range").textbox("getValue");if($.su.func.ipToInt(O)>$.su.func.ipToInt(P)){Q.form("setError",$.su.CHAR.ERROR["00000053"]);$("input#bandwid_destination_ip_range").textbox("setError");return false}return true}},columns:[{xtype:"checkcolumn",width:40},{text:$.su.CHAR.QOS.ID,xtype:"rownumberer",width:50},{text:$.su.CHAR.QOS.DESCRIPTION,width:160,dataIndex:"description",renderer:function(O,e,N){if(N.description!==undefined){return N.description}else{if(N.source_ip_range===undefined||N.destination_ip_range===undefined){return O}return N.source_ip_range+" - "+N.destination_ip_range}}},{text:$.su.CHAR.QOS.MAX_EGRESS,width:120,dataIndex:"max_egress"},{text:$.su.CHAR.QOS.MAX_INGRESS,width:100,dataIndex:"max_ingress"},{text:$.su.CHAR.GRID.STATUS,width:100,dataIndex:"enable",renderer:function(T,R,Q){var U=Q[E.grid("getStore").keyProperty];var P=E.grid("getColumns");var O=P[0];var e="";var S="",V="",N="";if(Q.enable==="on"){S=$.su.CHAR.GRID.ENABLED;V="enabled";N="on"}else{S=$.su.CHAR.GRID.DISABLED;V="disabled";N="off"}e+='<a href="javascript:void(0);" data-index="'+R+'" data-name="'+O.dataIndex+'" data-value="'+N+'" data-key="'+U+'" data-on="on" data-off="off" data-ip="'+Q.ip+'" class="grid-content-btn btn-status-change btn-status '+V+'">';e+='<span class="icon"></span>';e+='<span class="text">'+S+"</span>";e+="</a>";return e}},{xtype:"settings"}],operation:"prompt|add|delete"}).on({ev_update:function(){var e=E.grid("getStore");e.load()},ev_insert:function(){var e=E.grid("getStore");e.load()},ev_remove:function(){var e=E.grid("getStore");e.load()}});E.delegate("a.btn-status-change","click",function(W){W.preventDefault();W.stopPropagation();var aa=$(this).attr("data-key"),Z=$(this).attr("data-value"),Q=$(this).attr("data-on"),S=$(this).attr("data-off"),N=$(this).attr("data-name"),U=$(this).attr("data-index"),V=$(this).attr("data-ip"),Y=E.grid("getStore"),P=Y.keyProperty;dOld=Y.getData(aa);if(!aa){return}else{var X=$(this).closest("tr.grid-content-tr");if(X.hasClass("disabled")){return}var R=E.grid("getEditor");if(R&&R.isEditor){if(R.editing){$(R).editor("shake");return}}var O={};O.enable=(Z==="on")?"off":"on";var T=$.extend({},dOld,O);delete T[P];E.grid("runProgress");Y.update(aa,{old:$.su.json.toJSONString(dOld),"new":$.su.json.toJSONString(T)},function(){E.grid("prompt",true)},function(){E.grid("prompt",false)})}});function A(O,N){var P;for(var e=0;e<O.length;e++){P=O.charAt(e);if(N.indexOf(P)==-1){return false}}return true}function g(e){if(!A(e,"0123456789")){return false}if(parseInt(e,10)<=0||parseInt(e,10)>65535){return false}return true}function r(e){if(!g(e)){return false}return true}function b(T){if(!A(T,ch=",-0123456789")){return false}var S;var R;var P;var Q;P=new RegExp(",");Q=new RegExp("-");S=T.split(P);if(S.length>5||S.length<1){return false}for(var O=0;O<S.length;O++){if(S[O]==""){return false}for(var e=O+1;e<S.length;e++){if(S[O]==S[e]){return false}}R=S[O].split(Q);if(R.length!=1&&R.length!=2){return false}for(var N=0;N<R.length;++N){if(R[N]==""){return false}if(!r(R[N])){return false}}}return true}$("#rule_mac").textbox({fieldLabel:$.su.CHAR.QOS.MAC_ADDR,labelCls:"s",vtype:"mac",maxLength:17,allowBlank:false});$("#rule_ip_start").textbox({fieldLabel:$.su.CHAR.QOS.IP_ADDR,vtype:"ip",maxLength:15,textFormat:$.su.format.ip,labelCls:"s",cls:"inline-block",allowBlank:false});$("#rule_ip_end").textbox({fieldLabel:null,cls:"inline-block",vtype:"ip",maxLength:15,textFormat:$.su.format.ip,allowBlank:false});function A(O,N){var P;for(var e=0;e<O.length;e++){P=O.charAt(e);if(N.indexOf(P)==-1){return false}}return true}function g(e){if(!A(e,"0123456789")){return false}if(parseInt(e,10)<=0||parseInt(e,10)>65535){return false}return true}function r(e){if(!g(e)){return false}return true}function b(T){if(!A(T,ch=",-0123456789")){return false}var S;var R;var P;var Q;P=new RegExp(",");Q=new RegExp("-");S=T.split(P);if(S.length>5||S.length<1){return false}for(var O=0;O<S.length;O++){if(S[O]==""){return false}for(var e=O+1;e<S.length;e++){if(S[O]==S[e]){return false}}R=S[O].split(Q);if(R.length!=1&&R.length!=2){return false}for(var N=0;N<R.length;++N){if(R[N]==""){return false}if(!r(R[N])){return false}}}return true}function B(R,P){var Q=new RegExp("-");R=R.split(Q);P=P.split(Q);var N=-1;var O=parseInt(R[0],10);var e=R.length==1?O:parseInt(R[1],10);var T=parseInt(P[0],10);var S=P.length==1?T:parseInt(P[1],10);if(e<O){N=e;e=O;O=N}if(S<T){N=S;S=T;T=N}if((O<=T&&T<=e)||(O<=S&&S<=e)){return true}if((T<=O&&O<=S)||(T<=e&&e<=S)){return true}return false}function H(e,S){var R=new RegExp(",");var N=e+","+S;var Q=N.split(R);if(!b(e)||!b(S)){return false}for(var P=0;P<Q.length;P++){for(var O=P+1;O<Q.length;O++){if(B(Q[P],Q[O])){return true}}}return false}function v(N,e){if(N.name.toUpperCase()==e.name.toUpperCase()){return true}if(H(N.tcp_port,e.tcp_port)){return true}if(H(N.udp_port,e.udp_port)){return true}return false}var c=new $.su.Proxy({url:URL_QOS_LIST_NEW});function s(O,P){var e=O.length;for(var N=0;N<e;N++){if(P.toUpperCase()==O[N].mac.toUpperCase()){return true}}return false}function G(V,W,P,U,T,O){var Q=[];var N=0;for(var S=0;S<V.length;S++){Q[N]={};Q[N].name=appIdList[V[S].id].name;Q[N].tcp_port=appIdList[V[S].id].tcp_port;Q[N].udp_port=appIdList[V[S].id].udp_port;N++}for(var S=0;S<W.length;S++){Q[N]={};Q[N].name=W[S].name;Q[N].tcp_port="";Q[N].udp_port="";if(W[S].proto.toUpperCase()=="TCP"||W[S].proto.toUpperCase()=="ALL"){Q[N].tcp_port=W[S].port}if(W[S].proto.toUpperCase()=="UDP"||W[S].proto.toUpperCase()=="ALL"){Q[N].udp_port=W[S].port}N++}if(P!=""){var X=new RegExp(",");var e=P.split(X);for(var S=0;S<e.length;S++){Q[N]={};Q[N].name=appIdList[e[S]].name;Q[N].tcp_port=appIdList[e[S]].tcp_port;Q[N].udp_port=appIdList[e[S]].udp_port;N++}}if((U!="")&&(T!="")&&(O!="")){Q[N]={};Q[N].name=U;Q[N].tcp_port="";Q[N].udp_port="";if(T.toUpperCase()=="TCP"||T.toUpperCase()=="ALL"){Q[N].tcp_port=O}if(T.toUpperCase()=="UDP"||T.toUpperCase()=="ALL"){Q[N].udp_port=O}N++}for(var S=0;S<Q.length;S++){for(var R=S+1;R<Q.length;R++){if(v(Q[S],Q[R])){return true}}}return false}function C(P,N){var e=P.length;for(var O=0;O<e;O++){if(N.toUpperCase()==P[O].port.toUpperCase()){return true}}return false}$("#high_status").html($.su.CHAR.QOS.HIGH_PRIORITY_LBL);$("#middle_status").html($.su.CHAR.QOS.MIDDLE_PRIORITY_LBL);$("#low_status").html($.su.CHAR.QOS.LOW_PRIORITY_LBL);function D(Q){var N=Q.split(",");var e=N.length;for(var O in typeIdList){var P=[];var R="type_"+O+"_list";$(N).each(function(S,T){P.push(O+"_"+T);return O+"_"+T});$("#"+R).checkbox("setValue",P)}}function i(){for(var e in typeIdList){var N="type_"+e+"_list";$("#"+N).checkbox("setValue",[])}}function k(){$("#method_rd").radio("setValue","device");$("#device_name").textbox("setValue","");$("#mac_addr").textbox("setValue","");$("#rule_phy").radio("setValue","wireless");i();$("h5.type_collapse span.icon").removeClass("collapsed");$("#custom_cnt").fieldset("hide");$("#custom_name").textbox("setValue","");$("#rule_proto").combobox("setValue","all");$("#rule_port_list").textbox("setValue","")}$("#app_list_content").msg({autoshow:false,title:$.su.CHAR.QOS.RULE,cls:"qos-width",okHandler:function(){$("div.msg-btn-wrap span.form-error-tips").html("");if(current_items>=max_items){return false}var Q="";var aa=[];for(var Y in typeIdList){var O="type_"+Y+"_list";var X=[];container=$("#"+O).checkbox("getContainer"),container.find("input[type=checkbox]").each(function(ac,ad){if(ad.checked){var ab=ad.value.split("_");aa.push(ab[1])}})}$("#rule_app").val(aa);var e=$("#method_rd").radio("getValue");if(e=="device"){var N=$("#device_name").textbox("getValue");var W=$("#mac_addr").textbox("getValue");if(s(usedDeviceItem,W)){$("#mac_addr").textbox("setError");$("div.msg-btn-wrap span.form-error-tips").html($.su.CHAR.ERROR["00000065"]).fadeIn(150);return false}}if(e=="app"){var R=$("#rule_app").val();var V=$("#custom_name").textbox("getValue");var U=$("#rule_proto").combobox("getValue");var P=$("#rule_port_list").textbox("getValue");var T=(R=="")?0:R.split(",").length;var S=(V=="")?T:T+1;S=S+current_items;if(S>max_items){$("div.msg-btn-wrap span.form-error-tips").html($.su.CHAR.ERROR["00000125"]).fadeIn(150);return false}if(G(usedAppItem,usedCustomItem,R,V,U[0],P)){$("div.msg-btn-wrap span.form-error-tips").html($.su.CHAR.ERROR["00000065"]).fadeIn(150);return false}}if(e=="phy"){var Z=$("#rule_phy").textbox("getValue");if(Z==""){$("#rule_phy").textbox("setError");$("div.msg-btn-wrap span.form-error-tips").html($.su.CHAR.ERROR["00000129"]).fadeIn(150);return false}if(C(usedPhsicalPortItem,Z)){$("#rule_phy").textbox("setError");$("div.msg-btn-wrap span.form-error-tips").html($.su.CHAR.ERROR["00000065"]).fadeIn(150);return false}}if(!$("form#add_item").form("validate")){return false}$("form#add_item").form("submit",{operation:"add"},function(ab){$("div.msg-btn-wrap span.form-error-tips").html("");a(ab);k();$("div.msg-btn-wrap span.form-error-tips").html()})},cancelHandler:function(){$("#device_name").textbox("reset").textbox("setNormal");$("#mac_addr").textbox("reset").textbox("setNormal");k();var e=$("#rule_app").val();$("div.msg-btn-wrap span.form-error-tips").html("");D(e)},type:"prompt"});$("div.msg-btn-wrap .btn-msg-cancel").before('<span class="form-error-tips custom-xl" style="display: none;"></span>');$("form#add_item").form({proxy:L,showPrompt:false,fields:[{name:"method",mapping:"method"},{name:"device_name",mapping:"device_name"},{name:"mac",mapping:"mac"},{name:"phy",mapping:"phy"},{name:"rule_app",mapping:"rule_app"},{name:"custom_name",mapping:"custom_name"},{name:"proto",mapping:"proto"},{name:"port",mapping:"port"}],autoLoad:false,submitBtn:null});$("#add_btn_high").button({text:$.su.CHAR.OPERATION.ADD,cls:"right-pos",handler:function(){if(current_items<max_items){$("#app_list_content").msg("show");$("#rule_priority").val("high")}else{l()}}});$("#add_btn_middle").button({text:$.su.CHAR.OPERATION.ADD,cls:"right-pos",handler:function(){if(current_items<max_items){$("#app_list_content").msg("show");$("#rule_priority").val("middle")}else{l()}}});$("#add_btn_low").button({text:$.su.CHAR.OPERATION.ADD,cls:"right-pos",handler:function(){if(current_items<max_items){$("#app_list_content").msg("show");$("#rule_priority").val("low")}else{l()}}});function a(S){var U;if(!S){U=0}else{U=S.length}current_items=U;var P="";var R="";var N="";highCount=0;middleCount=0;lowCount=0;usedDeviceItem=[];usedPhsicalPortItem=[];usedAppItem=[];usedCustomItem=[];var W="";var Q="";for(var T=0;T<U;T++){var X=S[T];X.name?W=$.su.func.escapeHtml(X.name):1;X.name?Q=$.su.func.escapeHtml($.su.func.breakWordWithLen(X.name,15)):1;if(X.priority=="high"){highCount++;if(X.type=="device"){P+='<p class="access-client-list-p qos-list-p"><span title="'+W+'" class="qos-display-name" >'+Q+'</span><span class="access-client-list-icon list-icon-pos"><span class="icon-del" index='+T+"></span></span></p>";P+='<div class="access-client-detail qos-item-detail hidden"><p class="cfg_status"><label class="label_status_sss">'+$.su.CHAR.QOS.MAC_ADDR_P+'</label><span class="cfg_value">'+X.mac+'</span></p><p class="cfg_status"><label class="label_status_sss">'+$.su.CHAR.QOS.IP_P+'</label><span class="cfg_value">'+X.ip+"</span></p></div>";usedDeviceItem.push({name:Q,mac:X.mac})}if(X.type=="port"){P+='<p class="access-client-list-pp">'+p[X.phy]+'<span class="icon-del" index='+T+"></span></p>";usedPhsicalPortItem.push({port:X.phy})}if(X.type=="app"){if(X.custom){P+='<p class="access-client-list-p qos-list-p"><span title="'+W+'" class="qos-display-name" >'+Q+'</span><span class="access-client-list-icon  list-icon-pos"><span class="icon-del" index='+T+"></span></span></p>";P+='<div class="access-client-detail  qos-item-detail hidden"><p class="cfg_status"><label class="label_status_ss">'+$.su.CHAR.QOS.PROTO_P+'</label><span class="cfg_value">'+X.proto+'</span></p><p class="cfg_status"><label class="label_status_ss">'+$.su.CHAR.QOS.PORT_P+'</label><span class="cfg_value">'+X.port+"</span></p></div>";usedCustomItem.push({name:Q,proto:X.proto,port:X.port})}else{var O=X.app;var e=appIdList[O].name;var V=$.su.CHAR.APPLIST[e]?$.su.CHAR.APPLIST[e]:e;P+='<p class="access-client-list-pp"><span title="'+W+'" class="qos-display-name" >'+V+'</span><span class="icon-del" index='+T+"></p>";usedAppItem.push({id:X.app})}}}if(X.priority=="middle"){middleCount++;if(X.type=="device"){R+='<p class="access-client-list-p qos-list-p"><span title="'+W+'" class="qos-display-name" >'+Q+'</span><span class="access-client-list-icon list-icon-pos"><span class="icon-del" index='+T+"></span></span></p>";R+='<div class="access-client-detail qos-item-detail hidden"><p class="cfg_status"><label class="label_status_sss">'+$.su.CHAR.QOS.MAC_ADDR_P+'</label><span class="cfg_value">'+X.mac+'</span></p><p class="cfg_status"><label class="label_status_sss">'+$.su.CHAR.QOS.IP_P+'</label><span class="cfg_value">'+X.ip+"</span></p></div>";usedDeviceItem.push({name:Q,mac:X.mac})}if(X.type=="port"){R+='<p class="access-client-list-pp">'+p[X.phy]+'<span class="icon-del" index='+T+"></span></p>";usedPhsicalPortItem.push({port:X.phy})}if(X.type=="app"){if(X.custom){R+='<p class="access-client-list-p qos-list-p"><span title="'+W+'" class="qos-display-name" >'+Q+'</span><span class="access-client-list-icon  list-icon-pos"><span class="icon-del" index='+T+"></span></span></p>";R+='<div class="access-client-detail  qos-item-detail hidden"><p class="cfg_status"><label class="label_status_ss">'+$.su.CHAR.QOS.PROTO_P+'</label><span class="cfg_value">'+X.proto+'</span></p><p class="cfg_status"><label class="label_status_ss">'+$.su.CHAR.QOS.PORT_P+'</label><span class="cfg_value">'+X.port+"</span></p></div>";usedCustomItem.push({name:Q,proto:X.proto,port:X.port})}else{var O=X.app;var e=appIdList[O].name;var V=$.su.CHAR.APPLIST[e]?$.su.CHAR.APPLIST[e]:e;R+='<p class="access-client-list-pp"><span title="'+W+'" class="qos-display-name" >'+V+'</span><span class="icon-del" index='+T+"></p>";usedAppItem.push({id:X.app})}}}if(X.priority=="low"){lowCount++;if(X.type=="device"){N+='<p class="access-client-list-p qos-list-p"><span title="'+W+'" class="qos-display-name" >'+Q+'</span><span class="access-client-list-icon list-icon-pos"><span class="icon-del" index='+T+"></span></span></p>";N+='<div class="access-client-detail qos-item-detail hidden"><p class="cfg_status"><label class="label_status_sss">'+$.su.CHAR.QOS.MAC_ADDR_P+'</label><span class="cfg_value">'+X.mac+'</span></p><p class="cfg_status"><label class="label_status_sss">'+$.su.CHAR.QOS.IP_P+'</label><span class="cfg_value">'+X.ip+"</span></p></div>";usedDeviceItem.push({name:Q,mac:X.mac})}if(X.type=="port"){N+='<p class="access-client-list-pp">'+p[X.phy]+'<span class="icon-del" index='+T+"></span></p>";usedPhsicalPortItem.push({port:X.phy})}if(X.type=="app"){if(X.custom){N+='<p class="access-client-list-p qos-list-p"><span title="'+W+'" class="qos-display-name" >'+Q+'</span><span class="access-client-list-icon  list-icon-pos"><span class="icon-del" index='+T+"></span></span></p>";N+='<div class="access-client-detail  qos-item-detail hidden"><p class="cfg_status"><label class="label_status_ss">'+$.su.CHAR.QOS.PROTO_P+'</label><span class="cfg_value">'+X.proto+'</span></p><p class="cfg_status"><label class="label_status_ss">'+$.su.CHAR.QOS.PORT_P+'</label><span class="cfg_value">'+X.port+"</span></p></div>";usedCustomItem.push({name:Q,proto:X.proto,port:X.port})}else{var O=X.app;var e=appIdList[O].name;var V=$.su.CHAR.APPLIST[e]?$.su.CHAR.APPLIST[e]:e;N+='<p class="access-client-list-pp"><span title="'+W+'" class="qos-display-name" >'+V+'</span><span class="icon-del" index='+T+"></p>";usedAppItem.push({id:X.app})}}}}$("div#high_list").html(P);$("div#middle_list").html(R);$("div#low_list").html(N);$("p.access-client-list-pp").delegate("span.icon-del","click",function(aa){if(doing_list_delete){return false}doing_list_delete=true;var Y=$(this).attr("index");var Z=this;c.write({operation:"del",index:Y},function(ab){doing_list_delete=false;a(ab)})})}$("#device_cnt").fieldset({fields:[{name:"device_name"},{name:"mac"}]});$("#phy_cnt").fieldset({fields:[{name:"phy"}]});$("#app_cnt").fieldset({fields:[{name:"rule_app"},{name:"custom_name"},{name:"proto"},{name:"port"}]});$("#phy_cnt").fieldset("hide");$("#app_cnt").fieldset("hide");$("#rule_phy").radio({fieldLabel:$.su.CHAR.QOS.PORT,labelCls:"s",columns:3,allowBlank:false,items:[{boxlabel:$.su.CHAR.QOS.WIFI_HOME,inputValue:"wireless",checked:true},{boxlabel:$.su.CHAR.QOS.WIFI_GUEST,inputValue:"guest"},{boxlabel:$.su.CHAR.QOS.PORT1,inputValue:"port1"},{boxlabel:$.su.CHAR.QOS.PORT2,inputValue:"port2"},{boxlabel:$.su.CHAR.QOS.PORT3,inputValue:"port3"},{boxlabel:$.su.CHAR.QOS.PORT4,inputValue:"port4"}]});$("input#device_name").textbox({fieldLabel:$.su.CHAR.PARENTAL_CTR.DEVICE,vtype:"string_visible_allow_blank",minLength:0,maxLength:32,labelCls:"s",tipsCls:"after-button xl",allowBlank:false,cls:"inline-block "});var z=new $.su.Proxy({url:URL_ONLINE_BLACK});var f=new $.su.Store({proxy:z,fields:[{name:"name"},{name:"ipaddr"},{name:"mac"}],autoLoad:false});$("#device_view").button({text:$.su.CHAR.PARENTAL_CTR.BTN_VIEW,cls:"inline-block ml5",handler:function(){$("div#device_survey").msg("show");f.load()}});var q=$("div#device_survey").msg({autoshow:false,title:$.su.CHAR.PARENTAL_CTR.ACCESS_DEVICES_LIST,type:"window"});var F=$("div#device_result").grid({store:f,maxLines:5,columns:[{text:$.su.CHAR.ACCESS_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.ACCESS_CTR.NAME,width:150,dataIndex:"name"},{text:$.su.CHAR.ACCESS_CTR.IP_ADDRESS,width:150,dataIndex:"ipaddr"},{text:$.su.CHAR.ACCESS_CTR.MAC_ADDRESS,width:170,dataIndex:"mac"},{text:$.su.CHAR.GRID.OPERATION,renderer:function(N,e){return'<a href="javascript:void(0);" data-index="'+e+'" class="choose-existing-service choose" >'+$.su.CHAR.OPERATION.CHOOSE+"</a>"}}]});$(F).delegate("a.choose-existing-service","click",function(Q){Q.preventDefault();var N=F.grid("getStore"),O=$(this).attr("data-index"),P=N.data[O]||undefined;if(P){$("input#device_name").textbox("setValue",P.name);$("input#mac_addr").textbox("setValue",P.mac)}q.msg("close")});$("input#mac_addr").textbox({fieldLabel:$.su.CHAR.PARENTAL_CTR.MAC_ADDRESS,vtype:"mac",maxLength:17,labelCls:"s",allowBlank:false,vtype:"mac"});$("span#qossetting-warning-text-toomany-items").html($.su.CHAR.ERROR["00000125"]);var d=$("div#qossetting-warning-msg").msg({type:"alert",global:true,cls:"m",closeBtn:false});function l(){var e=$("div#qossetting-warning-msg");if(e.is(":hidden")){e.msg("show")}}function h(R){var T=R.length;var O=0;var e="";var W={};var V=[];var X="";for(var S=0;S<T;S++){e="";var Q=R[S];typeIdList[Q.id]=Q.name;if(Q.children){O=Q.children.length}X=$.su.CHAR.APPLIST[Q.name];e+='<h5 class="type_title">'+X+"</h5>";var N="type_"+Q.id+"_list";e+="<input id="+N+" />";$("#app_list_container").append(e);V=[];for(var P=0;P<O;P++){W={};W.boxlabel=$.su.CHAR.APPLIST[Q.children[P].name]?$.su.CHAR.APPLIST[Q.children[P].name]:Q.children[P].name;W.uncheckedValue="off";W.inputValue=Q.id+"_"+Q.children[P].id;W.name="app_list";W.itemCls="app_name_info";W.id=Q.id+"_"+Q.children[P].id;appIdList[Q.children[P].id]={};appIdList[Q.children[P].id].name=Q.children[P].name;appIdList[Q.children[P].id].tcp_port=Q.children[P].tcp_port?Q.children[P].tcp_port:"";appIdList[Q.children[P].id].udp_port=Q.children[P].udp_port?Q.children[P].udp_port:"";V.push(W)}$("#"+N).checkbox({fieldLabel:null,defaultValue:"",cls:"app_info_cnt",columns:3,items:V})}var U=$.su.CHAR.QOS.CUSTOM_APP;e='<h5 class="type_title type_collapse"><span class="text">'+U+'</span><span class="icon"></span></h5>';e+='<div id="custom_cnt"><input id="custom_name" name="custom_name" />';e+='<input id="rule_proto" name="proto" >';e+='<input  type="text"   id="rule_port_list" name="port"></div>';$("#app_list_container").append(e);$("#rule_custom_lbl").html($.su.CHAR.QOS.CUSTOM);$("#custom_name").textbox({fieldLabel:$.su.CHAR.QOS.NAME,allowBlank:false,maxLength:32,vtype:"name"});$("#rule_proto").combobox({fieldLabel:$.su.CHAR.QOS.PROTO,defaultValue:["all"],items:[{name:$.su.CHAR.QOS.ALL,value:"all"},{name:$.su.CHAR.QOS.TCP,value:"tcp"},{name:$.su.CHAR.QOS.UDP,value:"udp"}]});$("#rule_proto").combobox("setValue","all");$("#rule_port_list").textbox({fieldLabel:$.su.CHAR.QOS.PORT,tips:$.su.CHAR.QOS.PORT_TIPS,tipsCls:"xs",cls:"inline-block",validator:function(Y){return b(Y)},allowBlank:false});$("#custom_cnt").fieldset({fields:[{name:"custom_name"},{name:"proto"},{name:"port"}]});$("#custom_cnt").fieldset("hide")}$.post(URL_QOS_APP_LIST_NEW,{operation:"load"},function(N,O,e){if(N.data){h(N.data)}c.read({},function(Q,P){a(Q);max_items=P.max_rules||max_items})},"json");var p={wireless:$.su.CHAR.QOS.WIFI_HOME,guest:$.su.CHAR.QOS.WIFI_GUEST,port1:$.su.CHAR.QOS.PORT1,port2:$.su.CHAR.QOS.PORT2,port3:$.su.CHAR.QOS.PORT3,port4:$.su.CHAR.QOS.PORT4};var m={all:$.su.CHAR.QOS.TCP_UDP,tcp:$.su.CHAR.QOS.TCP,udp:$.su.CHAR.QOS.UDP};$("#app_list_container").delegate(".type_collapse","click",function(){if($("h5.type_collapse span.icon").hasClass("collapsed")){$("h5.type_collapse span.icon").removeClass("collapsed");$("#custom_cnt").fieldset("hide")}else{$("h5.type_collapse span.icon").addClass("collapsed");$("#custom_cnt").fieldset("show")}});$(".access-client-list").delegate("p.access-client-list-p","click",function(P){P=P?P:window.event;var O=function(e){if(e.relatedTarget){return e.relatedTarget}else{if(e.toElement){return e.toElement}else{if(e.fromElement){return e.fromElement}else{if(e.target){return e.target}else{return null}}}}};t=O(P);if((t.tagName.toUpperCase()=="SPAN")&&($(t).hasClass("icon-del"))){if(doing_list_delete){return false}doing_list_delete=true;var N=$(t).attr("index");c.write({operation:"del",index:N},function(e){doing_list_delete=false;a(e)})}else{if($(this).hasClass("selected-list-p")){accessLeftFlag=true;$(this).removeClass("selected-list-p");$(this).next("div.access-client-detail").hide()}else{accessLeftFlag=false;$("div#access_wired_list").find("p.access-client-list-p qos-list-p").removeClass("selected-list-p");$("div#access_wired_list").find("p.access-client-list-p qos-list-p").next("div.access-client-detail").hide();$(this).addClass("selected-list-p");$(this).next("div.access-client-detail").fadeIn(150)}}}).delegate("p.access-client-list-p,p.access-client-list-pp","mousedown",function(N){if(!dragObj){dragObj=this}else{c.read({},function(O,e){a(O)})}allowDrag="waiting";setTimeout(function(){if(allowDrag=="waiting"){allowDrag=true}},200)});var J;$("#qoslist").on("mousemove",function(N){if(allowDrag===true){J=$(dragObj).closest(".status-panel").attr("id")=="high_panel"?0:($(dragObj).closest(".status-panel").attr("id")=="middle_panel"?216:432);$(dragObj).css("z-index","99");$(dragObj).css("position","absolute");$(dragObj).css("left",N.clientX-this.offsetLeft+$(document).scrollLeft()-$(".top-content").offset().left-J+"px");$(dragObj).css("top",N.clientY-this.offsetTop+$(".top-main").scrollTop()-127+"px");if($(dragObj).next().hasClass("access-client-detail")){$(dragObj).next().css("z-index","99");$(dragObj).next().css("position","absolute");$(dragObj).next().css("left",N.clientX-this.offsetLeft+$(document).scrollLeft()-$(".top-content").offset().left-J+"px");$(dragObj).next().css("top",N.clientY-this.offsetTop+$(".top-main").scrollTop()-94+"px")}}});$("#qoslist").on("mouseup",function(O){allowDrag=false;var N=O.clientX-this.offsetLeft+$(document).scrollLeft()-$(".top-content").offset().left-J;if(J==0){if(N>=216-30&&N<=246+30){c.write({operation:"update",index:$(dragObj).find(".icon-del").attr("index"),old:'{"priority":"high"}',"new":'{"priority":"middle"}'},function(e){a(e)})}else{if(N>=432-30&&N<=462+30){c.write({operation:"update",index:$(dragObj).find(".icon-del").attr("index"),old:'{"priority":"high"}',"new":'{"priority":"low"}'},function(e){a(e)})}else{$(dragObj).css("z-index","");$(dragObj).css("position","");$(dragObj).css("left","0");$(dragObj).css("top","0");$(dragObj).next().css("z-index","");$(dragObj).next().css("position","");$(dragObj).next().css("left","0");$(dragObj).next().css("top","0")}}}else{if(J==216){if(N>=-216&&N<=-187+30){c.write({operation:"update",index:$(dragObj).find(".icon-del").attr("index"),old:'{"priority":"middle"}',"new":'{"priority":"high"}'},function(e){a(e)})}else{if(N>=216-30){c.write({operation:"update",index:$(dragObj).find(".icon-del").attr("index"),old:'{"priority":"middle"}',"new":'{"priority":"low"}'},function(e){a(e)})}else{$(dragObj).css("z-index","");$(dragObj).css("position","");$(dragObj).css("left","0");$(dragObj).css("top","0");$(dragObj).next().css("z-index","");$(dragObj).next().css("position","");$(dragObj).next().css("left","0");$(dragObj).next().css("top","0")}}}else{if(J==432){if(N>=-216-30&&N<=-187+30){c.write({operation:"update",index:$(dragObj).find(".icon-del").attr("index"),old:'{"priority":"low"}',"new":'{"priority":"middle"}'},function(e){a(e)})}else{if(N<=-403+30){c.write({operation:"update",index:$(dragObj).find(".icon-del").attr("index"),old:'{"priority":"low"}',"new":'{"priority":"hight"}'},function(e){a(e)})}else{$(dragObj).css("z-index","");$(dragObj).css("position","");$(dragObj).css("left","0");$(dragObj).css("top","0");$(dragObj).next().css("z-index","");$(dragObj).next().css("position","");$(dragObj).next().css("left","0");$(dragObj).next().css("top","0")}}}}}dragObj=null});iptvProxy.read({},function(N){if(N.qos_iptv_compatible=="no"){var e=N.enable;if(e=="on"){$("input#enable").checkbox("disable");$("input#enable").checkbox("setTips",$.su.CHAR.ERROR["00000105"])}else{}}});sysNatProxy.read({},function(N){if(N.boost_traffic_compatible=="no"){var e=N.hw_enable;if(e=="on"){$("input#enable").checkbox("disable");$("input#enable").checkbox("setTips",$.su.CHAR.ERROR["00000111"])}else{}}});var M=new $.su.Help({container:"div#help_qos",content:["QOS","QOS_RULE","BW_CONTROL"]})});</script>
</body>
</html>
