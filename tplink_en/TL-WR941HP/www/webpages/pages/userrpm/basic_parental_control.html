<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Parental Control</title>
</head>
<body>
<div class="func-container">
	 <div id="parental">
	    	<input type="text"  id="enable_parental" name="enable" value="" />
	 </div>
	 <div id="under_parental">
 		<div id="parentalGrid">
		</div>
	 </div>
 	<div id="own_editor">
		<input id="device_name" name="name">
		<button id="device_view"></button>
		<input id="mac_addr" name="mac">
		<input id="access_calendar" name="calendar">
		<input id="device_description" name="note">
		<input id="entry_enable" name="enable">
	</div>
	<div id="device_survey">
 		<p id="device_title"></p>
 		<div id="device_result">
		</div>
		<button id="ok"></button>
		<button id="cancle"></button>
 	</div>	 
	<div id="help_basic_parental_control"></div> 
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(r){var q=$.su.url("/admin/parental_control?form=enable");var n=$.su.url("/admin/parental_control?form=device");var x=$.su.url("/admin/parental_control?form=mode");var c=$.su.url("/admin/access_control?form=black_devices");var t=$.su.url("/admin/time?form=settings");var s="";$("div.func-container").page({title:$.su.CHAR.BASIC_PARENTAL_CTR.TITLE,help:""});$("div#parental").panel({title:$.su.CHAR.BASIC_PARENTAL_CTR.TITLE,collapsible:false});$("input#device_name").textbox({fieldLabel:$.su.CHAR.PARENTAL_CTR.DEVICE,vtype:"string_visible_allow_blank",minLength:0,maxLength:32,tipsCls:"after-button xl",allowBlank:false,cls:"inline-block "});$("input#mac_addr").textbox({fieldLabel:$.su.CHAR.BASIC_PARENTAL_CTR.MAC_ADDRESS,vtype:"mac",maxLength:17,allowBlank:false,vtype:"mac"});var i=new $.su.Proxy({url:t,autoLoad:false});var b={"0":"GMT-12:00","60":"GMT-11:00","120":"GMT-10:00","180":"GMT-09:00","240":"GMT-08:00","300":"GMT-07:00","360":"GMT-06:00","420":"GMT-05:00","450":"GMT-04:30","480":"GMT-04:00","510":"GMT-03:30","540":"GMT-03:00","600":"GMT-02:00","660":"GMT-01:00","720":"GMT","780":"GMT+01:00","840":"GMT+02:00","900":"GMT+03:00","930":"GMT+03:30","960":"GMT+04:00","990":"GMT+04:30","1020":"GMT+05:00","1050":"GMT+05:30","1065":"GMT+05:45","1080":"GMT+06:00","1110":"GMT+06:30","1140":"GMT+07:00","1200":"GMT+08:00","1260":"GMT+09:00","1290":"GMT+09:30","1320":"GMT+10:00","1380":"GMT+11:00","1440":"GMT+12:00","1500":"GMT+13:00"};var u={"1":$.su.CHAR.ORDER["1ST_"],"2":$.su.CHAR.ORDER["2ND"],"3":$.su.CHAR.ORDER["3RD"]};var g={mon:$.su.CHAR.DATE.MON,tue:$.su.CHAR.DATE.TUES,wed:$.su.CHAR.DATE.WED,thu:$.su.CHAR.DATE.THUR,fri:$.su.CHAR.DATE.FRI,sat:$.su.CHAR.DATE.SAT,sun:$.su.CHAR.DATE.SUN};var d={"1":$.su.CHAR.DATE.JAN,"2":$.su.CHAR.DATE.FEB,"3":$.su.CHAR.DATE.MAR,"4":$.su.CHAR.DATE.APR,"5":$.su.CHAR.DATE.MAY,"6":$.su.CHAR.DATE.JUN,"7":$.su.CHAR.DATE.JUL,"8":$.su.CHAR.DATE.AUG,"9":$.su.CHAR.DATE.SEP,"10":$.su.CHAR.DATE.OCT,"11":$.su.CHAR.DATE.NOV,"12":$.su.CHAR.DATE.DEC};var l=0;var v=function(A,z,B){clearInterval(l);var C=function(F){var I="";var E=F.date.split("/");var D=parseInt(E[0],10);var H=parseInt(E[1],10);var J=E[2];I+=g[F.day.toLowerCase()]+" ";I+=(u[H]||H+$.su.CHAR.ORDER.TH)+" ";I+=d[D]+" ";I+=J+" ";I+=F.time+" ";I+=b[F.timezone];var G='<span class="label">'+$.su.CHAR.PARENTAL_CTR.SYSTEM_TIME+":</span>";G+="<span>";G+=I;G+="</span>";return G};i.read({},function(E){if(E){var F={date:E.date,day:E.day,time:E.time,timezone:E.timezone,support24:E.hour24_support,enable24:E.hour24_enable};var D=function(K){var J=F.time.split(":");var G=false;if(J[0]==23&&J[1]==59&&J[2]==59){G=true}var I=function(L){var M=parseInt(L,10);if(M<10){return("0"+M)}return M};if(K!=true){if(J[2]==59){J[2]=-1;J[1]=J[1]==59?0:parseInt(J[1],10)+1;J[0]=J[1]==0?parseInt(J[0],10)+1:J[0];J[0]=J[0]==24?0:J[0]}F.time=I(J[0])+":"+I(J[1])+":"+I((parseInt(J[2],10)+1))}var H=F.time;if(F.support24=="yes"){if(F.enable24=="off"){if(parseInt(J[0],10)>=12){if(parseInt(J[0],10)==12){J[0]=24}F.time=(J[0]-12)+":"+I(J[1])+":"+I((parseInt(J[2],10)+1))+" PM"}else{if(parseInt(J[0],10)==0){J[0]=12}F.time=parseInt(J[0],10)+":"+I(J[1])+":"+I((parseInt(J[2],10)+1))+" AM"}}}var J=C(F);B.msg("setTitle",J);F.time=H;if(G==true){i.read({},function(L){F={date:L.date,day:L.day,time:L.time,timezone:L.timezone,support24:L.hour24_support,enable24:L.hour24_enable}})}};D(true);l=setInterval(D,1*1000)}})};var j=function(){clearInterval(l)};$("input#access_calendar").timepicker({fieldLabel:$.su.CHAR.BASIC_PARENTAL_CTR.TIME,cls:"time-settings"}).on("ev_beforeshow",v).on("ev_close",j);$("input#device_description").textbox({fieldLabel:$.su.CHAR.BASIC_PARENTAL_CTR.DESCRIPTION,vtype:"string_visible_allow_blank",maxLength:32,allowBlank:true,tipsCls:"s",tips:$.su.CHAR.BASIC_PARENTAL_CTR.OPTIONAL});$("input#entry_enable").checkbox({fieldLabel:"",defaultValue:"on",items:[{boxlabel:$.su.CHAR.BASIC_PARENTAL_CTR.ENABLE,uncheckedValue:"off",inputValue:"on",id:"chk_enable",checked:true}]});$("#device_view").button({text:$.su.CHAR.BASIC_PARENTAL_CTR.BTN_VIEW,cls:"inline-block ml5",handler:function(){$("div#device_survey").msg("show");o.load()}});var y=$("div#device_survey").msg({autoshow:false,title:$.su.CHAR.BASIC_PARENTAL_CTR.ACCESS_DEVICES_LIST,type:"window"});var w=new $.su.Proxy({url:c});var o=new $.su.Store({proxy:w,fields:[{name:"name"},{name:"ipaddr"},{name:"mac"}],autoLoad:false});var p=$("div#device_result").grid({store:o,maxLines:5,columns:[{text:$.su.CHAR.ACCESS_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.ACCESS_CTR.NAME,width:150,dataIndex:"name"},{text:$.su.CHAR.ACCESS_CTR.IP_ADDRESS,width:150,dataIndex:"ipaddr"},{text:$.su.CHAR.ACCESS_CTR.MAC_ADDRESS,width:170,dataIndex:"mac"},{text:$.su.CHAR.GRID.OPERATION,renderer:function(A,z){return'<a href="javascript:void(0);" data-index="'+z+'" class="choose-existing-service choose" >'+$.su.CHAR.OPERATION.CHOOSE+"</a>"}}]});$(p).delegate("a.choose-existing-service","click",function(C){C.preventDefault();var z=p.grid("getStore"),A=$(this).attr("data-index"),B=z.data[A]||undefined;if(B){$("input#device_name").textbox("setValue",B.name);$("input#mac_addr").textbox("setValue",B.mac)}y.msg("close")});var a=new $.su.Proxy({url:q});$("input#enable_parental").switchbutton({fieldLabel:$.su.CHAR.BASIC_PARENTAL_CTR.TITLE,proxy:a,labelCls:"l",cls:"form-inner",field:{name:"enable"}}).on("ev_loadData",function(A,z){s=z.host_mac});$("div#under_parental").panel({title:$.su.CHAR.BASIC_PARENTAL_CTR.DEVICE_CTR,collapsible:false});var k=new $.su.Proxy({url:n});var m=new $.su.Store({proxy:k,fields:[{name:"name"},{name:"mac"},{name:"calendar"},{name:"note"},{name:"enable"}],autoLoad:true});var h=$("div#parentalGrid").grid({store:m,minLines:0,paging:{},editor:{content:"#own_editor",validator:function(){var C=h.grid("getStore");keyProperty=C.keyProperty;grid_array=C.data;var D=$(h.grid("getEditor"));var A=D.find("input[name=mac]").val();if(s.toUpperCase()==A.toUpperCase()){$(h.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000064"]);return false}var z=grid_array.length;if($.isArray(grid_array)&&z>0){for(var B=0;B<z;B++){if(D[0].editing){if(grid_array[B].key==D[0].editingId){continue}}var E=grid_array[B];if(E.mac.toUpperCase()==A.toUpperCase()){$(h.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000007"]);return false}}}if($("#access_calendar").timepicker("getValue")=="{}"){$(h.grid("getEditor")).form("setError",$.su.CHAR.ERROR["00000152"]);return false}return true},fields:[{name:"name"},{name:"mac"},{name:"calendar"},{name:"note"},{name:"enable"}]},columns:[{xtype:"checkcolumn",width:32},{text:$.su.CHAR.BASIC_PARENTAL_CTR.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.BASIC_PARENTAL_CTR.DEVICE,width:100,dataIndex:"name"},{text:$.su.CHAR.BASIC_PARENTAL_CTR.MAC_ADDRESS,width:130,dataIndex:"mac"},{text:$.su.CHAR.BASIC_PARENTAL_CTR.TIME,width:100,dataIndex:"calendar",xtype:"actioncolumn",items:[{xtype:"timepicker",cls:"time-settings",inputCls:"time-settings",fieldLabel:null,viewOnly:true}]},{text:$.su.CHAR.BASIC_PARENTAL_CTR.DESCRIPTION,width:110,dataIndex:"note"},{text:$.su.CHAR.BASIC_PARENTAL_CTR.STATUS,width:70,dataIndex:"enable",xtype:"statuscolumn"},{xtype:"settings"}],operation:"prompt|add|delete"}).delegate("input.time-settings","ev_beforeshow",v).delegate("input.time-settings","ev_close",j);var f=new $.su.Help({container:"div#help_basic_parental_control",content:["BASIC_PARENTAL_CONTROL","BASIC_PARENTAL_DEVICE"]})});</script>
</body>
</html>
