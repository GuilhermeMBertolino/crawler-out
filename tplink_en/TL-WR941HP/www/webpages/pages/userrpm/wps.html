<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WPS</title>
<script src="js/libs/corner.js"></script>
<script src="js/libs/excanvas.js"></script>
<style type="text/css">
	#wps_container{
		position:relative;
		height:100px;
	}
	#wps_disable{
		width:84px;
		height:84px;
		position:absolute;
		left: 50%;
		margin-left: -42px;
		border-radius:42px;
	}
	#wps_button,#wps_mask{
		width:84px;
		height:84px;
		position:absolute;
		left: 50%;
		margin-left: -42px;
		background:#ffcb00;
		color:#fff;
		cursor:pointer;
		border-radius:42px;
		-webkit-border-radius:42px;
		-ms-border-radius:42px;
		-moz-border-radius:42px;
		-o-border-radius:42px;  
	}
	#wps_button.starting{
		background:#4acbd6;
	}
	#wps_button.starting:hover{
		background:#4acbd6;
	}
	#wps_mask.starting{
		background:rgb(165,229,235);
		animation:Breathing 1.5s ease-out infinite alternate;
	}
	#wps_button:hover{
		background:#e8ba46;
	}
	#wps_title{    
		text-align: center;
		position: absolute;
		top: 50%;
		margin-top: -18px;
		width: 100%;
	}
	#wps_title h3{
		font-size:16px;
	}
	#wps_title span{
		font-size:13px;
	}
	@-webkit-keyframes Breathing {
		0% {
			-webkit-transform: scale(1);
		}
		100% {
			-webkit-transform: scale(1.36);
		}
	}
	@keyframes Breathing {
		0% {
			transform: scale(1);
		}
		100% {
			transform: scale(1.36);
		}
	}
	#wps_container .status-container{
		position:absolute;
		top:100px;
	}
</style>
</head>
<body>
<div class="func-container">
	<div id="wps_method_one" >
		<p class="note">
			<span></span>
			<br />
			<span></span>
		</p>
		<div id="wps_container">
			<div id="wps_disable">
			</div>
			<div id="wps_mask">
			</div>
			<div id="wps_button" class="">
				<div id="wps_title">
					<span></span>
					<h3></h3>
				</div>
			</div>
			<input id="push-conn-result" />
		</div>
		<p class="note hidden" id="note_wireless">
			<span class="title note-title"></span>
			<span class="text" id="note_wireless_text"></span>
		</p>
	</div>
	<div id="adv_btn" class="advanced-block part-seperate" type="button">
		<span class="advanced-icon"></span>
		<span class="advanced-text"></span>
	</div>
	<div id="basic_btn" class="basic-block part-seperate" type="button">
		<span class="basic-icon"></span>
		<span class="basic-text"></span>
	</div>
	<div id="pin_cute">
		<input id="pin_cute_type" />
		<div class="ml10" id="router_pin_container">
			<p class="note" id="router_pin_note" ></P>
			<form id="router_pin_form">
				<input id="enable_router_wps" name="wps_label" />
				<input id="router_pin" name="wps_pin" />
				<button id="router_pin_button_generate"></button>
				<button id="router_pin_button_default"></button>
				<div class="custom_loading_ctn">
					<span id="general_loading" class="loading"></span>
				</div>
			</form>
			<p class="note hidden" id="note_pin_lock">
				<span class="title note-title"></span>
				<span id="pin_lock_note" class="note"></span>
			</p>
		</div>
		<div class="ml10" id="client_pin_container">
			<input id="enable_client_wps" />
			<button id="client_pin_button"></button>
			<input id="pin_progress" />
			<button id="pin-cancel-btn" />			
			<div class="inline-block">
				<input id="pin-conn-result" />
			</div>
		</div>
	</div>
	<div id="help_wps"></div>
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(B){$("div.func-container").page({title:$.su.CHAR.WPS.TITLE,help:""});$("div#wps_method_one").panel({title:$.su.CHAR.WPS.TITLE,help:""});$("span#pin_lock_note").html($.su.CHAR.ERROR["00000124"]);var y=$.su.url("/admin/wireless?form=wps_pin");var x=$.su.url("/admin/wireless?form=wps_connect");var z=$.su.url("/admin/wireless?form=syspara_wps");var u=$.su.url("/admin/wireless?form=wireless_2g");var j;var d;var k;var i;var q;var A;var l="";var p=false;var t="";var v=false;$("span.note-title").html($.su.CHAR.OPERATION.NOTE);$("span#note_wireless_text").html($.su.CHAR.WPS.SWITCH_NOTE);var w=new $.su.Proxy({url:x});a(0);function a(E){j=setInterval(function(){if(v==true){E++}else{E=0}w.read({option:"pbc"},function(F){if(E==60){v=true;b(F,"timeout");$("#wps_title span").text($.su.CHAR.WPS.START);$("#wps_button").css({background:""});$("#wps_disable").css({"z-index":"-1"})}if(F.wps_status!="ok"){b(F);$("#wps_title span").text($.su.CHAR.WPS.START);$("#wps_button").css({background:""});$("#wps_disable").css({"z-index":"-1"})}else{v=true;C.status("setNormal");$("#wps_button").css({background:""});$("#wps_disable").css({"z-index":"-1"});$("#wps_button").addClass("starting");$("#wps_mask").addClass("starting");$("#wps_title span").text($.su.CHAR.WPS.CANCEL)}})},2000)}var n=new $.su.Proxy({url:z});function s(){$("#wps_title span").text($.su.CHAR.WPS.START);$("input#enable_client_wps").textbox("disable");$("input#pin_cute_type").radio("disable");$("input#enable_router_wps").switchbutton("disable");$("#router_pin_note").css({color:"#b2b2b2"});$("button#router_pin_button_generate").button("disable");$("button#router_pin_button_default").button("disable");$("input#router_pin").textbox("disable");$("button#client_pin_button").button("disable");$("#wps_disable").css({"z-index":"9999999"});$("#wps_button").css({background:"#b2b2b2"})}function o(){$("#wps_title span").text($.su.CHAR.WPS.WAIT);$("input#enable_client_wps").textbox("enable");$("input#pin_cute_type").radio("enable");$("input#enable_router_wps").switchbutton("enable");$("#router_pin_note").css({color:"rgb(77,77,77)"});$("button#router_pin_button_generate").button("enable");$("button#router_pin_button_default").button("enable");$("input#router_pin").textbox("enable");$("button#client_pin_button").button("enable")}n.read({},function(E){q=E.wps;if(q=="off"){s();clearInterval(j)}else{r.read({},function(F){A=F.enable;if(A=="off"){s();$("#note_wireless").removeClass("hidden");clearInterval(j)}else{o();$("#note_wireless").addClass("hidden");if(l=="lock"){if(t=="on"){p=true;$("#note_pin_lock").removeClass("hidden")}}w.read({},function(J,L,I){if(typeof J=="undefined"){return}timeout=J.wps_timeout;var K=J.available;var H=J.disabled;var G=$("span#note_wireless_text");if(K){if(H=="on"){s();clearInterval(j);$("#note_wireless").removeClass("hidden");G.html($.su.CHAR.WPS.SWITCH_NOTE)}else{$("#note_wireless").addClass("hidden");G.html("")}}else{if(H=="on"){$("#note_wireless").removeClass("hidden");G.html($.su.CHAR.WPS.SWITCH_NOTE)}else{$("#note_wireless").removeClass("hidden");G.html($.su.CHAR.WPS.SWITCH_NOTE2)}s();clearInterval(j)}})}})}});var r=new $.su.Proxy({url:u});$("#wps_method_one p span:eq(0)").text($.su.CHAR.WPS.METHOD_ONE);$("#wps_method_one p span:eq(1)").text($.su.CHAR.WPS.BUTTON_TIPS);$("#wps_title h3").text($.su.CHAR.WPS.WPS);$("#wps_title span").text($.su.CHAR.WPS.WAIT);$("#wps_button").css({background:"#b2b2b2"});$("#wps_disable").css({"z-index":"9999999"});var C=$("#push-conn-result").status({proxy:{url:x}});function g(){C.status("setNormal");clearInterval(j);if($("#wps_button").attr("class").indexOf("starting")>-1){w.read({option:"cancel"},function(){v=false;$("#wps_button").removeClass("starting");$("#wps_mask").removeClass("starting");$("#wps_title span").text($.su.CHAR.WPS.START);a(0)})}else{if($("button#pin-cancel-btn").closest(".widget-container").css("display")!="none"){$("button#pin-cancel-btn").click()}$("#wps_disable").css({"z-index":"9999999"});$("#wps_button").css({background:"#b2b2b2"});$("#wps_title span").text($.su.CHAR.WPS.CONNECTING);w.read({option:"connect"},function(F){$("#wps_disable").css({"z-index":"9999999"});$("#wps_button").css({background:"#b2b2b2"});$("#wps_title span").text($.su.CHAR.WPS.CONNECTING);var E=120*1000;if(F.wps_status=="ok"){v=true;k=0;a(0)}else{b(F)}})}}$("#wps_button").bind("click",g);function b(E){if(v==true){if(E.wps_status=="success"){var F=$.su.CHAR.WPS.RESULT_HEAD+" <b>"+E.mac+"</b> "+$.su.CHAR.WPS.RESULT_END;C.status("setSuccess",F)}if(E.wps_status=="error"){C.status("setFailed",$.su.CHAR.WPS.STATUS_ERROR)}if(E.wps_status=="failed"){C.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_ERROR)}if(E.wps_status=="overlap"){C.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_OVERLAP)}if(E.wps_status=="timeout"){C.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_TIMEOUT)}if(arguments[1]){C.status("setFailed",$.su.CHAR.WPS.NOT_FOUND)}v=false;k=0}$("#wps_button").removeClass("starting");$("#wps_mask").removeClass("starting");$("#wps_title span").text($.su.CHAR.WPS.START)}$("span.advanced-text").html($.su.CHAR.WPS.OTHER);$("span.basic-text").html($.su.CHAR.WPS.OTHER);$("#basic_btn").hide();$("#pin_cute").hide();$("#adv_btn").click(function(){$("#basic_btn").show();$("#pin_cute").show();$(this).hide()});$("#basic_btn").click(function(){$("#adv_btn").show();$("#pin_cute").hide();$(this).hide()});$("#pin_cute_type").radio({fieldLabel:null,columns:3,items:[{boxlabel:$.su.CHAR.WPS.ROUTER_PIN,inputValue:"router",checked:true},{boxlabel:$.su.CHAR.WPS.CLIENT_PIN,inputValue:"client"}]}).on("ev_change",function(G,F,E){if(E=="router"){$("#router_pin_container").show();$("#client_pin_container").hide()}else{if(E=="client"){$("#router_pin_container").hide();$("#client_pin_container").show()}}});$("#client_pin_container").hide();var D=new $.su.Proxy({url:y});var c=new $.su.Proxy({url:y,async:false});$("input#enable_router_wps").switchbutton({fieldLabel:$.su.CHAR.WPS.ENABLE_ROUTER_PIN,proxy:D,autoLoad:false,field:{name:"wps_label"},onHandler:function(){if(p){$("span#note_pin_lock").removeClass("hidden")}},offHandler:function(){$("span#note_pin_lock").addClass("hidden")}});$("input#router_pin").textbox({fieldLabel:$.su.CHAR.WPS.ROUTER_PIN,cls:"inline-block",readOnly:true});$("#general_loading").hide();$("button#router_pin_button_generate").button({cls:"inline-block",text:$.su.CHAR.WPS.GENERAL,handler:function(){$("button#router_pin_button_generate").button("disable");$("#general_loading").fadeIn(150);D.write({option:"generate"},function(E){$("input#router_pin").textbox("setValue",E.wps_pin);$("button#router_pin_button_generate").button("enable");$("#general_loading").fadeOut(150);p=false;$("#note_pin_lock").addClass("hidden")})}});$("button#router_pin_button_default").button({cls:"inline-block",text:$.su.CHAR.WPS.DEFAULT,handler:function(){$("button#router_pin_button_default").button("disable");$("#general_loading").fadeIn(150);D.write({option:"default"},function(E){$("input#router_pin").textbox("setValue",E.wps_pin);$("button#router_pin_button_default").button("enable");$("#general_loading").fadeOut(150)})}});function h(E){w.read({option:"pin"},function(G,I,F){i++;if(typeof G=="undefined"){return}if(G.wps_status=="success"){var H=$.su.CHAR.WPS.RESULT_HEAD+" <b>"+G.mac+"</b> "+$.su.CHAR.WPS.RESULT_END;m.status("setSuccess",H);clearInterval(d);d=false;$("button#client_pin_button").button("enable");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("#pin_progress").progressbar("hide");i=0}else{if(G.wps_status=="ok"){m.status("setLoading","")}else{if(G.wps_status=="error"){m.status("setFailed",$.su.CHAR.WPS.STATUS_PIN_ERROR)}if(G.wps_status=="failed"){m.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_ERROR)}if(G.wps_status=="overlap"){m.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_OVERLAP)}if(G.wps_status=="timeout"){m.status("setFailed",$.su.CHAR.WPS.STATUS_CONN_TIMEOUT)}clearInterval(d);d=false;$("button#client_pin_button").button("enable");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("#pin_progress").progressbar("hide");i=0}}if(i>=120*1000/1000){if(d){clearInterval(d);d=false;$("button#client_pin_button").button("enable");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("#pin_progress").progressbar("hide");m.status("setFailed",$.su.CHAR.WPS.NOT_FOUND);i=0}}})}c.read({},function(E){l=E.lock_2g;t=E.wps_label});$("form#router_pin_form").form({proxy:D,fields:[{name:"wps_label",mapping:"wps_label"},{name:"wps_pin",mapping:"wps_pin"}],autoLoad:true});var m=$("#pin-conn-result").status({proxy:{url:x}});$("#enable_client_wps").textbox({fieldLabel:$.su.CHAR.WPS.ENABLE_ROUTER_PIN,fieldLabel:$.su.CHAR.WPS.ENTER_CLIENT_PIN,vtype:{vtype:"number",max:99999999},maxLength:8,minLength:8,allowBlank:false,validator:function(E){if(E.toString().length!=8){return $.su.CHAR.ERROR["00000075"]}return true},cls:"no-label-align"});$("button#client_pin_button").button({text:$.su.CHAR.WPS.CONNECT,cls:"inline-block",handler:function(){if($("#wps_button").hasClass("starting")){$("#wps_button").click()}var E=$("input#enable_client_wps").textbox("getValue");if(!$("input#enable_client_wps").textbox("validate")){return false}$("button#client_pin_button").button("disable");w.read({option:"connect",wps_pin:E},function(F){m.status("setNormal");$("#pin_progress").progressbar("show");$("#pin_progress").progressbar("reset");$("#pin_progress").progressbar("animate",0,1,120*1000);$("#pin-cancel-btn").button("getContainer").css("display","inline-block");if(!d){i=0;d=setInterval(h,2000)}else{i=0;clearInterval(d);d=false;d=setInterval(h,2000)}$("button#pin-cancel-btn").button("enable")},function(){m.status("setFailed",$.su.CHAR.WPS.STATUS_PIN_ERROR);$("button#client_pin_button").button("enable");return},function(){})}});$("#pin_progress").progressbar({fieldLabel:null,cls:"inline-block",width:300,height:6,value:0});$("#pin_progress").progressbar("hide");$("button#pin-cancel-btn").button({text:$.su.CHAR.WPS.CANCEL,handler:function(){$("input#enable_client_wps").textbox("enable");$("button#pin-cancel-btn").button("disable");w.read({option:"cancel"},function(E){if(E.wps_status=="cancel"){m.status("setSuccess",$.su.CHAR.WPS.STATUS_CANCEL)}else{m.status("setNormal")}});clearInterval(d);d=false;$("#pin_progress").progressbar("reset");$("#pin_progress").progressbar("hide");$("button#client_pin_button").button("show");$("button#pin-cancel-btn").button("hide");$("button#client_pin_button").button("enable")},cls:"inline-block hidden"});$("#router_pin_note").html($.su.CHAR.WPS.ROUTER_PIN_NOTE);$.su.app.runningModule.addUnloadHandler(function(){clearInterval(j);clearInterval(d)});var f=new $.su.Help({container:"div#help_wps",content:["WPS"]})});</script>
</body>
</html>
