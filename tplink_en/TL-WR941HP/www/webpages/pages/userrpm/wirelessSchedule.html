<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Wireless Schedule</title>
</head>
<body>
<div class="func-container">
	 <div id="wireless_enable">
	 	<form id="wireless_schedule_form">
			<input id="enable" name="enable" />
        	<p class="note hidden" id="note_title">
            	<span class="title note-title"></span>
            	<span class="note" id="wireless_note"></span>
       	 	</p>
       	 </form>
	 </div>
	 <div id="wireless_scheudle" class="hidden">
		<div id="wireless_schedule_grid">
		</div>
		<div id="schedule_editor">
			<p class="note editor_title">
			</p>
			<input id="from" name="from" />
			<input id="to" name="to" />
			<input id="repeat" />
			<input id="week" name="repeat" />
			<p class="note">
			</p>
		</div>
	 </div>
	 <div id="wireless_schedule_help"></div>
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(g){var k=$.su.url("/admin/wireless?form=wireless_schedule");var c;var d=[];$("div.func-container").page({title:$.su.CHAR.WIRELESS_SCHEDULE.TITLE,help:""});$("div#wireless_enable").panel({title:$.su.CHAR.WIRELESS_SCHEDULE.TITLE,collapsible:false});var l=new $.su.Proxy({url:k});$("span.note-title").html($.su.CHAR.OPERATION.NOTE);$("span#wireless_note").html($.su.CHAR.WIRELESS_SCHEDULE.CHECK_TIME_NOTE);$("#wireless_enable").on("click","a#go-to-time",function(){if(window.sysMode=="router"){$.su.menu.advanced.goTo("time-settings")}else{$.su.menu.basic.goTo("time-settings")}});$("form#wireless_schedule_form").form({proxy:l,fields:[{name:"enable"}],submitBtn:"default"}).on("ev_loadData",function(m,i){if(i.time_set=="no"||i.time_type!="auto"){$("#wireless_schedule_form").form("disable");$("p#note_title").show()}});$("#enable").switchbutton({fieldLabel:$.su.CHAR.WIRELESS_SCHEDULE.TITLE,labelCls:"s",proxy:l,field:{name:"enable"}}).on("ev_loadData",function(p,q,m){if(m=="on"){$("#wireless_scheudle").show();if(q.list.length>0){d=q.list;c=[];for(var n=0;n<q.list.length;n++){c.push({repeat:q.list[n].split(":")[0].split(","),key:"key-"+n,from:JSON.parse(q.list[n].split(":")[1])[0],to:JSON.parse(q.list[n].split(":")[1])[1]})}j.loadData(c)}else{d=[];c=[];for(var n=0;n<q.list.length;n++){c.push({repeat:q.list[n].split(":")[0].split(","),key:"key-"+n,from:JSON.parse(q.list[n].split(":")[1])[0],to:JSON.parse(q.list[n].split(":")[1])[1]})}j.loadData(c)}}else{$("#wireless_scheudle").hide()}});$("div#wireless_scheudle").panel({title:$.su.CHAR.WIRELESS_SCHEDULE.OFFTIME,collapsible:false});$("#schedule_editor .note").text($.su.CHAR.WIRELESS_SCHEDULE.NOTE3);$(".editor_title").text($.su.CHAR.WIRELESS_SCHEDULE.OFFTIME+":");var b=[];for(var f=0;f<24;f++){b.push({name:f<10?("0"+f):f,value:f})}var a=[];for(var f=1;f<25;f++){a.push({name:f<10?("0"+f):f,value:f})}$("#from").combobox({fieldLabel:$.su.CHAR.WIRELESS_SCHEDULE.FROM,labelCls:"s",items:b}).on("ev_change",function(){setTimeout(function(){for(var i=0;i<24;i++){$("#to").combobox("enableItem",[i])}var m=$("#from").combobox("getValue");if(b[m].value>0){for(var i=0;i<b[m].value+1;i++){$("#to").combobox("disableItem",[i])}}else{$("#to").combobox("disableItem",["0"])}},20)});$("#to").combobox({fieldLabel:$.su.CHAR.WIRELESS_SCHEDULE.TO,labelCls:"s",items:a}).on("ev_change",function(){setTimeout(function(){for(var m=1;m<25;m++){$("#from").combobox("enableItem",[m])}var i=$("#to").combobox("getValue");if(a[i].value>0){for(var m=a[i].value-1;m<25;m++){$("#from").combobox("disableItem",[m])}}else{$("#from").combobox("disableItem",["0"])}},20)});$("#repeat").radio({fieldLabel:$.su.CHAR.WIRELESS_SCHEDULE.REPEAT,labelCls:"s",columns:2,items:[{boxlabel:$.su.CHAR.WIRELESS_SCHEDULE.EVE,inputValue:"0",checked:true},{boxlabel:$.su.CHAR.WIRELESS_SCHEDULE.SEL,inputValue:"1"}]}).on("ev_change",function(i,m,p){if(p==1){$("#week").checkbox("show")}else{$("#week").checkbox("hide")}});$("#week").checkbox({fieldLabel:$.su.CHAR.WIRELESS_SCHEDULE.SEL,labelCls:"s",columns:7,items:[{boxlabel:$.su.CHAR.DATE.SUN,inputValue:"sun",uncheckValue:"",name:"sun"},{boxlabel:$.su.CHAR.DATE.MON,inputValue:"mon",uncheckValue:"",name:"mon"},{boxlabel:$.su.CHAR.DATE.TUES,inputValue:"tue",uncheckValue:"",name:"tue"},{boxlabel:$.su.CHAR.DATE.WED,inputValue:"wed",uncheckValue:"",name:"wed"},{boxlabel:$.su.CHAR.DATE.THUR,inputValue:"thu",uncheckValue:"",name:"thu"},{boxlabel:$.su.CHAR.DATE.FRI,inputValue:"fri",uncheckValue:"",name:"fri"},{boxlabel:$.su.CHAR.DATE.SAT,inputValue:"sat",uncheckValue:"",name:"sat"}]}).on("ev_change",function(i,m,p){setTimeout(function(){if(p[0]!="eve"){$("#repeat").radio("setValue",1)}else{$("#repeat").radio("setValue",0)}},20)});$("#week").checkbox("hide");var j=new $.su.Store({autoLoad:true,fields:[{name:"from"},{name:"to"},{name:"repeat"}],proxy:{}});$("div#wireless_schedule_grid").grid({store:j,editor:{content:"#schedule_editor",fields:[{name:"from"},{name:"to"},{name:"repeat"}],validator:function(){if($("#from").combobox("getValue").length==0){$("#from").combobox("setError",$.su.CHAR.ERROR["00000062"]);return false}if($("#to").combobox("getValue").length==0){$("#to").combobox("setError",$.su.CHAR.ERROR["00000062"]);return false}if($("#repeat").radio("getValue")==1&&$("#week").checkbox("getValue").length==0){$("#week").checkbox("setError",$.su.CHAR.ERROR["00000062"]);return false}$("div#wireless_schedule_grid").grid("runProgress");var s=$("#from").textbox("getValue"),r=$("#to").textbox("getValue"),q=$("#repeat").radio("getValue"),p=$("#week").checkbox("getValue");var n=[],m=$("div#wireless_schedule_grid").grid("getEditor").editingId.split("-")[1];if(q==1){n=p.join(",")+":["+s+","+r+"]";for(var o=0;o<d.length;o++){if(o==m){d[o]=p+":"+d[o].split(":")[1]}else{d[o]=d[o].split(":")[0]+":"+d[o].split(":")[1]}}}else{n="eve:["+s+","+r+"]";for(var o=0;o<d.length;o++){if(o==m){d[o]="eve:"+d[o].split(":")[1]}else{d[o]=d[o].split(":")[0]+":"+d[o].split(":")[1]}}}if($($("div#wireless_schedule_grid").grid("getEditor")).get(0).editingIndex=="add"){d.push(n)}else{d.splice($($("div#wireless_schedule_grid").grid("getEditor")).get(0).editingIndex,1,n)}l.write({list:JSON.stringify(d)},function(i){if(i.list.length>0){d=i.list;$("div#wireless_schedule_grid").grid("prompt",true);$($("div#wireless_schedule_grid").grid("getEditor")).editor("cancelEdit")}else{d=[];$("div#wireless_schedule_grid").grid("prompt",true);$($("div#wireless_schedule_grid").grid("getEditor")).editor("cancelEdit")}});return false}},columns:[{xtype:"checkcolumn",width:30},{xtype:"rownumberer",width:45},{text:$.su.CHAR.WIRELESS_SCHEDULE.OFFTIME,dataIndex:"from",width:240,renderer:function(m,n,p){return p.from+"-"+p.to}},{text:$.su.CHAR.WIRELESS_SCHEDULE.REPEAT,dataIndex:"repeat",width:240,renderer:function(n,q,s){if(s.repeat=="eve"){return"Everyday"}else{var r=[];for(var p=0;p<s.repeat.length;p++){var m=[];m[p]=s.repeat[p].slice(0,1).toUpperCase()+s.repeat[p].slice(1);if(r==""){r=m[p]}else{r=r+","+m[p]}}return r}}},{text:$.su.CHAR.GRID.MODIFY,renderer:function(m,n,q){var p="";p+='<a href="javascript:void(0);" data-index="'+n+'" data-key="key-'+n+'" class="grid-content-btn grid-content-btn-edit btn-edit">';p+='<span class="icon"></span>';p+='<span class="text">'+$.su.CHAR.OPERATION.EDIT+"</span>";p+="</a>";p+='<a href="javascript:void(0);" data-index="'+n+'" data-key="key-'+n+'" class="grid-content-btn btn-delete">';p+='<span class="icon"></span>';p+='<span class="text">'+$.su.CHAR.OPERATION.DELETE+"</span>";p+="</a>";return p}}],operation:["add","delete",{xtype:"button",text:$.su.CHAR.OPERATION.DELETE,iconCls:"delete",handler:function(){var o=$("div#wireless_schedule_grid").grid("getSelected");if(o.length>0){$("div#wireless_schedule_grid").grid("runProgress");var n=[];for(var m=0;m<o.length;m++){delete d[o[m].split("-")[1]]}for(m=0;m<d.length;m++){if(d[m]){n.push(d[m])}}setTimeout(function(){l.write({list:JSON.stringify(n)},function(i){if(i.list.length>0){d=i.list;$("div#wireless_schedule_grid").grid("prompt",true)}else{d=[];$("div#wireless_schedule_grid").grid("prompt",true)}})},500)}else{$("div#wireless_schedule_grid").get(0).noneSelectMsg.msg("show")}},}]}).delegate("a.grid-content-btn.btn-delete","click",function(i){$("div#wireless_schedule_grid").grid("runProgress");d.splice($(this).attr("data-index")*1,1);setTimeout(function(){l.write({list:JSON.stringify(d)},function(m){if(m.list.length>0){d=m.list;$("div#wireless_schedule_grid").grid("prompt",true)}else{d=[];$("div#wireless_schedule_grid").grid("prompt",true)}})},500)});$(".operation-container div.button-container span.text").css({color:"#e00000"});$(".operation-container a.btn-delete").hide();$("a.btn-add").on("click",function(){setTimeout(function(){for(var i=1;i<25;i++){$("#to").combobox("enableItem",[i])}for(var i=0;i<24;i++){$("#from").combobox("enableItem",[i])}},20)});var h=new $.su.Help({container:"div#wireless_schedule_help",content:["WIRELESS_SCHEDULE"]})});</script>
</body>
</html>
