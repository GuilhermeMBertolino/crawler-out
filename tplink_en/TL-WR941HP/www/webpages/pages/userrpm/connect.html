<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Connect to Existing Network</title>
</head>
<body>
<div class="func-container">
	<div id="connect-container">
		<div id="region_tips_connect" class="region-tips-wrap hidden">
			<span id="region_status_tips" class="region-status-tips"></span>
			<button id="jump_to_basic" type="button"></button>
		</div>
		<form id="connect-form">
			<div id="2g-connect">
				<input id="2g_connect_ap_enable" name="enable"/>
				<button id="btn_2g_scan" type="button"></button>
				<input id="2g_connect_ap_ssid" name="ssid" />
				<input id="2g_connect_ap_security" name="encryption"/>
				<input id="2g_connect_ap_password" name="psk_key"/>
				<input id="2g_connect_ap_password_wep" name="wep_key1"/>
				<input type="text"  id="channelwidth-2g" name="htmode" value=""/>
			</div>
			<div id="router_2g_msg">
                <div id="2g_connect_error" class="hidden">
                	<p id="2g_connect_error_tip" class="connection-error-p"></p>
                </div>
				<div id="router_2g_grid" class="quicksetup-grid"></div>
			</div>
			</br>
			</br>
			</br>
			<div id="router_pro_msg" class="hidden">
				<p id="router_pro_text" class="reboot-progressbar-text"></p>
				<input id="router_grid_pro"/>
			</div>
		</form>
		<button id="total_save" type="button"></button>
	</div>
	<div id="connect_help"></div>
</div>
<script type="text/javascript">try{$}catch(e){location.href="/"}$(document).ready(function(v){var d={};var a={};var m;var p=new $.su.Proxy({timeout:15000,url:$.su.url("/admin/wireless?form=syspara_2g")});var q=new $.su.Proxy({timeout:20*1000,url:$.su.url("/admin/wireless?form=region"),async:false});var r=new $.su.Proxy({url:$.su.url("/admin/wireless?form=wireless_2g")});q.read({},function(x){support_smart_conn=x.support_smart_connect||"no";d=x.capability;a=x});var h;var l;var t=false;var i={"2g":false};var w=0;$("span#region_status_tips").html($.su.CHAR.CONNECT.REGION_TIPS);$("p#2g_connect_error_tip").html($.su.CHAR.CONNECT.CONNECT_ERROR);$("#router_pro_text").html($.su.CHAR.CONNECT.SCANNING);var g=$("div#router_pro_msg").msg({type:"window",closeBtn:true,cls:"l"}).on("ev_close",function(){clearInterval(h);clearTimeout(l);t=true;if(i["2g"]){s("2g")}});$("input#router_grid_pro").progressbar({cls:"scan-progressbar",showPercentage:true,height:6,width:400});$("button#jump_to_basic").button({text:$.su.CHAR.CONNECT.GO_REGION,cls:"inline-block",handler:function(){$.su.menu.basic.goTo("region")}});var c=$("form#connect-form").form({proxy:p,fields:[{name:"enable",mapping:"enable"},{name:"ssid",mapping:"ssid"},{name:"encryption",mapping:"encryption"},{name:"psk_key",mapping:"psk_key"},{name:"wep_key1",mapping:"wep_key1"}],submitBtn:"#total_save",validator:function(){var A;A=$("input#2g_connect_ap_security").combobox("getValue")[0];var z;z=$("input#2g_connect_ap_password").textbox("getValue").toString();var y;y=$("input#2g_connect_ap_password_wep").textbox("getValue").toString();function x(C,E,G){var F=/^[A-Fa-f0-9]+$/;var B=/^[A-Za-z0-9\`\~\!\@\#\$\%\^\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\|\/\?\.\,\<\>\s]+$/;var D=/^[A-Za-z0-9\`\~\!\@\#\$\&\*\(\)\-\=\_\+\[\]\{\}\;\:\'\"\\|\/\?\.\,\<\>\%\^\ ]+$/;if(C=="wep"){if(E.length==5){if(!B.test(E)){G.textbox("setError",$.su.CHAR.ERROR["00000215"].replace("%num",5));return false}}else{if(E.length==13){if(!B.test(E)){G.textbox("setError",$.su.CHAR.ERROR["00000215"].replace("%num",13));return false}}else{if(E.length==10){if(!F.test(E)){G.textbox("setError",$.su.CHAR.ERROR["00000216"].replace("%num",10));return false}}else{if(E.length==26){if(!F.test(E)){G.textbox("setError",$.su.CHAR.ERROR["00000216"].replace("%num",26));return false}}else{G.textbox("setError",$.su.CHAR.ERROR["00000213"]);return false}}}}}else{if(C=="psk"){if(E.length<8||E.length>64){G.textbox("setError",$.su.CHAR.ERROR["00000214"]);return false}else{if(E.length==64&&!F.test(E)){G.textbox("setError",$.su.CHAR.ERROR["00000214"]);return false}else{if(!D.test(E)){G.textbox("setError",$.su.CHAR.ERROR["00000214"]);return false}}}}}return true}if(A=="wep"){if($("input#2g_connect_ap_enable").checkbox("getValue")[0]=="enable"&&!x(A,y,$("input#2g_connect_ap_password_wep"))){return false}}else{if(A=="psk"){if($("input#2g_connect_ap_enable").checkbox("getValue")[0]=="enable"&&!x(A,z,$("input#2g_connect_ap_password"))){return false}}}return true}}).on("ev_loadData",function(x,y){if(y.enable=="off"){$("input#2g_connect_ap_password").textbox("hide");$("input#2g_connect_ap_password_wep").textbox("hide");if($("input#2g_connect_ap_security").combobox("getValue")=="psk"){$("input#2g_connect_ap_password").textbox("show")}else{if($("input#2g_connect_ap_security").combobox("getValue")=="wep"){$("input#2g_connect_ap_password_wep").textbox("show")}else{$("input#2g_connect_ap_password").textbox("disable");$("input#2g_connect_ap_password_wep").textbox("disable");$("input#2g_connect_ap_password").textbox("hide");$("input#2g_connect_ap_password_wep").textbox("hide")}}}r.read({},function(z){$("input#channelwidth-2g").combobox("setValue",z.htmode)})});$("div#connect-container").panel({title:$.su.CHAR.CONNECT.TITLE_CONNECT,collapsible:false});function s(x){$("button#btn_"+x+"_scan").button("enable");i[x]=false}function o(x){$("button#btn_"+x+"_scan").button("disable");i[x]=true}$("input#2g_connect_ap_enable").checkbox({fieldLabel:$.su.CHAR.CONNECT.NETWORK_24G,labelCls:"xl",items:[{boxlabel:$.su.CHAR.CONNECT.ENABLE_2G_ROUTER_AP,inputValue:"on",uncheckedValue:"off",name:"enable"}]}).on("ev_change",function(y,x,z){if(z[0]=="on"||z[0]=="enable"){$("input#2g_connect_ap_ssid").textbox("enable");$("input#2g_connect_ap_security").combobox("enable");$("button#btn_2g_scan").button("enable");$("input#channelwidth-2g").combobox("enable");if($("input#2g_connect_ap_security").combobox("getValue")=="psk"){$("input#2g_connect_ap_password").textbox("enable")}else{if($("input#2g_connect_ap_security").combobox("getValue")=="wep"){$("input#2g_connect_ap_password_wep").textbox("enable")}else{$("input#2g_connect_ap_password").textbox("disable");$("input#2g_connect_ap_password_wep").textbox("disable");$("input#2g_connect_ap_password").textbox("hide");$("input#2g_connect_ap_password_wep").textbox("hide")}}}else{$("button#btn_2g_scan").button("disable");$("input#2g_connect_ap_ssid").textbox("disable");$("input#2g_connect_ap_ssid").textbox("setNormal");$("input#2g_connect_ap_security").combobox("disable");$("input#2g_connect_ap_password").textbox("disable");$("input#2g_connect_ap_password").textbox("setNormal");$("input#2g_connect_ap_password_wep").textbox("disable");$("input#2g_connect_ap_password_wep").textbox("setNormal");$("input#channelwidth-2g").combobox("disable")}}).on("ev_loadData",function(x,y){$("input#2g_connect_ap_password").textbox("hide");$("input#2g_connect_ap_password_wep").textbox("hide");if($("input#2g_connect_ap_security").combobox("getValue")=="psk"){$("input#2g_connect_ap_password").textbox("enable");$("input#2g_connect_ap_password").textbox("show")}else{if($("input#2g_connect_ap_security").combobox("getValue")=="wep"){$("input#2g_connect_ap_password_wep").textbox("enable");$("input#2g_connect_ap_password_wep").textbox("show")}else{$("input#2g_connect_ap_password").textbox("disable");$("input#2g_connect_ap_password_wep").textbox("disable");$("input#2g_connect_ap_password").textbox("hide");$("input#2g_connect_ap_password_wep").textbox("hide")}}});$("button#btn_2g_scan").button({fieldLabel:"",labelCls:"xl",cls:"width-184",text:$.su.CHAR.CONNECT.SCAN_CHOOSE,handler:function(){t=false;u.grid("removeAllData");g.msg("show",o("2g"));$("input#router_grid_pro").progressbar("reset");var z=60*1000;var y=$("input#router_grid_pro");var x=false;y.progressbar("reset");y.progressbar("animate",0,1,z);l=setTimeout(function(){if(!x){setTimeout(function(){if(t==false){h=setInterval(function(){var A=setTimeout(function(){clearInterval(h)},300);$("div#router_2g_grid").grid("show");if(t==false){g.msg("close",s("2g"));$("div#router_2g_msg").msg("show",o("2g"))}$("div#router_2g_grid").find("input.totalCount").textbox("setValue","0");$("div#router_2g_grid").addClass("no-cursor");clearInterval(h);$("p#2g_connect_error_tip").html($.su.CHAR.ERROR["00000189"]);$("div#2g_connect_error").show()},1000)}},1000)}},z);b.load({},function(B){x=true;clearTimeout(l);var A=$("input#router_grid_pro").progressbar("getValue");if(A<0.98){y.progressbar("stop").progressbar("animate",A,0.98,1000,function(){setTimeout(function(){if(t==false){h=setInterval(function(){var C=setTimeout(function(){clearInterval(h)},300);$("div#router_2g_grid").grid("show");y.progressbar("stop").progressbar("animate",0.98,1,500,function(){if(t==false){g.msg("close",s("2g"));$("div#router_2g_msg").msg("show",o("2g"))}if(B.length==0){$("div#router_2g_grid").addClass("no-cursor")}else{$("div#router_2g_grid").removeClass("no-cursor")}clearInterval(h);$("div#2g_connect_error").hide()})},1000)}},1000)})}else{y.progressbar("stop").progressbar("animate",A,1,500,function(){setTimeout(function(){if(t==false){h=setInterval(function(){var C=setTimeout(function(){clearInterval(h)},300);$("div#router_2g_grid").grid("show");if(t==false){g.msg("close",s("2g"));$("div#router_2g_msg").msg("show",o("2g"))}if(B.length==0){$("div#router_2g_grid").addClass("no-cursor")}else{$("div#router_2g_grid").removeClass("no-cursor")}clearInterval(h);$("div#2g_connect_error").hide()},1000)}},1000)})}},function(){u.grid("removeAllData");$("div#router_2g_grid").addClass("no-cursor");$("p#2g_connect_error_tip").html($.su.CHAR.CONNECT.CONNECT_ERROR);$("div#2g_connect_error").show()},function(){u.grid("removeAllData");$("div#router_2g_grid").addClass("no-cursor");$("p#2g_connect_error_tip").html($.su.CHAR.CONNECT.CONNECT_ERROR);$("div#2g_connect_error").show()})}});var n=new $.su.Proxy({timeout:60000,url:$.su.url("/admin/wireless?form=survey_2g")});var f=$("div#router_2g_msg").msg({autoshow:false,global:false,title:$.su.CHAR.CONNECT.ROUTER_AP_24G,cls:"xxl",type:"window"}).on("ev_close",function(){s("2g")});var b=new $.su.Store({proxy:n,autoLoad:false,fields:[{name:"bssid"},{name:"ssid"},{name:"signal"},{name:"channel"},{name:"encryption"}]});var u=$("div#router_2g_grid").grid({store:b,minLines:0,maxLines:5,columns:[{text:$.su.CHAR.GRID.ID,xtype:"rownumberer",width:40},{text:$.su.CHAR.SYSPARA.SSID,width:130,dataIndex:"ssid"},{text:$.su.CHAR.SYSPARA.MAC_ADDRESS,width:140,dataIndex:"bssid"},{text:$.su.CHAR.SYSPARA.SIGNAL,width:100,dataIndex:"signal",renderer:function(y){var x="";var z=y.toString();switch(z){case"0":case"1":case"2":case"3":case"4":case"5":x+='<span class="signal-level-'+z+' signal-icon"></span>';break;default:x+='<span class="signal-level-0 signal-icon"></span>';break}return x}},{text:$.su.CHAR.SYSPARA.CHANNEL,width:100,dataIndex:"channel"},{text:$.su.CHAR.SYSPARA.SECURITY,width:100,dataIndex:"encryption",renderer:function(x){if(x.toUpperCase()=="NONE"){return $.su.CHAR.SYSPARA.NONE}else{return x.toUpperCase()}}},{text:$.su.CHAR.GRID.OPERATION,renderer:function(z,x,y){return'<a href="void(0);" index="'+x+'" class="choose" >'+$.su.CHAR.OPERATION.CHOOSE+"</a>"}}],operation:[{xtype:"totalCount",cls:"left",fieldLabel:$.su.CHAR.SYSPARA.AP_NUMBER},{xtype:"button",text:$.su.CHAR.OPERATION.REFRESH,id:"refreshBtn_2g",iconCls:"btn-refresh",handler:function(x){x.stopPropagation();x.preventDefault();$("#refreshBtn_2g").button("disable");u.grid("runProgress");u.grid("getStore").load({},function(){u.grid("prompt",true);$("#refreshBtn_2g").button("enable")},function(){u.grid("prompt",false);$("#refreshBtn_2g").button("enable")},function(){u.grid("prompt",false);enableButton()});return true}}]}).on("ev_load",function(z,x){var y=$(this);$(x).each(function(B,C){var A=C.encryption.toUpperCase();if(A!="NONE"&&A!="WEP"&&A!="PSK"){y.grid("disableRow",B)}})});$("div#router_2g_grid").delegate("a.choose","click",function(D){var y=$("div#router_2g_grid").grid("getStore");var z=$(this).attr("index");D.preventDefault();var B=$(this).parents("tr.grid-content-tr")[0];var C=y.data[z].ssid;var A=y.data[z].channel;w=A;var x=$(B).find("td.grid-content-td-encryption div").eq(0).html().toLowerCase();if(x==$.su.CHAR.CONNECT.NO_SECURITY.toLowerCase()){x="none"}if(x!="none"&&x!="wep"&&x!="psk"){return}$("input#2g_connect_ap_ssid").textbox("setValue",C);$("#2g_connect_ap_security").combobox("setValue",x);$("div#router_2g_msg").msg("close")});$("input#2g_connect_ap_ssid").textbox({fieldLabel:$.su.CHAR.CONNECT.HOST_AP_24G,labelCls:"xl",cls:"inline-block",maxLength:32,minLength:0,allowBlank:false,autoTrim:false,vtype:{vtype:"utf8_lan",maxLength:32},validator:function(y){var x=encodeURIComponent(y);x=x.replace(/%[A-F\d]{2}/g,"U").length;if(x>32){return $.su.CHAR.ERROR["00000210"]}return true}}).on("ev_change",function(x,z){var y=encodeURIComponent(z);y=y.replace(/%[A-F\d]{2}/g,"U").length;if(y==32){$(this).attr("maxLength",z.length)}else{if(y>32){$(this).attr("maxLength",z.length-1)}else{if(y<32){$(this).attr("maxLength",32)}}}});$("input#2g_connect_ap_security").combobox({fieldLabel:$.su.CHAR.CONNECT.ROUTER_AP_SECURITY_24G,labelCls:"xl",items:[{value:"none",name:$.su.CHAR.CONNECT.NO_SECURITY},{value:"psk",name:$.su.CHAR.CONNECT.WPA_WPA2},{value:"wep",name:$.su.CHAR.CONNECT.WEP}]}).on("ev_change",function(y,x,z){$("input#2g_connect_ap_password").textbox("setNormal");$("input#2g_connect_ap_password_wep").textbox("setNormal");if(z[0]=="none"){if($("input#2g_connect_ap_enable").checkbox("getValue")[0]=="enable"){$("input#2g_connect_ap_password").textbox("disable");$("input#2g_connect_ap_password_wep").textbox("disable");$("input#2g_connect_ap_password").textbox("hide");$("input#2g_connect_ap_password_wep").textbox("hide")}}else{if(z[0]=="wep"){if($("input#2g_connect_ap_enable").checkbox("getValue")[0]=="enable"){$("input#2g_connect_ap_password_wep").textbox("enable");$("input#2g_connect_ap_password_wep").textbox("show");$("input#2g_connect_ap_password").textbox("disable");$("input#2g_connect_ap_password").textbox("hide")}}else{if($("input#2g_connect_ap_enable").checkbox("getValue")[0]=="enable"){$("input#2g_connect_ap_password").textbox("enable");$("input#2g_connect_ap_password").textbox("show");$("input#2g_connect_ap_password_wep").textbox("disable");$("input#2g_connect_ap_password_wep").textbox("hide")}}}});$("input#2g_connect_ap_password").textbox({fieldLabel:$.su.CHAR.CONNECT.ROUTER_AP_PASSWORD_24G,labelCls:"xl",allowBlank:false,vtype:"password",maxLength:64,autoTrim:false});$("input#2g_connect_ap_password_wep").textbox({fieldLabel:$.su.CHAR.CONNECT.ROUTER_AP_PASSWORD_24G,labelCls:"xl",allowBlank:false,vtype:"password",maxLength:64,autoTrim:false});$("input#channelwidth-2g").combobox({fieldLabel:$.su.CHAR.WIRELESS.CHANNEL_WIDTH,labelCls:"xl"});var j=function(A){var C=d.htmode_2g;var B=[];var x=C.length;B[0]={name:$.su.CHAR.WIRELESS.AUTO,value:"auto"};for(var z=0;z<x;z++){var y={};y.name=C[z]+$.su.CHAR.WIRELESS.MHZ;y.value=C[z];B.push(y)}$("#channelwidth-2g").combobox("loadData",B)};$("button#total_save").button({text:$.su.CHAR.OPERATION.SAVE,cls:"submit",handler:function(){c.form("submit");var x=$("input#2g_connect_ap_security").textbox("getValue");var y=$("input#2g_connect_ap_password").textbox("getValue");var A=$("input#2g_connect_ap_password_wep").textbox("getValue");var z=$("input#channelwidth-2g").combobox("getValue");if(x=="none"){r.write({encryption:x,htmode:z})}else{if(x=="psk"){r.write({encryption:x,psk_key:y,htmode:z})}else{if(x=="wep"){r.write({encryption:x,wep_key1:A,htmode:z})}}}}});j(a);$.su.app.runningModule.addUnloadHandler(function(){clearInterval(h)});var k=new $.su.Help({container:"div#connect_help",content:["WIRELESS_CONNECT"]})});</script>
</body>
</html>
