<script>function initAccessDevicesListTable(){var t=[],s=1,a=$.act(ACT_GL,LAN_HOST_ENTRY,null,null);$.exe(function(e){e||($.each(a,function(){1==this.active&&(t.push([{text:s,width:"5%"},{text:$.htmlEncodeStr(this.hostName),width:"10%"},{text:this.IPAddress,width:"10%"},{text:this.MACAddress.replace(/\:/g,"-"),width:"15%"},{text:"<span class='table-grid-icon add-icon'></span>",width:"15%"}]),s++)}),$.initTableBody($("#tableAccessDevicesList"),t),$.tablePages($("#tableAccessDevicesList"),68),$("span.add-icon").click(function(){var t=$(this).parents("tr:eq(0)").find("td:eq(3)").text(),s=$(this).parents("tr:eq(0)").find("td:eq(2)").text();$("#staticMac").tpAddress("val",t),$("#staticIP").tpAddress("val",s),$("#accessDevList").fadeOut(20,function(){$("#accessDevList").removeClass("on-mask msg-container").addClass("nd")}),$("#mask").hide()}))})}function initStaticEdit(){isEdit?($("#groupView").removeClass("nd"),$("#groupSel").addClass("nd"),$.each(brLanList,function(){staticIpList[staticEditIndex].__stack.split(",")[0]==this.__stack.split(",")[0]&&$("#brName").html(this.bridgeName)}),$("#staticMac").tpAddress("val",staticIpList[staticEditIndex].chaddr.toUpperCase()),$("#staticIP").tpAddress("val",staticIpList[staticEditIndex].yiaddr),$("#staticEn").prop("checked",1==staticIpList[staticEditIndex].enable)):($("#groupView").addClass("nd"),$("#groupSel").removeClass("nd"),$.each(brLanList,function(){var t="<option value="+this.__stack+">"+this.bridgeName+"</option>";$("#staticGroup").append(t)}))}function clickOK(){var t,s={};if(s.chaddr=$("#staticMac").tpAddress("val").toUpperCase(),s.yiaddr=$("#staticIP").tpAddress("val"),s.enable=$("#staticEn").prop("data-checked")?1:0,$.mac(s.chaddr))return $("#staticMac").tpAddress("focus"),!1;if($.ifip(s.yiaddr))return $("#staticIP").tpAddress("focus"),!1;var a;brLanList=$.act(ACT_GL,L2_BRIDGING_ENTRY,null,null,["bridgeName"]),$.exe()||$.each(brLanList,function(){"Default"==this.bridgeName&&(a=this.__stack)});var e=$.ip2ip($("#staticIP").tpAddress("val"));if(lanIPv4Cfg=$.act(ACT_GS,LAN_IP_INTF,null,a,["IPInterfaceIPAddress","IPInterfaceSubnetMask","X_TP_MACAddress"]),!$.exe()){if(lanIPv4Cfg[0].IPInterfaceIPAddress==e)return $.alert(CMM_DMZ_IP_NOT_BE_LAN_IP),void $("#staticIP").tpAddress("focus");isEdit?$.act(ACT_SET,LAN_DHCP_STATIC_ADDR,staticIpList[staticEditIndex].__stack,null,s):(t=$("#staticGroup").data("value"),$.act(ACT_ADD,LAN_DHCP_STATIC_ADDR,null,t,s)),$.exe()||($.removeLoading(),$.reload())}}function clickCancel(){$.reload()}</script>
<style>#accessDevList{width:426px}#accessDevList td{text-align:center;border-color:#ccc;border-radius:0;border-bottom:none;border-right:none;padding:0 3px}#accessDevList td:first-child{border-left:none}</style>
<div class="content-container" id="staticContent">
    <form class="pure-form pure-form-aligned" id="staticForm">
        <div id="groupView" class="pure-control-group">
            <label class="label-title T_group">Group:</label>
            <span class="text" id="brName"></span>
        </div>

        <div>
            <b class="T_macaddr">Mac Address:</b>
            <input type="text" id="staticMac" required class="mac-address">
            <div style="display:inline-block">
                <button type="submit" class="blue T_scan" id="t_viewdev">Scan</button>
            </div>
        </div>

        <div>
            <form class="pure-form pure-form-aligned">
                <div id="accessDevList" class="nd">
                    <div id="closeDeviceList" class="table-op">
                        <div class="table-btn">
                            <span class="close-icon table-icon"></span>
                        </div>
                    </div>

                    <table id="tableAccessDevicesList">
                        <thead>
                            <span id="t_devlist" class="msg-container-title"></span>
                        </thead>
                        <tbody id="bodyAccessDevicesList">
                        </tbody>
                    </table>
                </div>
            </form>
        </div>

        <div>
            <b id="t_resvip">Reserved IP Address:</b>
            <input type="text" id="staticIP" required class="ip-address">
            <span></span>
        </div>

        <div id="groupSel">
            <b class="T_group">Group</b>
            <select id="staticGroup">
            </select>
        </div>

        <div>
            <b></b>
            <input type="checkbox" id="staticEn" checked="true">
            <label class="T_c_enable">Enable this entry</label>
        </div>

        <div class="inline-btn-right">
            <button type="submit" class="green inline T_cancel" id="editCancel">Cancel</button>
            <button type="submit" class="green inline T_save" id="editOK">Save</button>
        </div>
        <p class="br"></p>
    </form>
</div>

<script>$("#editOK").on("click",function(e){$.addLoading($(this)),clickOK()}),$("#editCancel").on("click",function(e){clickCancel()}),$("#t_viewdev").click(function(){$("#accessDevList").fadeIn(20,function(){$("#accessDevList").removeClass("nd").addClass("on-mask msg-container")}),$.setFixedCentral($("#accessDevList")),$("#mask").show()}),$("#closeDeviceList").click(function(){$("#accessDevList").fadeOut(20,function(){$("#accessDevList").removeClass("on-mask msg-container").addClass("nd")}),$("#mask").hide()});var AccessDevicesListHeadArray=[{text:table_str.id,width:"10%"},{text:table_str.devname,width:"20%"},{text:table_str.ip,width:"20%"},{text:table_str.mac,width:"20%"},{text:table_str.operation,width:"20%"}];$.initTableHead($("#tableAccessDevicesList"),AccessDevicesListHeadArray),$("#tableAccessDevicesList").tpTable(initAccessDevicesListTable),$.tpInit(initStaticEdit)</script>
