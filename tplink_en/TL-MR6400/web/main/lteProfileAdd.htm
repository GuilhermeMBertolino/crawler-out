<script language="javascript">function init(){var e,t=$.act(ACT_GL,LTE_WAN_CFG,null,null,["dataSwitchStatus"]),a=$.act(ACT_GL,WAN_COMMON_INTF_CFG,null,null,["WANAccessType"]),i=0;$.exe()||($.each(a,function(){"LTE"==this.WANAccessType&&(e=this.__stack)}),$.each(t,function(){var t=$.stkPop(this.__stack,1);if(e==t)return wanCfgStk=this.__stack,$.act(ACT_SET,LTE_WAN_CFG,wanCfgStk,null,["profileAction=4"]),wanCfg=$.act(ACT_GET,LTE_WAN_CFG,this.__stack,null,null),profileList=$.act(ACT_GL,LTE_PROFILE,null,null,null),i=1,!1}),1==i&&$.exe())}function selectObj(e){e&&(e.focus(),e.select())}function isValidString(e){return!/\s/.test(e)&&!/['"]/.test(e)}function isValidLength(e){return e.length>0&&e.length<32}function isValidApnNi(e){return String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return t=!t||t<0?0:+t,this.substring(t,t+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),!((e=e.toLowerCase()).startsWith("rac")||e.startsWith("lac")||e.startsWith("sgsn")||e.startsWith("rnc")||e.endsWith(".gprs")||e.includes("*"))}function isValidLabel(e){return/^(?=[A-Za-z0-9])[A-Za-z0-9-]*[A-Za-z0-9]$/.test(e)}function isValidProfileName(e){return!/\s/.test(e)&&/[^'"<>()]/.test(e)}function checkParam(e,t){var a,i,n,l=$("#c_profileName").val(),_=$("#c_pdpType").data("value");if(!l)return $.alert(ERR_LTE_PROFILE_NAME_EMPTY),selectObj($("#c_profileName")),!1;if(!isValidLength(l))return $.alert(ERR_LTE_PROFILE_NAME_MAXLEN_ERROR),selectObj($("#c_profileName")),!1;if(!isValidString(l))return $.alert(ERR_LTE_PROFILE_NAME_ILLEGAL_CHAR),selectObj($("#c_profileName")),!1;for(r=0;r<e.length;r++)if(("NONE"!=e[r].profileName||1!=t)&&l==e[r].profileName)return $.alert(ERR_LTE_PROFILE_SAME_PROFILE_NAME),selectObj($("#c_profileName")),!1;if(0==_||2==_){if(a=$("#c_usrLte0").val(),i=$("#c_pwdLte0").val(),n=$("#c_apn0").val(),0==$("#c_apnType0").data("value")){if(!n)return $.alert(ERR_LTE_PROFILE_APN_EMPTY),selectObj($("#c_apn0")),!1;if(!isValidApnNi(n))return $.alert(ERR_LTE_PROFILE_APN_ILLEGAL_CHAR),selectObj($("#b_apn0")),!1;labels=n.split(".");for(r=0;r<labels.length;r++)if(!isValidLabel(labels[r]))return $.alert(ERR_LTE_PROFILE_APN_ILLEGAL_CHAR),selectObj($("#b_apn0")),!1}if(a){if(!isValidLength(a))return $.alert(ERR_LTE_PROFILE_USERNAME_MAXLEN_ERROR),selectObj($("#c_usrLte0")),!1;if(!isValidString(a))return $.alert(ERR_LTE_PROFILE_USERNAME_ILLEGAL_CHAR),selectObj($("#c_usrLte0")),!1}if(i){if(!isValidLength(i))return $.alert(ERR_LTE_PROFILE_PASSWORD_MAXLEN_ERROR),selectObj($("#c_pwdLte0")),!1;if(!isValidString(i))return $.alert(ERR_LTE_PROFILE_PASSWORD_ILLEGAL_CHAR),selectObj($("#c_pwdLte0")),!1}}if(1==_){if(a=$("#c_usrLte1").val(),i=$("#c_pwdLte1").val(),n=$("#c_apn1").val(),0==$("#c_apnType1").data("value")){if(!n)return $.alert(ERR_LTE_PROFILE_APN_EMPTY),selectObj($("#c_apn1")),!1;if(!isValidApnNi(n))return $.alert(ERR_LTE_PROFILE_APN_ILLEGAL_CHAR),selectObj($("#b_apn0")),!1;labels=n.split(".");for(var r=0;r<labels.length;r++)if(!isValidLabel(labels[r]))return $.alert(ERR_LTE_PROFILE_APN_ILLEGAL_CHAR),selectObj($("#b_apn0")),!1}if(a){if(!isValidLength(a))return $.alert(ERR_LTE_PROFILE_USERNAME_MAXLEN_ERROR),selectObj($("#c_usrLte1")),!1;if(!isValidString(a))return $.alert(ERR_LTE_PROFILE_USERNAME_ILLEGAL_CHAR),selectObj($("#c_usrLte1")),!1}if(i){if(!isValidLength(i))return $.alert(ERR_LTE_PROFILE_PASSWORD_MAXLEN_ERROR),selectObj($("#c_pwdLte1")),!1;if(!isValidString(i))return $.alert(ERR_LTE_PROFILE_PASSWORD_ILLEGAL_CHAR),selectObj($("#c_pwdLte1")),!1}}return!0}var wanCfg,wanCfgStk,profileList=new Array;$("select#c_pdpType").on("click.lteProfileAdd",function(e){1==$("#c_pdpType").data("value")?($("#c_ipv4").addClass("nd"),$("#c_ipv6").removeClass("nd")):($("#c_ipv4").removeClass("nd"),$("#c_ipv6").addClass("nd"))}),$("select#c_apnType0").on("click.lteProfileAdd",function(e){1==$("#c_apnType0").data("value")?$("#c_ipv4Apn").addClass("nd"):$("#c_ipv4Apn").removeClass("nd")}),$("select#c_apnType1").on("click.lteProfileAdd",function(e){1==$("#c_apnType1").data("value")?$("#c_ipv6Apn").addClass("nd"):$("#c_ipv6Apn").removeClass("nd")}),$("#saveBtn").click(function(){if(0==checkParam(profileList,wanCfg.defaultProfile))return!1;var e={};e.profileName=$("#c_profileName").val(),e.pdpType=$("#c_pdpType").data("value"),1!=e.pdpType?(e.ipv4ApnType=$("#c_apnType0").data("value"),0==e.ipv4ApnType?e.ipv4Apn=$("#c_apn0").val():e.ipv4Apn="",e.ipv4Username=$("#c_usrLte0").val(),e.ipv4Password=$("#c_pwdLte0").val(),e.ipv4AuthType=$("#c_authType0").data("value")):(e.ipv6ApnType=$("#c_apnType1").data("value"),0==e.ipv6ApnType?e.ipv6Apn=$("#c_apn1").val():e.ipv6Apn="",e.ipv6Username=$("#c_usrLte1").val(),e.ipv6Password=$("#c_pwdLte1").val(),e.ipv6AuthType=$("#c_authType1").data("value")),e.profileAction=2,$.act(ACT_SET,LTE_WAN_CFG,wanCfgStk,null,e),$.addLoading($(this)),$.exe(function(e){e||($.removeLoading(),$.loadMain("advanceLte.htm"))})}),$("#cancelBtn").click(function(){$.loadMain("advanceLte.htm")})</script>

<h3 id="t_sett">Create Profile</h3>

<div class="content-container">
    <form class="pure-form pure-form-aligned">
    
        <div><b class="xl T_profileName">Profile Name:</b>
                <input type="text" class="lte" id="c_profileName" maxlength="31" oninput="$.maxlength(this)">
        </div>
        <div><b class="xl T_pdpType">PDP Type:</b>
            <select id="c_pdpType" class="lte">
                <option value="0" selected="selected">IPv4</option>
                <option value="1">IPv6</option>
                <option value="2">IPv4 & IPv6</option>
            </select>
        </div>

        <div id="c_ipv4">
            <div id="c_ipv4ApnType"><b id="c_ipv4ApnType_b" class="xl T_lteApnType">APN Type:</b>
                <select id="c_apnType0" class="lte">
                    <option value="0" class="T_static" selected="selected">Static</option>
                    <option value="1" class="T_dynamic">Dynamic</option>
                </select>
            </div>
            <div id="c_ipv4Apn"><b id="c_ipv4Apn_b" class="xl T_lteApn">APN:</b>
                    <input type="text" class="lte" id="c_apn0" maxlength="62">
            </div>
            <div id="c_ipv4Usr"><b id="c_ipv4Usr_b" class="xl T_lteUsername">Username:</b>
                    <input type="text" class="lte" id="c_usrLte0" maxlength="31">
            </div>
            <div id="c_ipv4Pwd"><b id="c_ipv4Pwd_b" class="xl T_ltePassword">Password:</b>
                    <input type="password" class="lte" id="c_pwdLte0" maxlength="31">
            </div>

            <div id="c_ipv4AuthType"><b id="c_ipv4AuthType_b" class="xl T_lteAuthType">Authentication Type:</b>
                <select id="c_authType0" class="lte">
                    <option value="0" class="T_none" selected="selected">NONE</option>
                    <option value="1">PAP </option>
                    <option value="2">CHAP</option>
                    <option value="3">PAP/CHAP</option>
                </select>
            </div>
        </div>

        <div id="c_ipv6" class="nd">
            <div id="c_ipv6ApnType"><b id="c_ipv6ApnType_b" class="xl T_lteApnType">APN Type:</b>
                <select id="c_apnType1" class="lte">
                    <option value="0" class="T_static" selected="selected">Static</option>
                    <option value="1" class="T_dynamic">Dynamic</option>
                </select>
            </div>

            <div id="c_ipv6Apn"><b id="c_ipv6Apn_b" class="xl T_lteApn">APN:</b>
                    <input type="text" class="lte" id="c_apn1" maxlength="62">
            </div>
            <div id="c_ipv6Usr"><b id="c_ipv6Usr_b" class="xl T_lteUsername">Username:</b>
                    <input type="text" class="lte" id="c_usrLte1" maxlength="31">
            </div>
            <div id="c_ipv6Pwd"><b id="c_ipv6Pwd_b" class="xl T_ltePassword">Password:</b>
                    <input type="password" class="lte" id="c_pwdLte1" maxlength="31">
            </div>

            <div id="c_ipv6AuthType"><b id="c_ipv6AuthType_b" class="xl T_lteAuthType">Authentication Type:</b>
                <select id="c_authType1" class="lte">
                    <option value="0" class="T_none" selected="selected">NONE</option>
                    <option value="1">PAP </option>
                    <option value="2">CHAP</option>
                    <option value="3">PAP/CHAP</option>
                </select>
            </div>
        </div>

        <p class="br"></p>

        <div class="inline-btn-right">
            <div class="inline">
                <button type="submit" class="green T_cancel" id="cancelBtn">Cancel</button>
            </div>
            <div class="inline">
                <button type="submit" class="green T_ok" id="saveBtn">OK</button>
            </div>
        </div></form>
</div>

<script>$(document).ready(function(){$.tpInit(init)})</script>

