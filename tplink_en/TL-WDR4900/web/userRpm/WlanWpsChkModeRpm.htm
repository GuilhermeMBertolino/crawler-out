<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<script language="JavaScript" src="../dynaform/custom.js" type="text/JavaScript"></script>
<script type="text/javascript">
<!--
var g_reqURL = "";

function doPage()
{
	location.href = g_reqURL + "?NewDevCfg=Connect";
}

function doSubmit()
{
	var df = document.forms[0];
	if(df.WpsAddDevMode[0].checked)
	{
		if(df.DevPin.value.length != 8)
		{
			alert( js_pin_dig = "The PIN must be a 8-digit number.");
			df.DevPin.focus();
			df.DevPin.select();
			return false;
		}
		if(is_number(df.DevPin.value) == false)
		{
			alert( js_illegal_input = "The input value contain illegal characters, please input another one!");
			df.DevPin.focus();
			df.DevPin.select();
			return false;
		}
	}

	if(isConfigured == 0)
		alert(str_wps_name_short + " is unconfigured, if the " + str_wps_name_short + " session succeed, the router will reboot");

	return true;
}

function onBackPage()
{
	location.href = g_reqURL;
}
//-->
</script>
</head>
<body onLoad="setTagStr(document,'ntw_wlan_chk_mode');LoadHelp('WlanWpsChkModeHelpRpm.htm'); resize(this);">
    <form action="" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
        <center>
            <table id="autoWidth">
                <tr>
                    <td colspan="2" class=h1 id="t_title">Add A New Device</td>
                </tr>
                <tr>
                    <td colspan="2" class=blue>&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="2" style="padding-left:30px;font-size:14px"><input name="WpsAddDevMode" type="radio" value="1" checked>&nbsp;<span id="t_dev_pin">Enter the new device's PIN.</span></td>
                </tr>
                <tr>
                    <td colspan="2" style="padding-left:30px;font-size:14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="t_pin">PIN:&nbsp;</span><input name="DevPin" value="" maxlength="8"></td>
                </tr>
                <tr>
                    <td colspan="2" style="padding-left:30px;font-size:14px"><input name="WpsAddDevMode" type="radio" value="2">&nbsp;<span id="t_new_dev_pin">Press the button of the new device in two minutes.</span></td>
                </tr>
                <tr id="statNewLine" style="display:none">
                    <td colspan="2">&nbsp;</td>
                </tr>
                <tr id="WpsStatusVis" style="display:none">
                    <td colspan="2" id="WpsStatus" class="emp" style="padding-left:30px;">-</td>
                </tr>
                <tr id="showErrMsg" style="display:none">
                    <td colspan="2" id="errMsg" style="padding-left:30px;font-weight:bold;font-size:14px">-</td>
                </tr>
                <tr>
                    <td colspan="2" class="blue">&nbsp;</td>
                </tr>
                <tr>
                    <td class="mbtn" colspan="2"><input name="Back" type="button" class="buttonBig" value="Back" onclick="onBackPage();">&nbsp;<input name="NewDevCfg" type="submit" class="buttonBig" value="Connect"></td>
                </tr>
            </table>
        </center>
    </form>
</body>
</html>
<script type="text/javascript">
if(addDevCfg[4] == 0)//2.4G
{
	g_reqURL = "/userRpm/WpsCfgRpm.htm";
	document.getElementById("t_title").innerHTML = "Add A New Device (2.4GHz)";
}
else
{
	g_reqURL = "/userRpm/WpsCfgRpm_5g.htm";
	document.getElementById("t_title").innerHTML = "Add A New Device (5GHz)";
}
document.forms[0].action = g_reqURL;

if(addDevCfg[0] == 1)
{
	document.getElementById("statNewLine").style.display = "block";
	document.getElementById("showErrMsg").style.display = "block";
	document.getElementById("errMsg").innerHTML = "<span style=\"color:#FF0000\" id=\"t_wrong_pin\">Invalid WPS PIN, please check if it is correct!</span>";
	document.forms[0].DevPin.value = addDevCfg[1];
	document.forms[0].DevPin.focus();
	document.forms[0].DevPin.select();
}
else if(addDevCfg[1] != "00000000")
{
	document.forms[0].DevPin.value = addDevCfg[1];
}
if(addDevCfg[2] == 1)
{
	window.setTimeout("doPage()", 5000);
	document.getElementById("statNewLine").style.display = "block";
	document.getElementById("WpsStatusVis").style.display = "block";
	document.getElementById("WpsStatus").innerHTML = "<span id=\"t_conneting\">Connecting ...</span>";

	document.forms[0].WpsAddDevMode[0].disabled = true;
	document.forms[0].WpsAddDevMode[1].disabled = true;
	document.forms[0].DevPin.disabled = true;
	document.forms[0].Back.disabled = true;
	document.forms[0].NewDevCfg.disabled = true;
}
else if(addDevCfg[2] == 2)
{
	document.getElementById("statNewLine").style.display = "block";
	document.getElementById("WpsStatusVis").style.display = "block";
	document.getElementById("WpsStatus").innerHTML = "<span id=\"t_con_suc\">Connect successfully!</span>";
}
else if(addDevCfg[2] == 3)
{
	document.getElementById("statNewLine").style.display = "block";
	document.getElementById("WpsStatusVis").style.display = "block";
	document.getElementById("WpsStatus").innerHTML = "<span id=\"t_con_err\">Connect error!</span>";
}
document.forms[0].WpsAddDevMode[addDevCfg[3] - 1].checked = true;
</script>
