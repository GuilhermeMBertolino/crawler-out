<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<script type="text/javascript">
<!--//
var g_reqURL = (wlanFilterAdvPara[8] == 0) ? "/userRpm/WlanMacFilterRpm.htm" : "/userRpm/WlanMacFilterRpm_5g.htm";
var keyLen64 = 10;
var keyLen128 = 26;
var keyLen152 = 32;
function getKeyLen(type)
{
	var keyLen = 0;
	if(3 == type)
		keyLen = keyLen64;
	else if(4 == type)
		keyLen = keyLen128;
	else if(5 == type)
		keyLen = keyLen152;
	return keyLen;
}

function auto_length()
{
	var cf = document.forms[0];
	var keyLen = 0;
	keyLen = getKeyLen(cf.Type.selectedIndex + 1);
	if(keyLen > 0)
	{
		cf.key.disabled = false;
		cf.key.maxLength = cf.key.size = keyLen;
		cf.key.value = cf.key.value.substring(0, keyLen);
	}
	else
	{
		cf.key.disabled = true;
		cf.key.maxLength = cf.key.size = keyLen152;
	}
}

function checkKey(key, type)
{
	var c;
	var zeronum = 0;
	var ch = "0123456789ABCDEFabcdef";
	var expectedLen = getKeyLen(type);
	if(expectedLen <= 0)
		return true;
	if(key.length != expectedLen)
		return false;
	for(var i = 0; i < key.length; i++)
	{
		c = key.charAt(i);
		if(c == "0")
			zeronum++;
		if(ch.indexOf(c) == -1)
		{
			return false;
		}
		if(zeronum == expectedLen)
			return false;
	}
	return true;
}

function onChangeType()
{
	auto_length();
}

function doBack(nPage)
{
	location.href = g_reqURL + "? Page = " + nPage;
}

function is_spmac(mac_string)
{
	if(mac_string == "00-00-00-00-00-00")
	{
		alert( js_inv_mac_addr = "Invalid MAC address, please input another one!");
		return false;
	}
	var ch = "Ff-";
	for(var i = 0; i < mac_string.length; i++)
	{
		c = mac_string.charAt(i);
		if(ch.indexOf(c) == -1)
			return true;
	}
	alert( js_inv_mac_addr = "Invalid MAC address, please input another one!");
	return false;
}

function doSubmit()
{
	if(document.forms[0].Mac.value == "")
	{
		alert( js_pl_cor_mac = "Please input a correct MAC address!");
		var element = document.forms[0].Mac;
		if(element)
		{
			element.focus();
			element.select();
		}
		return false;
	}
	if(document.forms[0].Mac.value != "")
	{
		if(!is_macaddr(document.forms[0].Mac.value))
		{
			var element = document.forms[0].Mac;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
		if(!is_spmac(document.forms[0].Mac.value))
		{
			var element = document.forms[0].Mac;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	if(document.forms[0].Desc.value != "")
	{
		if(!is_hostname(document.forms[0].Desc.value))
		{
			var element = document.forms[0].Desc;
			if(element)
			{
				element.focus();
				element.select();
			}
			return false;
		}
	}
	if(!checkKey(document.forms[0].key.value, document.forms[0].Type.selectedIndex + 1))
	{
		var element = document.forms[0].key;

		alert( js_pl_cor_wep = "Please input a correct WEP Key!")
		if(element)
		{
			element.focus();
			element.select();
		}
		return false;
	}
	return true;
}
//-->
</script>
</head>
<body onLoad="setTagStr(document,'wlan_mac_fil_adv');LoadHelp('WlanMacFilterHelpRpm.htm'); resize(this);" onResize="resize(this);">
    <center>
        <form action="" enctype="multipart/form-data" method="get" onSubmit="return doSubmit();">
            <table id="autoWidth">
                <tr>
                    <td class=h1 colspan=2 id="t_title">Add or Modify Wireless MAC Address Filtering entry</td>
                </tr>
                <tr>
                    <td class=blue colspan=2></td>
                </tr>
                <tr>
                    <td class=Item id = "t_mac_addr">MAC Address:</td>
                    <td><input name="Mac" type="text" class="text" value="-" size="17" maxlength="17"></td>
                </tr>
                <tr>
                    <td class=Item id = "t_desc">Description:</td>
                    <td><input name="Desc" type="text" class="text" value="-" size="30" maxlength="30"></td>
                </tr>
                <tr style="display:none">
                    <td class=Item id = "t_pri"> Privilege: </td>
                    <td>
                    <select  size="1" name="Type" class="list" onChange="onChangeType()">
                        <script type="text/javascript">
                            var typeList = new Array("", "allow", "deny", "64 bit", "128 bit", "152 bit");
                            for( i = 1; i < 6; i++)
                            {
                                document.write('<option value=' + i + '>' + typeList[i] + '&nbsp;</option>');
                            }
                        </script>
                    </select></td>
                </tr>
                <tr style="display:none">
                    <td style="display:none" class=Item id = "t_wep_key"> WEP Key: </td>
                    <td ><input name="key" type="text" class="text" value="" size="32" maxlength="32"></td>
                </tr>
                <tr>
                    <td class=Item id = "t_sta">Status:</td>
                    <td>
                    <select name="entryEnabled" class="list">
                        <option value="1" id = "t_enabled">Enabled</option>
                        <option value="0" id = "t_disabled">Disabled</option>
                    </select></td>
                </tr>
                <tr>
                    <td class=blue colspan=2></td>
                </tr>
                <tr>
                    <td></td>
                    <td><input name="Changed" type="hidden" value=0><input name="SelIndex" type="hidden" value="0"><input name="Page" type="hidden" value="1"><input name="Save" type="submit" class="buttonBig" value="Save"> &nbsp; <input type="button" value="Back" name="Back" class="buttonBig" onClick="doBack(curPage);"></td>
                </tr>
            </table>
        </form>
    </center>
</body>
<head>
    <meta http-equiv="pragma" content="no-cache">
</head>
</html>
<script type="text/javascript">
document.forms[0].action = g_reqURL;
document.forms[0].Mac.value = wlanFilterAdvPara[0];
document.forms[0].Desc.value = wlanFilterAdvPara[1];
document.forms[0].Type.value = wlanFilterAdvPara[2];
document.forms[0].key.value = wlanFilterAdvPara[3];
document.forms[0].key.size = (getKeyLen(wlanFilterAdvPara[2]) == 0) ? keyLen152 : getKeyLen(wlanFilterAdvPara[2]);
document.forms[0].key.maxLength = (getKeyLen(wlanFilterAdvPara[2]) == 0) ? keyLen152 : getKeyLen(wlanFilterAdvPara[2]);
document.forms[0].key.disabled = (wlanFilterAdvPara[2] == 1 || wlanFilterAdvPara[2] == 2) ? true : false;
document.forms[0].entryEnabled.value = wlanFilterAdvPara[4];
var curPage = wlanFilterAdvPara[7];
document.forms[0].Changed.value = wlanFilterAdvPara[5];
document.forms[0].SelIndex.value = wlanFilterAdvPara[6];
document.forms[0].Page.value = curPage;
//document.getElementById("t_pri").style.display = (wlanFilterAdvPara[8]) ? "block" : "none";
//document.getElementById("t_wep_key").style.display = (wlanFilterAdvPara[8]) ? "block" : "none";
onChangeType();
</script>
