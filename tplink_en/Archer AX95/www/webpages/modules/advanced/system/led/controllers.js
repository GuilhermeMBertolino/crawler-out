!function(r){r.su.moduleManager.define("led",{models:["ledControlModel","nightModeModel"],stores:[],services:["time","timer"],views:["ledView"],listeners:{ev_on_launch:function(e,t,o,n,i,d,s){this.unRegisterAutoSaveData([n.ledControlModel]),this.startCheckLed(!0),n.nightModeModel.load()},ev_before_destroy:function(e,t){t.beforeDestroy()}},init:function(n,i,d,e,t,s){this.configViews({}),this.listen({"models.nightModeModel.enable":{ev_value_change:function(e,t,o){"on"===t?(i.ledView.nightModeFieldset.show(),s.time.on("on_time_change",n.onTimeChange),s.time.on("on_hour24_change",n.onHour24Change)):(i.ledView.nightModeFieldset.hide(),s.time.off("on_time_change",n.onTimeChange),s.time.off("on_hour24_change",n.onHour24Change))}},"models.nightModeModel.timeStart":{ev_value_change:function(e,t,o){var t=t||"00:00",n=d.nightModeModel.timeEnd.getValue()||"00:00";"string"==typeof t&&"string"==typeof n&&(t=parseInt(t.replace(":",""),10),parseInt(n.replace(":",""),10)<=t?d.nightModeModel.timeEnd.setShortTips(r.su.CHAR.LED.NEXT_DAY_TIP):d.nightModeModel.timeEnd.setShortTips("&nbsp;"))}},"models.nightModeModel.timeEnd":{ev_value_change:function(e,t,o){var n=d.nightModeModel.timeStart.getValue()||"00:00",t=t||"00:00";"string"==typeof n&&"string"==typeof t&&(n=parseInt(n.replace(":",""),10),parseInt(t.replace(":",""),10)<=n?d.nightModeModel.timeEnd.setShortTips(r.su.CHAR.LED.NEXT_DAY_TIP):d.nightModeModel.timeEnd.setShortTips("&nbsp;"))}}}),this.control({"#led-enable":{ev_view_change:function(e,t){this.stopCheckLed(),d.ledControlModel.submit({success:function(){n.startCheckLed(!1)}})}}})}},function(e,n,o,t,i,d){var s=null;return{startCheckLed:function(e){s=d.timer.setInterval(this,function(){o.ledControlModel.load()},2900,e)},stopCheckLed:function(){d.timer.clearInterval(this,s),s=null},onTimeChange:function(e,t){var o=d.time.getHour24(),t=d.time.format(t,"yyyy-MM-dd HH:mm:ss",o);n.ledView.currentTime.setValue(t)},onHour24Change:function(e,t){t?(o.nightModeModel.timeEnd.setHourSystem("24"),o.nightModeModel.timeStart.setHourSystem("24")):(o.nightModeModel.timeEnd.setHourSystem("12"),o.nightModeModel.timeStart.setHourSystem("12"))},beforeDestroy:function(){d.time.off("on_time_change",e.onTimeChange),d.time.off("on_hour24_change",e.onHour24Change),this.stopCheckLed()}}})}(jQuery);