<script language="javascript">function showPPTP(){$("#pptp_elem_basic").removeClass("nd"),$("#pptp_mtu_msg").removeClass("nd")}function initEditPptp(){var p=$.wd.conn[$.wd.editIndex].obj;$("#pptp_username").val(p.username),$("#pptp_pwd").val(p.password),$("#pptp_pwd").next("input").val(p.password),$("#pptp_srvAddrName").val(p.serverIpOrName),"DHCP"==p.addressingType?($("#pptp_ipType_stc").prop("checked",!1),$("#pptp_ipType_stc").data("tpRadio").refresh(),$("#pptp_ipType_dyn").prop("checked",!0),$("#pptp_ipType_dyn").data("tpRadio").refresh(),$("#pptp_dyn_ip_elem").removeClass("nd"),$("#pptp_stc_ip_elem").addClass("nd"),$("#pptp_isp_ip_dyn").html(p.externalIPAddressIP?p.externalIPAddressIP:"0.0.0.0"),$("#pptp_isp_net_mask_dyn").html(p.subnetMaskIP?p.subnetMaskIP:"0.0.0.0"),$("#pptp_isp_gw_dyn").html(p.defaultGatewayIP?p.defaultGatewayIP:"0.0.0.0"),$("#pptp_isp_dns_1_dyn").html(p.DNSServersIP.split(",")[0]?p.DNSServersIP.split(",")[0]:"0.0.0.0"),$("#pptp_isp_dns_2_dyn").html(p.DNSServersIP.split(",")[1]?p.DNSServersIP.split(",")[1]:"0.0.0.0")):"Static"==p.addressingType&&($("#pptp_ipType_dyn").prop("checked",!1),$("#pptp_ipType_dyn").data("tpRadio").refresh(),$("#pptp_ipType_stc").prop("checked",!0),$("#pptp_ipType_stc").data("tpRadio").refresh(),$("#pptp_stc_ip_elem").removeClass("nd"),$("#pptp_dyn_ip_elem").addClass("nd"),$("#pptp_isp_ip_stc").tpAddress("val",p.externalIPAddressIP),$("#pptp_isp_net_mask_stc").tpAddress("val",p.subnetMaskIP),$("#pptp_isp_gw_stc").tpAddress("val",p.defaultGatewayIP?p.defaultGatewayIP:"0.0.0.0"),$("#pptp_isp_dns_1_stc").tpAddress("val",p.DNSServersIP.split(",")[0]?p.DNSServersIP.split(",")[0]:"0.0.0.0"),$("#pptp_isp_dns_2_stc").tpAddress("val",p.DNSServersIP.split(",")[1]?p.DNSServersIP.split(",")[1]:"0.0.0.0")),$("#pptp_internet_ip").html(p.externalIPAddress),$("#pptp_internet_dns_1").html(p.DNSServers.split(",")[0]?p.DNSServers.split(",")[0]:"0.0.0.0"),$("#pptp_internet_dns_2").html(p.DNSServers.split(",")[1]?p.DNSServers.split(",")[1]:"0.0.0.0"),$("#pptp_mtu").val(p.maxMRUSize),$("#pptp_connOnDemand").prop("checked",!1),$("#pptp_connAlwaysOn").prop("checked",!1),$("#pptp_connManual").prop("checked",!1),$("#pptp_connOnDemand").data("tpRadio").refresh(),$("#pptp_connAlwaysOn").data("tpRadio").refresh(),$("#pptp_connManual").data("tpRadio").refresh(),"OnDemand"==p.connectionTrigger?($("#pptp_connOnDemand").prop("checked",!0),$("#pptp_connOnDemand").data("tpRadio").refresh()):"AlwaysOn"==p.connectionTrigger?($("#pptp_connAlwaysOn").prop("checked",!0),$("#pptp_connAlwaysOn").data("tpRadio").refresh()):"Manual"==p.connectionTrigger&&($("#pptp_connManual").prop("checked",!0),$("#pptp_connManual").data("tpRadio").refresh()),$("#pptp_idleTime").val(p.idleDisconnectTime)}function initPPTP(){showPPTP(),dftGtw=$("#defaut_gateway_pptp"),"pptp"==$.wd.conn[$.wd.editIndex].type?initEditPptp():($("#pptp_connAlwaysOn").prop("checked",!0),$("#pptp_connAlwaysOn").data("tpRadio").refresh(),$("#pptp_maxIdle-container").addClass("nd"));var p,e=$.act(ACT_GL,L2_BRIDGING_ENTRY,null,null,["bridgeName"]);$.exe()||($.each(e,function(){"Default"==this.bridgeName&&(p=this.__stack)}),lanIPv4Cfg=$.act(ACT_GS,LAN_IP_INTF,null,this.__stack,["IPInterfaceIPAddress","IPInterfaceSubnetMask","X_TP_MACAddress"]),$.exe()),initDefaultGwDNS(),$("#divMacClone").removeClass("nd")}function addPptpAttrs(){if(wanArg.username=$("#pptp_username").val(),wanArg.password=$("#pptp_pwd").val(),""==$("#pptp_srvAddrName").val())return $.alert(ERR_WAN_DA_SERVER_NAME_EMPTY),$("#pptp_srvAddrName").focus().select(),!1;if(wanArg.serverIpOrName=$("#pptp_srvAddrName").val(),$("#pptp_ipType_stc").prop("checked")){var p=$("#pptp_isp_ip_stc").tpAddress("val"),e=$("#pptp_isp_net_mask_stc").tpAddress("val"),t=$("#pptp_isp_gw_stc").tpAddress("val");if(wanArg.addressingType="Static",$.ifip(p)||$.mask(e)||$.ipmask(p,e))return!1;if(wanArg.externalIPAddressIP=$.ip2ip(p),wanArg.subnetMaskIP=$.ip2ip(e),""==t||"0.0.0.0"!=t&&$.ifip(t,!0))return $.alert(ERR_IP_FORMAT),$("#pptp_isp_gw_stc").tpAddress("focus"),!1;if("0.0.0.0"==t||!$.isSameLan(t,e,p,e))return $.alert(ERR_GATEWAY_INVAD),$("#pptp_isp_gw_stc").tpAddress("focus"),!1;wanArg.defaultGatewayIP=$.ip2ip(t);var s=$("#pptp_isp_dns_1_stc").tpAddress("val"),n=$("#pptp_isp_dns_2_stc").tpAddress("val"),a="";if($.ifip(s,!0))return $.alert(ERR_WAN_DNSADDR_INVAD),$("#pptp_isp_dns_1_stc").tpAddress("focus"),!1;if(""!=s&&"0.0.0.0"!=s&&$.ifip(s,!0))return $.alert(ERR_WAN_DNSADDR_INVAD),$("#pptp_isp_dns_1_stc").tpAddress("focus"),!1;if(""!=s&&"0.0.0.0"!=s&&$.isSameLan(s,lanIPv4Cfg[0].IPInterfaceSubnetMask,lanIPv4Cfg[0].IPInterfaceIPAddress,lanIPv4Cfg[0].IPInterfaceSubnetMask))return $.alert(ERR_WAN_DNSADDR_LAN_CONFLICT),$("#pptp_isp_dns_1_stc").tpAddress("focus"),!1;if(""!=n&&"0.0.0.0"!=n&&$.ifip(n,!0))return $.alert(ERR_WAN_SECDNS_INVAD),$("#pptp_isp_dns_2_stc").tpAddress("focus"),!1;if(""!=n&&"0.0.0.0"!=n&&$.isSameLan(n,lanIPv4Cfg[0].IPInterfaceSubnetMask,lanIPv4Cfg[0].IPInterfaceIPAddress,lanIPv4Cfg[0].IPInterfaceSubnetMask))return $.alert(ERR_WAN_DNSADDR_LAN_CONFLICT),$("#pptp_isp_dns_2_stc").tpAddress("focus"),!1;if(2==lanIPv4Cfg.length){if(""!=s&&"0.0.0.0"!=s&&$.isSameLan(s,lanIPv4Cfg[1].IPInterfaceSubnetMask,lanIPv4Cfg[1].IPInterfaceIPAddress,lanIPv4Cfg[1].IPInterfaceSubnetMask))return $.alert(ERR_WAN_DNSADDR_LAN_CONFLICT),$("#pptp_isp_dns_1_stc").tpAddress("focus"),!1;if(""!=n&&"0.0.0.0"!=n&&$.isSameLan(n,lanIPv4Cfg[1].IPInterfaceSubnetMask,lanIPv4Cfg[1].IPInterfaceIPAddress,lanIPv4Cfg[1].IPInterfaceSubnetMask))return $.alert(ERR_WAN_DNSADDR_LAN_CONFLICT),$("#pptp_isp_dns_2_stc").tpAddress("focus"),!1}if(s=s?$.ip2ip(s):"0.0.0.0",n=n?$.ip2ip(n):"0.0.0.0",a=s+","+n,wanArg.DNSServersIP=a,$.ifip(wanArg.serverIpOrName,!0)&&"0.0.0.0"==s&&"0.0.0.0"==n)return $.alert(ERR_WAN_DA_DNS_EMPTY),$("#pptp_isp_dns_1_stc").tpAddress("focus"),!1}else wanArg.addressingType="DHCP";if(!($("#pptp_mtu").val()>=576&&$("#pptp_mtu").val()<=1500))return $.alert(ERR_WAN_MTU_INVAD),$("#pptp_mtu").focus().select(),!1;if(wanArg.maxMRUSize=parseInt($("#pptp_mtu").val(),10),1==$("#pptp_connAlwaysOn").prop("checked"))wanArg.connectionTrigger="AlwaysOn";else{if(!$("#pptp_idleTime").val()||!$.isnum($("#pptp_idleTime").val()))return $.alert(ERR_IDLETIME_INVAD),$("#pptp_idleTime").focus().select(),!1;wanArg.idleDisconnectTime=parseInt($("#pptp_idleTime").val(),10),1==$("#pptp_connOnDemand").prop("checked")?wanArg.connectionTrigger="OnDemand":1==$("#pptp_connManual").prop("checked")&&(wanArg.connectionTrigger="Manual")}return"pptp"==$.wd.conn[$.wd.editIndex].type&&($.wd.l3ForwardingObj.__ifAliasName=dftGtw.data("text")),!0}function showDyn(){$("#pptp_dyn_ip_elem").removeClass("nd"),$("#pptp_stc_ip_elem").addClass("nd")}function showStc(){$("#pptp_stc_ip_elem").removeClass("nd"),$("#pptp_dyn_ip_elem").addClass("nd")}var lanIPv4Cfg={};$("#pptp_connAlwaysOn").click(function(p){$("#pptp_maxIdle-container").addClass("nd")}),$("#pptp_connOnDemand").click(function(p){$("#pptp_maxIdle-container").removeClass("nd")}),$("#pptp_connManual").click(function(p){$("#pptp_maxIdle-container").removeClass("nd")})</script>

<div id="pptp_elem_basic" class="nd">
	<div><b class="T_username">Username:</b>
		<input type="text" size="15" id="pptp_username" maxlength="255" class="xl">
	</div>
	<div><b class="T_passwd">Password:</b>
		<input type="password" size="15" id="pptp_pwd" maxlength="255" class="xl">
	</div>

	<div><b class="T_addrType">Addressing Type:</b>
		<input type="radio" name="ipType" id="pptp_ipType_dyn" onclick="showDyn()" checked="checked">
		<label class="T_dynip">Dynamic IP</label>
		<input type="radio" name="ipType" id="pptp_ipType_stc" onclick="showStc()">
		<label class="T_staip">Static IP</label>
	</div>

	<div><b class="T_srvIpName">Server IP Address/Name:</b>
		<input type="text" size="15" id="pptp_srvAddrName" maxlength="80">
	</div>
	<div id="pptp_dyn_ip_elem">
		<div class="pure-control-group cfg-line">
			<label class="label-title T_ipaddr" id="isp_ip_addr">IP Address:</label>
			<span class="text" id="pptp_isp_ip_dyn">0.0.0.0</span>
		</div>
		<div class="pure-control-group cfg-line">
			<label class="label-title T_netmask" id="isp_subnet_mask">Subnet Mask:</label>
			<span class="text" id="pptp_isp_net_mask_dyn">0.0.0.0</span>
		</div>
		<div class="pure-control-group cfg-line">
			<label class="label-title T_gateway" id="isp_gateway">Gateway:</label>
			<span class="text" id="pptp_isp_gw_dyn">0.0.0.0</span>
		</div>
		<div class="pure-control-group cfg-line">
			<label class="label-title T_dns_srv" id="isp_dns">DNS Server:</label>
			<span class="text" id="pptp_isp_dns_1_dyn">0.0.0.0</span>
			<span class="text" id="pptp_isp_dns_2_dyn">0.0.0.0</span>
		</div>
	</div>
	<div id="pptp_stc_ip_elem" class="nd">
		<div><b class="T_ipaddr">IP Address:</b>
			<input type="text" id="pptp_isp_ip_stc" value="0.0.0.0" size="15" maxlength="15" class="ip-address">
		</div>
		<div><b class="T_netmask">Subnet Mask:</b>
			<input type="text" id="pptp_isp_net_mask_stc" value="0.0.0.0" size="15" maxlength="15" class="ip-address">
		</div>
		<div><b class="T_gateway">Gateway:</b>
			<input type="text" id="pptp_isp_gw_stc" value="0.0.0.0" size="15" maxlength="15" class="ip-address">
		</div>
		<div><b class="T_dns">Primary DNS:</b>
			<input type="text" id="pptp_isp_dns_1_stc" value="0.0.0.0" size="15" maxlength="15" class="ip-address">
		</div>
		<div><b class="T_secdns">Secondary DNS:</b>
			<input type="text" id="pptp_isp_dns_2_stc" value="0.0.0.0" size="15" maxlength="15" class="ip-address">
			<span class="T_optional">(Optional)</span>
		</div>
	</div>
	<p class="br"></p>
	<div class="pure-control-group cfg-line">
		<label class="label-title T_ipaddr" id="pptp_internet_ip_addr">Internet IP Address:</label>
		<span class="text" id="pptp_internet_ip">0.0.0.0</span>
	</div>
	<div class="pure-control-group cfg-line">
		<label class="label-title T_int_dns" id="internet_dns">Internet DNS:</label>
		<span class="text" id="pptp_internet_dns_1">0.0.0.0</span>
		<span class="text" id="pptp_internet_dns_2">0.0.0.0</span>
	</div>
	<p class="br"></p>
	<div>
        <b class="T_defgw">Default Gateway:</b>
        <select id="defaut_gateway_pptp" class="l"></select>
    </div>
	<div>
		<div id="pptp_mtu_msg">
			<b class="T_mtuSize">MTU Size:</b>
			<input type="text" id="pptp_mtu" size="5" maxlength="4" value="1420">
			<div class="textbox-tips">
				<span class="T_mtu1420">1420 as default</span>,
				<span class="T_nochg">do not change unless necessary</span>
			</div>
		</div>
	</div>

	<div><b class="T_connmode">Connection Mode:</b>
		<input type="radio" name="linkMode" id="pptp_connAlwaysOn">
		<label class="T_typeauto">Always on</label>
		<input type="radio" name="linkMode" id="pptp_connOnDemand">
		<label class="T_typedemand">Connect on demand</label>
		<input type="radio" name="linkMode" id="pptp_connManual">
		<label class="T_typemanual">Connect manually</label>
	</div>
	<div id="pptp_maxIdle-container">
		<b class="T_midle">Max Idle Time:</b>
		<input type="text" id="pptp_idleTime" size="3" maxlength="2" value="15" class="s">
		<div class="textbox-tips">
			<span class="T_minutes">minutes.</span>
			<span class="T_zmean">(0 means always active.)</span>
		</div>
	</div>
</div>

<script language="JavaScript">$.tpInit(initPPTP)</script>

