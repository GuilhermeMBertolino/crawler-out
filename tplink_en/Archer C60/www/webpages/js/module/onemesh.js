(function(){$.su.module=$.su.module||{};$.su.module.onemesh=$.su.module.onemesh||{};var onemesh={};onemesh.basicNetWork=function(){var interfaces=$.su.module.createObject();var empty=$.su.module.createObject("empty");var isAp=window.sysMode==="ap";var clearStatus=function(){$("div#map_icon_internet").removeClass("selected");$("div#map_icon_router").removeClass("map-icon-router-conn");$("div#map_icon_wireless").removeClass("map-icon-wireless-conn");$("div#map_icon_wire").removeClass("map-icon-wire-conn");$("div#map_icon_printer").removeClass("map-icon-printer-conn");$("div#map_icon_usb").removeClass("map-icon-usb-conn");$("div#internet_panel").hide();$("div#router_panel").hide();$("div#wireless_host_panel").hide();$("div#wireless_guest_panel").hide();$("div#wire_panel").hide();$("div#printer_panel").hide();$("div#usb_panel").hide()};empty.clearStatus=clearStatus;interfaces.init=function(){if(isAp){return null}$("div.map-router").css("left","317px");$("div.map-line-internet-router").css("width","75px");$("div.map-line-vertical").css("left","357px");$("div.map-line-router-mesh").show();$("#map_mesh").show();$("p#map_mesh_p").html($.su.CHAR.BASIC_NETWORK.MESH_DEVICES);$("span#map_title_mesh").html($.su.CHAR.BASIC_NETWORK.MESH_DEVICES);$("#no-mesh-device-note-1").html($.su.CHAR.ONE_MESH.NO_MESH_DEVICE_NOTE_1);$("#no-mesh-device-note-2").html($.su.CHAR.ONE_MESH.NO_MESH_DEVICE_NOTE_2);var meshListProxy=new $.su.Proxy({url:$.su.url("/admin/onemesh_network?form=mesh_sclient_list_all")});var meshDetailProxy=new $.su.Proxy({url:$.su.url("/admin/onemesh_network?form=mesh_sclient_detail")});var meshListStore=new $.su.Store({proxy:meshListProxy,fields:[{name:"name"},{name:"model"},{name:"status"},{name:"location"},{name:"mac"}],autoLoad:false});meshListStore.load({operation:"read"});$("input#mesh-device-name").textbox({fieldLabel:$.su.CHAR.ONE_MESH.NAME,labelCls:"xs",inputCls:"xl",allowBlank:false,maxLength:64});$("input#mesh-device-mac").textbox({fieldLabel:null,cls:"hidden"});$("#mesh-device-location").combobox({fieldLabel:$.su.CHAR.ONE_MESH.LOCATION,cls:"mesh-device-location",labelCls:"xs",inputCls:"xl",items:[{value:"bedroom",name:$.su.CHAR.ONE_MESH.BEDROOM},{value:"hallway",name:$.su.CHAR.ONE_MESH.HALLWAY},{value:"kitchen",name:$.su.CHAR.ONE_MESH.KITCHEN},{value:"living_room",name:$.su.CHAR.ONE_MESH.LIVING_ROOM},{value:"master_bedroom",name:$.su.CHAR.ONE_MESH.MASTER_ROOM},{value:"office",name:$.su.CHAR.ONE_MESH.OFFICE},{value:"study",name:$.su.CHAR.ONE_MESH.STUDY},{value:"other",name:$.su.CHAR.ONE_MESH.OTHER}]});var meshGrid=$("div#map_grid_mesh").grid({store:meshListStore,editor:{content:"#map_grid_mesh_editor",fields:[{name:"name"},{name:"location"},{name:"mac"}],validator:function(){var editor=$(meshGrid.grid("getEditor"));var meshEditorForm=editor.children("td.editor-container");var key=editor.prev("tr").data("key");var meshValidate=function(){if($("input#mesh-device-name").textbox("getValue").length===0){return false}return true};if(meshValidate()){var newData=meshEditorForm.form("serialize");meshDetailProxy.write(newData,function(data){meshGrid.grid("prompt",true);var data=meshGrid.grid("getStore").data;$.each(data,function(i,v){if(key===v.key){$.extend(v,newData);return}});$(meshGrid.grid("getEditor")).editor("cancelEdit");meshGrid.grid("getStore").loadData(data)},function(){meshGrid.grid("prompt",false)},function(){meshGrid.grid("prompt",false)})}return false}},columns:[{text:$.su.CHAR.GRID_ID_COLUMN,xtype:"rownumberer",width:40},{text:$.su.CHAR.BASIC_NETWORK.NAME,dataIndex:"name",width:114},{text:$.su.CHAR.BASIC_NETWORK.MODEL,width:114,dataIndex:"model"},{text:$.su.CHAR.BASIC_NETWORK.STATUS,width:136,dataIndex:"status",renderer:function(val,index,data){switch(val){case"connected":return $.su.CHAR.BASIC_NETWORK.CONNECTED;case"disconnected":return $.su.CHAR.BASIC_NETWORK.DISCONNECTED;default:return val}}},{text:$.su.CHAR.BASIC_NETWORK.LOCATION,width:136,dataIndex:"location",renderer:function(val,index,data){switch(val){case"bedroom":return $.su.CHAR.ONE_MESH.BEDROOM;case"hallway":return $.su.CHAR.ONE_MESH.HALLWAY;case"kitchen":return $.su.CHAR.ONE_MESH.KITCHEN;case"living_room":return $.su.CHAR.ONE_MESH.LIVING_ROOM;case"master_bedroom":return $.su.CHAR.ONE_MESH.MASTER_ROOM;case"office":return $.su.CHAR.ONE_MESH.OFFICE;case"study":return $.su.CHAR.ONE_MESH.STUDY;case"other":return $.su.CHAR.ONE_MESH.OTHER;default:return val}}},{text:$.su.CHAR.GRID.MODIFY,renderer:function(data,i,rawData){var inHTML="";inHTML+='<a href="javascript:void(0);" data-index="'+i+'" data-key="key-'+i+'" data-mac="'+rawData.mac+'" class="grid-content-btn grid-content-btn-edit btn-edit">';inHTML+='<span class="icon"></span>';inHTML+='<span class="text">'+$.su.CHAR.OPERATION.EDIT+"</span>";inHTML+="</a>";return inHTML}}]}).on("ev_load",function(e,data){if(data&&data.length>0){$("#map_grid_mesh").show();$("#map_mesh_no_devices").hide();$("span#map_num_mesh").html(data.length)}else{$("#map_grid_mesh").hide();$("#map_mesh_no_devices").show();$("span#map_num_mesh").html(0)}});$("div#map_mesh").click(function(){interfaces.clearStatus();$("div#map_icon_mesh").addClass("map-icon-mesh-conn");$("div.panel").hide();$("div#mesh_panel").fadeIn(150)})};interfaces.clearStatus=function(){if(!isAp){$("div#map_icon_mesh").removeClass("map-icon-mesh-conn");$("div#mesh_panel").hide()}clearStatus()};interfaces.addHelpContent=function(content){if(isAp){return content}var _content="BASIC_NETWORK_ONEMESH";content.splice(content.indexOf("BASIC_NETWORK_ROUTER")+1,0,_content);return content};return $.su.module.one_mesh_support?interfaces:empty};$.su.module.onemesh=onemesh}());