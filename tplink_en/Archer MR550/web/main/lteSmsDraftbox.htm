<script>function doEscapeChar(a){for(var t="",e=0;e<a.length;e++)18==a.charCodeAt(e)?t+="\n":17==a.charCodeAt(e)?t+="\r":t+=a[e];return t}function tablePagesLteSms(a,t,e){var s,i=$(a),l=0,r=t,n=null==arguments[3]?7:arguments[3];if(param=[],i.next(".table-bottom-pages").remove(),!i.find("tr").hasClass("space-tr")&&0!=r){i.bind("repaginate",function(){if(i.find("tbody").empty(),$("#staticAll").prop("checked",!1),$("#staticAll").data("tpCheckbox").refresh(),!((l+=1)*t>=e+t)){$.act(ACT_SET,LTE_SMS_DRAFTMSGBOX,null,null,["PageNumber="+l]);var a=new Array,r=0,o="";smsDraftboxPagelist=$.act(ACT_GL,LTE_SMS_DRAFTMSGENTRY,null,null,["index","to","content"]),$.exe()||($.each(smsDraftboxPagelist,function(){o=doEscapeChar(this.content),this.content=o,s=$.resizeStr(this.content,30),a.push([{text:'<div><input type="checkbox" id="staticCheckbox'+r+'"/><label></label></div>',width:"5%"},{text:""==this.to?" ":this.to,width:"15"},{text:$.htmlEncode(s),width:"70"},{text:"<span class='table-grid-icon edit-modify-icon' onClick='doMsgRead("+r+")'></span><span class='table-grid-icon edit-trash-icon' id='del_"+r+"' onclick='doMsgDel("+r+");'></span>",width:"10%"}]),r++}),$.initTableBody($("#tableSmsDraftbox"),a)),l-=1;var b=Math.floor((n-1)/2),f=Math.round((n-1)/2);if($("span[id$="+d+"]").show(),g.remove(),p.remove(),c>n+2){if(l>b+1){g.insertAfter($("#1-"+d));for(m=2;m<Math.min(l-b+1,c-n);m++)$("#"+m+"-"+d).hide()}if(l<c-f-2){p.insertBefore($("#"+c+"-"+d));for(var m=Math.max(l+f+2,n+2);m<c;m++)$("#"+m+"-"+d).hide()}}}});for(var o=e,c=Math.ceil(o/r),d=$.randomId("prev"),b=$.randomId("next"),g=$('<span id="left-'+d+'">...</span>'),p=$('<span id="right-'+d+'">...</span>'),f=$("<div class='table-bottom-pages'><span id='"+d+"' class='page'></span></div>"),m=1;m<=c;m++)$("<span id='"+m+"-"+d+"'>"+m+"</span>").on("click",{newPage:m-1},function(a){l=a.data.newPage,curPageNumGlobal=l+1,$(this).hasClass("click-page")||($(this).siblings("span").removeClass("click-page"),$(this).addClass("click-page"),i.trigger("repaginate"),l-1<0?$("#"+d).addClass("gray"):$("#"+d).removeClass("gray"),l+1>=c?$("#"+b).addClass("gray"):$("#"+b).removeClass("gray"))}).appendTo(f);var h=$("<span id='"+b+"' class='page right'></span>");if(f.append(h),f.insertAfter(i),0==c&&($("#"+d).addClass("gray"),$("#"+b).addClass("gray")),$("#"+d).on("click",function(){var a=$(this).siblings("span"),t=Number($(this).siblings("span.click-page").text())-1;curPageNumGlobal=(l=t-1)+1,l<0?curPageNumGlobal=1:(a.removeClass("click-page"),$("#"+t+"-"+d).addClass("click-page"),i.trigger("repaginate"),l-1<0&&$(this).addClass("gray"),$("#"+b).removeClass("gray"))}),$("#"+b).on("click",function(){var a=$(this).siblings("span"),t=Number($(this).siblings("span.click-page").text())+1;curPageNumGlobal=(l=t-1)+1,l>=c?curPageNumGlobal=c:(a.removeClass("click-page"),$("#"+t+"-"+d).addClass("click-page"),i.trigger("repaginate"),l+1>=c&&$(this).addClass("gray"),$("#"+d).removeClass("gray"))}),0==c){var u=new Array;$.initTableBody($("#tableSmsDraftbox"),u)}$("span#1-"+d).click()}}function doMsgDel(a){$.confirm(c_str.del_choosed,function(){$("#staticCheckbox"+a).parents("tr").first().remove(),$.act(ACT_DEL,LTE_SMS_DRAFTMSGENTRY,smsDraftboxPagelist[a].__stack,null),$.exe(function(a){a&&$.reload()}),$.reload()},function(){})}function doMsgRead(a){param[0]=2,param[1]=2,param[2]=curPageNumGlobal,param[3]=a,param[4]=smsDraftboxPagelist,$.loadMain("lteSmsNewMsg.htm",param)}function clickSelStaticAll(){for(var a=$("#staticAll").prop("data-checked"),t=0;t<smsDraftboxPagelist.length;t++){var e=$("#staticCheckbox"+t);e.prop("data-checked")!=a&&(e.prop("checked",a),e.data("tpCheckbox").refresh())}}function delAllMsg(){for(var a=0;a<smsDraftboxPagelist.length;a++){var t=$("#staticCheckbox"+a);t.prop("data-checked")&&(t.parents("tr").first().remove(),$.act(ACT_DEL,LTE_SMS_DRAFTMSGENTRY,smsDraftboxPagelist[a].__stack,null),$.exe()&&($.removeLoading(),$.reload()))}$.removeLoading(),$.reload()}function clickStaticDel(){for(var a=0,t=0;t<smsDraftboxPagelist.length;t++)if($("#staticCheckbox"+t).prop("data-checked")){a=1;break}a&&$.confirm(c_str.del_choosed,function(){$.addLoading($("#staticDel").next("label:first")),setTimeout(delAllMsg,200)},function(){})}function initSmsDraftboxTable(){$.act(ACT_SET,LTE_SMS_DRAFTMSGBOX,null,null,["PageNumber=0"]),$.exe(function(a){}),smsDraftBoxObj=$.act(ACT_GET,LTE_SMS_DRAFTMSGBOX,null,null,["totalNumber"]),$.exe(function(a){a||tablePagesLteSms($("#tableSmsDraftbox"),8,smsDraftBoxObj.totalNumber)})}function initTableDraftbox(){var a=[{text:'<div><input type="checkbox" id="staticAll" onClick="clickSelStaticAll();"/><label></label></div>',width:"5%"},{text:table_str.phoneNum,width:"15%"},{text:table_str.message,width:"70"},{text:table_str.modify,width:"10%"}];$.initTableHead($("#tableSmsDraftbox"),a),$("#tableSmsDraftbox").tpTable(initSmsDraftboxTable)}function init(){initTableDraftbox()}var smsDraftboxPagelist,smsDraftBoxObj,curPageNumGlobal,param</script>

<h3 id="t_et">Draft Box</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="table-op">
            <div class="table-btn">
                <span class="refresh-icon" id="staticRefresh"></span>
                <label class="T_refresh">Refresh</label>
                <span class="delete-icon" id="staticDel"></span>
                <label class="T_del">Delete</label>
            </div>
        </div>

        <table id="tableSmsDraftbox">
            <thead></thead>
            <tbody id="tableSmsDraftboxBody">
                <tr id="editSmsDraftbox" class="nd">
                    <td colspan="6">
                        <div id="draftboxStaticPage"></div>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>

<script>$("#staticDel").click(function(c){clickStaticDel()}),$("#staticRefresh").click(function(c){$.reload()}),$.tpInit(init)</script>
