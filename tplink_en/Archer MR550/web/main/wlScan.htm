<script language="javascript">function removeAll(){for(var n=$.id("apTbl");n.rows.length>0;)n.deleteRow(-1)}function connect(n){var e=new Object;e.ssid=$.mainParam.ssid,e.standard=$.mainParam.standard,e.channel=$.mainParam.channel,e.autoChannel=$.mainParam.autoChannel,e.bandWidth=$.mainParam.bandWidth,e.apEn=$.mainParam.apEn,e.SSIDAdvertisementEnabled=$.mainParam.SSIDAdvertisementEnabled,e.wdsExist=0,null!=n&&(e.wdsExist=1,e.SSID=n.SSID,e.BSSID=n.BSSID,e.channel=n.channel),$.addLoading($.id("backBtn"),500,function(){$.loadMain("wlBasic.htm",e)})}function getTbl(n,e){var l=$.id("apTbl");removeAll(),$.each(apList,function(n,e){row=l.insertRow(-1),cell=row.insertCell(-1),cell.innerHTML=e+1,cell.width="5%",cell=row.insertCell(-1),cell.innerHTML=this.BSSID,cell.width="15%",cell=row.insertCell(-1),cell.innerHTML=this.SSID.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;"),cell=row.insertCell(-1),cell.innerHTML=this.RSSI,cell.width="15%",cell=row.insertCell(-1),cell.innerHTML=this.channel,cell.width="10%",cell=row.insertCell(-1),0==this.securityEnable?cell.innerHTML="<span class='T T_none'>"+m_str.none+"</span>":cell.innerHTML="<span class='T T_encryption'>"+s_str.encryption+"</span>",cell.width="12%",cell=row.insertCell(-1),cell.innerHTML="<span class=a onclick=connect(apList["+e+"]);><span class='T T_conn'>"+m_str.conn+"</span></span>",cell.width="10%"}),$.resize(l,showNum)}function refresh(n){$.addLoading(n),$.act(ACT_OP,ACT_OP_WLAN_SCAN,wlanObj.__stack),$.exe(function(n){n||(apList=$.act(ACT_GS,LAN_WLAN_BSSDESC_ENTRY,null,wlanObj.__stack,["SSID","BSSID","SecurityEnable","Channel","RSSI"]),$.exe(function(n){n||(setTip(apList.length),getTbl(apList),$.removeLoading())}))})}function setTip(n){$.h($.id("tip"),n)}var showNum=10</script>
<p class="et T" id="et">AP List</p>
<div class="con1 L">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="line">
<span class="T" id="t_info">The scanned APs are as follows</span>
</p>
<p align="left"><span class="T" id="t_aps">AP numbers:</span> <i class="bd" id="tip"></i><input type="button" class="button L ml T T_refresh" id="refresh" value="Refresh" onclick="refresh(this)"></p>
<div class="XL thead"><table class="XL bdr tc"><tr><th width="5%">ID</th><th width="15%">BSSID</th><th>SSID</th><th width="15%" class="T" id="t_signal">Signal strength</th><th width="10%" class="T T_channel">Channel</th><th width="12%" class="T T_encryption">Encryption</th><th width="10%" class="T T_conn">Connect</th></tr></table></div>
<div class="XL tbody"><table class="XL bdr tc" id="apTbl"></table></div>
</div>
<p class="bl"></p>
<p class="tail"><input type="button" id="backBtn" class="button L T T_back" onclick="connect(null)" value="Back"></p>
</div>
<script language="javascript">var apList,wlanList,wlanObj;wlanList=$.act(ACT_GL,LAN_WLAN,null,null,["name","X_TP_Band"]),$.exe()||$.each(wlanList,function(){"2.4GHz"==this.X_TP_Band&&(wlanObj=this)}),apList=$.act(ACT_GS,LAN_WLAN_BSSDESC_ENTRY,null,wlanObj.__stack,["SSID","BSSID","SecurityEnable","Channel","RSSI"]),$.exe()||(setTip(apList.length),getTbl(apList,1))</script>