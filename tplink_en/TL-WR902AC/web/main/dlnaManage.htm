<script language="javascript" type="text/javascript">var DLNA_MAX_FOLDER_NUM=4;var DLNA_DEFAULT_NAME="MediaShare";var strScanList=new Array(["1","3600"],["2","7200"],["3","10800"],["4","14400"],["5","18000"],["6","21600"],["7","25200"],["8","28800"],["9","32400"],["10","36000"],["11","39600"],["12","43200"],["13","46800"],["14","50400"],["15","54000"],["16","57600"],["17","61200"],["18","64800"],["19","68400"],["20","72000"],["21","75600"],["22","79200"],["23","82800"],["24","86400"]);function escapeStr(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function doSave(){var newDlnaObj={};newDlnaObj.serverState=$.id("enable").checked?1:0;newDlnaObj.serverName=$.id("name").value;newDlnaObj.scanFlag=$.id("autoScanEnable").checked?1:0;newDlnaObj.scanInterval=$.id("autoScanItvl").value;if(newDlnaObj.serverName==""){$.alert(ERR_USB_DLNA_SERVER_NAME_EMPTY);return}if($.asc(newDlnaObj.serverName,true)){$.alert(ERR_USB_DLNA_SERVER_NAME_NOT_ASCII);return}if((/[\\\/\*\?"<>|\]\ ]+/).test(newDlnaObj.serverName)){$.alert(ERR_USB_DLNA_INVALID_SERVER_NAME);return}$.addLoading($.id("save"));$.act(ACT_SET,DLNA_MEDIA_SERVER,null,null,newDlnaObj);$.exe(function(ret){if(!ret){doRefresh()}})}function doAddContent(){$.loadMain("usbFolderBrowse.htm",["DLNA","ADD","/"])}function doEdit(stack){var newDlnaFolderObj=$.act(ACT_GET,DLNA_MEDIA_SERVER_FOLDER,stack,null);if($.exe()){return}$.loadMain("usbFolderBrowse.htm",["DLNA","EDIT",newDlnaFolderObj.name])}function doDel(stack){$.act(ACT_DEL,DLNA_MEDIA_SERVER_FOLDER,stack,null);if($.exe()){return}doRefresh()}function doManualScan(){$.addLoading($.id("manualScan"));$.act(ACT_OP,ACT_OP_DLNA_MANUAL_SCAN);$.exe(function(ret){$.removeLoading()})}function doChangeState(){if($.id("enable").checked){$.id("name").disabled=1;$.id("manualScan").disabled=0}else{$.id("name").disabled=0;$.id("manualScan").disabled=1}}function doAutoScanEnable(){if($.id("autoScanEnable").checked==1){$.id("autoScanItvl").disabled=0}else{if($.id("autoScanEnable").checked==0){$.id("autoScanItvl").disabled=1}}}function reDrawState(newDlnaObj){if(newDlnaObj.serverState==1){$.id("enable").checked=true}else{$.id("disable").checked=true}if($.realLen(newDlnaObj.serverName)>0){$.id("name").value=newDlnaObj.serverName}else{$.id("name").value=DLNA_DEFAULT_NAME}if(newDlnaObj.scanFlag==1){$.id("autoScanEnable").checked=true}else{$.id("autoScanEnable").checked=false}if($.id("enable").checked){$.id("name").disabled=1;$.id("manualScan").disabled=0}else{$.id("name").disabled=0;$.id("manualScan").disabled=1}if($.id("autoScanEnable").checked==1){$.id("autoScanItvl").disabled=0}else{if($.id("autoScanEnable").checked==0){$.id("autoScanItvl").disabled=1}}}function reDrawScanList(scanItvl){var i;var scanList=$.id("autoScanItvl");if(scanItvl>3600*24){scanItvl=3600*24}if(scanItvl<3600){scanItvl=3600}if(scanItvl%3600!=0){scanItvl=scanItvl/3600*3600}while((i=scanList.options.length)>0){scanList.remove(0)}$.each(strScanList,function(arg,index){opt=$.c("option");opt.value=this[1];opt.text=this[0];try{scanList.add(opt,null)}catch(e){scanList.add(opt)}if(opt.value==scanItvl){scanList.selectedIndex=index}})}function reDrawContentList(newDlnaFolderList){var row;var cell;var dlnaTable=$.id("tbl");if(newDlnaFolderList.length>0){$.removeClass($.id("tblInfo"),"nd")}else{$.addClass($.id("tblInfo"))}if(newDlnaFolderList.length>=DLNA_MAX_FOLDER_NUM){$.id("addContent").disabled=1}else{$.id("addContent").disabled=0}for(var i=0;i<newDlnaFolderList.length;i++){var thisStk="["+newDlnaFolderList[i].__stack+"]";row=dlnaTable.insertRow(-1);cell=row.insertCell(-1);cell.width="31px";cell.innerHTML=i+1;cell=row.insertCell(-1);cell.width="131px";cell.innerHTML=escapeStr(newDlnaFolderList[i].alias);cell=row.insertCell(-1);cell.width="131px";cell.innerHTML=$.resizeStr(escapeStr(newDlnaFolderList[i].name),31);cell=row.insertCell(-1);cell.width="79px";cell.innerHTML="<span class='a T T_edit' onClick='doEdit("+thisStk+")'>"+m_str.edit+"</span>&nbsp;<span class='a T T_del' onClick='doDel("+thisStk+")'>"+m_str.del+"</span>"}}function reDrawUI(){var newDlnaObj=$.act(ACT_GET,DLNA_MEDIA_SERVER,null,null);var newDlnaFolderList=$.act(ACT_GL,DLNA_MEDIA_SERVER_FOLDER,null,null,null);if($.exe()){return}reDrawState(newDlnaObj);reDrawScanList(newDlnaObj.scanInterval);reDrawContentList(newDlnaFolderList)}function initInstance(){reDrawUI()}function doRefresh(){$.reload()};</script>

<p class="et T" id="et">Media Server Settings</p>
<div class="con1 XL">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
	<p class="L1" >
		<b class="item M T" id="t_enable">Server Enable:</b>
		<input type="radio" name="dlna" id="enable" onClick="doChangeState()"/><span class="T T_en">Enable</span>
		<input type="radio" name="dlna" id="disable" onClick="doChangeState()"/><span class="T T_dis">Disable</span>
	</p>
	<p class="L1" >
		<b class="item M T" id="t_name">Server Name:</b><input type="text" class="text" size="24"  maxlength="15" id="name" />
	</p>
	<p class="L1">
		<b class="item M T" id="t_scan">Content Scan:</b>
			<span class="item M T" id="t_manual">Manual Scan:</span>
			<input type="button" id="manualScan" class="button L T" value="Scan Now" onClick="doManualScan()"/>
	</p>
	<p class="L1">
		<b class="item M">&nbsp;</b>
			<input type="checkbox" id="autoScanEnable" onClick="doAutoScanEnable()" /><span class="item M T" id="t_auto">Auto Scan:</span>
			<span class="T" id="t_every">every</span><select id="autoScanItvl"></select><span class="T" id="t_hour">hour(s)</span>
	</p>
	
<div class="nd" id="tblInfo">
<p class="bl" ></p>
<p class="L1 T" id="t_tip">You have shared the following contents:</p>
<p class="br"></p>
<div class="XL thead" >
<table class="XL bdr tc" id="tbl">
	<tr>
	<th width="31px" id="t_id">ID</th>
	<th width="131px" id="t_shname">Share Name</th>
	<th width="131px" id="t_fldname">Folder Name</th>
	<th width="79px" class="T T_edit">Edit</th>
	</tr>
</table>
</div>	

<p class="br"></p>
</div>
<p><input type="button" class="button XL T T_newfld" value="Add New Folder" id="addContent" onclick="doAddContent()"/></p>
<p class="bl"></p>
<p class="tail" id="tail">
	<input type="button" id="save" class="button L T T_save" value="Save" onclick="doSave()"/>
</p>
</div>
</div>
<script language="javascript" type="text/javascript">$.loadHelpFrame("UsbDlnaHelp.htm");initInstance();$.timeout(doRefresh,600000);</script>
