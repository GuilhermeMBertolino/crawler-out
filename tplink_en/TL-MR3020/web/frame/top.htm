<div id="top-con">
    <a id="top-product" href="http://www.tp-link.com" target="_blank">
        <span class="icon-logo"></span>
    </a>

    <div id="top-nav" class="top-nav">
        <ul id="ul-nav">
            <li id="qs">
                <span class="corner-left"></span>
                <span class="T_qs text pl">Quick Setup</span>
                <span class="corner-right"></span>
            </li>
            <li id="basic">
                <span class="corner-left"></span>
                <span class="T_basic text">Basic</span>
                <span class="corner-right"></span>
            </li>
            <li id="advanced">
                <span class="corner-left"></span>
                <span class="T_adv text" id = "top_advance_span">Advanced</span>
                <span class="corner-right"></span>
            </li>
        </ul>
    </div>
    <div class="top-country">
        <select id="top-country" class="top-country-select">
        </select>
    </div>
    <div id="top-control_div" class="top-control">
        <a id="cloudLogin" class="top-btn nd" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_account">account</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
            <div class="" id="cloudLogin-box" >
                <div class="connect-area"></div>
                <span class="icon-delta"></span>
                <div class="tips-content-container top-white">
                    <div class="shadow-top-left"></div>
                    <div class="shadow-top"></div>
                    <div class="shadow-top-right"></div>
                    <div class="shadow-left">
                        <div class="shadow-right">
                            <div class="tips-content-wrap">
                                <div class="tips-content-container-wrap">
                                    <div class="tips-content">
                                        <div id="tips-content-top">
                                            <span class="icon-account"></span>
                                            <div id="top-control-account-info">1@123.com</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tips-content-container grey bottom-grey">
                    <div class="shadow-left">
                        <div class="shadow-right">
                            <div class="tips-content-wrap">
                                <div class="tips-content-container-wrap">
                                    <div class="tips-content">
                                        <p id="top-control-account-logout" class="T_logout">Logout</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="shadow-bot-left grey"></div>
                    <div class="shadow-bot"></div>
                    <div class="shadow-bot-right grey"></div>
                </div>
            </div>
        </a>

        <a id="topMode" class="top-btn" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_topMode">Mode</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
        </a>
        <a id="topLogout" class="top-btn" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_logout">Logout</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
        </a>
        <a id="topReboot" class="top-btn" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_reboot">Reboot</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
        </a>
        <a id="topUpdate" class="top-btn nd" href="javascript:void(0);">
                <span class="icon">
                    <span class="icon" id="topUpdate-number">1</span>
                </span>
            <span class="text T_update">Update</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
        </a>
    </div>
    <div class="clr"></div>
</div>
<div id="mode-selection">
    <h4 id="mode-selection-title"></h4>
    <form class="pure-form pure-form-aligned">
        <div>
            <input type="radio" name="topMode" id="mode-access-point" value="accessPoint" />
            <label id="mode-access-point-label">Access Point</label>
        </div>
        <p id="mode-access-point-p">Transforms your existing wired network to a wireless network.</p>
        <div>
            <input type="radio" name="topMode" id="mode-repeater" value="repeater" />
            <label id="mode-repeater-label">Repeater/Bridge</label>
        </div>
        <p id="mode-repeater-p">Extends your existing wireless coverage by repeating the wireless signal.</p>
		<!--
        <div>
            <input type="radio" name="topMode" id="mode-client" value="client" />
            <label id="mode-client-label">Client</label>
        </div>
        <p id="mode-client-p">Act as Wireless Adapter to connect your wired devices to existing Wi-Fi.</p>
        <div>
            <input type="radio" name="topMode" id="mode-multi-ssid" value="multiSsid" />
            <label id="mode-multi-ssid-label">Multi-ssid</label>
        </div>
        <p id="mode-multi-ssid-p">Create multiple wireless networks to provide different security and VLAN groups.</p>
		-->
    </form>
</div>
<script type="text/javascript">
var rebooting = false;
(function () {
    $.disableNav = function(flag) {
        if (flag === true) {
            $('#top-nav').addClass('disabled');
        } else {
            $('#top-nav').removeClass('disabled');
        }
    };

    $.adjustTop = function () {
        var n = $('#top-con .top-control').find('a.top-btn:visible').length;
        $('#top-con').removeClass('crowded-4 crowded-3');
        if (n == 3) {
            $('#top-con').addClass('crowded-3');
        } else if (n >= 4) {
            $('#top-con').addClass('crowded-4');
        }
    };
	

    $.cloudLogin = function(isLogin, userName) {
        if (isLogin == true) {
            $('#cloudLogin').removeClass('nd').addClass('logined');
            $('#cloudLogin').find('.text').html(userName);
            $('#top-control-account-info').html(userName);
            $('#topLogout').addClass('nd');
            $.adjustTop();
        } else {
            $('#cloudLogin').addClass('nd').removeClass('logined');
            $('#cloudLogin').find('.text').html($.tpLang.s_str.account);
            $('#top-control-account-info').html('');
            $('#topLogout').removeClass('nd');
            $.adjustTop();
        }
    };
    $('#ul-nav li').click(function() {
        if ($('#top-nav').hasClass('disabled')) {
            //nav������
            return;
        }
        $(this).siblings().removeClass('selected');
        $(this).addClass('selected');
        $('#scroll').scrollTop(0);
        $.loadMenu('./frame/menu.htm');
    });
	

    $('#mode-selection-title').html($.tpLang.topMode.title);

    $('#mode-access-point-label').html($.tpLang.topMode.accessPointLabel);
    $('#mode-access-point-p').html($.tpLang.topMode.accessPointP);
    $('#mode-repeater-label').html($.tpLang.topMode.repeaterLabel);
    $('#mode-repeater-p').html($.tpLang.topMode.repeaterP);
    //$('#mode-client-label').html($.tpLang.topMode.clientLabel);
   // $('#mode-client-p').html($.tpLang.topMode.clientP);
    //$('#mode-multi-ssid-label').html($.tpLang.topMode.multiSsidLabel);
    //$('#mode-multi-ssid-p').html($.tpLang.topMode.multiSsidP);
	
	
       
	var sysmodeobj = $.act(ACT_GET, SYS_MODE, null, null);
	if (!$.exe()) 
	{
		if(sysmodeobj.mode != "AP")
		{
			$("#topMode").addClass('nd');
		}
		else
			{
				$('#top-control_div').addClass('top-control-left');
			}
			
		if(sysmodeobj.mode == 'AP')
		{
			$('#top_advance_span').html("Settings");
		}
	}
	

    $('#mode-selection').tpModal({
        global: true,
        confirmBtn: {
            str: $.tpLang.m_str.save,
            callback: function() {
                /*save*/
				var sysModeArg = {};
				if($("#mode-access-point").prop("checked") == true)
					sysModeArg.apModeType = '0';
				else if($("#mode-repeater").prop("checked"))
					sysModeArg.apModeType = '3';
					
				if($.apModeType != sysModeArg.apModeType)
				{
						
					$.act(ACT_SET, SYS_MODE, null, null, sysModeArg);
					
					$.exe(function(ret) {
						$.removeLoading();
						if (!ret) 
						{
							$.clearAsync();

							$.guage(["<span class='T T_rebooting'>" + s_str.rebooting + "</span>", "<span class='T T_wait_reboot'>" + s_str.wait_reboot + "</span>"], 100, $.guageInterval, function() {
								$.refresh();
							});
							$.act(ACT_OP, ACT_OP_REBOOT);
							$.exe(true);
						}
					});
				
				}
					
            },
            disabled: false
        }
    });


    $('#topMode').click(function() {
        $("#mode-selection input[type='radio']").tpRadio();
        /*load*/
		if(sysmodeobj.apModeType == '0')
		{
			$("#mode-access-point").prop("checked",true);
			$("#mode-access-point").tpRadio("refresh");
			
			$("#mode-repeater").prop("checked",false);
			$("#mode-repeater").tpRadio("refresh");
			
		}
		else if(sysmodeobj.apModeType == '3')
		{
			$("#mode-repeater").prop("checked",true);
			$("#mode-repeater").tpRadio("refresh");
			
			$("#mode-access-point").prop("checked",false);
			$("#mode-access-point").tpRadio("refresh");
		}
			
        $('#mode-selection').tpModal('show');
    });

    $('#topLogout').click(function() {
        $.confirm(c_str.logout, function() {
            $.act(ACT_CGI, '/cgi/logout');
            $.exe();
            //$.deleteCookie('Authorization');
            $.deleteCookie('UserChange');
            $.refresh();
        });
        return false;
    });
    $('#topReboot').click(function() {
        $.confirm(c_str.creboot, function() {
            $.clearAsync();
			rebooting = true;
            $.guage(["<span class='T T_rebooting'>" + s_str.rebooting + "</span>", "<span class='T T_wait_reboot'>" + s_str.wait_reboot + "</span>"], 100, $.guageInterval, function() {
                $.refresh();
            });
            $.act(ACT_OP, ACT_OP_REBOOT);
            $.exe(true);
        });
        return false;
    });

    //  add for cloud. for upgrade
    if ('INCLUDE_CLOUD' in window && INCLUDE_CLOUD == 1) {
        $('#cloudLogin').click(function () {
            $.goToOtherPage('cloudBasic.htm', 'basic');
        });

        $('#topUpdate').click(function() {
            $.goToOtherPage('softup.htm', 'advanced');
        });

        $('#cloudLogin-box').click(function() {
            //stop bubble to a
            return false;
        });

        $('#top-control-account-logout').click(function() {
            $.confirm(c_str.logout, function() {
                $.act(ACT_CGI, '/cgi/logout');
                $.exe();
                //$.deleteCookie('Authorization');
                $.deleteCookie('UserChange');
                $.refresh();
            });
            return false;
        });
        var newFwObj = $.act(ACT_GET, FW_UPGRADE_INFO, null, null, null);
        var cloudObj = $.act(ACT_GET, CLOUD_SERVICE, null, null, ['tcspStatus']);
            var userObj = $.act(ACT_GET,  CURRENT_USER);
        $.exe(function(err) {
            if (err) {
                return;
            }

            if (userObj.userSetting == 2 && userObj.logInCloud == 1) {
                //only cloud login online will show this button
                $.cloudLogin(true, userObj.userName);
            } else {
                $.cloudLogin(false, userObj.userName);
            }
            clientLocal = clientLocal == undefined ? 0:clientLocal;
            if (!!newFwObj.version && clientLocal != 0)
            {
                $("#topUpdate").removeClass('nd');
            } else {
                $("#topUpdate").addClass('nd');
            }
            $.adjustTop();
            if (cloudObj.tcspStatus == 2 || cloudObj.tcspStatus == 3) {
                var upgradeAlert1 = n_str.softup.upgradeAlert1 || "The current firmware does not support TP-Link cloud service. We strongly recommend that you download the latest firmware at www.tp-link.com and update it.",
                    upgradeAlert2 = n_str.softup.upgradeAlert2 || "The current firmware does not support TP-Link cloud service. We strongly recommend that you update the firmware by clicking the Update icon in the upper right corner.";
                $.toastGlobal({
                    text: cloudObj.tcspStatus == 2 ? upgradeAlert1 : upgradeAlert2,
                    className: "global-toast-important",
                    callback_close: function() {
                        $.act(ACT_SET, CLOUD_SERVICE, null, null, ['tcspStatus=1']);
                        $.exe();
                    }
                })
            }
        });

        if (document.cookie.search('goToUpgrade=true') >= 0) {
            $.goToOtherPage('softup.htm', 'advanced');
            $.deleteCookie('goToUpgrade');
        }
    }

    //    add for language selection by hwl

    function initLanguageSelect() {
        var select = $('#top-country');
        var items = [
            //            {"value": "bg_BG", "name": $.su.CHAR.LANGUAGE.BG_BG},
            //            {"value": "cs_CZ", "name": $.su.CHAR.LANGUAGE.CS_CZ},
            //            {"value": "da_DK", "name": $.su.CHAR.LANGUAGE.DA_DK},
            {
                "value": "de_DE",
                "name": $.su.CHAR.LANGUAGE.DE_DE,
                "include": "INCLUDE_LANGUAGE_DE_DE"
            }, {
                "value": "el_GR",
                "name": $.su.CHAR.LANGUAGE.EL_GR,
                "include": "INCLUDE_LANGUAGE_EL_GR"
            }, {
                "value": "en_US",
                "name": $.su.CHAR.LANGUAGE.EN_US,
                "include": "INCLUDE_LANGUAGE_EN_US"
            }, {
                "value": "es_ES",
                "name": $.su.CHAR.LANGUAGE.ES_ES,
                "include": "INCLUDE_LANGUAGE_ES_ES"
            }, {
                "value": "es_LA",
                "name": $.su.CHAR.LANGUAGE.ES_LA,
                "include": "INCLUDE_LANGUAGE_ES_LA"
            },
            //            {"value": "es_ES", "name": $.su.CHAR.LANGUAGE.ES_ES},
            //            {"value": "fi_FI", "name": $.su.CHAR.LANGUAGE.FI_FI},
            //            {"value": "fr_FR", "name": $.su.CHAR.LANGUAGE.FR_FR},
            {
                "value": "fr_FR",
                "name": $.su.CHAR.LANGUAGE.FR_FR,
                "include": "INCLUDE_LANGUAGE_FR_FR"
            }, {
                "value": "it_IT",
                "name": $.su.CHAR.LANGUAGE.IT_IT,
                "include": "INCLUDE_LANGUAGE_IT_IT"
            },
            //            {"value": "ko_KR", "name": $.su.CHAR.LANGUAGE.KO_KR},
            //            {"value": "nl_NL", "name": $.su.CHAR.LANGUAGE.NL_NL},
            //            {"value": "no_NO", "name": $.su.CHAR.LANGUAGE.NO_NO},
            {
                "value": "pl_PL",
                "name": $.su.CHAR.LANGUAGE.PL_PL,
                "include": "INCLUDE_LANGUAGE_PL_PL"
            },
            //            {"value": "pt_PT", "name": $.su.CHAR.LANGUAGE.PT_PT},
            {
                "value": "pt_BR",
                "name": $.su.CHAR.LANGUAGE.PT_BR,
                "include": "INCLUDE_LANGUAGE_PT_BR"
            },
            //            {"value": "ro_RO", "name": $.su.CHAR.LANGUAGE.RO_RO},
            {
                "value": "ru_RU",
                "name": $.su.CHAR.LANGUAGE.RU_RU,
                "include": "INCLUDE_LANGUAGE_RU_RU"
            },
            //            {"value": "sk_SK", "name": $.su.CHAR.LANGUAGE.SK_SK},
            //            {"value": "sv_SE", "name": $.su.CHAR.LANGUAGE.SV_SE},
            //            {"value": "th_TH", "name": $.su.CHAR.LANGUAGE.TH_TH},
            {
                "value": "th_TH",
                "name": $.su.CHAR.LANGUAGE.TR_TH,
                "include": "INCLUDE_LANGUAGE_TR_TH"
            }, {
                "value": "tr_TR",
                "name": $.su.CHAR.LANGUAGE.TR_TR,
                "include": "INCLUDE_LANGUAGE_TR_TR"
            }
            //            {"value": "uk_UA", "name": $.su.CHAR.LANGUAGE.UK_UA},
            //            {"value": "vi_VN", "name": $.su.CHAR.LANGUAGE.VI_VN},
            //            {"value": "zh_CN", "name": $.su.CHAR.LANGUAGE.ZH_CN},
            //            {"value": "zh_TW", "name": $.su.CHAR.LANGUAGE.ZH_TW}
        ];

        var languageCount = 0;
        for (var i = 0; i < items.length; i++) {
            if (window[items[i]["include"]]) {
                select.append('<option value="' + items[i]["value"] + '">' + items[i]["name"] + '</option>');
                languageCount++;
            }
        }
        if (languageCount > 1) {
            $('#top-country option[value="' + $.locale.locale + '"]').prop('selected', true);
            $('#top-country').tpSelect({
                    namespace: 'language'
                })
                .on('click', function() {
                    var val = $(this).data('value');
                    setTimeout(function() {
                        $.locale.set(val);

                    }, 500);
                });
        } else {
                $('#top-con .top-country').addClass('nv');
        }
    }

    initLanguageSelect();
    //    change the href of support
    $('#top-product').attr('href', $.su.CHAR.SUPPORT[$.locale.locale.toUpperCase()].replace(/Support\/?/, ''));
})();
</script>
