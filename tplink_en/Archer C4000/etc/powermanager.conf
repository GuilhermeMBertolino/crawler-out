config action DEFILE_THROTTLE_MASK
	option cmd 'set_throttle() { wl -i $1 pwrthrottle_mask $2 ; }'

config action DISABLE_CHAIN_THROTTLE
	option cmd 'set_throttle eth6 0x0 ; set_throttle eth7 0x0 ; set_throttle eth8 0x0'

config action SUB_DUTY_CYCLE
	option cmd 'sub_dutycycle() { local a=$(wl -i $1 dutycycle_thermal | sed "s/^\([0-9]*\).*/\1/g");local b=$(($a-17));if [ $b -le 15 ];then b=15;fi;wl -i $1 dutycycle_thermal $b; }'

config action ADD_DUTY_CYCLE
	option cmd 'add_dutycycle() { local a=$(wl -i $1 dutycycle_thermal | sed "s/^\([0-9]*\).*/\1/g");local b=$(($a+1));if [ $b -ge 100 ];then b=100;fi;wl -i $1 dutycycle_thermal $b; }'

config condition TEMP_5GU
	option cmd '$(wl -i eth6 phy_tempsense | sed "s/^\([0-9]*\).*/\1/g")'
	
config condition TEMP_2G
	option cmd '$(wl -i eth7 phy_tempsense | sed "s/^\([0-9]*\).*/\1/g")'

config condition TEMP_5GL
	option cmd '$(wl -i eth8 phy_tempsense | sed "s/^\([0-9]*\).*/\1/g")'

config condition GET_TIME
    option cmd '$(date +%s)'

config rule temp_monitor
	option freq '10000'
	option speedup_freq '10000'
	option action_0 '$SUB_DUTY_CYCLE ; $ADD_DUTY_CYCLE ; $DEFILE_THROTTLE_MASK ; $DISABLE_CHAIN_THROTTLE; Ta1=$TEMP_5GU; Tb1=$TEMP_2G; Tc1=$TEMP_5GL; Timea1=0; Timeb1=0; Timec1=0; let "tia=$GET_TIME-$Timea0   "; let "tib=$GET_TIME-$Timeb0   "; let "tic=$GET_TIME-$Timec0   "; '

    option condition_1 'test $Ta1 -z '''
	option action_1 'Ta1=0'
    option condition_2 'test $Ta1 -gt 110'
	option action_2 'sub_dutycycle eth6'
	option condition_3 'test $Ta1 -le 110 && test $Ta1 -lt 105 && test $Ta1 -le $Ta0 && test $tia -gt 19 '
	option action_3 'add_dutycycle eth6 ; Timea1=$GET_TIME'

	option condition_4 'test $Tb1 -z '''
	option action_4 'Tb1=0'
	option condition_5 'test $Tb1 -gt 115'
	option action_5 'sub_dutycycle eth7'
	option condition_6 'test $Tb1 -le 115 && test $Tb1 -lt 110 && test $Tb1 -le $Tb0 && test $tib -gt 19 '
	option action_6 'add_dutycycle eth7 ; Timeb1=$GET_TIME'

	option condition_7 'test $Tc1 -z '''
	option action_7 'Tc1=0'
	option condition_8 'test $Tc1 -gt 110'
	option action_8 'sub_dutycycle eth8'
	option condition_9 'test $Tc1 -le 110 && test $Tc1 -lt 105 && test $Tc1 -le $Tc0 && test $tic -gt 19 '
	option action_9 'add_dutycycle eth8 ; Timec1=$GET_TIME'

	option condition_10 'test 1'
	option action_10 'echo $Ta1 $Tb1 $Tc1 $Timea1 $Timeb1 $Timec1'
