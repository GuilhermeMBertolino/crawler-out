<div id="top-con">
    <a id="top-product" href="http://www.tp-link.com" target="_blank">
        <span class="icon-logo"></span>
    </a>

    <div id="top-nav" class="top-nav">
        <ul id="ul-nav">
            <li id="qs">
                <span class="corner-left"></span>
                <span class="T_qs text pl">Quick Setup</span>
                <span class="corner-right"></span>
            </li>
            <li id="basic">
                <span class="corner-left"></span>
                <span class="T_basic text">Basic</span>
                <span class="corner-right"></span>
            </li>
            <li id="advanced">
                <span class="corner-left"></span>
                <span class="T_adv text">Advanced</span>
                <span class="corner-right"></span>
            </li>
            <li id="APSetting" class="nd">
                <span class="corner-left"></span>
                <span class="text">setting</span>
                <span class="corner-right"></span>
            </li>
        </ul>
    </div>
        <div class="top-country">
            <select id="top-country" class="top-country-select">
            </select>
        </div>
    <div class="top-control">
        <a id="cloudLogin" class="top-btn nd" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_account">account</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
            <div class="" id="cloudLogin-box" >
                <div class="connect-area"></div>
                <span class="icon-delta"></span>
                <div class="tips-content-container top-white">
                    <div class="shadow-top-left"></div>
                    <div class="shadow-top"></div>
                    <div class="shadow-top-right"></div>
                    <div class="shadow-left">
                        <div class="shadow-right">
                            <div class="tips-content-wrap">
                                <div class="tips-content-container-wrap">
                                    <div class="tips-content">
                                        <div id="tips-content-top">
                                            <span class="icon-account"></span>
                                            <div id="top-control-account-info">1@123.com</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tips-content-container grey bottom-grey">
                    <div class="shadow-left">
                        <div class="shadow-right">
                            <div class="tips-content-wrap">
                                <div class="tips-content-container-wrap">
                                    <div class="tips-content">
                                        <p id="top-control-account-logout" class="T_logout">Logout</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="shadow-bot-left grey"></div>
                    <div class="shadow-bot"></div>
                    <div class="shadow-bot-right grey"></div>
                </div>
            </div>
        </a>

        <a id="topLogout" class="top-btn" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_logout">Logout</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
        </a>
        <a id="topReboot" class="top-btn" href="javascript:void(0);">
            <span class="icon"></span>
            <span class="text T_reboot">Reboot</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
            <span class="corner-bot-left"></span>
            <span class="corner-bot-right"></span>
        </a>
            <a id="topUpdate" class="top-btn nd" href="javascript:void(0);">
                <span class="icon">
                    <span class="icon" id="topUpdate-number">1</span>
                </span>
                <span class="text T_update">Update</span>
            <span class="corner-top-left"></span>
            <span class="corner-top-right"></span>
				<span class="corner-bot-left"></span>
            	<span class="corner-bot-right"></span>
            </a>
    </div>
    <div class="clr"></div>
</div>
<script type="text/javascript">
(function() {
    if (INCLUDE_ROUTER_MODE && $.routerMode == 'AP') {
        $('#APSetting span.text').html($.tpLang.menu_str.settings);
        $('#basic, #advanced').addClass('nd');
        $('#APSetting').removeClass('nd').addClass('selected');
    }

    $.disableNav = function(flag) {
        if (flag === true) {
            $('#top-nav').addClass('disabled');
        } else {
            $('#top-nav').removeClass('disabled');
        }
    };

        $.adjustTop = function() {
            var n = $('#top-con .top-control').find('a.top-btn:visible').length;
            $('#top-con').removeClass('crowded-4 crowded-3');
            if (n == 3) {
                $('#top-con').addClass('crowded-3');
            } else if (n >= 4) {
                $('#top-con').addClass('crowded-4');
            }
    };

    $.cloudLogin = function(isLogin, userName) {
        if (isLogin == true) {
            $('#cloudLogin').removeClass('nd').addClass('logined');
            $('#cloudLogin').find('.text').html(userName);
            $('#top-control-account-info').html(userName);
            $('#topLogout').addClass('nd');
            $.adjustTop();
        } else {
            $('#cloudLogin').addClass('nd').removeClass('logined');
            $('#cloudLogin').find('.text').html($.tpLang.s_str.account);
            $('#top-control-account-info').html('');
            $('#topLogout').removeClass('nd');
            $.adjustTop();
        }
    };
    $('#ul-nav li').click(function() {
        if ($('#top-nav').hasClass('disabled')) {
            //nav被禁用
            return;
        }
        $(this).siblings().removeClass('selected');
        $(this).addClass('selected');
        $('#scroll').scrollTop(0);
        $.loadMenu('./frame/menu.htm');
    });

    $('#topLogout').click(function() {
        $.confirm(c_str.logout, function() {
                $.act(ACT_CGI, '/cgi/logout');
                $.exe();
                //$.deleteCookie('Authorization');
            $.deleteCookie('UserChange');
            $.refresh();
        });
        return false;
    });
    $('#topReboot').click(function() {
        $.confirm(c_str.creboot, function() {
            $.clearAsync();

            $.guage(["<span class='T T_rebooting'>" + s_str.rebooting + "</span>", "<span class='T T_wait_reboot'>" + s_str.wait_reboot + "</span>"], 100, $.guageInterval, function() {
                $.refresh();
            });
            $.act(ACT_OP, ACT_OP_REBOOT2);
            $.exe(true);
        });
        return false;
    });

    //  add for cloud. for upgrade
    if ('INCLUDE_CLOUD' in window && INCLUDE_CLOUD == 1) {
            $('#cloudLogin').click(function () {
                $.goToOtherPage('cloudBasic.htm', 'basic');
            });

        $('#topUpdate').click(function() {
            $.goToOtherPage('softup.htm', 'advanced');
        });

        $('#cloudLogin-box').click(function() {
            //stop bubble to a
            return false;
        });

        $('#top-control-account-logout').click(function() {
            $.confirm(c_str.logout, function() {
                $.act(ACT_CGI, '/cgi/logout');
                $.exe();
                //$.deleteCookie('Authorization');
                $.deleteCookie('UserChange');
                $.refresh();
            });
            return false;
        });
        var newFwObj = $.act(ACT_GET, FW_UPGRADE_INFO, null, null, null);
        var cloudObj = $.act(ACT_GET, CLOUD_SERVICE, null, null, ['tcspStatus']);
            var userObj = $.act(ACT_GET,  CURRENT_USER);
        $.exe(function(err) {
            if (err) {
                return;
            }

                if (userObj.userSetting == 2 && userObj.logInCloud == 1 && $.routerMode != 'AP') {
                    //only cloud login online will show this button
                $.cloudLogin(true, userObj.userName);
                } else {
                $.cloudLogin(false, userObj.userName);
                }
            if ( !! newFwObj.version) {
                $("#topUpdate").removeClass('nd');
            } else {
                $("#topUpdate").addClass('nd');
            }
            $.adjustTop();
            if (cloudObj.tcspStatus == 2 || cloudObj.tcspStatus == 3) {
                var upgradeAlert1 = n_str.softup.upgradeAlert1 || "The current firmware does not support TP-Link cloud service. We strongly recommend that you download the latest firmware at www.tp-link.com and update it.",
                    upgradeAlert2 = n_str.softup.upgradeAlert2 || "The current firmware does not support TP-Link cloud service. We strongly recommend that you update the firmware by clicking the Update icon in the upper right corner.";
                $.toastGlobal({
                    text: cloudObj.tcspStatus == 2 ? upgradeAlert1 : upgradeAlert2,
                    className: "global-toast-important",
                    callback_close: function() {
                        $.act(ACT_SET, CLOUD_SERVICE, null, null, ['tcspStatus=1']);
                        $.exe();
                    }
                })
            }
        });

        if (document.cookie.search('goToUpgrade=true') >= 0) {
            $.goToOtherPage('softup.htm', 'advanced');
            $.deleteCookie('goToUpgrade');
        }
    }

    //    add for language selection by hwl

    function initLanguageSelect() {
        var select = $('#top-country');
        var items = [
            //            {"value": "bg_BG", "name": $.su.CHAR.LANGUAGE.BG_BG},
            //            {"value": "cs_CZ", "name": $.su.CHAR.LANGUAGE.CS_CZ},
            {"value": "da_DK", "name": $.su.CHAR.LANGUAGE.DA_DK, "include": "INCLUDE_LANGUAGE_DA_DK"},
            {
                "value": "de_DE",
                "name": $.su.CHAR.LANGUAGE.DE_DE,
                "include": "INCLUDE_LANGUAGE_DE_DE"
            }, {
                "value": "el_GR",
                "name": $.su.CHAR.LANGUAGE.EL_GR,
                "include": "INCLUDE_LANGUAGE_EL_GR"
            }, {
                "value": "en_US",
                "name": $.su.CHAR.LANGUAGE.EN_US,
                "include": "INCLUDE_LANGUAGE_EN_US"
            }, {
                "value": "es_ES",
                "name": $.su.CHAR.LANGUAGE.ES_ES,
                "include": "INCLUDE_LANGUAGE_ES_ES"
            }, {
                "value": "es_LA",
                "name": $.su.CHAR.LANGUAGE.ES_LA,
                "include": "INCLUDE_LANGUAGE_ES_LA"
            },
            {"value": "fi_FI", "name": $.su.CHAR.LANGUAGE.FI_FI, "include": "INCLUDE_LANGUAGE_FI_FI"},
            {
                "value": "fr_FR",
                "name": $.su.CHAR.LANGUAGE.FR_FR,
                "include": "INCLUDE_LANGUAGE_FR_FR"
            }, {
                "value": "it_IT",
                "name": $.su.CHAR.LANGUAGE.IT_IT,
                "include": "INCLUDE_LANGUAGE_IT_IT"
            },
            {"value": "ko_KR", "name": $.su.CHAR.LANGUAGE.KO_KR, "include": "INCLUDE_LANGUAGE_KO_KR"},
			{"value": "jp_JP", "name": $.su.CHAR.LANGUAGE.JP_JP, "include": "INCLUDE_LANGUAGE_JP_JP"},
            {"value": "nl_NL", "name": $.su.CHAR.LANGUAGE.NL_NL, "include": "INCLUDE_LANGUAGE_NL_NL"},
            {"value": "no_NO", "name": $.su.CHAR.LANGUAGE.NO_NO, "include": "INCLUDE_LANGUAGE_NO_NO"},
            {
                "value": "pl_PL",
                "name": $.su.CHAR.LANGUAGE.PL_PL,
                "include": "INCLUDE_LANGUAGE_PL_PL"
            },
            {"value": "pt_PT", "name": $.su.CHAR.LANGUAGE.PT_PT, "include": "INCLUDE_LANGUAGE_PT_PT"},
            {
                "value": "pt_BR",
                "name": $.su.CHAR.LANGUAGE.PT_BR,
                "include": "INCLUDE_LANGUAGE_PT_BR"
            },
            //            {"value": "ro_RO", "name": $.su.CHAR.LANGUAGE.RO_RO},
            {
                "value": "ru_RU",
                "name": $.su.CHAR.LANGUAGE.RU_RU,
                "include": "INCLUDE_LANGUAGE_RU_RU"
            },
            //            {"value": "sk_SK", "name": $.su.CHAR.LANGUAGE.SK_SK},
            {"value": "sv_SE", "name": $.su.CHAR.LANGUAGE.SV_SE, "include": "INCLUDE_LANGUAGE_SV_SE"},
            {
                "value": "th_TH",
                "name": $.su.CHAR.LANGUAGE.th_TH,
                "include": "INCLUDE_LANGUAGE_th_TH"
            }, {
                "value": "tr_TR",
                "name": $.su.CHAR.LANGUAGE.TR_TR,
                "include": "INCLUDE_LANGUAGE_TR_TR"
            }, {
                "value": "zh_TW",
                "name": $.su.CHAR.LANGUAGE.ZH_TW,
                "include": "INCLUDE_LANGUAGE_ZH_TW"
            },
            //            {"value": "uk_UA", "name": $.su.CHAR.LANGUAGE.UK_UA},
            {"value": "vi_VN", "name": $.su.CHAR.LANGUAGE.VI_VN, "include": "INCLUDE_LANGUAGE_VI_VN"}
            //            {"value": "zh_CN", "name": $.su.CHAR.LANGUAGE.ZH_CN},
            //            {"value": "zh_TW", "name": $.su.CHAR.LANGUAGE.ZH_TW}
        ];

        var languageCount = 0;
        for (var i = 0; i < items.length; i++) {
            if (window[items[i]["include"]]) {
                select.append('<option value="' + items[i]["value"] + '">' + items[i]["name"] + '</option>');
                languageCount++;
            }
        }
        if (languageCount > 1) {
            $('#top-country option[value="' + $.locale.locale + '"]').prop('selected', true);
            $('#top-country').tpSelect({
                    namespace: 'language'
                })
                .on('click', function() {
                    var val = $(this).data('value');
                    setTimeout(function() {
                        $.locale.set(val);

                    }, 500);
                });
        } else {
                $('#top-con .top-country').addClass('nv');
        }
    }

    initLanguageSelect();
    //    change the href of support
    $('#top-product').attr('href', $.su.CHAR.SUPPORT[$.locale.locale.toUpperCase()].replace(/Support\/?/, ''));
})();
</script>
