<div>
    <div class="titleBar">
        <a url="usbSettings.mobile.htm"><span class="icon-back sprite c-arrow-blue-left" ></span></a>
        <h1>Print Server</h1>
    </div>

    <div class="item-list mt15">
        <div class="section-container">
        <div class="section-box">
            <div>
                <span>Print Server</span>
            </div>
            <input type="checkbox" id="enable_server" />
        </div>
    </div>
    <div class="section-container mtNo">
        <div class="section-box">
            <span>
	            <script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_pn%>
	            </script>            	
            </span>
            <span class="text-readonly" id="printerName"></span>
        </div>
    </div>
    </div>
    <div class="section-note mt15">
        <span class="title">
            <script type="text/html" class="title-string">
                <%=$.tpLang.m_str.note%>:
            </script>
    	</span>
        <div class="mt10">
            <span class="num">
	    		<script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_step1%>
	            </script>
    		</span>
            <span class="item">
	    		<script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_note1%>
	            </script>
    		</span>
        </div>
        <div class="mt10">
            <span class="num">
	    		<script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_step2%>
	            </script>
    		</span>
            <span class="item">
	    		<script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_note2%>
	            </script>
    		</span>
        </div>
        <div class="mt10">
            <span class="num">
	    		<script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_step3%>
	            </script>
    		</span>
            <span class="item">
	    		<script type="text/html" class="title-string">
	                <%=$.tpLang.printSrv_nstr.t_note3%>
	            </script>
    		</span>
        </div>
    </div>

</div>

<script type='text/javascript'>
(function() {
    $.tpLocal('title-string', $.tpLang);
    $('.titleBar').titleBar();
    $('.titleBar').titleBar('title', $.tpLang.menu_str.printer);

    $('#enable_server').flipSwitch({
        'hasTitle': true,
        'title': $.tpLang.menu_str.printer
    })
    .bind('on.flipSwitch', function() {
    	$.startWaitingMobile($.tpLang.m_str.waiting);
	    $.act(ACT_SET, XTP_PRINT_SERVICE, null, null, ["enable=1"]);

	    if (!$.exe()) {
	        $.stopWaitingMobile();
	        $.reload();
	    }
    })
    .bind('off.flipSwitch', function() {
    	$.startWaitingMobile($.tpLang.m_str.waiting);
	    $.act(ACT_SET, XTP_PRINT_SERVICE, null, null, ["enable=0"]);

	    if (!$.exe()) {
	        $.stopWaitingMobile();
	        $.reload();
	    }
    });

    function refresh() {
        var curStatus = $.act(ACT_GET, XTP_PRINT_SERVICE, null, null, null);

        if ($.exe()) {
            return;
        }

        if (curStatus.serverName == 'No Printer') {
            $("#printerName").text($.tpLang.printSrv_nstr.t_noprint);
        } else {
            $("#printerName").text(curStatus.serverName);
        }

        if (curStatus.enable == 1) {
            $("#enable_server").flipSwitch({
                'on': true
            });
        } else {
            $("#enable_server").flipSwitch({
                'on': false
            });
        }
    }

    (function init() {
        refresh();
		$.auto(function() {
		    refresh();
		}, 5000);
    }) ();

})();
</script>
