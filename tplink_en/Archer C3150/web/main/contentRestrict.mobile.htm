<div class="titleBar">
    <a id="back" url="parentCtrl.mobile.htm"><span class="icon-back sprite c-arrow-blue-left"></span></a>
    <h1>
        <script type="text/html" class="title-string">
            <%=$.tpLang.parentCtrl_nstr.t_title3%>
        </script>
    </h1>
    <a id="save" data-status="save">
        <script type="text/html" class="title-string">
            <%=$.tpLang.m_str.save%>
        </script>
    </a>
</div>
<div class="item-list mt15">
    <div class="section-container">
    <div class="section-box">
        <label class="section-labelTitle" for="restrict-type">
            <script type="text/html" class="title-string">
                <%=$.tpLang.parentCtrl_nstr.m_cmode%>
            </script>
        </label>
        <select id="restrict-type" class="section-inputText s">
            <option value="1">
                <script type="text/html" class="title-string">
                    <%=$.tpLang.parentCtrl_nstr.t_blm%>
                </script>
            </option>
            <option value="0">
                <script type="text/html" class="title-string">
                    <%=$.tpLang.parentCtrl_nstr.t_wlm%>
                </script>
            </option>
        </select>
    </div>
</div>
</div>
<div class="item-list mt15">
    <div class="section-container" id="pBlack">
    <div class="section-box">
        <a class="turn-page" url="blackList.mobile.htm">
            <span>
                <script type="text/html" class="title-string">
                    <%=$.tpLang.parentCtrl_nstr.t_blm%>
                </script>
            </span>
        </a>
    </div>
</div>
    <div class="section-container nd" id="pWhite">
    <div class="section-box">
        <a class="turn-page" url="whiteList.mobile.htm">
            <span>
                <script type="text/html" class="title-string">
                    <%=$.tpLang.parentCtrl_nstr.t_wlm%>
                </script>
            </span>
        </a>
    </div>
</div>
</div>
<script type="text/javascript">
    (function() {
        var fwInfo;

        $.tpLocal('title-string', $.tpLang);
        $('.titleBar').titleBar();
        $('#restrict-type').selectMobile();

        $.each($('.turn-page'), function() {
            $.initTurnPage(this);
        });

        init();

        function init() {
            fwInfo = $.act(ACT_GET, FIREWALL, null, null, ["enalbeParentCtrl", "parentCtrlMode"]);

            if (!$.exe()) {
                $('#restrict-type').selectMobile('value', fwInfo.parentCtrlMode);
                $('#restrict-type').on('change', function() {
                    checkList();
                });
                checkList();
            }

            $('#save').on('click', function() {
                saveListType();
            });
        }
        function checkList() {
            var type = $('#restrict-type').val();
            if (type === '1') {
                $('#pBlack').show();
                $('#pWhite').hide();
            } else if (type === '0') {
                $('#pWhite').show();
                $('#pBlack').hide();
            } else {
                $('#pWhite').hide();
                $('#pBlack').hide();
            }
        }
        function saveListType() {
            $.startWaitingMobile($.tpLang.m_str.waiting);
            if ($('#restrict-type').val() === '1') {
                $.act(ACT_SET, FIREWALL, null, null, ["parentCtrlMode=1"]);
                $.exe(function(err) {
                    $.stopWaitingMobile('');
                    if (!err) {
                        $.reload();
                    }
                });
            } else if ($('#restrict-type').val() === '0') {

                $.act(ACT_SET, FIREWALL, null, null, ["parentCtrlMode=0"]);
                $.exe(function(err) {
                    $.stopWaitingMobile('');
                    if (!err) {
                        $.reload();
                    }
                });
            }
        }
    })();
</script>