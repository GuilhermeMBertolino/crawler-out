<script>var smsDraftboxPagelist,smsDraftBoxObj,curPageNumGlobal,param;function doEscapeChar(a){for(var t="",e=0;e<a.length;e++)18==a.charCodeAt(e)?t+="\n":17==a.charCodeAt(e)?t+="\r":t+=a[e];return t}function tablePagesLteSms(a,r,n){var o,c=$(a),d=0,t=r,b=null==arguments[3]?7:arguments[3];if(param=[],c.next(".table-bottom-pages").remove(),!c.find("tr").hasClass("space-tr")&&0!=t){c.bind("repaginate",function(){if(c.find("tbody").empty(),$("#staticAll").prop("checked",!1),$("#staticAll").data("tpCheckbox").refresh(),!(n+r<=(d+=1)*r)){$.act(ACT_SET,LTE_SMS_DRAFTMSGBOX,null,null,["PageNumber="+d]);var a=new Array,t=0,e="";smsDraftboxPagelist=$.act(ACT_GL,LTE_SMS_DRAFTMSGENTRY,null,null,["index","to","content"]),$.exe()||($.each(smsDraftboxPagelist,function(){e=doEscapeChar(this.content),this.content=e,o=$.resizeStr(this.content,30),a.push([{text:'<div><input type="checkbox" id="staticCheckbox'+t+'"/><label></label></div>',width:"5%"},{text:""==this.to?" ":this.to,width:"15"},{text:$.htmlEncode(o),width:"70"},{text:"<span class='table-grid-icon edit-modify-icon' onClick='doMsgRead("+t+")'></span><span class='table-grid-icon edit-trash-icon' id='del_"+t+"' onclick='doMsgDel("+t+");'></span>",width:"10%"}]),t++}),$.initTableBody($("#tableSmsDraftbox"),a)),d-=1;var s=Math.floor((b-1)/2),i=Math.round((b-1)/2);if($("span[id$="+p+"]").show(),f.remove(),m.remove(),b+2<g){if(s+1<d){f.insertAfter($("#1-"+p));for(var l=2;l<Math.min(d-s+1,g-b);l++)$("#"+l+"-"+p).hide()}if(d<g-i-2){m.insertBefore($("#"+g+"-"+p));for(l=Math.max(d+i+2,b+2);l<g;l++)$("#"+l+"-"+p).hide()}}}});for(var e=n,g=Math.ceil(e/t),p=$.randomId("prev"),s=$.randomId("next"),f=$('<span id="left-'+p+'">...</span>'),m=$('<span id="right-'+p+'">...</span>'),i=$("<div class='table-bottom-pages'><span id='"+p+"' class='page'></span></div>"),l=1;l<=g;l++)$("<span id='"+l+"-"+p+"'>"+l+"</span>").on("click",{newPage:l-1},function(a){d=a.data.newPage,curPageNumGlobal=d+1,$(this).hasClass("click-page")||($(this).siblings("span").removeClass("click-page"),$(this).addClass("click-page"),c.trigger("repaginate"),d-1<0?$("#"+p).addClass("gray"):$("#"+p).removeClass("gray"),g<=d+1?$("#"+s).addClass("gray"):$("#"+s).removeClass("gray"))}).appendTo(i);var h=$("<span id='"+s+"' class='page right'></span>");if(i.append(h),i.insertAfter(c),0==g&&($("#"+p).addClass("gray"),$("#"+s).addClass("gray")),$("#"+p).on("click",function(){var a=$(this).siblings("span"),t=Number($(this).siblings("span.click-page").text())-1;curPageNumGlobal=(d=t-1)+1,d<0?curPageNumGlobal=1:(a.removeClass("click-page"),$("#"+t+"-"+p).addClass("click-page"),c.trigger("repaginate"),d-1<0&&$(this).addClass("gray"),$("#"+s).removeClass("gray"))}),$("#"+s).on("click",function(){var a=$(this).siblings("span"),t=Number($(this).siblings("span.click-page").text())+1;curPageNumGlobal=(d=t-1)+1,g<=d?curPageNumGlobal=g:(a.removeClass("click-page"),$("#"+t+"-"+p).addClass("click-page"),c.trigger("repaginate"),g<=d+1&&$(this).addClass("gray"),$("#"+p).removeClass("gray"))}),0==g){var u=new Array;$.initTableBody($("#tableSmsDraftbox"),u)}$("span#1-"+p).click()}}function doMsgDel(a){$.confirm(c_str.del_choosed,function(){$("#staticCheckbox"+a).parents("tr").first().remove(),$.act(ACT_DEL,LTE_SMS_DRAFTMSGENTRY,smsDraftboxPagelist[a].__stack,null),$.exe(function(a){a&&$.reload()}),$.reload()},function(){return})}function doMsgRead(a){param[0]=2,param[1]=2,param[2]=curPageNumGlobal,param[3]=a,param[4]=smsDraftboxPagelist,$.loadMain("lteSmsNewMsg.htm",param)}function clickSelStaticAll(){for(var a=$("#staticAll").prop("data-checked"),t=0;t<smsDraftboxPagelist.length;t++){var e=$("#staticCheckbox"+t);e.prop("data-checked")!=a&&(e.prop("checked",a),e.data("tpCheckbox").refresh())}}function delAllMsg(){for(var a=0;a<smsDraftboxPagelist.length;a++){var t=$("#staticCheckbox"+a);t.prop("data-checked")&&(t.parents("tr").first().remove(),$.act(ACT_DEL,LTE_SMS_DRAFTMSGENTRY,smsDraftboxPagelist[a].__stack,null),$.exe()&&($.removeLoading(),$.reload()))}$.removeLoading(),$.reload()}function clickStaticDel(){for(var a=0,t=0;t<smsDraftboxPagelist.length;t++){if($("#staticCheckbox"+t).prop("data-checked")){a=1;break}}a&&$.confirm(c_str.del_choosed,function(){return $.addLoading($("#staticDel").next("label:first")),void setTimeout(delAllMsg,200)},function(){return})}function initSmsDraftboxTable(){$.act(ACT_SET,LTE_SMS_DRAFTMSGBOX,null,null,["PageNumber=0"]),$.exe(function(a){}),smsDraftBoxObj=$.act(ACT_GET,LTE_SMS_DRAFTMSGBOX,null,null,["totalNumber"]),$.exe(function(a){a||tablePagesLteSms($("#tableSmsDraftbox"),8,smsDraftBoxObj.totalNumber)})}function initTableDraftbox(){var a=[{text:'<div><input type="checkbox" id="staticAll" onClick="clickSelStaticAll();"/><label></label></div>',width:"5%"},{text:table_str.phoneNum,width:"15%"},{text:table_str.message,width:"70"},{text:table_str.modify,width:"10%"}];$.initTableHead($("#tableSmsDraftbox"),a),$("#tableSmsDraftbox").tpTable(initSmsDraftboxTable)}function init(){initTableDraftbox()}</script>
<h3 id="t_et">Draft Box</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="table-op">
            <div class="table-btn">
                <span class="refresh-icon" id="staticRefresh"></span>
                <label class="T_refresh">Refresh</label>
                <span class="delete-icon" id="staticDel"></span>
                <label class="T_del">Delete</label>
            </div>
        </div>
        <table id="tableSmsDraftbox">
            <thead></thead>
            <tbody id="tableSmsDraftboxBody">
                <tr id="editSmsDraftbox" class="nd">
                    <td colspan="6">
                        <div id="draftboxStaticPage"></div>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>
<script>$("#staticDel").click(function(c){clickStaticDel()}),$("#staticRefresh").click(function(c){$.reload()}),$.tpInit(init)</script>
