<script language="javascript">var sysModeObj,specialConnectionList=[];function doEdit(n,s){for(var t=0;t<$.wd.conn.length;t++)if($.wd.conn[t].obj.__stack==s&&(1==n&&$.wd.conn[t].type.indexOf("ppp")<0||2==n&&0<=$.wd.conn[t].type.indexOf("ppp")||3==n&&"l2tp"==$.wd.conn[t].type||4==n&&"pptp"==$.wd.conn[t].type)){$.wd.editIndex=t;break}$.loadPage("divPage","div.htm")}function doDel(a,n){var e=n;$.confirm(c_str.del_con,function(){$.showCover(),$.lock();var s=!1,t=e.slice();t[2]=0;var i=$.act(ACT_GET,WAN_CONN_DEVICE,t,null,["WANIPConnectionNumberOfEntries","WANPPPConnectionNumberOfEntries"]);$.exe(function(n){n?$.hideCover():+i.WANIPConnectionNumberOfEntries+ +i.WANPPPConnectionNumberOfEntries==1&&(s=!0),1==a?($.act(ACT_OP,ACT_OP_DHCP_RELEASE,e),$.exe(),$.act(ACT_DEL,WAN_IP_CONN,e,null)):2==a?$.act(ACT_DEL,WAN_PPP_CONN,e,null):3==a?$.act(ACT_DEL,WAN_L2TP_CONN,e,null):4==a&&$.act(ACT_DEL,WAN_PPTP_CONN,e,null),(s||3==a||4==a)&&$.act(ACT_DEL,WAN_CONN_DEVICE,t,null),$.exe(function(n){n||($.hideCover(),$.reload())})})})}function doDisConn(n,s){var t=s;1==n?($.act(ACT_OP,ACT_OP_DHCP_RELEASE_BY_USER,t),$.act(ACT_OP,ACT_OP_WAN6_IP_DISCONN_BY_USER,t)):2==n?($.act(ACT_OP,ACT_OP_PPP_DISCONN,t),$.act(ACT_OP,ACT_OP_WAN6_PPP_DISCONN,t)):3==n?$.act(ACT_OP,ACT_OP_L2TP_DISCONN,t):4==n&&$.act(ACT_OP,ACT_OP_PPTP_DISCONN,t),$.exe()||$.timeout(function(){$.reload()},1500)}function doConn(n,s){var t=s;1==n?($.act(ACT_OP,ACT_OP_DHCP_RENEW_BY_USER,t),$.act(ACT_OP,ACT_OP_WAN6_IP_CONN_BY_USER,t)):2==n?($.act(ACT_OP,ACT_OP_PPP_CONN,t),$.act(ACT_OP,ACT_OP_WAN6_PPP_CONN,t)):3==n?$.act(ACT_OP,ACT_OP_L2TP_CONN,t):4==n&&$.act(ACT_OP,ACT_OP_PPTP_CONN,t),$.exe()||$.timeout(function(){$.reload()},1500)}function isSpecialConnection(n){return!(!INCLUDE_IPTV||"iptv"!=n.name&&"ewan_iptv"!=n.name)}function initSpecialConnection(){var n=$.act(ACT_GL,WAN_IP_CONN,null,null,["name"]),s=$.act(ACT_GL,WAN_PPP_CONN,null,null,["name"]);$.exe()||($.merge(n,s),$.each(n,function(){1==isSpecialConnection(this)&&specialConnectionList.push(this)}))}function init(){INCLUDE_3G4G_BACKUP||($("#check_ping").addClass("nd"),$("#lteBackup").addClass("nd"),$("#lteBackup_space").addClass("nd"),$("#lteBackup_ping").addClass("nd"),$("#detection").addClass("nd"),$("#DNS").addClass("nd"),$("#ipv4_ping").addClass("nd"),$("#ipv6_ping").addClass("nd"),$("#bSave").addClass("nd")),$("#scroll").scrollTop(0),initSpecialConnection(),INCLUDE_CHECK_WANALIVE_WITH_PING&&initLteBackup()}function initLteBackup(){sysModeObj=$.act(ACT_GET,SYS_MODE,null,null,null),$.exe(),$("#check_ping").removeClass("nd"),$("#lteBackup_ping").removeClass("nd"),$("#lteBackup_ping").removeClass("off"),$("#lteBackup_ping").removeClass("on"),1==sysModeObj.lteBackupEnable?($("#lteBackup_ping").addClass("on"),$("#lteBackup_en_ping").addClass("selected"),$("#detection").removeClass("nd"),$("#DNS").removeClass("nd"),$("#dns").val(sysModeObj.DNS),$("#bSave").removeClass("nd"),0==sysModeObj.detectionMode?$("#single_dect").prop("checked","checked"):$("#dual_dect").prop("checked","checked")):($("#lteBackup_ping").addClass("off"),$("#lteBackup_dis_ping").addClass("selected"),$("#detection").addClass("nd"),$("#ipv4_ping").addClass("nd"),$("#ipv6_ping").addClass("nd"),$("#DNS").addClass("nd"),$("#bSave").addClass("nd"))}function initTable(){var D,A,I,E=new Array,i=$.act(ACT_GL,WAN_COMMON_INTF_CFG,null,null,["WANAccessType"]);if("DSL"==$.sysMode){var a={},e=$.act(ACT_GL,WAN_DSL_LINK_CFG,null,null);a=INCLUDE_VDSLWAN?$.act(ACT_GL,WAN_DSL_INTF_CFG,null,null,["status","linkEncapsulationUsed"]):($("#xDslTip").addClass("nd"),$.act(ACT_GL,WAN_DSL_INTF_CFG,null,null,["status"]))}else if("ETH"==$.sysMode)var c=$.act(ACT_GL,WAN_ETH_INTF,null,null,null),o=$.act(ACT_GL,WAN_ETH_LINK_CFG,null,null);if(INCLUDE_IPV6&&$("#t_ipvx").removeClass("nd"),INCLUDE_IPTV)$.act(ACT_GET,DSL_IPTV_CFG,null,null,["iptvVPI","iptvVCI"]);INCLUDE_3G4G_BACKUP&&!INCLUDE_CHECK_WANALIVE_WITH_PING&&(sysModeObj=$.act(ACT_GET,SYS_MODE,null,null,["lteBackupEnable"]));var _=$.act(ACT_GL,WAN_IP_CONN,null,null),d=$.act(ACT_GL,WAN_PPP_CONN,null,null);if(INCLUDE_L2TP)var L=$.act(ACT_GL,WAN_L2TP_CONN,null,null);if(INCLUDE_PPTP)var f=$.act(ACT_GL,WAN_PPTP_CONN,null,null);var m=$.act(ACT_GET,L3_FORWARDING,null,null,["__ifAliasName"]);if(INCLUDE_IPV6)var S=$.act(ACT_GET,L3_IP6_FORWARDING,null,null,["__ifAliasName"]);$.exe(function(n){if(!n){if(INCLUDE_3G4G_BACKUP&&!INCLUDE_CHECK_WANALIVE_WITH_PING&&($("#lteBackup").removeClass("nd"),$("#lteBackup_space").removeClass("nd"),$("#lteBackup").removeClass("off"),$("#lteBackup").removeClass("on"),1==sysModeObj.lteBackupEnable?($("#lteBackup").addClass("on"),$("#lteBackup_en").addClass("selected")):($("#lteBackup").addClass("off"),$("#lteBackup_dis").addClass("selected"))),$.each(i,function(){("DSL"==$.sysMode&&"DSL"==this.WANAccessType||"ETH"==$.sysMode&&"Ethernet"==this.WANAccessType)&&($.wd.pStk=this.__stack,$.wd.l3ForwardingObj.__ifAliasName=m.__ifAliasName,$.wd.originIfAliasName=m.__ifAliasName,INCLUDE_IPV6&&($.wd.l3Ip6ForwardingObj.__ifAliasName=S.__ifAliasName))}),"DSL"==$.sysMode){var C="",r="",T=0,u=0;INCLUDE_VDSLWAN&&($.wd.curSupXtmType="G.993.2_Annex_K_PTM"==a[0].linkEncapsulationUsed?"PTM":"ATM","PTM"==$.wd.curSupXtmType?($("#xDslTipText").val(n_str.wan.xDslTipTextVDSL),T=1):$("#xDslTipText").val(n_str.wan.xDslTipTextADSL));for(var s=0;s<a.length;s++){var t=a[s].__stack.split(",");C+=t[0]+",",r+=a[s].status+","}var P="",h="",N="";for(s=0;s<e.length;s++){t=e[s].__stack.split(",");h+=t[0]+t[1]+",",P+=e[s].linkType+",",N+=e[s].destinationAddress+","}return $.each(_,function(){var n=$.stkPop(this.__stack,2);if($.wd.pStk==n){for(var s,t=this.__stack.split(","),i=t[0]+t[1],a=h.split(","),e=t[0],c=C.split(","),o=P.split(","),_=N.split(","),d=r.split(","),l=0;l<a.length;l++)if(i==a[l]){if(INCLUDE_IPTV_V2&&("iptv"==this.name||"ewan_iptv"==this.name))continue;connObj={},connObj.dsl=$.act(ACT_GET,WAN_DSL_LINK_CFG,$.stkPop(this.__stack,1),null,["destinationAddress","linkType","ATMPeakCellRate","ATMMaximumBurstSize","ATMSustainableCellRate","ATMEncapsulation","ATMQoS"]),INCLUDE_VDSLWAN&&(connObj.ptm=$.act(ACT_GET,WAN_PTM_LINK_CFG,$.stkPop(this.__stack,1),null,["X_TP_Used","X_TP_VlanEnabled","X_TP_VID"])),$.exe(),u=INCLUDE_VDSLWAN?connObj.ptm.X_TP_Used:0,connObj.obj=this,connObj.obj.__stack=this.__stack,(s=INCLUDE_VDSLWAN&&1==u?connObj.ptm.X_TP_VID:_[l].split(":")[1])<=0&&(s="N/A"),INCLUDE_VDSLWAN&&0!=u||"IPoA"!=o[l]||(connObj.type="ipoa"),(INCLUDE_VDSLWAN&&1==u||"EoA"==o[l])&&("IP_Bridged"==this.connectionType&&(connObj.type="bridge"),"IP_Routed"==this.connectionType&&("DHCP"==this.addressingType?connObj.type="dynamicIp":"Static"==this.addressingType&&(connObj.type="staticIp"))),$.wd.editIndex=$.wd.conn.push(connObj);break}var p="["+this.__stack+"]";for(l=0;l<c.length;l++)if(e==c[l]){if(A="Up"==d[l]?"Connected"==this.connectionStatus||1==this.X_TP_IPv6Enabled&&"Connected"==this.X_TP_IPv6ConnStatus?(D=INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span class='T_connected'>"+m_str.connected+"</span>","IP_Bridged"==this.connectionType||"IP_Routed"==this.connectionType&&"Static"==this.addressingType?"<span class='conn-opt-disabled T_disconn'>"+m_str.disconn+"</span>":"<span class='conn-opt T T_disconn' onClick='doDisConn(1, "+p+");'>"+m_str.disconn+"</span>"):"Disconnected"!=this.connectionStatus&&"Unconfigured"!=this.connectionStatus||"Disconnected"!=this.X_TP_IPv6ConnStatus&&"Unconfigured"!=this.X_TP_IPv6ConnStatus?($.auto(function(){$.locked()||$.reload()},5e3),D=INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span class='T_connecting'>"+m_str.connecting+"</span>","<span class='conn-opt-disabled T_conn' >"+m_str.conn+"</span>"):(D=INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span class='T_disconnected'>"+m_str.disconnected+"</span>",INCLUDE_VDSLWAN&&T!=u?"<span class='conn-opt-disabled T_conn' onClick='doConn(1, "+p+");'>"+m_str.conn+"</span>":"<span class='conn-opt T_conn' onClick='doConn(1, "+p+");'>"+m_str.conn+"</span>"):(D="Initializing"==d[l]||"EstablishingLink"==d[l]?($.auto(function(){$.locked()||$.reload()},5e3),INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span>DSL "+m_str.initing+"</span>"):INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span>DSL "+m_str.disconnected+"</span>","<span class='conn-opt-disabled T_conn'>"+m_str.conn+"</span>"),INCLUDE_IPTV)if(0<=this.name.search("iptv")){if(INCLUDE_IPTV_V2)continue;I="IP_Bridged"==this.connectionType?"<span class='a T T_view table-grid-icon edit-modify-icon' onClick='doEdit(1, "+p+")'></span>":"<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(1, "+p+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(1, "+p+")'></span>"}else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(1, "+p+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(1, "+p+")'></span>";else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(1, "+p+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(1, "+p+")'></span>";E.push([{text:this.name,width:""},{text:s,width:"10%"},{text:D,width:"20%"},{text:A,width:"10%"},{text:I,width:"15%"}]);break}}}),$.each(d,function(){var n=$.stkPop(this.__stack,2);if($.wd.pStk==n){for(var s,t=this.__stack.split(","),i=t[0]+t[1],a=h.split(","),e=t[0],c=C.split(","),o=(P.split(","),N.split(",")),_=r.split(","),d=0;d<a.length;d++)if(i==a[d]){if(INCLUDE_IPTV_V2&&("iptv"==this.name||"ewan_iptv"==this.name))continue;connObj={},connObj.dsl=$.act(ACT_GET,WAN_DSL_LINK_CFG,$.stkPop(this.__stack,1),null,["destinationAddress","linkType","ATMPeakCellRate","ATMMaximumBurstSize","ATMSustainableCellRate","ATMEncapsulation","ATMQoS"]),INCLUDE_VDSLWAN&&(connObj.ptm=$.act(ACT_GET,WAN_PTM_LINK_CFG,$.stkPop(this.__stack,1),null,["X_TP_Used","X_TP_VlanEnabled","X_TP_VID"])),$.exe(),u=INCLUDE_VDSLWAN?connObj.ptm.X_TP_Used:0,connObj.obj=this,connObj.obj.__stack=this.__stack,(s=INCLUDE_VDSLWAN&&1==u?connObj.ptm.X_TP_VID:o[d].split(":")[1])<=0&&(s="N/A"),"PPPoA"==this.transportType?connObj.type="pppoa":"PPPoE"==this.transportType?connObj.type="pppoe":"L2TP"==this.transportType?connObj.type="l2tp":"PPTP"==this.transportType&&(connObj.type="pptp"),$.wd.editIndex=$.wd.conn.push(connObj);break}var l="["+this.__stack+"]";for(d=0;d<c.length;d++)if(e==c[d]){if("Up"==_[d]?"Connected"==this.connectionStatus||1==this.X_TP_IPv6Enabled&&"Connected"==this.X_TP_IPv6ConnStatus?(D=INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span class='T_connected'>"+m_str.connected+"</span>",A="<span class='conn-opt T_discon' onClick='doDisConn(2, "+l+");'>"+m_str.disconn+"</span>"):"Disconnected"!=this.connectionStatus&&"Unconfigured"!=this.connectionStatus||"Disconnected"!=this.X_TP_IPv6ConnStatus&&"Unconfigured"!=this.X_TP_IPv6ConnStatus?"Connecting"!=this.connectionStatus&&"Connecting"!=this.X_TP_IPv6ConnStatus||($.auto(function(){$.locked()||$.reload()},5e3),D=INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span class='T_connecting'>"+m_str.connecting+"</span>",A="<span class='conn-opt T_disconn' onClick='doDisConn(2, "+l+");'>"+m_str.disconn+"</span>"):(D=INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span class='T_disconnected'>"+m_str.disconnected+"</span>",A=INCLUDE_VDSLWAN&&T!=u?"<span class='conn-opt-disabled T_conn' onClick='doConn(2, "+l+");'>"+m_str.conn+"</span>":"<span class='conn-opt T_conn' onClick='doConn(2, "+l+");'>"+m_str.conn+"</span>"):A=(D="Initializing"==_[d]||"EstablishingLink"==_[d]?($.auto(function(){$.locked()||$.reload()},5e3),INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span>DSL "+m_str.initing+"</span>"):INCLUDE_VDSLWAN&&T!=u?"<span>DSL "+m_str.disabled+"</span>":"<span>DSL "+m_str.disconnected+"</span>","<span class='conn-opt-disabled T_conn'>"+m_str.conn+"</span>"),INCLUDE_IPTV_V2){if("iptv"==this.name||"ewan_iptv"==this.name)continue;I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(2, "+l+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(2, "+l+")'></span>"}else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(2, "+l+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(2, "+l+")'></span>";E.push([{text:this.name,width:"20%"},{text:s,width:""},{text:D,width:"20%"},{text:A,width:"10%"},{text:I,width:"15%"}]);break}}}),$.initTableBody($("#wanTable"),E),E}if("ETH"==$.sysMode){var l="",p="";for(s=0;s<c.length;s++){t=c[s].__stack.split(",");l+=t[0]+",",p+=c[s].status+","}var k="",b="";for(s=0;s<o.length;s++){t=o[s].__stack.split(",");b+=t[0]+t[1]+",",k+=o[s].linkType+","}return $.each(_,function(){var n=$.stkPop(this.__stack,2);if($.wd.pStk==n){for(var s=this.__stack.split(","),t=s[0]+s[1],i=b.split(","),a=s[0],e=l.split(","),c=(k.split(","),p.split(",")),o=0;o<i.length;o++)if(t==i[o]){if(INCLUDE_IPTV&&"ewan_iptv"==this.name)continue;connObj={},connObj.ewan=$.act(ACT_GET,WAN_ETH_LINK_CFG,$.stkPop(this.__stack,1),null,null),$.exe(),connObj.obj=this,connObj.obj.__stack=this.__stack,pvc=connObj.ewan.X_TP_VID<=0?"N/A":connObj.ewan.X_TP_VID,"IP_Bridged"==this.connectionType&&(connObj.type="bridge"),"IP_Routed"==this.connectionType&&("DHCP"==this.addressingType?connObj.type="dynamicIp":"Static"==this.addressingType&&(connObj.type="staticIp")),$.wd.editIndex=$.wd.conn.push(connObj);break}var _="["+this.__stack+"]";for(o=0;o<e.length;o++)if(a==e[o]){if(A="Up"==c[o]?"Connected"==this.connectionStatus||1==this.X_TP_IPv6Enabled&&"Connected"==this.X_TP_IPv6ConnStatus?(D="<span class='T_connected'>"+m_str.connected+"</span>","IP_Bridged"==this.connectionType||"IP_Routed"==this.connectionType&&"Static"==this.addressingType?"<span class='conn-opt-disabled T_disconn'>"+m_str.disconn+"</span>":"<span class='conn-opt T T_disconn' onClick='doDisConn(1, "+_+");'>"+m_str.disconn+"</span>"):"Disconnected"!=this.connectionStatus&&"Unconfigured"!=this.connectionStatus||"Disconnected"!=this.X_TP_IPv6ConnStatus&&"Unconfigured"!=this.X_TP_IPv6ConnStatus?($.auto(function(){$.locked()||$.reload()},5e3),D="<span class='T_connecting'>"+m_str.connecting+"</span>","<span class='conn-opt-disabled T_conn' >"+m_str.conn+"</span>"):(D="<span class='T_disconnected'>"+m_str.disconnected+"</span>","<span class='conn-opt T_conn' onClick='doConn(1, "+_+");'>"+m_str.conn+"</span>"):(D="<span>WAN "+m_str.disconnected+"</span>","<span class='conn-opt-disabled T_conn'>"+m_str.conn+"</span>"),INCLUDE_IPTV){if("ewan_iptv"==this.name)continue;I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(1, "+_+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(1, "+_+")'></span>"}else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(1, "+_+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(1, "+_+")'></span>";E.push([{text:this.name,width:""},{text:pvc,width:"10%"},{text:D,width:"20%"},{text:A,width:"10%"},{text:I,width:"15%"}]);break}}}),$.each(d,function(){var n=$.stkPop(this.__stack,2);if($.wd.pStk==n){for(var s,t=this.__stack.split(","),i=t[0]+t[1],a=b.split(","),e=t[0],c=l.split(","),o=(k.split(","),p.split(",")),_=0;_<a.length;_++)if(i==a[_]){if(INCLUDE_IPTV&&("iptv"==this.name||"ewan_iptv"==this.name))continue;connObj={},connObj.ewan=$.act(ACT_GET,WAN_ETH_LINK_CFG,$.stkPop(this.__stack,1),null,null),$.exe(),connObj.obj=this,connObj.obj.__stack=this.__stack,s=connObj.ewan.X_TP_VID<=0?"N/A":connObj.ewan.X_TP_VID,"PPPoA"==this.transportType?connObj.type="pppoa":"PPPoE"==this.transportType?connObj.type="pppoe":"L2TP"==this.transportType?connObj.type="l2tp":"PPTP"==this.transportType&&(connObj.type="pptp"),$.wd.editIndex=$.wd.conn.push(connObj);break}var d="["+this.__stack+"]";for(_=0;_<c.length;_++)if(e==c[_]){if("Up"==o[_]?"Connected"==this.connectionStatus||1==this.X_TP_IPv6Enabled&&"Connected"==this.X_TP_IPv6ConnStatus?(D="<span class='T_connected'>"+m_str.connected+"</span>",A="<span class='conn-opt T_discon' onClick='doDisConn(2, "+d+");'>"+m_str.disconn+"</span>"):"Disconnected"==this.connectionStatus||"Unconfigured"==this.connectionStatus&&("Disconnected"==this.X_TP_IPv6ConnStatus||"Unconfigured"==this.X_TP_IPv6ConnStatus)?(D="<span class='T_disconnected'>"+m_str.disconnected+"</span>",A=INCLUDE_VDSLWAN&&T!=u?"<span class='conn-opt-disabled T_conn' onClick='doConn(2, "+d+");'>"+m_str.conn+"</span>":"<span class='conn-opt T_conn' onClick='doConn(2, "+d+");'>"+m_str.conn+"</span>"):"Connecting"!=this.connectionStatus&&"Connecting"!=this.X_TP_IPv6ConnStatus||($.auto(function(){$.locked()||$.reload()},5e3),D="<span class='T_connecting'>"+m_str.connecting+"</span>",A="<span class='conn-opt T_disconn' onClick='doDisConn(2, "+d+");'>"+m_str.disconn+"</span>"):(D="<span>WAN "+m_str.disconnected+"</span>",A="<span class='conn-opt-disabled T_conn'>"+m_str.conn+"</span>"),INCLUDE_IPTV){if("iptv"==this.name||"ewan_iptv"==this.name)continue;I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(2, "+d+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(2, "+d+")'></span>"}else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(2, "+d+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(2, "+d+")'></span>";E.push([{text:this.name,width:"20%"},{text:s,width:""},{text:D,width:"20%"},{text:A,width:"10%"},{text:I,width:"15%"}]);break}}}),$.each(L,function(){var n=$.stkPop(this.__stack,2);if($.wd.pStk==n){for(var s,t=this.__stack.split(","),i=t[0]+t[1],a=b.split(","),e=t[0],c=l.split(","),o=(k.split(","),p.split(",")),_=0;_<a.length;_++)if(i==a[_]){if(INCLUDE_IPTV&&("iptv"==this.name||"ewan_iptv"==this.name))continue;connObj={},connObj.ewan=$.act(ACT_GET,WAN_ETH_LINK_CFG,$.stkPop(this.__stack,1),null,null),$.exe(),connObj.obj=this,connObj.obj.__stack=this.__stack,s="-1"==connObj.ewan.X_TP_VID?"N/A":connObj.ewan.X_TP_VID,"PPPoA"==this.transportType?connObj.type="pppoa":"PPPoE"==this.transportType?connObj.type="pppoe":"L2TP"==this.transportType?connObj.type="l2tp":"PPTP"==this.transportType&&(connObj.type="pptp"),$.wd.editIndex=$.wd.conn.push(connObj);break}var d="["+this.__stack+"]";for(_=0;_<c.length;_++)if(e==c[_]){if("Up"==o[_]?INCLUDE_IPV6&&0==this.X_TP_IPv4Enabled?(D="<span class='T_disconnected'>"+m_str.disconnected+"</span>",A="<span class='conn-opt T_conn' onClick='doConn(3, "+d+");'>"+m_str.conn+"</span>","Connected"==this.X_TP_IPv6ConnStatus&&(D="<span class='T_disconnected'>"+m_str.connected+"</span>",A="<span class='conn-opt T_discon' onClick='doDisConn(3, "+d+");'>"+m_str.disconn+"</span>")):"Connected"==this.connectionStatus?(D="<span class='T_connected'>"+m_str.connected+"</span>",A="<span class='conn-opt T_discon' onClick='doDisConn(3, "+d+");'>"+m_str.disconn+"</span>"):"Disconnected"==this.connectionStatus||"Unconfigured"==this.connectionStatus?(D="<span class='T_disconnected'>"+m_str.disconnected+"</span>",A=INCLUDE_VDSLWAN&&T!=u?"<span class='conn-opt-disabled T_conn' onClick='doConn(3, "+d+");'>"+m_str.conn+"</span>":"<span class='conn-opt T_conn' onClick='doConn(3, "+d+");'>"+m_str.conn+"</span>"):"Connecting"==this.connectionStatus&&($.auto(function(){$.locked()||$.reload()},5e3),D="<span class='T_connecting'>"+m_str.connecting+"</span>",A="<span class='conn-opt T_disconn' onClick='doDisConn(3, "+d+");'>"+m_str.disconn+"</span>"):(D="<span>WAN "+m_str.disconnected+"</span>",A="<span class='conn-opt-disabled T_conn'>"+m_str.conn+"</span>"),INCLUDE_IPTV){if("iptv"==this.name||"ewan_iptv"==this.name)continue;I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(3, "+d+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(3, "+d+")'></span>"}else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(3, "+d+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(3, "+d+")'></span>";E.push([{text:this.name,width:"20%"},{text:s,width:""},{text:D,width:"20%"},{text:A,width:"10%"},{text:I,width:"15%"}]);break}}}),$.each(f,function(){var n=$.stkPop(this.__stack,2);if($.wd.pStk==n){for(var s,t=this.__stack.split(","),i=t[0]+t[1],a=b.split(","),e=t[0],c=l.split(","),o=(k.split(","),p.split(",")),_=0;_<a.length;_++)if(i==a[_]){if(INCLUDE_IPTV&&("iptv"==this.name||"ewan_iptv"==this.name))continue;connObj={},connObj.ewan=$.act(ACT_GET,WAN_ETH_LINK_CFG,$.stkPop(this.__stack,1),null,null),$.exe(),connObj.obj=this,connObj.obj.__stack=this.__stack,s="-1"==connObj.ewan.X_TP_VID?"N/A":connObj.ewan.X_TP_VID,"PPPoA"==this.transportType?connObj.type="pppoa":"PPPoE"==this.transportType?connObj.type="pppoe":"L2TP"==this.transportType?connObj.type="l2tp":"PPTP"==this.transportType&&(connObj.type="pptp"),$.wd.editIndex=$.wd.conn.push(connObj);break}var d="["+this.__stack+"]";for(_=0;_<c.length;_++)if(e==c[_]){if("Up"==o[_]?INCLUDE_IPV6&&0==this.X_TP_IPv4Enabled?(D="<span class='T_disconnected'>"+m_str.disconnected+"</span>",A="<span class='conn-opt T_conn' onClick='doConn(4, "+d+");'>"+m_str.conn+"</span>","Connected"==this.X_TP_IPv6ConnStatus&&(D="<span class='T_disconnected'>"+m_str.connected+"</span>",A="<span class='conn-opt T_discon' onClick='doDisConn(4, "+d+");'>"+m_str.disconn+"</span>")):"Connected"==this.connectionStatus?(D="<span class='T_connected'>"+m_str.connected+"</span>",A="<span class='conn-opt T_discon' onClick='doDisConn(4, "+d+");'>"+m_str.disconn+"</span>"):"Disconnected"==this.connectionStatus||"Unconfigured"==this.connectionStatus?(D="<span class='T_disconnected'>"+m_str.disconnected+"</span>",A=INCLUDE_VDSLWAN&&T!=u?"<span class='conn-opt-disabled T_conn' onClick='doConn(4, "+d+");'>"+m_str.conn+"</span>":"<span class='conn-opt T_conn' onClick='doConn(4, "+d+");'>"+m_str.conn+"</span>"):"Connecting"==this.connectionStatus&&($.auto(function(){$.locked()||$.reload()},5e3),D="<span class='T_connecting'>"+m_str.connecting+"</span>",A="<span class='conn-opt T_disconn' onClick='doDisConn(4, "+d+");'>"+m_str.disconn+"</span>"):(D="<span>WAN "+m_str.disconnected+"</span>",A="<span class='conn-opt-disabled T_conn'>"+m_str.conn+"</span>"),INCLUDE_IPTV){if("iptv"==this.name||"ewan_iptv"==this.name)continue;I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(4, "+d+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(4, "+d+")'></span>"}else I="<span class='a table-grid-icon edit-modify-icon' onClick='doEdit(4, "+d+")'></span>&nbsp;<span class='a table-grid-icon edit-trash-icon' onClick='doDel(4, "+d+")'></span>";E.push([{text:this.name,width:"20%"},{text:s,width:""},{text:D,width:"20%"},{text:A,width:"10%"},{text:I,width:"15%"}]);break}}}),$.initTableBody($("#wanTable"),E),E}}})}$("span.delete-all-icon").click(function(){if(0!=$.wd.conn.length){var i=[],a=!1;$.confirm(c_str.del_con,function(){$.showCover(),$.lock(),$.each($.wd.conn,function(){if(a=!1,this.type){if(INCLUDE_IPTV&&0<=this.obj.name.search("iptv"))return!0;if(specialConnectionList.length){for(var n=0;n<specialConnectionList.length;n++)if($.stkPop(this.obj.__stack,1)==$.stkPop(specialConnectionList[n].__stack,1)){a=!0;break}a||i.push(this.obj.__stack)}else i.push(this.obj.__stack);"l2tp"==this.type?$.act(ACT_DEL,WAN_L2TP_CONN,this.obj.__stack,null):"pptp"==this.type?$.act(ACT_DEL,WAN_PPTP_CONN,this.obj.__stack,null):this.type.indexOf("ppp")<0?($.act(ACT_OP,ACT_OP_DHCP_RELEASE,this.obj.__stack),$.exe(),$.act(ACT_DEL,WAN_IP_CONN,this.obj.__stack,null)):$.act(ACT_DEL,WAN_PPP_CONN,this.obj.__stack,null)}});var s,t=[];$.each(i,function(){s=$.stkPop(this,1);for(var n=0;n<t.length;n++)if(t[n]==s)return!0;t.push(s),$.act(ACT_DEL,WAN_CONN_DEVICE,s,null)}),$.exe(function(n){$.hideCover(),$.reload()})})}else $.alert(CMM_WAN_NO_INTF)}),INCLUDE_3G4G_BACKUP&&($("#lteBackup_en").on("click.wan",function(n){$.addLoading($(this)),$.act(ACT_SET,SYS_MODE,null,null,["lteBackupEnable=1"]),$.exe(function(n){n&&(1==sysModeObj.lteBackupEnable?$("#lteBackup_en").addClass("selected"):$("#lteBackup_dis").addClass("selected")),$.removeLoading()})}),$("#lteBackup_dis").on("click.wan",function(n){$.addLoading($(this)),$.act(ACT_SET,SYS_MODE,null,null,["lteBackupEnable=0"]),$.exe(function(n){n&&(1==sysModeObj.lteBackupEnable?$("#lteBackup_en").addClass("selected"):$("#lteBackup_dis").addClass("selected")),$.removeLoading()})})),INCLUDE_CHECK_WANALIVE_WITH_PING&&($("#lteBackup_en_ping").on("click.wan",function(n){$.addLoading($(this)),$.act(ACT_SET,SYS_MODE,null,null,["lteBackupEnable=1"]),$.exe(function(n){$.removeLoading(),$.reload()})}),$("#lteBackup_dis_ping").on("click.wan",function(n){$.addLoading($(this)),$.act(ACT_SET,SYS_MODE,null,null,["lteBackupEnable=0"]),$.exe(function(n){$.removeLoading(),$.reload()})}),$("#single_dect").on("click",function(n){$("#ipv4_ping").addClass("nd"),$("#ipv6_ping").addClass("nd")}),$("#dual_dect").on("click",function(n){$("#ipv4_ping").removeClass("nd"),$("#ipv6_ping").removeClass("nd"),$("#ipv4_ping_address").tpAddress("val",sysModeObj.IPV4Ping),$("#ipv6_ping_address").val(sysModeObj.IPV6Ping)}),$("#t_save").on("click",function(n){if($.addLoading(),DNS=$("#dns").val(),""!=DNS&&$.chkKeyword(DNS)){if($("#dual_dect").prop("checked")){var s=$("#ipv4_ping_address").tpAddress("val"),t=$("#ipv6_ping_address").val();if("0.0.0.0"!=s&&$.ifip(s))return $("#ipv4_ping_address").tpAddress("focus"),void $.alert(ERR_IPV4_ADDRESS);if("::"!=t&&!$.isValidGLUIP6AddrStrict(t))return $("#ipv6_ping_address").focus().select(),void $.alert(ERR_IPV6_ADDRESS);$.act(ACT_SET,SYS_MODE,null,null,["detectionMode=1","DNS="+DNS,"IPV4Ping="+s,"IPV6Ping="+t])}else $.act(ACT_SET,SYS_MODE,null,null,["detectionMode=0","DNS="+DNS]);$.exe(),$.removeLoading(),$.reload()}else $.alert(ERR_DNS_NAME)})),$("#addConnIcon").click(function(){$.loadPage("divPage","div.htm"),$("#editContainer").addClass("nd")})</script>
<h3 id="et">DSL WAN Interface</h3>
<div class="content-container" id="arp">
    <form class="pure-form pure-form-aligned">
		<div class="button-group-container nd" id="lteBackup">
			<b class="T_lteBackup">3G/4G Backup</b>
			<ul><li><button id="lteBackup_en" class="fst" value="on">On</button></li>
				<li><button id="lteBackup_dis" class="lst" value="off">Off</button></li>
			</ul>
		</div>
		<div class="part-separate-m nd" id="lteBackup_space">
		</div>
        <div class="table-op" id="addItem">
            <div class="table-btn">
                <span class="refresh-icon"></span>
                <label class="T_refresh">Refresh</label>
                <span id="addConnIcon" class="add-icon"></span>
                <label class="T_add">Add</label>
                <span class="delete-all-icon"></span>
                <label class="T_delall">Delete All</label>
            </div>
        </div>
        <table id="wanTable">
            <thead></thead>
            <tbody id="wanBody">
                <tr id="editContainer" class="nd">
                    <td colspan="5">
                        <div id="divPage"></div>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>
<div class="nd" id="check_ping">
<h3 id="et7">Internet Backup</h3>
</div>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="button-group-container nd" id="lteBackup_ping">
            <b class="T_lteBackup">3G/4G Backup</b>
            <ul><li><button id="lteBackup_en_ping" class="fst" value="on">On</button></li>
                <li><button id="lteBackup_dis_ping" class="lst" value="off">Off</button></li>
            </ul>
        </div>
        <div class="pure-control-group nd" id="detection">
            <label id="t_offline_detection" class="label-title nd">Offline Detection</label>
            <input type="radio" name="offline_detection" id="single_dect">
            <label id="t_single">Single Detection</label>
            <input type="radio" name="offline_detection" id="dual_dect">
            <label id="t_dual">Dual Detection</label>
        </div>
        <div class="pure-control-group nd" id="ipv4_ping">
            <b id="t_ipv4_ping">IPv4 Ping:</b>
            <input type="text" class="ip-address" id="ipv4_ping_address" maxlength="15">
        </div>
        <div class="pure-control-group nd" id="ipv6_ping">
            <b id="t_ipv6_ping">IPv6 Ping:</b>
            <input type="text" class="tp-input-text" id="ipv6_ping_address" maxlength="40">
        </div>
        <div class="pure-control-group nd" id="DNS">
            <b id="t_DNS">DNS Lookup:</b>
            <input type="text" maxlength="40" class="tp-input-text" id="dns">
        </div>
        <div class="nd" id="bSave">
            <button type="submit" class="green T_save" id="t_save">Save</button>
        </div>
    </form>
</div>
<script language="javascript">var connObj={type:null,obj:{},dsl:{},ptm:{}};$.wd={conn:new Array,pStk:null,editIndex:0,l3ForwardingObj:{},l3Ip6ForwardingObj:{}};var pvcOrVid="DSL"==$.sysMode?INCLUDE_VDSLWAN?s_str.destVDSL:s_str.destADSL:"VLAN ID",headArray=[{text:table_str.wanInfName,width:""},{text:pvcOrVid,width:"15%"},{text:table_str.status,width:"20%"},{text:table_str.operation,width:"20%"},{text:table_str.modify,width:"15%"}];$.initTableHead($("#wanTable"),headArray),$("#wanTable").tpTable(initTable),$.tpInit(init)</script>
