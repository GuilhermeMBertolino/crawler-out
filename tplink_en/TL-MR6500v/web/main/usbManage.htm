<h3 id="t_dSett">Device Settings</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <button type="submit" id="refresh" class="blue left T_scan">Scan</button>
        <div id="usb_drawing" class="part-separate">
        </div>
        <div id="chart_cnt" class="part-separate">
        </div>
        <div id="chart_tip" class="nd">
            <div id="chart_tips_point"></div>
            <p></p>
            <div id="chart_tips_button"></div>
        </div>
    </form>
</div>
<h3 id="t_sSett">Sharing Settings</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <label id="t_nsn" for="server_name">Network/Media Server Name:</label>
        <input type="text" id="server_name" maxlength="15">
        <button type="submit" class="green T_save" id="shareSettings">Save</button>
    </form>
</div>
<h3 id="t_info">Folder Sharing</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="button-group-container">
            <b id="t_esa">Share All:</b>
            <ul>
                <li>
                    <button id="shareOn" class="fst" value="on">On</button>
                </li>
                <li>
                    <button id="shareOff" class="lst" value="off">Off</button>
                </li>
            </ul>
        </div>
        <div class="browse-content-container nd" id="folderSel">
            <div class="browse-content-container-wrap">
                <span><b id="t_brw">Browse for folder path</b>
                </span>
                <br>
                <br>
                <div id="folderSelContent">
                </div>
            </div>
            <div class="inline-btn-right">
                <button type="submit" class="green inline T_cancel" id="cancelPathSel">Cancel</button>
                <button type="submit" class="green inline T_save" id="confirmPathSel">Save</button>
            </div>
        </div>
        <div id="shareDrawing" class="nd">
            <div class="table-op">
                <div class="table-btn">
                    <span class="add-icon" id="shareItemAdd"></span>
                    <label class="T_add">Add</label>
                    <span class="delete-icon"></span>
                    <label class="T_del">Delete</label>
                </div>
            </div>
            <table id="shareTab">
                <thead></thead>
                <tbody>
                    <tr id="editShareFolder" class="nd">
                        <td colspan="8">
                            <div>
                                <b id="t_vol">Volume Name:</b>
                                <select id="shareVolume">
                                </select>
                            </div>
                            <div>
                                <b id="t_folP">Folder Path:</b>
                                <input type="text" id="filename" class="xl" disabled="disabled" required>
                                <button type="submit" class="blue" id="t_browse">Browse</button>
                            </div>
                            <div>
                                <b id="t_shareN">Folder Name:</b>
                                <input type="text" id="shareName" class="xl" maxlength="31" required>
                            </div>
                            <div>
                                <b></b>
                                <input type="checkbox" checked="checked" id="ea">
                                <label id="t_ea">Enable Authentication</label>
                            </div>
                            <div id="eaNote">
                                <b class="T_usbNote">After disable authentication, if you are still asked to login, type "guest" in account and leave the password blank.</b>
                            </div>
                            <div>
                                <b></b>
                                <input type="checkbox" id="wa">
                                <label id="t_wa">Enable Write Access</label>
                            </div>
                            <div>
                                <b></b>
                                <input type="checkbox" id="ems">
                                <label id="t_ems">Enable Media Sharing</label>
                            </div>
                            <div class="inline-btn-right">
                                <button type="submit" class="green T_cancel" id="edit-cancel">Cancel</button>
                                <button type="submit" class="green T_save" id="edit-ok">Save</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="button-group-container" id="authentication">
            <b id="t_ea_a">Enable Authentication:</b>
            <ul>
                <li>
                    <button id="authOn" class="fst" value="on">On</button>
                </li>
                <li>
                    <button id="authOff" class="lst" value="off">Off</button>
                </li>
            </ul>
        </div>
        <div class="nd" id="authenticationNote">
            <b class="T_usbNote">After disable authentication, if you are still asked to login, type "guest" in account and leave the password blank.</b>
        </div>
        <div id="authDrawing" class="nd">
            <div class="table-op">
                <div class="table-btn">
                    <span class="refresh-icon" id="refShareSet"></span>
                    <label class="T_refresh">Refresh</label>
                </div>
            </div>
            <table id="authTab">
                <thead></thead>
                <tbody></tbody>
            </table>
        </div>
    </form>
</div>
<script language="javascript">!function(){var i,_,o,u,h,E,r,c,d,T,p,f="",v="",m="",C=1,S=1,b="",t="",R="";if(INCLUDE_STORAGE_HTTP_SERVICE)var A;function g(e){var a={};"Online"==i[e].status?(a.enable=0,i[e].enable=0):"Standby"==i[e].status&&1==i[e].enable?(i[e].enable=0,a.enable=0):(i[e].enable=1,a.enable=1),$.act(ACT_SET,USB_DEVICE,i[e].__stack,null,a),$.exe(function(){$.removeLoading(),$.reload()})}function a(e){var a={};"Standby"==i[e].status&&1==i[e].enable&&(a.enable=1,$.act(ACT_SET,USB_DEVICE,i[e].__stack,null,a),$.exe()||$.reload())}function L(e){var a,t,l={};if("Online"==_[e].status)l.enable=0;else{if("Error"==_[e].status)return;if("Offline"==_[e].status&&"1"==_[e].enable)return a=e,t={enable:1,force:1},$.act(ACT_SET,LOGICAL_VOLUME,_[a].__stack,null,t),void($.exe()||$.reload());"Offline"==_[e].status?l.enable=1:$.reload()}$.act(ACT_SET,LOGICAL_VOLUME,_[e].__stack,null,l),$.exe(function(){$.removeLoading(),$.reload()})}function k(){var e,a,t=[];for(r=1;r<=i.length;r++)if("Online"==i[r-1].status){for(e=a=0;e<_.length;e++)i[r-1].__stack.split(",")[0]==_[e].__stack.split(",")[0]&&a++;for(e=0;e<_.length;e++)if(i[r-1].__stack.split(",")[0]==_[e].__stack.split(",")[0]){var l;l="Online"==_[e].status||("Error"==_[e].status||"Offline"==_[e].status&&_[e].enable,!1),0!=i[r-1].enable&&"Online"==i[r-1].status||(l=!1);var n={text:"<span class='safely-remove-icon table-icon' data-index='"+(r-1)+"'></span>",width:"15%",rowspan:a};t.push([{text:_[e].label+":("+_[e].name+")",width:"15%"},{text:_[e].capacity,width:"20%"},{text:s(I(_[e].freeSpace),I(_[e].capacity)),width:"38%"},{text:'<span class="table-grid-icon'+(l?" enable-icon":" disable-icon")+'" data-index="'+e+'"></span>',width:"12%"},n])}}return $.initTableBody($("#volumeTbl"),t),t}function s(e,a){var t=1-e/a,l=.9<=t,n='<div class="inline-block">';return n+='<div class="" style="position: relative; display: inline-block;">',n+='<div class="" style="margin-bottom:10px;top:7px;position:relative;">',n+='<div class="" style="border: 0 none;background-color: #a7a9ac;width: 230px; height: 6px;">',n+='<div class="progressbar-value'+(l?" grid_alert":"")+'" style="width:'+230*t+'px;height:100%;overflow: hidden;"></div>',n+="</div>",n+="</div>",n+="</div>",n+='<div class="volume-progress-text">',n+='<span class="'+(l?"grid_alert":"")+'">'+s_str.used+":"+(a-e).toFixed(1)+"G</span>",n+="<span>"+s_str.free+":"+e+"G</span>",n+="</div>",n+="</div>"}function I(e){return/K/.test(e)?1*(1*e.split(" K")[0]/1024/1024).toFixed(1):/M/.test(e)?1*(1*e.split(" M")[0]/1024).toFixed(1):/G/.test(e)?1*(1*e.split(" G")[0]).toFixed(1):/T/.test(e)?1*(1024*e.split(" T")[0]).toFixed(1):1*(1*e).toFixed(1)}function x(){var e,a,t,l,n,s,i=[],o="",r="";for(n=0;n<u.length;n++){var c=!1,d=m_str.disconnected;for(e=u[n].volumeLabel+":"+u[n].name,$.each(_,function(){if(this.uuid==u[n].volumeUuid)return a=this,!(c=!0)}),t=table_str.off,1==E[n].enable&&(t=table_str.on),l=""!=u[n].volumeUuid&&0==c?"<span class='table-grid-icon inactive-disable-icon' id='sp"+n+"'></span>":""!=u[n].volumeUuid&&"Online"!=a.status?("Error"==a.status||"Offline"==a.status&&a.enable,"<span class='table-grid-icon inactive-icon' id='sp"+n+"'></span>"):1==u[n].enable?"<span class='table-grid-icon enable-icon' id='sp"+n+"' data-index='"+n+"'></span>":"<span class='table-grid-icon disable-icon' id='sp"+n+"' data-index='"+n+"'></span>",o="<span class='table-grid-icon edit-modify-icon' id='edit"+n+"' data-index='"+n+"'></span>",r="<span class='table-grid-icon edit-trash-icon' id='del"+n+"' data-index='"+n+"'></span>",s=0;s<_.length;s++)_[s].label==u[n].volumeLabel&&(d=_[s].name);null==d&&(d=m_str.disconnected),i.push([{text:'<div><input type="checkbox" id="cb'+n+'" class="table-select-one" data-index="'+n+'"/><label></label></div>',width:"8%"},{text:n+1,width:"5%"},{text:u[n].alias,width:"15%"},{text:O(e),width:"25%"},{text:t,width:"10%"},{text:d,width:"10%"},{text:l,width:"10%"},{text:o+r,width:"17%"}])}return $.initTableBody($("#shareTab"),i),$.tablePages($("#shareTab"),8),i}function l(e){$.act(ACT_DEL,SMB_SERVICE_FOLDER,u[e].__stack,null,null),$.act(ACT_DEL,FTP_SERVER_FOLDER,h[e].__stack,null,null),$.act(ACT_DEL,DLNA_MEDIA_SERVER_FOLDER,E[e].__stack,null,null),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_DEL,STORAGE_HTTP_FOLDER,A[e].__stack,null,null),$.exe()}function D(){var e,a=[];if(0==_.length&&a.push([{text:"--",width:"10%"},{text:"--",width:"40%"},{text:"--",width:"25%"},{text:"--",width:"25%"}]),i=$.act(ACT_GL,USB_DEVICE,null,null),_=$.act(ACT_GL,LOGICAL_VOLUME,null,null),!$.exe()){for(r=1;r<=i.length;r++)if("Online"==i[r-1].status)for(e=0;e<_.length;e++)i[r-1].__stack.split(",")[0]==_[e].__stack.split(",")[0]&&"Online"==_[e].status&&a.push([{text:e+1,width:"10%"},{text:"volume("+_[e].name+")",width:"40%"},{text:_[e].label+":",width:"25%"},{text:_[e].name,width:"25%"}]);$.initTableBody($("#authTab"),a),$.tablePages($("#authTab"),5)}return a}function O(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}function M(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," ").replace(/\s/g," ")}$.tpInit(function(){i=$.act(ACT_GL,USB_DEVICE,null,null),_=$.act(ACT_GL,LOGICAL_VOLUME,null,null),o=$.act(ACT_GET,SMB_SERVICE,null,null,null),$.act(ACT_GET,FTP_SERVER,null,null,null),$.act(ACT_GET,DLNA_MEDIA_SERVER,null,null,null),u=$.act(ACT_GL,SMB_SERVICE_FOLDER,null,null,null),h=$.act(ACT_GL,FTP_SERVER_FOLDER,null,null,null),E=$.act(ACT_GL,DLNA_MEDIA_SERVER_FOLDER,null,null,null),INCLUDE_STORAGE_HTTP_SERVICE&&(A=$.act(ACT_GL,STORAGE_HTTP_FOLDER,null,null,null),$.act(ACT_GET,STORAGE_HTTP,null,null,null));var e,a;if(userAccessList_samba=$.act(ACT_GL,SMB_USER_ACCESS,null,null,null),userList=$.act(ACT_GL,USER_ACCOUNT,null,null,null),$("#chart_tip p").text(c_str.usbChartInfo),$("#chart_tips_button").text(m_str.ok),!$.exe()){if(0<i.length)if(i.length<=2&&function(e,a){for(var t=0,l=0;l<e.length;l++){for(var n=0,s=0;s<a.length;s++)$.stkPop(a[s].__stack)==e[l].__stack&&(n+=1);if(t<n&&(t=n),5<t)return!1}return!0}(i,_))!function(_,u){var t,l=["#4ACBD6","#11BBBF","#0D9999","#86E2E2","#59E6EA"],e=[];$("#chart_cnt").empty().show(),$("#usb_drawing").hide(),0<_.length&&-1===document.cookie.search("usbInfo=1")&&(document.cookie="usbInfo=1",$.showCover(),$("#mask").css({background:"#000",opacity:"0.3"}),$("#chart_tip").removeClass("nd"),$("#main").scrollTop(0));for(var n=0;n<_.length;n++)if("Online"==_[n].status){var s=0,i=0;e[n]=document.createElement("div"),$(e[n]).attr("class","device_chart"),$("#chart_cnt").append(e[n]),$.each(u,function(e){$.stkPop(this.__stack)==_[n].__stack&&(s+=I(this.capacity))}),t=[];var h=document.createElement("canvas");h.className="bg-line",h.width=350,h.height=350;var a=document.createElement("ul");a.className="device_info_ul",$.each(u,function(e){var o,r,c,d,a=this;$.stkPop(a.__stack)==_[n].__stack&&(o=n,r=i,c=h,d=s,t.push({value:I(a.capacity),color:"1"==a.enable?l[r%5]:"#A7A9AC",label:a.label+":("+a.name+")",free:I(a.freeSpace),clickCallback:function(){$.addLoading(),L(e)},showInfo:function(){var e,a=0,t=0,l=this.outerRadius,n=c.getContext("2d");$("#chart_cnt .device_chart:eq("+o+")").find("div.device_info").hide(),n.clearRect(0,0,350,350),n.beginPath(),n.strokeStyle=this.fillColor,n.lineWidth=2,n.moveTo(170,170),$.each(u,function(){$.stkPop(this.__stack)==_[o].__stack&&(t<r&&(a+=I(this.capacity)),t++)}),a=a/d*2*Math.PI,e=this.value/d*2*Math.PI,this.value==d&&(e=2.3);var s=a+e/2>Math.PI?-1:0,i=$("#chart_cnt .device_chart:eq("+o+")").find("div.device_info:eq("+r+")");n.lineTo(170+1.4*l*Math.sin(a+e/2),170-1.4*l*Math.cos(a+e/2)),n.lineTo(170+1.4*l*Math.sin(a+e/2)+(0==s?1:-1)*i.width(),170-1.4*l*Math.cos(a+e/2)),n.stroke(),T&&(n.beginPath(),n.fillStyle="#ffffff",n.arc(170,170,36,0,2*Math.PI,!1),n.fill()),i.show()},hideInfo:function(){var e=c.getContext("2d");$("#chart_cnt .device_chart:eq("+o+")").find("div.device_info").hide(),e.clearRect(0,0,350,350)}}),i++)}),1===t.length&&t.push({value:.01,color:"#fff",label:"",free:.01,clickCallback:function(){},showInfo:function(){},hideInfo:function(){}}),$("#chart_cnt .device_chart:eq("+n+")").append(h),$("#chart_cnt .device_chart:eq("+n+")").append(a);var o=document.createElement("canvas");o.width=140,o.height=140,$("#chart_cnt .device_chart:eq("+n+")").append(o);var T="Microsoft Internet Explorer"==navigator.appName&&"MSIE8.0"==navigator.appVersion.split(";")[1].replace(/[ ]/g,"");T&&(o=window.G_vmlCanvasManager.initElement(o),h=window.G_vmlCanvasManager.initElement(h)),function(u,h,E){new Chart(u.getContext("2d")).Doughnut(t,{showTooltips:!0,segmentStrokeWidth:1,percentageInnerCutout:45,animationSteps:30,animationEasing:"easeOutQuad",onAnimationComplete:function(){for(var e,a,t,l,n,s,i=E.getContext("2d"),o=0,r=0,c=0,d=this.outerRadius,_=0;_<this.segments.length;_++)t=this.segments[_].value/this.total*2*Math.PI,2==this.segments.length&&(t=2.3),e=document.createElement("div"),a=document.createElement("li"),e.className="device_info",a.className="device_info_li",$(u).closest(".device_chart").append(e),$(u).closest(".device_chart").find(".device_info_ul").append(a),r=o+t/2>Math.PI?-1:0,c=-1,$(e).css("top",parseInt(d-1.4*d*Math.cos(o+t/2)+c*e.offsetHeight-1)+"px"),$(e).css("left",parseInt(d+1.4*d*Math.sin(o+t/2)+r*e.offsetWidth+20)+"px"),l=-1<(1*this.segments[_].value-1*this.segments[_].free+"").indexOf(".")?(1*this.segments[_].value-1*this.segments[_].free).toFixed(1):1*this.segments[_].value-1*this.segments[_].free,n=-1<(1*this.segments[_].free+"").indexOf(".")?(1*this.segments[_].free).toFixed(1):1*this.segments[_].free,e.innerHTML="<h4>"+this.segments[_].label+'</h4><ul><li class="'+(9<=l/n?"alert":"")+'">'+s_str.used+": "+l+"G</li><li>"+s_str.free+": "+n+"G</li></ul>",a.innerHTML='<div style="background:'+this.segments[_].fillColor+'"></div>'+this.segments[_].label.split("(")[0],o+=t,e.style.display="none";i.beginPath(),i.fillStyle="#ffffff",i.arc(170,170,36,0,2*Math.PI,!1),i.fill(),h=-1<(h+"").indexOf(".")?(1*h).toFixed(1):1*h,s=T?'<div class="device_total" style="background:transparent;">'+h+"G</div>":'<div class="device_total">'+h+"G</div>",$(u).closest(".device_chart").append($(s))}})}(o,s,h),$("#chart_cnt .device_chart:eq("+n+")").append($('<button data-index="'+n+'" type="submit" class="bottom_button blue">'+m_str.remove+"</button>"))}$(".bottom_button").click(function(){var e=$(this).attr("data-index");$.addLoading(),g(e)})}(i,_);else{for(r=0;r<i.length;r++)"Online"==i[r].status&&0;for(r=0;r<_.length;r++)"Online"==_[r].status&&0;"<table id='volumeTbl'><thead></thead><tbody></tbody></table>",$("#usb_drawing").append("<table id='volumeTbl'><thead></thead><tbody></tbody></table>").append("<br>"),a=[{text:table_str.name,width:"15%"},{text:table_str.total,width:"20%"},{text:table_str.capacity,width:"38%"},{text:table_str.enable,width:"12%"},{text:m_str.remove,width:"15%"}],$.initTableHead($("#volumeTbl"),a),$("#volumeTbl").tpTable(k)}$("#server_name").val(o.serverName);var t=[{text:table_str.id,width:"10%"},{text:table_str.shareName,width:"40%"},{text:table_str.folderPath,width:"25%"},{text:table_str.volume,width:"25%"}];$.initTableHead($("#authTab"),t),$("#authTab").tpTable(D),a=[{text:'<div><input type="checkbox" id="shareTitle" class="table-select-all"/><label></label></div>',width:"8%"},{text:table_str.id,width:"5%"},{text:table_str.shareName,width:"15%"},{text:table_str.folderPath,width:"25%"},{text:table_str.mediaSharing,width:"10%"},{text:table_str.volume,width:"10%"},{text:table_str.status,width:"10%"},{text:table_str.modify,width:"17%"}],$.initTableHead($("#shareTab"),a),$("#shareTab").tpTable(x),0==o.anonymous?($("#authOn").addClass("selected"),$("#authenticationNote").addClass("nd")):($("#authOff").addClass("selected"),1==o.shareAll&&$("#authenticationNote").removeClass("nd")),0==o.shareAll?($("#shareOff").addClass("selected"),$("#authentication").addClass("nd"),$("#authDrawing").addClass("nd"),$("#shareDrawing").removeClass("nd")):($("#shareOn").addClass("selected"),$("#shareDrawing").addClass("nd"),$("#authentication").removeClass("nd"),$("#authDrawing").removeClass("nd"));for(var l=$("#shareVolume");0<$("#shareVolume option").length;)$("#shareVolume option[index='0']").remove();var n=$("<option>"+table_str.selectopt+"</option>");for(n.val(table_str.selectopt),l.append(n),e=0;e<_.length;e++)"Online"==_[e].status&&((n=$("<option></option>")).val(_[e].label+":"),n.text(_[e].label+":"),l.append(n));if(T=u.length,void 0!==$.mainParam){var s=$.mainParam||{};$("#scroll").scrollTop(s.scrollTop)}}}),$("#refresh").click(function(){if($.addLoading($(this)),i=$.act(ACT_GL,USB_DEVICE,null,null),!$.exe()){if(0==i.length)return $.removeLoading(),void $.reload();var e;for(e=0;e<i.length;e++)i[e].enable=1,a(e);$.removeLoading(),$.reload()}}),$("#chart_tips_button").click(function(){$.hideCover(),$("#mask").css({background:"#36444b",opacity:"0.2"}),$("#chart_tip").addClass("nd")}),$("#t_browse").click(function(){!function(){var e;for($.setFixedCentral($("#folderSel")),$.showCover(),$("#folderSel").removeClass("nd"),e=0;e<_.length;e++){var a;if("Online"==_[e].status&&t==_[e].label+":")a="<div style='padding-left:10px;' class='root'><div class='addFolder inline'></div>&nbsp;<span class='span inline' style='line-height:24px;vertical-align:top;cursor:pointer;'>"+_[e].label+":</span></div>",$("#folderSelContent").append(a)}}()}),$("#folderSelContent").on("click",".addFolder,.hideFolder",function(){var e;e=this,$(e).hasClass("addFolder")?($(e).parent().hasClass("vol")?($(e).siblings("div").removeClass("nd"),$(c).parent().removeClass("vol")):$(e).parent().hasClass("loaded")?$(e).siblings("div").removeClass("nd"):function e(a){var t;if(1==C&&(C=0,c=a),$(a).parent().hasClass("root")){for(t=0;t<_.length;t++)$(a).siblings(".span").text()==_[t].label+":"&&(f=_[t].name);var l,n=f+"/"+M(v),s={};if(s.targetPath=n,$.act(ACT_SET,FOLDER_BROWSE,null,null,s),folderList=$.act(ACT_GL,FOLDER_NODE,null,null,null),!$.exe())for(l=0;l<folderList.length;l++){var i=O(folderList[l].folderName);text='<div style="padding-left:23px;" class="div"><div class="addFolder inline"></div><div class="folderImg inline" style="cursor:pointer;"></div>&nbsp;<span class="fName inline" style="line-height:24px;vertical-align:top;cursor:pointer;">'+i+"</span></div>",$(c).parent().append(text)}C=1,v="",$(c).parent().hasClass("root")||$(c).parent().addClass("loaded")}else m=$(a).siblings(".fName").text(),""!=v&&(m+="/"+v),v=m,e($(a).parent())}(e),$(e).removeClass("addFolder"),$(e).addClass("hideFolder")):$(e).hasClass("hideFolder")&&($(e).removeClass("hideFolder"),$(e).addClass("addFolder"),$(e).parent().hasClass("root")&&$(e).parent().addClass("vol"),$(e).siblings("div").addClass("nd"))}).on("click",".folderImg",function(){$(this).siblings(".fName").click()}).on("click",".fName, span.span",function(){!function e(a){var t;var l;var n,s;if(1==S)if($(a).parent().hasClass("root")){for(b=$(a).text(),l=0;l<_.length;l++)$(a).text()==_[l].label+":"&&(f=_[l].name);n=$(a).css("color"),$(a).css("color","#0CF"),d&&($(d).css("color",n),s=$(d).siblings(".folderSel"),d!=a&&(s.removeClass("folderSel"),s.addClass("folderImg"))),d=a}else b="/"+$(a).text(),c=a,S=0,e($(a).parent());else if($(a).parent().hasClass("root")){for(t=$(a).siblings(".span").text(),l=0;l<_.length;l++)$(a).siblings(".span").text()==_[l].label+":"&&(f=_[l].name);b=t+b,S=1,n=$(c).css("color"),$(c).css("color","#0CF");var i=$(c).siblings(".folderImg");i.removeClass("folderImg"),i.addClass("folderSel"),d&&($(d).css("color",n),s=$(d).siblings(".folderSel"),d!=c&&(s.removeClass("folderSel"),s.addClass("folderImg"))),d=c}else b="/"+$(a).siblings("span").text()+b,e($(a).parent())}(this)}),$("#usb_drawing").on("click","span.safely-remove-icon",function(){var e=$(this).attr("data-index");$.addLoading(),g(e)}).on("click","span.disable-icon, span.enable-icon",function(){L($(this).attr("data-index"))}),$("#shareTab").on("click","span.enable-icon, span.disable-icon",function(){!function(e){var a,t={},l=!1;$.each(_,function(){this.uuid==u[e].volumeUuid&&(a=this,l=!0)}),""!=u[e].volumeUuid&&0==l||""!=u[e].volumeUuid&&"Online"!=a.status||(1==u[e].enable?t.enable=0:t.enable=1);$.act(ACT_SET,SMB_SERVICE_FOLDER,u[e].__stack,null,t),$.act(ACT_SET,FTP_SERVER_FOLDER,h[e].__stack,null,t),$.act(ACT_SET,DLNA_MEDIA_SERVER_FOLDER,E[e].__stack,null,t),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_SET,STORAGE_HTTP_FOLDER,A[e].__stack,null,t);if(!$.exe()&&($.act(ACT_SET,SMB_SERVICE,null,null,["modified=0"]),$.act(ACT_SET,FTP_SERVER,null,null,["modified=0"]),!$.exe())){var n={};n.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",n)}}($(this).attr("data-index"))}).on("click","span.edit-modify-icon",function(){!function(e){var a,t=u[p=e].volumeLabel+":";$("#shareVolume").find("option[value='"+t+"']").prop("selected","selected"),$("#shareVolume").tpSelect({refresh:1}),$("#filename").val(u[e].volumeLabel+":"+u[e].name),$("#shareName").val(u[e].alias),1==u[e].needAuth?($("#ea").prop("checked",!0).tpCheckbox(),$("#eaNote").addClass("nd")):($("#ea").prop("checked",!1).tpCheckbox(),$("#eaNote").removeClass("nd"));for(a=0;a<userAccessList_samba.length;a++)parseInt(u[e].__stack,10)==parseInt(userAccessList_samba[a].__stack,10)&&parseInt(userList[0].__stack,10)==userAccessList_samba[a].userId&&(7==userAccessList_samba[a].permissions?$("#wa").prop("checked",!0).tpCheckbox():$("#wa").prop("checked",!1).tpCheckbox());1==E[e].enable&&$("#ems").prop("checked",!0).tpCheckbox();R="modify"}($(this).attr("data-index"))}).on("click","span.edit-trash-icon",function(){!function(e){$.act(ACT_DEL,SMB_SERVICE_FOLDER,u[e].__stack,null,null),$.act(ACT_DEL,FTP_SERVER_FOLDER,h[e].__stack,null,null),$.act(ACT_DEL,DLNA_MEDIA_SERVER_FOLDER,E[e].__stack,null,null),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_DEL,STORAGE_HTTP_FOLDER,A[e].__stack,null,null);if(!$.exe()&&($.act(ACT_SET,SMB_SERVICE,null,null,["modified=0"]),$.act(ACT_SET,FTP_SERVER,null,null,["modified=0"]),!$.exe())){var a={};a.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",a)}}($(this).attr("data-index"))}).on("click",".share-table-checkbox",function(){!function(e){var a,t=1;if(1==$("#cb"+e).prop("data-checked")){for(a=0;a<u.length;a++)0==$("#cb"+a).prop("data-checked")&&(t=0);1==t&&$("#shareTitle").prop("checked",!0).tpCheckbox()}else $("#shareTitle").prop("checked",!1).tpCheckbox()}($(this).attr("data-index"))}),$("#shareDrawing").on("click",".delete-icon",function(){!function(){var e;if(1==$("#shareTitle").prop("data-checked"))for(e=0;e<u.length;e++)l(e);else for(e=0;e<u.length;e++)1==$("#cb"+e).prop("data-checked")&&l(e);$.act(ACT_SET,SMB_SERVICE,null,null,["modified=0"]),$.act(ACT_SET,FTP_SERVER,null,null,["modified=0"]),$.exe();var a={};a.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",a)}()}),$("#shareVolume").click(function(){t=$("#shareVolume").data("value")}),$("#shareItemAdd").click(function(){R="add"}),$("#cancelPathSel").click(function(){$.hideCover(),$("#folderSelContent").empty(),$("#folderSel").addClass("nd")}),$("#confirmPathSel").click(function(){$.hideCover(),$("#folderSelContent").empty(),$("#folderSel").addClass("nd"),$("#filename").val(M(b))}),$("#refShareSet").click(function(){D()}),$("#shareOn").click(function(){if($.addLoading($(this)),$.act(ACT_SET,SMB_SERVICE,null,null,["shareAll=1"]),$.act(ACT_SET,FTP_SERVER,null,null,["shareAll=1"]),$.act(ACT_SET,DLNA_MEDIA_SERVER,null,null,["shareAll=1"]),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_SET,STORAGE_HTTP,null,null,["shareAll=1"]),!$.exe()){$.removeLoading(),$("#authentication").removeClass("nd"),$("#shareDrawing").addClass("nd"),$("#authDrawing").removeClass("nd");var e={};e.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",e)}}),$("#shareOff").click(function(){if($.addLoading($(this)),$.act(ACT_SET,SMB_SERVICE,null,null,["shareAll=0"]),$.act(ACT_SET,FTP_SERVER,null,null,["shareAll=0"]),$.act(ACT_SET,DLNA_MEDIA_SERVER,null,null,["shareAll=0"]),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_SET,STORAGE_HTTP,null,null,["shareAll=0"]),!$.exe()){$.removeLoading(),$("#authentication").addClass("nd"),$("#authDrawing").addClass("nd"),$("#shareDrawing").removeClass("nd");var e={};e.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",e)}}),$("#authOn").click(function(){if($.addLoading($(this)),$.act(ACT_SET,SMB_SERVICE,null,null,["anonymous=0"]),$.act(ACT_SET,FTP_SERVER,null,null,["anonymous=0"]),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_SET,STORAGE_HTTP,null,null,["anonymous=0"]),!$.exe()){$.removeLoading();var e={};e.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",e)}}),$("#authOff").click(function(){if($.addLoading($(this)),$.act(ACT_SET,SMB_SERVICE,null,null,["anonymous=1"]),$.act(ACT_SET,FTP_SERVER,null,null,["anonymous=1"]),INCLUDE_STORAGE_HTTP_SERVICE&&$.act(ACT_SET,STORAGE_HTTP,null,null,["anonymous=1"]),!$.exe()){$.removeLoading();var e={};e.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",e)}}),$("#shareSettings").click(function(){if($.addLoading($(this)),16<=$("#server_name").val().length)$.alert(CMM_USB_SERVER_NAME_LENGTH);else{var e={};if(e.serverName=$("#server_name").val(),""!=e.serverName)if($.asc(e.serverName,!0))$.alert(ERR_USB_DLNA_SERVER_NAME_NOT_ASCII);else if(/[\\\/\*\?=+:;,."<>|@\[\]\(\)\ ]+/.test(e.serverName))$.alert(ERR_USB_DLNA_INVALID_SERVER_NAME);else{var a={};a.serverName=$("#server_name").val(),$.act(ACT_SET,DLNA_MEDIA_SERVER,null,null,e),$.act(ACT_SET,SMB_SERVICE,null,null,a),$.exe(function(e){if(!e){$.removeLoading();var a={};a.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",a)}})}else $.alert(ERR_USB_DLNA_SERVER_NAME_EMPTY)}}),$("#edit-ok").click(function(){var e,a,t,l,n,s,i,o={},r={},c={};if(INCLUDE_STORAGE_HTTP_SERVICE)var d={};if($.addLoading($(this)),""!==(e=$("#shareName").val()))if(/[\\\/:\*\?"<>|\]\ ]+/.test(e))$.alert(ERR_USB_INVALID_CHAR_IN_FOLDER_NAME);else if($.asc(e))$.alert(ERR_USB_SHARE_NAME_NOT_ASCII);else if(t=a="",$.each(_,function(){this.name==f&&(a=this.uuid,t=this.label)}),""!=(s=$("#filename").val())){if(i=2==s.length||"ALL:"==s?"/":s.substring(s.indexOf(":")+1,s.length),"add"==R){for(l=0;l<u.length;l++){if(i==u[l].name&&a==u[l].volumeUuid)return void $.alert(ERR_USB_DIR_EXIST);if($("#shareName").val()==u[l].alias)return void $.alert(ERR_USB_SHARE_NAME_EXIST)}o.name=i,o.alias=$("#shareName").val(),o.enable=1,o.needAuth=1==$("#ea").prop("data-checked")?1:0,r.name=i,r.alias=$("#shareName").val(),r.enable=1,r.needAuth=1==$("#ea").prop("data-checked")?1:0,r.writePermission=1==$("#wa").prop("data-checked")?7:3,c.name=i,c.alias=$("#shareName").val(),c.enable=1==$("#ems").prop("data-checked")?1:0,c.needAuth=1==$("#ea").prop("data-checked")?1:0,INCLUDE_STORAGE_HTTP_SERVICE&&(d.name=i,d.alias=$("#shareName").val(),d.enable=1,d.needAuth=1==$("#ea").prop("data-checked")?1:0,d.readOnly=1==$("#wa").prop("data-checked")?0:1),""!=a&&(o.volumeUuid=a,r.volumeUuid=a,c.volumeUuid=a,INCLUDE_STORAGE_HTTP_SERVICE&&(d.volumeUuid=a)),""!=t&&(o.volumeLabel=t,r.volumeLabel=t,c.volumeLabel=t,INCLUDE_STORAGE_HTTP_SERVICE&&(d.volumeLabel=t)),$.act(ACT_ADD,SMB_SERVICE_FOLDER,null,null,o),u=$.act(ACT_GL,SMB_SERVICE_FOLDER,null,null,null),$.act(ACT_ADD,FTP_SERVER_FOLDER,null,null,r),h=$.act(ACT_GL,FTP_SERVER_FOLDER,null,null,null),$.act(ACT_ADD,DLNA_MEDIA_SERVER_FOLDER,null,null,c),E=$.act(ACT_GL,DLNA_MEDIA_SERVER_FOLDER,null,null,null),INCLUDE_STORAGE_HTTP_SERVICE&&($.act(ACT_ADD,STORAGE_HTTP_FOLDER,null,null,d),A=$.act(ACT_GL,STORAGE_HTTP_FOLDER,null,null,null))}else{for(l=0;l<u.length;l++){if($("#shareName").val()==u[l].alias&&l!=p)return void $.alert(ERR_USB_SHARE_NAME_EXIST);if(i==u[l].name&&a==u[l].volumeUuid&&l!=p)return void $.alert(ERR_USB_DIR_EXIST)}o.name=i,o.alias=$("#shareName").val(),o.needAuth=1==$("#ea").prop("data-checked")?1:0,r.name=i,r.alias=$("#shareName").val(),r.needAuth=1==$("#ea").prop("data-checked")?1:0,r.writePermission=1==$("#wa").prop("data-checked")?7:3,c.name=i,c.alias=$("#shareName").val(),c.enable=1==$("#ems").prop("data-checked")?1:0,c.needAuth=1==$("#ea").prop("data-checked")?1:0,INCLUDE_STORAGE_HTTP_SERVICE&&(d.name=i,d.alias=$("#shareName").val(),d.needAuth=1==$("#ea").prop("data-checked")?1:0,d.readOnly=1==$("#wa").prop("data-checked")?0:1),""!=a&&(o.volumeUuid=a,r.volumeUuid=a,c.volumeUuid=a,INCLUDE_STORAGE_HTTP_SERVICE&&(d.volumeUuid=a)),""!=t&&(o.volumeLabel=t,r.volumeLabel=t,c.volumeLabel=t,INCLUDE_STORAGE_HTTP_SERVICE&&(d.volumeLabel=t)),$.act(ACT_SET,SMB_SERVICE_FOLDER,u[p].__stack,null,o),u=$.act(ACT_GL,SMB_SERVICE_FOLDER,null,null,null),$.act(ACT_SET,FTP_SERVER_FOLDER,h[p].__stack,null,r),h=$.act(ACT_GL,FTP_SERVER_FOLDER,null,null,null),$.act(ACT_SET,DLNA_MEDIA_SERVER_FOLDER,E[p].__stack,null,c),E=$.act(ACT_GL,DLNA_MEDIA_SERVER_FOLDER,null,null,null),INCLUDE_STORAGE_HTTP_SERVICE&&($.act(ACT_SET,STORAGE_HTTP_FOLDER,A[p].__stack,null,d),A=$.act(ACT_GL,STORAGE_HTTP_FOLDER,null,null,null))}$.exe(function(e){if(e)$.removeLoading();else{"add"==R?(n=u[T].__stack,h[T].__stack,INCLUDE_STORAGE_HTTP_SERVICE&&A[T].__stack):(n=u[p].__stack,h[p].__stack,INCLUDE_STORAGE_HTTP_SERVICE&&A[p].__stack);var a=1,t={};for(l=0;l<userAccessList_samba.length;l++)parseInt(n,10)==parseInt(userAccessList_samba[l].__stack,10)&&(parseInt(userList[0].__stack,10)==userAccessList_samba[l].userId&&((t.userId=1)==$("#wa").prop("data-checked")?t.permissions=7:t.permissions=3),$.act(ACT_SET,SMB_USER_ACCESS,userAccessList_samba[l].__stack,null,t),a=0);1==a&&((t.userId=1)==$("#wa").prop("data-checked")?t.permissions=7:t.permissions=3,$.act(ACT_ADD,SMB_USER_ACCESS,null,n,t)),$.exe(function(e){if(e)$.removeLoading();else if($.act(ACT_SET,SMB_SERVICE,null,null,["modified=0"]),$.act(ACT_SET,FTP_SERVER,null,null,["modified=0"]),!$.exe()){$.removeLoading();var a={};a.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",a)}})}})}else $.alert(CMM_USB_BROWSE_FOLDER_PATH);else $.alert(ERR_USB_SHARE_NAME_EMPTY)}),$("#edit-cancel").click(function(){var e={};e.scrollTop=$("#scroll").scrollTop(),$.loadMain("usbManage.htm",e)})}()</script>
