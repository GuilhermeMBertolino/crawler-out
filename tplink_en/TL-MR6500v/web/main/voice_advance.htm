<h3 class="T" id="t_st0">Telephony Mode</h3>
<div class="content-container">
    <p class="cfg-line T_selectmode">Select the telephony mode.</p>
    <form class="pure-form pure-form-aligned">
        <div id="voip-mode">
            <input type="radio" name="voipMode" onclick="selectMode(1)" id="voip-opt">
            <label id="t_st1">VoIP</label>
            <input type="radio" name="voipMode" onclick="selectMode(0)" id="volte-opt">
            <label class="T_volte">VoLTE</label>
        </div>
    </form>
	<div style="text-align:right" class="part-separate">
        <button type="submit" class="green inline T_save" id="voice_save" onclick="saveModeSwitch(event,0)">Save</button>
    </div>
</div>
<div id="volte-field" class="nd">
    <hr style="margin-bottom:30px;border-top:0 none;border-bottom:1px solid #ccc">
    <form class="pure-form pure-form-aligned">
        <div class="button-group-container" id="a_mobileDataSwitch">
            <b class="xl T_volte">VoLTE</b>
            <ul><li><button id="volte-enable" class="fst" value="on" onclick="toggleVolteSwitch(event,1)">On</button></li>
                <li><button id="volte-disable" class="lst" value="off" onclick="toggleVolteSwitch(event,0)">Off</button></li>
            </ul>
        </div>
    </form>
    <p class="cfg-line T_enablelte" style="margin-top:16px;margin-bottom:30px">By enabling this mode, you can make or receive phone calls over the 4G LTE network.</p>
    <p class="cfg-line T_carriersupport" style="color:#a7a9ac">Note: To use this feature, your carrier must also support VoLTE calls. If you are not sure about it, contact your carrier for help.</p>
</div>
<div id="voip-field" class="nd">
    <h3 class="T" id="t_st1">VoIP</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="table-op" id="addItem">
            <div class="table-btn">
                <span id="refresh" class="refresh-icon"></span>
                <label class="T_refresh">Refresh</label>
                <span id="add" class="add-icon"></span>
                <label class="T_add">Add</label>
                <span id="delAll" class="delete-all-icon"></span>
                <label class="T_delall">Delete All</label>
            </div>
        </div>
        <table id="table-number">
            <thead></thead>
            <tbody id="body-number">
                <tr id="edit-container-number" class="nd">
                    <td colspan="4">
                        <div>
                            <b class="T_telephonyprovider">Telephony Provider: </b>
                            <select id="provider_list">
                            </select>
                        </div>
                        <div id="_isp_advanced" class="nd">
                            <div class="advanced-block">
                                    <span class="advanced-icon advanced-hide-icon" id="moreCfg" onclick="moreCfgSwitch(this)"></span>
                                <span class="T_adv">Advanced</span>
                            </div>
                            <div id="con_More" class="nd">
                                <div>
                                    <b class="T_registrarport">Registrar Port:</b>
                                    <input type="text" size="30" id="regPort" value="5060">
                                </div>
                                <div>
                                    <b class="T_sipproxy">SIP Proxy:</b>
                                    <input type="text" maxlength="42" id="SipProxyAddr" value="0.0.0.0">
                                </div>
                                <div>
                                    <b class="T_sipproxy">SIP Proxy:</b>
                                    <select id="SipProxyAddr_select"></select>
                                </div>
                                <div>
                                    <b class="T_sipproxyport">SIP Proxy Port:</b>
                                    <input type="text" size="30" id="SipProxyPort" value="5060">
                                </div>
                                <div>
                                    <b class="T_outboundproxy">Outbound Proxy:</b>
                                    <input type="text" maxlength="42" id="ObProxyAddr" value="0.0.0.0">
                                </div>
                                <div>
                                    <b class="T_outboundproxy">Outbound Proxy:</b>
                                    <select id="ObProxyAddr_select"></select>
                                </div>
                                <div>
                                    <b class="T_outboundproxyport">Outbound Proxy Port:</b>
                                    <input type="text" size="30" id="ObProxyPort" value="5060">
                                </div>
                                <br>
                                <div>
                                    <input type="checkbox" id="RegViaOB">
                                    <label class="T_label1">Register via Outbound Proxy</label>
                                </div>
                            </div>
                        </div>
                        <div class="inline-btn-right">
                            <button type="submit" class="green T_cancel" id="cancel">Cancel</button>
                            <button type="submit" class="green T_save" id="t_save">Save</button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>
<div id="areacodePanel" class="nd">
    <h3 class="T" id="t_st3">Area Code Setting</h3>
    <div class="content-container">
        <form class="pure-form pure-form-aligned">
            <p class="cfg-line T_areacodeinfo"> By enabling and entering your area code here</p>
            <div class="button-group-container">
                <b class="T" id="t_status">Status:</b>
                <ul>
                    <li>
                        <button id="AreaCode_on" class="fst" value="on">On</button>
                    </li>
                    <li>
                        <button id="AreaCode_off" class="lst" value="off">Off</button>
                    </li>
                </ul>
            </div>
            <div>
                <b class="T_areacode1">AreaCode: </b>
                <input type="text" maxlength="8" id="AreaCode">
            </div>
			<div class="part-separate" id="expt_label">
				<label class="T_exception">Exception: </label>
			</div>
			<div style="line-height:36px" id="expt_num">
            <span id="addNumIcon">
                <span class="table-icon add-icon" style="margin-left:0"></span>
                <label class="table-icon-text T" id="t_addnum">Add more numbers</label>
				<br>
				</span>
			</div>
            <div class="btn-right">
                <button type="submit" class="green T_save" id="saveAreaCode">Save</button>
            </div>
        </form>
    </div>
</div>
<h3 class="T" id="t_st2">Advance Settings</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="advanced-block">
            <span class="advanced-icon advanced-hide-icon" id="moreCfg1" onclick="moreCfgSwitch1(this)"></span>
            <span class="T_adv">Advanced</span>
        </div>
        <div id="con_More1" class="nd">
            <div>
                <b class="xxl T" id="t_bound">Bound Interface Name:</b>
                <select class="xxl" id="ifName">
                </select>
            </div>
            <div>
                <b class="xxl T_locale">Locale Selection:</b>
                <select class="l" id="localeName">
                </select>
            </div>
            <div>
                <b class="xxl T" id="t_dscpsip">DSCP for SIP:</b>
                <select class="l" id="tosByteSip">
                    <option value="46" selected="selected">EF (101110)</option>
                    <option value="14">AF13 (001110)</option>
                    <option value="12">AF12 (001100)</option>
                    <option value="10">AF11 (001010)</option>
                    <option value="8">CS1 (001000)</option>
                    <option value="22">AF23 (010110)</option>
                    <option value="20">AF22 (010100)</option>
                    <option value="18">AF21 (010010)</option>
                    <option value="16">CS2 (010000)</option>
                    <option value="30">AF33 (011110)</option>
                    <option value="28">AF32 (011100)</option>
                    <option value="26">AF31 (011010)</option>
                    <option value="24">CS3 (011000)</option>
                    <option value="38">AF43 (100110)</option>
                    <option value="36">AF42 (100100)</option>
                    <option value="34">AF41 (100010)</option>
                    <option value="32">CS4 (100000)</option>
                    <option value="40">CS5 (101000)</option>
                    <option value="48">CS6 (110000)</option>
                    <option value="56">CS7 (111000)</option>
                </select>
            </div>
            <div>
                <b class="xxl T" id="t_dscprtp">DSCP for RTP:</b>
                <select class="l" id="tosByteRtp">
                    <option value="46" selected="selected">EF (101110)</option>
                    <option value="14">AF13 (001110)</option>
                    <option value="12">AF12 (001100)</option>
                    <option value="10">AF11 (001010)</option>
                    <option value="8">CS1 (001000)</option>
                    <option value="22">AF23 (010110)</option>
                    <option value="20">AF22 (010100)</option>
                    <option value="18">AF21 (010010)</option>
                    <option value="16">CS2 (010000)</option>
                    <option value="30">AF33 (011110)</option>
                    <option value="28">AF32 (011100)</option>
                    <option value="26">AF31 (011010)</option>
                    <option value="24">CS3 (011000)</option>
                    <option value="38">AF43 (100110)</option>
                    <option value="36">AF42 (100100)</option>
                    <option value="34">AF41 (100010)</option>
                    <option value="32">CS4 (100000)</option>
                    <option value="40">CS5 (101000)</option>
                    <option value="48">CS6 (110000)</option>
                    <option value="56">CS7 (111000)</option>
                </select>
            </div>
            <div>
                <b class="xxl T" id="t_dtmf">Dtmf Relay setting:</b>
                <select class="l" id="dtmfRelay">
                    <option class="T" id="t_sipinfo" value="SIPInfo">SIPInfo</option>
                    <option value="RFC2833">RFC2833</option>
                    <option class="T" id="t_inband" value="InBand">InBand</option>
                </select>
            </div>
            <div>
                <b class="xxl T" id="t_registimeout">Registration Expire Timeout:</b>
                <input type="text" class="text" id="regExpTmr">
                <span class="T" id="t_timeout">(300~3600 seconds)</span>
            </div>
            <div>
                <b class="xxl T" id="t_regisinterval">Registration Retry Interval:</b>
                <input type="text" class="text" id="regRetryInt">
                <span class="T" id="t_interval">(30~300 seconds)</span>
            </div>
            <div>
                <b class="xxl T" id="t_name">"No answer" time: </b>
                <input type="text" id="noans_time">
                <span class="T" id="t_sec">(5~60 seconds)</span>
            </div>
            <div class="nd">
                <b class="xxl T" id="t_sipprotocol">SIP Transport protocol:</b>
                <select id="transport">
                </select>
            </div>
            <div>
                <b class="xxl T" id="t_t38support">T38 support: </b>
                <input type="checkbox" id="t38Enable" value="YES">
                <label class="T_enable">Enable</label>
            </div>
            <div class="nd">
                <input type="checkbox" id="enblTagMat" value="Yes">
                    <label class="T" id="t_siptag" for="enblTagMat">Enable SIP tag matching (Uncheck for Vonage
                        Interop).</label>
            </div>
            <div>
                <b class="xxl T" id="t_end">End With '#': </b>
                <input type="checkbox" id="end">
                <label class="T_enable">Enable</label>
            </div>
            <button type="submit" class="green T_save" id="saveAdv">Save</button>
        </div>
    </form>
</div>
</div>
<script>var voipCodecs,editIsp,country,ips,ppps,numList,switchObj,curStk=[],curIndex=-1,editFlag=0,intervalArray=[],modeIdArray=new Array(0,0,0,0,0,0,0,0),numId=new Array,NWK_PREFER_MODE_2G_ONLY=0,NWK_PREFER_MODE_3G_ONLY=1,NWK_PREFER_MODE_4G_ONLY=2,NWK_PREFER_MODE_4G_FIRST=3,headArray=[{text:table_str.status,width:"5%"},{text:table_str.telnumber,width:"25%"},{text:table_str.provider,width:"20%"},{text:table_str.modify,width:"20%"}];function getStack(){var e=$.act(ACT_GL,XTP_MULTI_ISP,null,null,["multiExtension"]);if(0==$.exe()){for(var t=0;t<e.length;t++)if(!e[t].multiExtension||""==e[t].multiExtension)return curStk=e[t].__stack,curIndex=t,!0;return!(curIndex=-1)}}function doDel(t){$.confirm(c_str.voice_del_con,function(){var e={multiExtension:"",multiAccountInRoute:0,multiAuthPassword:"",multiAuthUserName:"",multiIspName:"",multiOutboundProxy:"0.0.0.0",multiOutboundProxyPort:5060,multiProfileName:"",multiProxyServer:"0.0.0.0",multiProxyServerPort:5060,multiRegisterViaOB:2,multiRegistrarServer:"0.0.0.0",multiRegistrarServerPort:5060,multiVoipNum:"",multiVoipPrefixNum:""};$.act(ACT_SET,XTP_MULTI_ISP,t,null,e),actForSendMsg(),$.exe(function(e){e||($.voipTelePhoneNumbersNeedToRefresh=!0,pageReload())})})}function doEdit(e){editFlag=1,curStk=e;var t=$.act(ACT_GET,XTP_MULTI_ISP,e,null,null);0==$.exe()&&($("#provider_list").ispMgr("data",t),editIsp=$("#provider_list").data("value"))}function advEnterCheck(){var e,t,a,i={};try{e=n_str.voice_advance.t_name,i=$("#noans_time"),a="noans_time",t=getNumValue1(a,e,5,60,!0),i.get(0).value=t,e=n_str.voice_advance.t_registimeout,i=$("#regExpTmr"),a="regExpTmr",t=getNumValue1(a,e,300,3600,!0),i.get(0).value=t,e=n_str.voice_advance.t_regisinterval,i=$("#regRetryInt"),a="regRetryInt",t=getNumValue1(a,e,30,300,!0),i.get(0).value=t}catch(e){if(!1===e)return!1;throw e}return!0}function init(){$.removeLoading();var e,t,a=VOICE_CAPABILITIES,i=a.X_TP_LocaleList.split(","),n=a.regions.split(","),r="",l="",o="";$.each(i,function(e,t){for(var a=this.split("-"),i=0;i<n.length;i++)n[i]==a[0]&&(o=n[i],l=a[0]+" - "+a[1],r+="<option value='"+o+"' text='"+l+"' >"+l+"</option>")}),$("#localeName").empty().append(r);VOICE_CAP_SIP.transports.split(",");r="<option value='UDP' text='UDP' >UDP</option>",$("#transport").empty().append(r),$.auto(freshStatus,VOICE_FRESH_TIME,!0),voipVoiceProfileList=$.act(ACT_GL,VOICE_PROF,null,null,["DTMFMethod","region"]),voipFaxT38List=$.act(ACT_GL,VOICE_PROF_FAXT38,null,null,["enable"]),voipSIPList=$.act(ACT_GL,VOICE_PROF_SIP,null,null,["registrarServerTransport","X_TP_ToTagMatching","DSCPMark","registerExpires","registerRetryInterval"]),voipRTPList=$.act(ACT_GL,VOICE_PROF_RTP,null,null,["DSCPMark"]),voipVoiceServiceList=$.act(ACT_GL,VOICE,null,null,["X_TP_BoundIfName"]),switchObj=$.act(ACT_GET,SYS_MODE,null,null,["VOIPSwitch","VOLTESwitch"]);var s=$.act(ACT_GL,VOICE_PROF_LINE_CALLFEAT,null,null,["X_TP_OutgoingCallEndWithSharp","X_TP_DoNotDisturbStart","X_TP_CallForwardOnNoAnswerThresholdTime"]);if(0==$.exe()){e=switchObj.VOIPSwitch,t=switchObj.VOLTESwitch;var d=voipVoiceProfileList[0],c=voipFaxT38List[0],u=voipSIPList[0],_=voipRTPList[0],p=voipVoiceServiceList[0];selectMode(e),"1"==e?($("#voip-field").show(),$("#volte-field").hide()):($("#voip-field").hide(),$("#volte-field").show()),"1"==t?($("#volte-enable").addClass("selected"),$("#volte-disable").removeClass("selected")):($("#volte-enable").removeClass("selected"),$("#volte-disable").addClass("selected")),$('#transport option[value="'+u.registrarServerTransport+'"]').prop("selected","selected"),$("#t38Enable").prop("checked","1"==c.enable),$("#enblTagMat").prop("checked","1"==u.X_TP_ToTagMatching),$('#dtmfRelay option[value="'+d.DTMFMethod+'"]').prop("selected","selected"),$('#tosByteSip option[value="'+u.DSCPMark+'"]').prop("selected","selected"),$('#tosByteRtp option[value="'+_.DSCPMark+'"]').prop("selected","selected"),$("#regExpTmr").prop("value",u.registerExpires),$("#regRetryInt").prop("value",u.registerRetryInterval),$('#ifName option[value="'+p.X_TP_BoundIfName+'"]').prop("selected","selected"),$('#localeName option[value="'+d.region+'"]').prop("selected","selected"),$("#localeName").prop("disabled",!0),$("#end").prop("checked","1"==s[0].X_TP_OutgoingCallEndWithSharp),$("#noans_time").prop("value",s[0].X_TP_CallForwardOnNoAnswerThresholdTime);var m={refresh:1};$("#starthour").tpSelect(m),$("#startminute").tpSelect(m),$("#endthour").tpSelect(m),$("#endtminute").tpSelect(m),$("#transport").tpSelect(m),$("#dtmfRelay").tpSelect(m),$("#tosByteSip").tpSelect(m),$("#tosByteRtp").tpSelect(m),$("#ifName").tpSelect(m),$("#localeName").tpSelect(m)}}function initTable(){var a=[],e=$.act(ACT_GL,XTP_MULTI_ISP,null,null,["multiProfileName","multiRegistrarServer","multiExtension","multiStatus","MultiIspName","multiVoipPrefixNum","multiVoipNum"]);if(0==$.exe()){var i=0;$.each(e,function(){var e=0;if(this.multiExtension&&""!=this.multiExtension){e=parseInt(this.multiStatus,10)<=0?0:1;var t="["+this.__stack+"]";e?a.push([{text:"<span class='table-grid-icon conn-status' data-stack=\""+this.__stack+'"></span>',width:"5%"},{text:"1&1 Internet"===this.multiIspName?""+this.multiVoipPrefixNum+this.multiVoipNum:this.multiProfileName,width:"25%"},{text:"Other"==this.multiIspName?$.tpLang.s_str.otherprovider:this.multiIspName,width:"25%"},{text:"<span class='table-grid-icon edit-modify-icon' id='edit_"+i+"' onclick='doEdit("+t+");'></span><span class='table-grid-icon edit-trash-icon' id='del_"+i+"' onclick='doDel("+t+");'></span>",width:"20%"}]):a.push([{text:"<span class='table-grid-icon disconn-status' data-stack=\""+this.__stack+'"></span>',width:"5%"},{text:"1&1 Internet"===this.multiIspName?""+this.multiVoipPrefixNum+this.multiVoipNum:this.multiProfileName,width:"25%"},{text:"Other"==this.multiIspName?$.tpLang.s_str.otherprovider:this.multiIspName,width:"25%"},{text:"<span class='table-grid-icon edit-modify-icon' id='edit_"+i+"' onclick='doEdit("+t+");'></span><span class='table-grid-icon edit-trash-icon' id='del_"+i+"' onclick='doDel("+t+");'></span>",width:"20%"}])}i++}),$.initTableBody($("#table-number"),a),0<a.length&&!0===$.voipTelePhoneNumbersNeedToRefresh&&(refreshConnectStatus(),$.voipTelePhoneNumbersNeedToRefresh=null),$("#provider_list").ispMgr({domID:"_isp_advanced"})}}function freshStatus(){var e=$.act(ACT_GL,WAN_IP_CONN,null,null,["enable","name","X_TP_IfName","connectionType"]),t=$.act(ACT_GL,WAN_PPP_CONN,null,null,["enable","name","X_TP_IfName"]);if(INCLUDE_L2TP)var a=$.act(ACT_GL,WAN_L2TP_CONN,null,null,["enable","name","ifName"]);if(INCLUDE_PPTP)var i=$.act(ACT_GL,WAN_PPTP_CONN,null,null,["enable","name","ifName"]);if(0==$.exe()){var n="<option value='LAN' text='LAN'>"+showtype[8]+"</option><option value='Any_WAN' text='Any_WAN'>"+showtype[9]+"</option>",r="",l="",o=$("#ifName").data("value");$.each(e,function(e,t){0!=this.X_TP_IfName.length&&this.connectionType==MDMVS_IP_ROUTED&&1==this.enable&&(r=this.X_TP_IfName,l=this.name,n+="<option value='"+r+"' text='"+l+"' >"+l+"</option>")}),$.each(t,function(e,t){0!=this.X_TP_IfName.length&&1==this.enable&&(r=this.X_TP_IfName,l=this.name,n+="<option value='"+r+"' text='"+l+"' >"+l+"</option>")}),INCLUDE_L2TP&&$.each(a,function(e,t){0!=this.ifName.length&&1==this.enable&&(r=this.ifName,l=this.name,n+="<option value='"+r+"' text='"+l+"' >"+l+"</option>")}),INCLUDE_PPTP&&$.each(i,function(e,t){0!=this.ifName.length&&1==this.enable&&(r=this.ifName,l=this.name,n+="<option value='"+r+"' text='"+l+"' >"+l+"</option>")}),$("#ifName").empty().append(n),$('#ifName option[value="'+o+'"]').prop("selected","selected");$("#ifName").tpSelect({refresh:1})}}function refreshConnectStatus(r,l,a){r=r||1e3,l=l||15,a=a||3e3,$("#table-number span.table-grid-icon.disconn-status, #table-number span.table-grid-icon.conn-status").each(function(){var i=this,e=$(i).attr("data-stack");if(e){$(i).removeClass("disconn-status conn-status").addClass("loading-icon");var n=0,t=setInterval(function(){var a=setInterval(function(){if(0!=$("body").find($(i)).length){n++;var t=$.act(ACT_GET,XTP_MULTI_ISP,e,null,null);$.exe(function(e){e||(parseInt(t.multiStatus,10)<=0?l<=n&&($(i).removeClass("loading-icon").addClass("disconn-status"),clearInterval(a)):($(i).removeClass("loading-icon").addClass("conn-status"),clearInterval(a)))})}else clearInterval(a)},r);intervalArray.push(a),clearInterval(t)},a);intervalArray.push(t)}})}function pageReload(){for(;0<intervalArray.length;)clearInterval(intervalArray.pop());$.reload()}function enterCheckArea(){var e,t,a,i;try{if(a=s_str.areacode,t=$("#AreaCode"),i="AreaCode",e=getValue(i,a,0,8,!1),t.get(0).value=e,checkNum(t,a),1===INCLUDE_AREACODE){for(var n=[],r=0;r<modeIdArray.length;r++)modeIdArray[r]&&(t=$("#num_"+r),i="num_"+r,a=s_str.num,getValue(i,a,3,32),t.get(0).value=getValue(i,a,3,32),checkNum(t,a),n.push(t.get(0).value));for(var l=0;l<n.length-1;l++)for(var o=l+1;o<n.length;o++){if(n[o]==n[l])throw $.alert(ERR_VOIP_THROUGHT_NUMBER_CONFLICT_ERROR),!1;if(0==n[o].indexOf(n[l])||0==n[l].indexOf(n[o]))throw $.alert(ERR_VOIP_NUMBER_HEAD_SAME_ERROR),!1}}}catch(e){if(!1===e)return!1;throw e}return!0}function moreCfgSwitch(e){$(e).hasClass("cln")?($("#con_More").addClass("nd"),$(e).removeClass("cln")):($("#con_More").removeClass("nd"),$(e).addClass("cln"))}function moreCfgSwitch1(e){$(e).hasClass("cln")?($("#con_More1").addClass("nd"),$(e).removeClass("cln")):($("#con_More1").removeClass("nd"),$(e).addClass("cln"))}function selectMode(e){"1"==e?$("#voip-opt").prop("checked",!0):$("#volte-opt").prop("checked",!0)}function saveModeSwitch(e){var t={};$("#voip-opt").prop("checked")?t.VOIPSwitch="1":$("#volte-opt").prop("checked")&&(t.VOIPSwitch="0"),$.addLoading(),$.act(ACT_SET,SYS_MODE,null,null,t),$.exe(function(e){$.VOIPSwitch=parseInt(t.VOIPSwitch),$.reloadMenu($.curPage),$.helpContent={},$.loadScript("./locale/help_format.js")})}function toggleVolteSwitch(e,n){$.addLoading($(e.target)),$.act(ACT_SET,SYS_MODE,switchObj.__stack,null,["VOLTESwitch="+n]),$.exe(function(e){var t,a=$.act(ACT_GL,LTE_WAN_CFG,null,null,["networkPreferredMode"]),i=$.act(ACT_GL,WAN_COMMON_INTF_CFG,null,null,["WANAccessType"]);$.exe()||($.each(i,function(){"LTE"==this.WANAccessType&&(t=this.__stack)}),$.each(a,function(){var e=$.stkPop(this.__stack,1);if(t==e){this.__stack;"0"==n&&this.networkPreferredMode==NWK_PREFER_MODE_4G_ONLY&&($.act(ACT_SET,LTE_WAN_CFG,this.__stack,null,["networkPreferredMode="+NWK_PREFER_MODE_4G_FIRST]),$.exe())}})),$.removeLoading(),e||$.reload()})}function doReboot(){$.guage(["<span class='T_rebooting'>"+s_str.rebooting+"</span>","<span class='T T_wait_reboot'>"+s_str.wait_reboot+"</span>"],100,$.guageInterval,function(){$.refresh()}),$.act(ACT_OP,ACT_OP_REBOOT),$.exe(!0)}1===INCLUDE_AREACODE&&($("#areacodePanel").show(),$("#AreaCode_on").click(function(){$.addLoading($(this)),$.act(ACT_SET,XTP_IGD_AREA_CODE_CFG,areaCodeObj.__stack,null,["enable=1"]),actForSendMsg(),$.exe(function(e){$.removeLoading(),e||$.reload()}),$("#AreaCode").prop("disabled",!1)}),$("#AreaCode_off").click(function(){$.addLoading($(this)),$.act(ACT_SET,XTP_IGD_AREA_CODE_CFG,areaCodeObj.__stack,null,["enable=0"]),actForSendMsg(),$.exe(function(e){$.removeLoading(),e||$.reload()}),$("#AreaCode").prop("disabled",!0)}),$("#saveAreaCode").click(function(){if($.addLoading($(this)),1===INCLUDE_AREACODE)var e={};if(0!=enterCheckArea()){var t=$("#AreaCode").prop("value");if($.act(ACT_SET,XTP_IGD_AREA_CODE_CFG,areaCodeObj.__stack,null,["areaCode="+t]),1===INCLUDE_AREACODE){$.each(numList,function(){$.act(ACT_DEL,XTP_IGD_AREA_CODE_EXCEPTION,this.__stack,null)});for(var a=0;a<modeIdArray.length;a++)modeIdArray[a]&&(e.number=$("#num_"+a).prop("value"),$.act(ACT_ADD,XTP_IGD_AREA_CODE_EXCEPTION,null,null,e))}actForSendMsg(),$.exe(function(e){$.removeLoading(),e||$.reload()})}})),$("#addNumIcon").click(function(){for(var e=0;e<modeIdArray.length;e++)if(0==modeIdArray[e]){modeIdArray[e]=1;break}if(e>=modeIdArray.length)$.alert(ERR_VOIP_TELEPHONE_NUMBER_LIST_FULL_ERROR);else{$("#addNumIcon").parent("div").append('<div class="keyword"><input type="text" id="num_'+e+'" class="tp-input-text" required="true"/><span class="table-icon delete-icon"></span></div>');var t="#num_"+e;numId.push(t),$("span.delete-icon").click(function(){var e=$(this).parent("div.keyword").children("input").attr("id").split("_");modeIdArray[e[1]]=0,$(this).parent("div.keyword").remove()})}}),$("#delAll").click(function(){$.confirm(c_str.voice_del_allcon,function(){$.addLoading($(this));var e=!1,t=$.act(ACT_GL,XTP_MULTI_ISP,null,null,["multiExtension"]);if(0==$.exe()){for(var a=0;a<t.length;a++)if(t[a].multiExtension&&""!=t[a].multiExtension){var i={multiExtension:"",multiAccountInRoute:0,multiAuthPassword:"",multiAuthUserName:"",multiIspName:"",multiOutboundProxy:"0.0.0.0",multiOutboundProxyPort:5060,multiProfileName:"",multiProxyServer:"0.0.0.0",multiProxyServerPort:5060,multiRegisterViaOB:2,multiRegistrarServer:"0.0.0.0",multiRegistrarServerPort:5060,multiVoipNum:"",multiVoipPrefixNum:""};0==e&&(e=!0),$.act(ACT_SET,XTP_MULTI_ISP,t[a].__stack,null,i)}e?(actForSendMsg(),$.exe(function(e){$.removeLoading(),e||($.voipTelePhoneNumbersNeedToRefresh=!0,pageReload())})):$.removeLoading()}})}),$("#cancel").click(function(){pageReload()}),$("#refresh").click(function(){pageReload()}),$("#t_save").click(function(){if($.addLoading($(this)),!$("#provider_list").ispMgr("check"))return $.removeLoading(),!1;var e=$("#provider_list").ispMgr("data"),t=$("#provider_list").data("value");if(editFlag&&editIsp!=t||!editFlag&&getStack()){var a,i={},n=$.act(ACT_GS,XTP_MULTIISP_CODEC_LIST,null,curStk,["multiCodec","multiPacketizationPeriod","multiPriority"]);if(0!=$.exe())return;for(a=0;a<n.length;a++)(i={}).multiPriority=$("#provider_list").ispMgr("codec",n[a].multiCodec),i.multiPacketizationPeriod="20",$.act(ACT_SET,XTP_MULTIISP_CODEC_LIST,n[a].__stack,null,i)}if(1===INCLUDE_AREACODE){var r=$("#provider_list").ispMgr("data","areaCode");if(""===areaCodeObj.areaCode&&(r||e.multiVoipPrefixNum)){var l=r||e.multiVoipPrefixNum;$.act(ACT_SET,XTP_IGD_AREA_CODE_CFG,areaCodeObj.__stack,null,["areaCode="+l,"enable=1"])}}e.multiIspName==$.tpLang.s_str.otherprovider&&(e.multiIspName="Other"),editFlag?($.act(ACT_SET,XTP_MULTI_ISP,curStk,null,e),actForSendMsg(),$.exe(function(e){$.removeLoading(),e||($.voipTelePhoneNumbersNeedToRefresh=!0,pageReload())})):getStack()?($.act(ACT_SET,XTP_MULTI_ISP,curStk,null,e),actForSendMsg(),$.each(ips,function(){if("voip"==this.name&&0==this.enable)return $.act(ACT_SET,WAN_IP_CONN,this.__stack,null,["Enable=1"]),!1}),$.each(ppps,function(){if("voip"==this.name&&0==this.enable)return $.act(ACT_SET,WAN_PPP_CONN,this.__stack,null,["Enable=1"]),!1}),$.exe(function(e){$.removeLoading(),e||($.voipTelePhoneNumbersNeedToRefresh=!0,pageReload())})):$.alert(ERR_VOIP_ACCOUNT_MUCH_ADD_ERROR)}),$("#saveAdv").click(function(){$.addLoading($(this));var e={};if(e.X_TP_OutgoingCallEndWithSharp=1==$("#end").prop("data-checked")?"1":"0",e.X_TP_CallForwardOnNoAnswerThresholdTime=$("#noans_time").prop("value"),0!=advEnterCheck()){freshStatus();var t={},a={},i={},n={},r={},l={};n.X_TP_ToTagMatching=$("#enblTagMat").prop("data-checked")?"1":"0",i.enable=$("#t38Enable").prop("data-checked")?"1":"0",n.registrarServerTransport=$("#transport").data("value"),l.X_TP_BoundIfName=$("#ifName").data("value"),t.country=$("#localeName").data("value"),r.DSCPMark=$("#tosByteRtp").data("value"),n.DSCPMark=$("#tosByteSip").data("value"),a.DTMFMethod=$("#dtmfRelay").data("value"),0<$("#regRetryInt").prop("value")&&(n.registerRetryInterval=$("#regRetryInt").prop("value")),0<$("#regExpTmr").prop("value")&&(n.registerExpires=$("#regExpTmr").prop("value"));var o=$.act(ACT_GL,VOICE_PROF_LINE_CALLFEAT,null,null,["X_TP_OutgoingCallEndWithSharp","X_TP_DoNotDisturbStart","X_TP_CallForwardOnNoAnswerThresholdTime"]);0==$.exe()&&($.each(o,function(){$.act(ACT_SET,VOICE_PROF_LINE_CALLFEAT,this.__stack,null,e)}),$.act(ACT_SET,LOCAL,null,null,t),$.act(ACT_SET,VOICE_PROF,voipVoiceProfileList[0].__stack,null,a),$.act(ACT_SET,VOICE_PROF_FAXT38,voipFaxT38List[0].__stack,null,i),$.act(ACT_SET,VOICE_PROF_SIP,voipSIPList[0].__stack,null,n),$.act(ACT_SET,VOICE_PROF_RTP,voipRTPList[0].__stack,null,r),$.act(ACT_SET,VOICE,voipVoiceServiceList[0].__stack,null,l),actForSendMsg(),$.exe(function(e){$.removeLoading(),freshFlag=!0,e||($.voipTelePhoneNumbersNeedToRefresh=!0,pageReload())}))}}),function(){if(1===INCLUDE_AREACODE){if(areaCodeObj=$.act(ACT_GET,XTP_IGD_AREA_CODE_CFG,null,null,["enable","countryCode","areaCode"]),1===INCLUDE_AREACODE&&(numList=$.act(ACT_GL,XTP_IGD_AREA_CODE_EXCEPTION,null,null,null)),0!=$.exe())return;1==areaCodeObj.enable?($("#AreaCode_on").addClass("selected"),$("#AreaCode_off").removeClass("selected"),$("#AreaCode").prop("disabled",!1),""!=areaCodeObj.areaCode?($("#expt_label").removeClass("nd"),$("#expt_num").removeClass("nd")):($("#expt_label").addClass("nd"),$("#expt_num").addClass("nd"))):($("#AreaCode_off").addClass("selected"),$("#AreaCode_on").removeClass("selected"),$("#AreaCode").prop("disabled",!0),$("#expt_label").addClass("nd"),$("#expt_num").addClass("nd")),$("#AreaCode").prop("value",areaCodeObj.areaCode),1===INCLUDE_AREACODE&&$("#Exception").prop("value",areaCodeObj.exceptionCode)}if($.tpInit(init),$.initTableHead($("#table-number"),headArray),$("#table-number").tpTable(initTable),1===INCLUDE_AREACODE){if(numList.length)for(var e=0;e<numList.length;e++){$("#addNumIcon").parent("div").append('<div class="keyword"><input type="text" id="num_'+e+'" class="tp-input-text"/><span class="table-icon delete-icon"></span></div>'),modeIdArray[e]=1,$("#num_"+e).prop("value",numList[e].number);var t="#num_"+e;numId.push(t)}$("span.delete-icon").click(function(){var e=$(this).parent("div.keyword").children("input").attr("id").split("_");modeIdArray[e[1]]=0,$(this).parent("div.keyword").remove()})}ips=$.act(ACT_GL,WAN_IP_CONN,null,null,["Enable","Name"]),ppps=$.act(ACT_GL,WAN_PPP_CONN,null,null,["Enable","Name"]),$.exe(function(e){e&&$.alert(e)})}()</script>
