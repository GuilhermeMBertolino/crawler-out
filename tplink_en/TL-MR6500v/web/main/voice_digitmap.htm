<script language="javascript">var voipDigitMapList,voipDigitMapArray;function checkIegal(e){$.id("curmap");for(var r,t=0,a=0,c=0,i=0,s=0;s<e.length;s++)switch(e.charAt(s)){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(a){if(c){if(e.charCodeAt(s)<=t)return!1;c=0}}else i++;break;case"[":if(a)return!1;a=1;break;case".":return 1!=e.length&&((2!=e.length||"."!=e.charAt(0))&&(""==(r=e.charAt(s+1))||("t"==r||"T"==r||"#"==r)&&""==(r=e.charAt(s+2))));case"]":if(!a)return!1;if(((r=e.charCodeAt(s-1))<48||57<r)&&"X"!=e.charAt(s-1)&&"x"!=e.charAt(s-1)&&"*"!=e.charAt(s-1))return!1;a=0,i++;break;case"-":if(!a||c)return!1;if(c=1,!(48<=e.charCodeAt(s-1)&&e.charCodeAt(s-1)<=57))return!1;if(t=e.charCodeAt(s-1),!(48<=e.charCodeAt(s+1)&&e.charCodeAt(s+1)<=57))return!1;break;case"x":case"X":a||i++;break;case"t":case"T":return"."==(r=e.charAt(s-1))&&"\0"==(r=e.charAt(s+1));case"*":a||i++;break;case"#":if(a)return!1;i++;break;default:return!1}return!a&&3<=i}function checkEmerIegal(e){for(var r,t=0,a=0,c=0,i=0;i<e.length;i++)switch(e.charAt(i)){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(a){if(c){if(e.charCodeAt(i)<=t)return!1;c=0}}else 0;break;case"[":if(a)return!1;a=1;break;case".":return!1;case"]":if(!a)return!1;if((r=e.charCodeAt(i-1))<48||57<r)return!1;a=0,0;break;case"-":if(!a||c)return!1;if(c=1,!(48<=e.charCodeAt(i-1)&&e.charCodeAt(i-1)<=57))return!1;if(t=e.charCodeAt(i-1),!(48<=e.charCodeAt(i+1)&&e.charCodeAt(i+1)<=57))return!1;break;case"x":case"X":if(a)return!1;0;break;case"t":case"T":default:return!1}return!a}function EnterCheck(){var e,r,t;r=$.id("curmap").value,e=$.id("curmap"),curemerstr=$.id("curemercall").value,ctrlemer=$.id("curemercall"),t=""==r?[]:r.split("|");for(var a=0;a<t.length;a++){if(32<t[a].length)return alert(t[a]+n_str.voice_digitmap.t_alert1),setFocus(e),!1;if(0==t[a].length)return alert(n_str.voice_digitmap.t_alert2),setFocus(e),!1;if(0==checkIegal(t[a]))return alert(t[a]+n_str.voice_digitmap.t_alert3),setFocus(e),!1}t=""==curemerstr?[]:curemerstr.split("|");for(a=0;a<t.length;a++){if(32<t[a].length)return alert(t[a]+n_str.voice_digitmap.t_alert1),setFocus(ctrlemer),!1;if(0==t[a].length)return alert(n_str.voice_digitmap.t_alert2),setFocus(ctrlemer),!1;if(0==checkEmerIegal(t[a]))return alert(t[a]+n_str.voice_digitmap.t_alert3),setFocus(ctrlemer),!1}return!0}function SaveDigitMap(){var e,r;if(e=$.id("curmap"),r=$.id("curemercall"),0==EnterCheck())return!1;if(256<$.id("curmap").value.length)return alert(n_str.voice_digitmap.t_alert4),setFocus(e),!1;if(32<$.id("curemercall").value.length)return alert(n_str.voice_digitmap.t_alert5),setFocus(r),!1;var t={};t.digitMap=$.id("curmap").value,t.X_TP_EmergencyDigitMap=$.id("curemercall").value,$.act(ACT_SET,VOICE_PROF,voipDigitMapList[0].__stack,null,t),actForSendMsg(),$.addLoading($.id("saveBtn")),$.exe(function(e){e||$.loadMain("voice_digitmap.htm")})}function initDigitMap(){voipDigitMapList=$.act(ACT_GL,VOICE_PROF,null,null,["DigitMap","X_TP_EmergencyDigitMap"]),0==$.exe()&&($.id("curmap").value=voipDigitMapList[0].digitMap,$.id("curemercall").value=voipDigitMapList[0].X_TP_EmergencyDigitMap)}</script>
<p class="et" id="et"><b class="T_digitmap">DigitMap</b></p>
<div class="con1 XXL">
<p class="ct T_digitmap" id="et">DigitMap</p>
<p class="bl"></p>
<table align="center" class="bdr XXXL" cellpadding="10" cellspacing="0">
		<tr>
			<th id="t_curDigMap">Current DigitMap </th><th><input id="curmap" type="text" class="text" size="60" maxlength="256"><span id="t_max_256">(256 char max.)</span><span class="red">*</span></th>
		</tr>
		<tr>
			<th id="t_curEmeCall">Current Emergency Call </th><th><input id="curemercall" type="text" class="text" size="60" maxlength="32"><span id="t_max_32">(32 char max.)</span><span class="red">*</span></th>
		</tr>
</table>
<p class="bl"></p>
	<p class="st" id="t_examp">Example: digitmap settings</p>
	<table align="center" class="bdr XXXL" cellpadding="0" cellspacing="0">
		<tr>
			<th id="t_digitRule">Digitmap Rule</th>
			<th id="t_means">Means</th>
		</tr>
		<tr>
			<td>[2-5]</td>
			<td id="t_means1">match one digit between 2 and 5</td>
		</tr>
		<tr>
			<td>x</td>
			<td id="t_means2">match one digit between 0 and 9</td>
		</tr>
		<tr>
			<td>[57]</td>
			<td id="t_means3">5 or 7</td>
		</tr>
		<tr>
			<td>.</td>
			<td id="t_means4">repeat the previous digit 0 or more times</td>
		</tr>
		<tr>
			<td>t</td>
			<td id="t_means5">timeout</td>
		</tr>
		<tr>
			<td>3xxxx</td>
			<td id="t_means6">a digit string has 5 digits which begins with 3</td>
		</tr>
		<tr>
			<td>0x.t</td>
			<td id="t_means7">a digit string begins with 0 will be sent out after timeout </td>
		</tr>
		<tr>
			<td>0x.#</td>
			<td id="t_means8">a digit string begins with 0 will be sent out after # is dialed</td>
		</tr>
		<tr>
			<td>0x.</td>
			<td id="t_means9">a digit string begins with 0 will be sent out after timeout or # is dialed</td>
		</tr>
	</table>
<p class="bl"></p>
<p class="tail">
<input id="saveBtn" type="button" class="button L T T_save" value="Save" onclick="SaveDigitMap()">
</p>
</div>
<script language="javascript">$.loadHelp(),initDigitMap()</script>
