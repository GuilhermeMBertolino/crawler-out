<script language="javascript">var adsls,vdsls,ips,ppps,wans,defaultHostname="",gatewayStack="",gatewayType="",portMappingList={},portTriggerList={},dslStack="",bIptvAvailable=!0,bVoipAvailable=!0,bDelGateway=!1,voipVoiceService={},iptvConn={},voipConn={},adslAnnexType="",vdslAnnexType="";function getVoiceInfo(){var s=$.act(ACT_GL,VOICE,null,null,["X_TP_BoundIfName"]);$.exe()||(voipVoiceService=s[0])}function getGatewayInfo(){var t={},s=[],a=0;if(ppps=INCLUDE_WAN_VLAN?(ips=INCLUDE_MER?$.act(ACT_GL,WAN_IP_CONN,null,null,["name","connectionType","addressingType","externalIPAddress","subnetMask","defaultGateway","DNSServers","X_TP_8021QEnabled","X_TP_VlanID","X_TP_MerEnabled","X_TP_Username","X_TP_Password"]):$.act(ACT_GL,WAN_IP_CONN,null,null,["Name","ConnectionType","AddressingType","ExternalIPAddress","SubnetMask","DefaultGateway","DNSServers","X_TP_8021QEnabled","X_TP_VlanID"]),$.act(ACT_GL,WAN_PPP_CONN,null,null,["Name","TransportType","Username","Password","X_TP_8021QEnabled","X_TP_VlanID"])):(ips=INCLUDE_MER?$.act(ACT_GL,WAN_IP_CONN,null,null,["name","connectionType","addressingType","externalIPAddress","subnetMask","defaultGateway","DNSServers","X_TP_MerEnabled","X_TP_Username","X_TP_Password"]):$.act(ACT_GL,WAN_IP_CONN,null,null,["Name","ConnectionType","AddressingType","ExternalIPAddress","SubnetMask","DefaultGateway","DNSServers"]),$.act(ACT_GL,WAN_PPP_CONN,null,null,["Name","TransportType","Username","Password"])),wans=$.act(ACT_GL,WAN_COMMON_INTF_CFG,null,null,["WANAccessType"]),adsls=$.act(ACT_GL,WAN_DSL_LINK_CFG,null,null,["Enable","AutoConfig","DestinationAddress","LinkType","ATMEncapsulation"]),INCLUDE_VDSLWAN&&(vdsls=$.act(ACT_GL,WAN_PTM_LINK_CFG,null,null,["Enable","X_TP_Used","X_TP_VID"])),INCLUDE_WAN_MODE&&"DSL"!=$.qd.realMode){if(INCLUDE_WAN_MODE&&("ETH"==$.qd.realMode||"USB_3G"==$.qd.realMode)){if(lastMode=$.act(ACT_GET,SYS_MODE,null,null,["DSLL3ForwardingName"]),$.exe())return;t.__ifAliasName=lastMode.DSLL3ForwardingName}}else if(t=$.act(ACT_GET,L3_FORWARDING,null,null,["__ifAliasName"]),$.exe())return;for(a=0;a<ips.length;a++)s.push(ips[a]);for(a=0;a<ppps.length;a++)s.push(ppps[a]);$.qd.conns=[],$.qd.adsl={},$.qd.gw=void 0,INCLUDE_VDSLWAN&&($.qd.vdsl={}),$.each(s,function(){if("DSL"===$.arr2obj(wans,"__stack")[$.stkPop(this.__stack,2)].WANAccessType&&("iptv"==this.name?iptvConn=this:"voip"==this.name?voipConn=this:$.qd.conns.push(this),this.name===t.__ifAliasName))if(($.qd.gw=this).connectionType&&"IP_Routed"!=this.connectionType||(gatewayStack=this.__stack,gatewayType=this.connectionType?"ip":"ppp"),INCLUDE_VDSLWAN&&(isPTM=$.arr2obj(vdsls,"__stack")[$.stkPop(this.__stack)].X_TP_Used),INCLUDE_VDSLWAN&&1==isPTM)obj=$.arr2obj(vdsls,"__stack")[$.stkPop(this.__stack)],$.qd.vdsl={type:"vdsl",vid:obj.X_TP_VID,wan:$.stkPop(this.__stack,2)},"IP_Routed"==this.connectionType?"Static"==this.addressingType?($.qd.connType="staip",dns=this.DNSServers.split(","),$.qd.staip={ip:this.externalIPAddress,mask:this.subnetMask,gw:this.defaultGateway,dns:dns[0],dns2:dns[1]}):"DHCP"==this.addressingType&&($.qd.connType="dhcp",!INCLUDE_MER||"Sky(MER)_VDSL"!=$.qd.dsl.isp&&"Other"!=$.qd.dsl.isp||($.qd.dhcp={usr:this.X_TP_Username,pwd:this.X_TP_Password},"Other"==$.qd.dsl.isp&&($.qd.dhcp.merEnabled=this.X_TP_MerEnabled))):"PPPoE"==this.transportType&&($.qd.connType="ppp",$.qd.ppp={usr:this.username,pwd:this.password,cfm:this.password}),$.qd.gwInfo={vid:obj.X_TP_VID,type:$.qd.type};else{obj=$.arr2obj(adsls,"__stack")[$.stkPop(this.__stack)];var s=obj.destinationAddress.split(":")[1].split("/");INCLUDE_WAN_VLAN?$.qd.adsl={type:"adsl",vpi:s[0],vci:s[1],auto:1==obj.autoConfig,wan:$.stkPop(this.__stack,2),tagEnabled:this.X_TP_8021QEnabled,tag:this.X_TP_VlanID}:$.qd.adsl={type:"adsl",vpi:s[0],vci:s[1],auto:1==obj.autoConfig,wan:$.stkPop(this.__stack,2)},"EoA"==obj.linkType?"IP_Routed"==this.connectionType?"Static"==this.addressingType?($.qd.connType="staip",gatewayType="ip",dns=this.DNSServers.split(","),$.qd.staip={ip:this.externalIPAddress,mask:this.subnetMask,gw:this.defaultGateway,dns:dns[0],dns2:dns[1]}):"DHCP"==this.addressingType&&($.qd.connType="dhcp",gatewayType="ip",!INCLUDE_MER||"Sky(MER)_VDSL"!=$.qd.dsl.isp&&"Other"!=$.qd.dsl.isp||($.qd.dhcp={usr:this.X_TP_Username,pwd:this.X_TP_Password},"Other"==$.qd.dsl.isp&&($.qd.dhcp.merEnabled=this.X_TP_MerEnabled))):"PPPoE"==this.transportType&&($.qd.connType="ppp",gatewayType="ppp",$.qd.ppp={usr:this.username,pwd:this.password,cfm:this.password}):"IPoA"==obj.linkType?($.qd.connType="ipoa",gatewayType="ipoa",dns=this.DNSServers.split(","),$.qd.ipoa={ip:this.externalIPAddress,mask:this.subnetMask,gw:this.defaultGateway,dns:dns[0],dns2:dns[1]}):"PPPoA"==obj.linkType&&($.qd.connType="pppoa",gatewayType="pppoa",$.qd.pppoa={usr:this.username,pwd:this.password,cfm:this.password}),$.qd.gwInfo={vpi:s[0],vci:s[1],auto:1==obj.autoConfig,type:$.qd.type}}}),$.qd.adsl.wan||$.each(wans,function(){"DSL"===this.WANAccessType&&($.qd.adsl.wan=this.__stack)}),INCLUDE_VDSLWAN&&!$.qd.vdsl.wan&&$.each(wans,function(){"DSL"===this.WANAccessType&&($.qd.vdsl.wan=this.__stack)}),$.each(wans,function(){if("DSL"==this.WANAccessType)return dslStack=this.__stack,!1})}function doEnabledMer(){$("#enmer").prop("data-checked")?($.qd.dhcp.merEnabled=1,"dhcp"!=$("#vdslConnectionType").data("value")&&$("#vdslConnectionType").find("option[value=dhcp]").prop("selected","selected"),$("#div_dhcp_mer").fadeIn(200),$("#vdslConnectionType").attr("disabled",!0)):($.qd.dhcp.merEnabled=0,"dhcp"==$("#vdslConnectionType").data("value")&&$("#div_dhcp_mer").fadeOut(200),$("#vdslConnectionType").attr("disabled",!1)),$("#vdslConnectionType").tpSelect({refresh:1})}function doEnableVid(){$("#envid").prop("data-checked")?$("#div_vid").removeClass("nd"):$("#div_vid").addClass("nd")}function doEnableVtag(){$("#envtag").prop("data-checked")?$("#div_vtag").removeClass("nd"):$("#div_vtag").addClass("nd")}function initDSLParams(s,t,a,d,e,p){INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType?($("#vdsl_radio").prop("checked",!0),$("#div_vdsl").removeClass("nd"),$("#div_adsl").addClass("nd"),INCLUDE_WAN_VLAN&&$("#div_adslTag").addClass("nd"),void 0===d||0==d?($("#vid").val(1),$("#envid").prop("checked",""),$("#div_vid").addClass("nd")):($("#vid").val(d),$("#envid").prop("checked","checked"),$("#div_vid").removeClass("nd")),$("#vdslConnectionType").find("option[value="+p+"]").attr("selected",!0),1==s&&($("#envid").attr("disabled",!0),$("#vid").attr("disabled",!0),$("#vdslConnectionType").attr("disabled",!0)),"Other"!=$.qd.dsl.isp?($("#div_enVlan").addClass("nd"),$("#div_vid").addClass("nd"),$("#vdslConnectionType").attr("disabled",!0)):($("#div_enVlan").removeClass("nd"),void 0===d||0==d?$("#div_vid").addClass("nd"):$("#div_vid").removeClass("nd"))):($("#adsl_radio").prop("checked",!0),$("#div_vdsl").addClass("nd"),$("#div_adsl").removeClass("nd"),INCLUDE_WAN_VLAN&&$("#div_adslTag").removeClass("nd"),$("#adslConnectionType").find("option[value="+p+"]").attr("selected",!0),1==s?($("#vpi").val(t),$("#vpi").attr("disabled",!0),$("#vci").val(a),$("#vci").attr("disabled",!0),$("#adslConnectionType").attr("disabled",!0),INCLUDE_WAN_VLAN&&($("#envtag").attr("disabled",!0),$("#vtag").val(e),$("#vtag").attr("disabled",!0))):($("#vpi").val(t),$("#vpi").attr("disabled",!1),$("#vci").val(a),$("#vci").attr("disabled",!1),INCLUDE_WAN_VLAN&&(void 0===e||0==e?($("#vtag").val(7),$("#envtag").prop("checked",""),$("#div_vtag").addClass("nd")):($("#vtag").val(e),$("#envtag").prop("checked","checked"),$("#div_vtag").removeClass("nd")))),"Other"!=$.qd.dsl.isp?($("#div_vpi").addClass("nd"),$("#div_vci").addClass("nd"),INCLUDE_WAN_VLAN&&"Telekom(Privat)_ADSL"!=$.qd.dsl.isp&&$("#div_adslTag").addClass("nd"),$("#adslConnectionType").attr("disabled",!0)):($("#div_vpi").removeClass("nd"),$("#div_vci").removeClass("nd"),INCLUDE_WAN_VLAN&&$("#div_adslTag").removeClass("nd"))),INCLUDE_MER&&"Other"==$.qd.dsl.isp&&1==$.qd.dhcp.merEnabled&&($("#enmer").prop("checked",!0),$("#enmer").tpCheckbox())}function collectDslParams(){INCLUDE_VDSLWAN&&"Other"==$.qd.dsl.isp&&(1==$("#vdsl_radio").prop("checked")?$.qd.dslType="vdsl":$.qd.dslType="adsl"),INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType?($.qd.dsl.vid=0,$("#envid").prop("data-checked")&&($.qd.dsl.vid=parseInt($("#vid").val(),10))):($.qd.dslType="adsl",$.qd.dsl.vpi=parseInt($("#vpi").val(),10),$.qd.dsl.vci=parseInt($("#vci").val(),10),INCLUDE_WAN_VLAN&&($.qd.dsl.vtag=$.qd.dsl.vtag||0,!$("#div_adslTag").hasClass("nd")&&$("#envtag").prop("data-checked")&&($.qd.dsl.vtag=parseInt($("#vtag").val(),10))))}function doDslTypeChange(s){var t="";(t="vdsl"==s?($("#div_adsl").addClass("nd"),$("#div_vdsl").removeClass("nd"),$("#vdslConnectionType").data("value")):($("#div_adsl").removeClass("nd"),$("#div_vdsl").addClass("nd"),$("#adslConnectionType").data("value")))||(t="ppp"),"Other"==$.qd.dsl.isp&&INCLUDE_WAN_VLAN&&(-1!=t.search("oa")?$("#div_adslTag").addClass("nd"):$("#div_adslTag").removeClass("nd")),showConnType(t),INCLUDE_MER&&"dhcp"==t&&"vdsl"==s&&$("#enmer").prop("data-checked")?$("#div_dhcp_mer").fadeIn(200):$("#div_dhcp_mer").fadeOut(200)}function initPPPoEAttrs(){var s=!1;$.qd.ppp||($.qd.ppp={}),$.qd.ppp.usr&&$("#ppp_username").val($.qd.ppp.usr),$.qd.ppp.pwd&&($("#ppp_password").val($.qd.ppp.pwd),$("#ppp_cfmpassword").val($.qd.ppp.pwd)),INCLUDE_WAN_VLAN&&("Other"==$.qd.dsl.isp?(!INCLUDE_VDSLWAN||INCLUDE_VDSLWAN&&1==$("#adsl_radio").prop("checked"))&&(s=!0):$.qd.dsl.vtag&&(s=!0,$("#envtag").prop("checked",!0).data("tpCheckbox").refresh(),$("#envtag").prop("disabled",!0).data("tpCheckbox").refresh(),$("#div_vtag").removeClass("nd"),$("#vtag").val($.qd.dsl.vtag),$("#vtag").prop("disabled",!0))),s&&$("#div_adslTag").removeClass("nd")}function addPPPoEAttrs(){$.qd.ppp.usr=$("#ppp_username").val(),$.qd.ppp.pwd=$("#ppp_password").val(),$.qd.ppp.cfm=$("#ppp_cfmpassword").val()}function chkPPPoEAttrs(){return""==$.qd.ppp.usr?($.alert(ERR_USERNAME_INVAD),$("#ppp_username").focus(),$("#ppp_username").select(),!1):$.qd.ppp.pwd!==$.qd.ppp.cfm?($.alert(ERR_PWD_INVAD),$("#ppp_password").focus(),$("#ppp_password").select(),!1):void 0}function initPPPoAAttrs(){$.qd.pppoa||($.qd.pppoa={}),$.qd.pppoa.usr&&$("#pppoa_username").val($.qd.pppoa.usr),$.qd.pppoa.pwd&&($("#pppoa_password").val($.qd.pppoa.pwd),$("#pppoa_cfmpassword").val($.qd.pppoa.pwd)),INCLUDE_WAN_VLAN&&$("#div_adslTag").addClass("nd")}function addPPPoAAttrs(){$.qd.pppoa.usr=$("#pppoa_username").val(),$.qd.pppoa.pwd=$("#pppoa_password").val(),$.qd.pppoa.cfm=$("#pppoa_cfmpassword").val()}function chkPPPoAAttrs(){return""==$.qd.pppoa.usr?($.alert(ERR_USERNAME_INVAD),$("#pppoa_username").focus(),$("#pppoa_username").select(),!1):$.qd.pppoa.pwd!==$.qd.pppoa.cfm?($.alert(ERR_PWD_INVAD),$("#pppoa_password").focus(),$("#pppoa_password").select(),!1):void 0}function initStaticIpAttrs(){var s=!1;$.qd.staip||($.qd.staip={}),$.qd.staip.ip&&$("#staip").val($.qd.staip.ip),$.qd.staip.mask&&$("#staipmask").val($.qd.staip.mask),$.qd.staip.gw&&$("#staipgw").val($.qd.staip.gw),$.qd.staip.dns&&$("#staipdns1").val($.qd.staip.dns),$.qd.staip.dns2&&$("#staipdns2").val($.qd.staip.dns2),INCLUDE_WAN_VLAN&&("Other"==$.qd.dsl.isp?(!INCLUDE_VDSLWAN||INCLUDE_VDSLWAN&&1==$("#adsl_radio").prop("checked"))&&(s=!0):$.qd.dsl.vtag&&(s=!0,$("#envtag").prop("checked",!0).data("tpCheckbox").refresh(),$("#envtag").prop("disabled",!0).data("tpCheckbox").refresh(),$("#div_vtag").removeClass("nd"),$("#vtag").val($.qd.dsl.vtag),$("#vtag").prop("disabled",!0))),s&&$("#div_adslTag").removeClass("nd")}function addStaticIpAttrs(){$.qd.staip.ip=$("#staip").val(),$.qd.staip.mask=$("#staipmask").val(),$.qd.staip.gw=$("#staipgw").val(),$.qd.staip.dns=$("#staipdns1").val(),$.qd.staip.dns2=$("#staipdns2").val()}function chkStaticIpAttrs(){return $.ifip($.qd.staip.ip,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staip").focus(),$("#staip").select(),!1):$.mask($.qd.staip.mask,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staipmask").focus(),$("#staipmask").select(),!1):$.ipmask($.qd.staip.ip,$.qd.staip.mask,!0)?($.alert(ERR_IPMASK_HOST_INVAD),$("#staipmask").focus(),$("#staipmask").select(),!1):$.ifip($.qd.staip.gw,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staipgw").focus(),$("#staipgw").select(),!1):$.ipmask($.qd.staip.gw,$.qd.staip.mask,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staipgw").focus(),$("#staipgw").select(),!1):$.ipmaskgw($.qd.staip.ip,$.qd.staip.mask,$.qd.staip.gw,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staipgw").focus(),$("#staipgw").select(),!1):$.ifip($.qd.staip.dns,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staipdns1").focus(),$("#staipdns1").select(),!1):$.qd.staip.dns2&&0!==$.ip2num($.qd.staip.dns2)&&$.ifip($.qd.staip.dns2,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#staipdns2").focus(),$("#staipdns2").select(),!1):void 0}function initIPoAAttrs(){$.qd.ipoa||($.qd.ipoa={}),$.qd.ipoa.ip&&$("#ipoa").val($.qd.ipoa.ip),$.qd.ipoa.mask&&$("#ipoamask").val($.qd.ipoa.mask),$.qd.ipoa.gw&&$("#ipoagw").val($.qd.ipoa.gw),$.qd.ipoa.dns&&$("#ipoadns1").val($.qd.ipoa.dns),$.qd.ipoa.dns2&&$("#ipoadns2").val($.qd.ipoa.dns2),INCLUDE_WAN_VLAN&&$("#div_adslTag").addClass("nd")}function addIPoAAttrs(){$.qd.ipoa.ip=$("#ipoa").val(),$.qd.ipoa.mask=$("#ipoamask").val(),$.qd.ipoa.gw=$("#ipoagw").val(),$.qd.ipoa.dns=$("#ipoadns1").val(),$.qd.ipoa.dns2=$("#ipoadns2").val()}function chkIPoAAttrs(){return $.ifip($.qd.ipoa.ip,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoa").focus(),$("#ipoa").select(),!1):$.mask($.qd.ipoa.mask,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoamask").focus(),$("#ipoamask").select(),!1):$.ipmask($.qd.ipoa.ip,$.qd.ipoa.mask,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoa").focus(),$("#ipoa").select(),!1):$.ifip($.qd.ipoa.gw,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoagw").focus(),$("#ipoagw").select(),!1):$.ipmask($.qd.ipoa.gw,$.qd.ipoa.mask,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoa").focus(),$("#ipoa").select(),!1):$.ipmaskgw($.qd.ipoa.ip,$.qd.ipoa.mask,$.qd.ipoa.gw,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoa").focus(),$("#ipoa").select(),!1):$.ifip($.qd.ipoa.dns,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoadns1").focus(),$("#ipoadns1").select(),!1):$.qd.ipoa.dns2&&0!==$.ip2num($.qd.ipoa.dns2)&&$.ifip($.qd.ipoa.dns2,!0)?($.alert(ERR_STAIP_IP_INVAD),$("#ipoadns2").focus(),$("#ipoadns2").select(),!1):void 0}function initDynamicIPAttrs(){var s=!1;INCLUDE_WAN_VLAN&&("Other"==$.qd.dsl.isp?(!INCLUDE_VDSLWAN||INCLUDE_VDSLWAN&&1==$("#adsl_radio").prop("checked"))&&(s=!0):$.qd.dsl.vtag&&(s=!0,$("#envtag").prop("checked",!0).data("tpCheckbox").refresh(),$("#envtag").prop("disabled",!0).data("tpCheckbox").refresh(),$("#div_vtag").removeClass("nd"),$("#vtag").val($.qd.dsl.vtag),$("#vtag").prop("disabled",!0))),!INCLUDE_MER||"Sky(MER)_VDSL"!=$.qd.dsl.isp&&"Other"!=$.qd.dsl.isp||($.qd.dhcp||($.qd.dhcp={}),$.qd.dhcp.usr&&$("#dynamicip_username").val($.qd.dhcp.usr),$.qd.dhcp.pwd&&$("#dynamicip_password").val($.qd.dhcp.pwd)),s&&$("#div_adslTag").removeClass("nd")}function addDynamicIPAttrs(){$.qd.dhcp.usr=$("#dynamicip_username").val(),$.qd.dhcp.pwd=$("#dynamicip_password").val()}function chkDynamicIPAtts(){if(""==$.qd.dhcp.usr)return $.alert(ERR_USERNAME_INVAD),$("#dynamicip_username").focus(),$("#dynamicip_username").select(),!1}function initBridgeAttrs(){var s=!1;INCLUDE_WAN_VLAN&&("Other"==$.qd.dsl.isp?(!INCLUDE_VDSLWAN||INCLUDE_VDSLWAN&&1==$("#adsl_radio").prop("checked"))&&(s=!0):$.qd.dsl.vtag&&(s=!0,$("#envtag").prop("checked",!0).data("tpCheckbox").refresh(),$("#envtag").prop("disabled",!0).data("tpCheckbox").refresh(),$("#div_vtag").removeClass("nd"),$("#vtag").val($.qd.dsl.vtag),$("#vtag").prop("disabled",!0))),s&&$("#div_adslTag").removeClass("nd")}function setDefaultHostname(){var s,t=0,a="",d=0;for(t=0;t<$.model.length;t++)if(s=$.model.charAt(t),-1=="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".indexOf(s)){if(0==d||0<d&&"_"==a.charAt(d-1))continue;a+="_",d++}else a+=s,d++;defaultHostname=0<d&&"_"==a.charAt(d-1)?a.substr(0,d-1):a}function showConnType(s){$("#div_connType").children().css("display","none"),$("#div_"+s).trigger("initAttrs"),$("#div_"+s).fadeIn(200)}function initConnType(){var s=void 0!==$.qd.dsl.vpi?$.qd.dsl.vpi:"8",t=void 0!==$.qd.dsl.vci?$.qd.dsl.vci:"35",a=void 0!==$.qd.dsl.vid?$.qd.dsl.vid:"0",d=void 0!==$.qd.dsl.vtag?$.qd.dsl.vtag:"0";INCLUDE_MER&&"Other"==$.qd.dsl.isp&&1==$.qd.dhcp.merEnabled&&($.qd.type="dhcp");var e="Other"==$.qd.dsl.isp?$.qd.type?$.qd.type:"ppp":$.qd.type;"Other"==$.qd.dsl.isp&&(void 0!==$.qd.connType&&(e=$.qd.connType),"Unknown"==$.qd.currDslType&&(void 0!==$.qd.adsl.type?$.qd.dslType="adsl":void 0!==$.qd.vdsl.type&&($.qd.dslType="vdsl")),s=void 0!==$.qd.adsl.vpi?$.qd.adsl.vpi:s,t=void 0!==$.qd.adsl.vci?$.qd.adsl.vci:t,a=void 0!==$.qd.vdsl.vid&&"-1"!=$.qd.vdsl.vid?$.qd.vdsl.vid:a,d=void 0!==$.qd.adsl.tag&&"-1"!=$.qd.adsl.tag?$.qd.adsl.tag:d),initDSLParams(!1,s,t,a,d,e),showConnType(e),INCLUDE_MER&&("Sky(MER)_VDSL"==$.qd.dsl.isp||"Other"==$.qd.dsl.isp&&1==$.qd.dhcp.merEnabled)?("Other"==$.qd.dsl.isp&&($("#vdslConnectionType").find("option[value=dhcp]").prop("selected","selected"),$("#vdslConnectionType").attr("disabled",!0),$("#vdslConnectionType").tpSelect({refresh:1})),$("#div_dhcp_mer").fadeIn(200)):$("#div_dhcp_mer").fadeOut(200)}function doAddVoipConn(s,a){var t="",d={},e={name:"voip",enable:1,transportType:$.qd.dsl.voip.connType,username:null!=$.qd[$.qd.type]?$.qd[$.qd.type].usr:"",password:null!=$.qd[$.qd.type]?$.qd[$.qd.type].pwd:"",X_TP_IfName:""},p={name:"voip",enable:1,connectionType:"IP_Routed",addressingType:"DHCP",NATEnabled:1,X_TP_Hostname:defaultHostname,X_TP_IfName:""},i=!1,n={};d="PPPoE"==$.qd.dsl.voip.connType?e:p,INCLUDE_WAN_VLAN&&("adsl"==$.qd.dsl.voip.dslType?-1!=$.qd.dsl.voip.vtag?(d.X_TP_8021QEnabled=1,d.X_TP_VlanID=$.qd.dsl.voip.vtag,-1!=$.qd.dsl.voip.priority&&(d.X_TP_VlanPr=$.qd.dsl.voip.priority)):d.X_TP_8021QEnabled=0:INCLUDE_VDSLWAN&&"vdsl"==$.qd.dsl.voip.dslType&&0!=$.qd.dsl.voip.vid&&-1!=$.qd.dsl.voip.priority&&(d.X_TP_VlanPr=$.qd.dsl.voip.priority));var o=function(s){if("PPPoE"==$.qd.dsl.voip.connType)var t=$.act(ACT_ADD,WAN_PPP_CONN,null,s,d);else t=$.act(ACT_ADD,WAN_IP_CONN,null,s,d);$.exe(function(s){if(s)return i&&($.act(ACT_DEL,WAN_CONN_DEVICE,n.__stack,null),$.exe()),$.alert(s),void $.removeLoading();t="PPPoE"==$.qd.dsl.voip.connType?(ppps.push(t),$.act(ACT_GET,WAN_PPP_CONN,t.__stack,null,["X_TP_IfName"])):(ips.push(t),$.act(ACT_GET,WAN_IP_CONN,t.__stack,null,["X_TP_IfName"])),$.exe(function(s){if(s)return $.alert(s),void $.removeLoading();1==$.qd.dsl.voip.bindToInternet?$.act(ACT_SET,VOICE,voipVoiceService.__stack,null,["X_TP_BoundIfName="+$.qd.newConn.ifName]):$.act(ACT_SET,VOICE,voipVoiceService.__stack,null,["X_TP_BoundIfName="+t.X_TP_IfName]),$.exe(function(s){a&&"function"==typeof a&&a()})})})},_=function(){i=!0,n=$.act(ACT_ADD,WAN_CONN_DEVICE,null,dslStack),$.exe(function(s){if(s)return $.alert(s),void $.removeLoading();t==WAN_DSL_LINK_CFG?adsls.push({enable:newVoipConnDevArgs.enable,destinationAddress:newVoipConnDevArgs.destinationAddress,linkType:newVoipConnDevArgs.linkType,ATMEncapsulation:newVoipConnDevArgs.ATMEncapsulation,__stack:n.__stack}):INCLUDE_VDSLWAN&&t==WAN_PTM_LINK_CFG&&vdsls.push({enable:newVoipConnDevArgs.enable,X_TP_Used:newVoipConnDevArgs.X_TP_Used,X_TP_VlanEnabled:newVoipConnDevArgs.X_TP_VlanEnabled,X_TP_VID:newVoipConnDevArgs.X_TP_VID,__stack:n.__stack}),$.act(ACT_SET,t,n.__stack,null,newVoipConnDevArgs),o(n.__stack)})};switch(t="adsl"==$.qd.dsl.voip.dslType?(pvcs="PVC:"+$.qd.dsl.voip.vpi+"/"+$.qd.dsl.voip.vci,newVoipConnDevArgs={enable:1,destinationAddress:pvcs,linkType:("PPPoA"==$.qd.dsl.voip.connType?"PPPoA":"IPoA"==$.qd.dsl.voip.connType&&"IPoA")||"EoA",ATMEncapsulation:$.qd.dsl.voip.encapMode},INCLUDE_WAN_VLAN&&-1!=$.qd.dsl.voip.vtag&&(d.X_TP_8021QEnabled=1,d.X_TP_VlanID=$.qd.dsl.voip.vtag),WAN_DSL_LINK_CFG):(newVoipConnDevArgs={enable:1,X_TP_Used:1,X_TP_VlanEnabled:0==$.qd.dsl.voip.vid?0:1,X_TP_VID:$.qd.dsl.voip.vid},WAN_PTM_LINK_CFG),s.step){case 1:$.each(ppps,function(){if(this.__stack==s.voipStk)return ppps.pop(this),$.act(ACT_DEL,WAN_PPP_CONN,s.voipStk,null),!1}),$.each(ips,function(){if(this.__stack==s.voipStk)return ips.pop(this),$.act(ACT_DEL,WAN_IP_CONN,s.voipStk,null),!1}),o(s.connDevStk);break;case 2:$.each(ppps,function(){if(this.__stack==s.voipStk)return ppps.pop(this),$.act(ACT_DEL,WAN_PPP_CONN,s.voipStk,null),!1}),$.each(ips,function(){if(this.__stack==s.voipStk)return ips.pop(this),$.act(ACT_DEL,WAN_IP_CONN,s.voipStk,null),!1}),_();break;case 3:break;case 4:$.each(adsls,function(){if(this.__stack==s.connDevStk)return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==s.connDevStk)return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_CONN_DEVICE,s.connDevStk,null),_();break;case 5:$.each(ppps,function(){if(this.__stack==s.voipStk)return ppps.pop(this),$.act(ACT_DEL,WAN_PPP_CONN,s.voipStk,null),!1}),$.each(ips,function(){if(this.__stack==s.voipStk)return ips.pop(this),$.act(ACT_DEL,WAN_IP_CONN,s.voipStk,null),!1}),$.each(adsls,function(){if(this.__stack==$.stkPop(s.voipStk,1))return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==$.stkPop(s.voipStk,1))return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_CONN_DEVICE,$.stkPop(s.voipStk,1),null),_();break;case 6:$.each(ppps,function(){if(this.__stack==s.voipStk)return ppps.pop(this),$.act(ACT_DEL,WAN_PPP_CONN,s.voipStk,null),!1}),$.each(ips,function(){if(this.__stack==s.voipStk)return ips.pop(this),$.act(ACT_DEL,WAN_IP_CONN,s.voipStk,null),!1}),$.each(adsls,function(){if(this.__stack==$.stkPop(s.voipStk,1))return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==$.stkPop(s.voipStk,1))return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_CONN_DEVICE,$.stkPop(s.voipStk,1),null),o(s.connDevStk);break;case 7:o(s.connDevStk);break;case 8:_();break;case 9:$.each(ppps,function(){if(this.__stack==s.voipStk)return ppps.pop(this),$.act(ACT_DEL,WAN_PPP_CONN,s.voipStk,null),!1}),$.each(ips,function(){if(this.__stack==s.voipStk)return ips.pop(this),$.act(ACT_DEL,WAN_IP_CONN,s.voipStk,null),!1}),$.each(adsls,function(){this.__stack!=$.stkPop(s.voipStk,1)&&this.__stack!=s.connDevStk||adsls.pop(this)}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){this.__stack!=$.stkPop(s.voipStk,1)&&this.__stack!=s.connDevStk||vdsls.pop(this)}),$.act(ACT_DEL,WAN_CONN_DEVICE,$.stkPop(s.voipStk,1),null),$.act(ACT_DEL,WAN_CONN_DEVICE,s.connDevStk,null),_();break;case 10:$.each(ppps,function(){if(this.__stack==s.voipStk)return ppps.pop(this),$.act(ACT_DEL,WAN_PPP_CONN,s.voipStk,null),!1}),$.each(ips,function(){if(this.__stack==s.voipStk)return ips.pop(this),$.act(ACT_DEL,WAN_IP_CONN,s.voipStk,null),!1}),$.each(adsls,function(){if(this.__stack==s.connDevStk)return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==s.connDevStk)return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_CONN_DEVICE,s.connDevStk,null),_()}}function doAddIptvConn(s){var t="",a=!1,d={},e={name:"iptv",enable:1,connectionType:"IP_Routed",addressingType:"DHCP",NATEnabled:1,X_TP_Hostname:defaultHostname,X_TP_IfName:""},p=function(s){$.act(ACT_ADD,WAN_IP_CONN,null,s,e),$.exe(function(s){if(s)return a&&($.act(ACT_DEL,WAN_CONN_DEVICE,d.__stack),$.exe()),$.alert(s),void $.removeLoading();$.act(ACT_OP,ACT_IPTV_UPDATE_DSL_IPTV_CFG,null,null),$.exe(),$.removeLoading(),1==$.qd.internetDiag||2==$.qd.internetDiag?loadSubPage("qsDiag.htm"):$.qf.next()})},i=function(){a=!0,d=$.act(ACT_ADD,WAN_CONN_DEVICE,null,dslStack),$.exe(function(s){if(s)return $.alert(s),void $.removeLoading();$.act(ACT_SET,t,d.__stack,null,newIptvConnDevArgs),p(d.__stack)})};switch(t="adsl"==$.qd.dsl.iptv.dslType?(pvcs="PVC:"+$.qd.dsl.iptv.vpi+"/"+$.qd.dsl.iptv.vci,newIptvConnDevArgs={enable:1,destinationAddress:pvcs,LinkType:("pppoa"==$.qd.dsl.iptv.connType?"PPPoA":"ipoa"==$.qd.dsl.iptv.connType&&"IPoA")||"EoA",ATMEncapsulation:$.qd.dsl.iptv.encapMode},INCLUDE_WAN_VLAN&&-1!=$.qd.dsl.iptv.vtag&&(e.X_TP_8021QEnabled=1,e.X_TP_VlanID=$.qd.dsl.iptv.vtag),WAN_DSL_LINK_CFG):(newIptvConnDevArgs={enable:1,X_TP_Used:1,X_TP_VlanEnabled:0==$.qd.dsl.iptv.vid?0:1,X_TP_VID:$.qd.dsl.iptv.vid},WAN_PTM_LINK_CFG),s.step){case 1:$.each(ips,function(){if(this.__stack==s.iptvStk)return ips.pop(this),!1}),$.act(ACT_DEL,WAN_IP_CONN,s.iptvStk,null),p(s.connDevStk);break;case 2:$.each(ips,function(){if(this.__stack==s.iptvStk)return ips.pop(this),!1}),$.act(ACT_DEL,WAN_IP_CONN,s.iptvStk,null),i();break;case 3:break;case 4:$.each(adsls,function(){if(this.__stack==s.connDevStk)return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==s.connDevStk)return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_CONN_DEVICE,s.connDevStk,null),i();break;case 5:$.each(ips,function(){if(this.__stack==s.iptvStk)return ips.pop(this),!1}),$.each(adsls,function(){if(this.__stack==$.stkPop(s.iptvStk,1))return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==$.stkPop(s.iptvStk,1))return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_IP_CONN,s.iptvStk,null),$.act(ACT_DEL,WAN_CONN_DEVICE,$.stkPop(s.iptvStk,1),null),i();break;case 6:$.each(ips,function(){if(this.__stack==s.iptvStk)return ips.pop(this),!1}),$.each(adsls,function(){if(this.__stack==$.stkPop(s.iptvStk,1))return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==$.stkPop(s.iptvStk,1))return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_IP_CONN,s.iptvStk,null),$.act(ACT_DEL,WAN_CONN_DEVICE,$.stkPop(s.iptvStk),null),p(s.connDevStk);break;case 7:p(s.connDevStk);break;case 8:i();break;case 9:$.each(ips,function(){if(this.__stack==s.iptvStk)return ips.pop(this),!1}),$.each(adsls,function(){this.__stack!=$.stkPop(s.iptvStk,1)&&this.__stack!=s.connDevStk||adsls.pop(this)}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){this.__stack!=$.stkPop(s.iptvStk,1)&&this.__stack!=s.connDevStk||vdsls.pop(this)}),$.act(ACT_DEL,WAN_IP_CONN,s.iptvStk,null),$.act(ACT_DEL,WAN_CONN_DEVICE,$.stkPop(s.iptvStk,1),null),$.act(ACT_DEL,WAN_CONN_DEVICE,s.connDevStk,null),i();break;case 10:$.each(ips,function(){if(this.__stack==s.iptvStk)return ips.pop(this),!1}),$.each(adsls,function(){if(this.__stack==s.connDevStk)return adsls.pop(this),!1}),INCLUDE_VDSLWAN&&$.each(vdsls,function(){if(this.__stack==s.connDevStk)return vdsls.pop(this),!1}),$.act(ACT_DEL,WAN_IP_CONN,s.iptvStk,null),$.act(ACT_DEL,WAN_CONN_DEVICE,s.connDevStk,null),i()}}function doAddConnection(){var t,a={},d={},e="",p=!1,i="",n="ppp"==$.qd.type||"pppoa"==$.qd.type?{name:"",enable:1,transportType:"ppp"==$.qd.type?"PPPoE":"PPPoA",username:$.qd[$.qd.type].usr,password:$.qd[$.qd.type].pwd,X_TP_IfName:""}:{},o={name:"",enable:1,connectionType:"IP_Routed",addressingType:"DHCP",NATEnabled:1,X_TP_Hostname:defaultHostname,X_TP_IfName:""};INCLUDE_MER&&("Sky(MER)_VDSL"==$.qd.dsl.isp||"Other"==$.qd.dsl.isp&&$("#enmer").prop("data-checked"))&&(o.X_TP_MerEnabled=1,o.X_TP_Username=$.qd.dhcp.usr,o.X_TP_Password=$.qd.dhcp.pwd);var _="staip"==$.qd.type||"ipoa"==$.qd.type?{name:"",X_TP_IfName:"",enable:1,connectionType:"IP_Routed",addressingType:"Static",NATEnabled:1,externalIPAddress:$.qd[$.qd.type].ip,subnetMask:$.qd[$.qd.type].mask,defaultGateway:$.qd[$.qd.type].gw,DNSOverrideAllowed:1,DNSServers:$.qd[$.qd.type].dns+","+$.qd[$.qd.type].dns2}:{},l={enable:1,connectionType:"IP_Bridged"};INCLUDE_WAN_VLAN&&(n.X_TP_8021QEnabled=$.qd.dsl.vtag?1:0,n.X_TP_VlanID=$.qd.dsl.vtag?$.qd.dsl.vtag:0,o.X_TP_8021QEnabled=$.qd.dsl.vtag?1:0,o.X_TP_VlanID=$.qd.dsl.vtag?$.qd.dsl.vtag:0,_.X_TP_8021QEnabled=$.qd.dsl.vtag?1:0,_.X_TP_VlanID=$.qd.dsl.vtag?$.qd.dsl.vtag:0,l.X_TP_8021QEnabled=$.qd.dsl.vtag?1:0,l.X_TP_VlanID=$.qd.dsl.vtag?$.qd.dsl.vtag:0);var c=function(s){"ppp"==$.qd.type||"pppoa"==$.qd.type?d=$.act(ACT_ADD,WAN_PPP_CONN,null,s,n):"dhcp"==$.qd.type?d=$.act(ACT_ADD,WAN_IP_CONN,null,s,o):"staip"==$.qd.type||"ipoa"==$.qd.type?d=$.act(ACT_ADD,WAN_IP_CONN,null,s,_):"br"==$.qd.type&&(d=$.act(ACT_ADD,WAN_IP_CONN,null,s,l)),$.exe(function(s){if(s)return p&&(a=$.act(ACT_DEL,WAN_CONN_DEVICE,i),$.exe()),getGatewayInfo(),$.removeLoading(),void $.alert(s);if($.qd.newConn={stack:d.__stack,ifName:d.X_TP_IfName},"br"!=$.qd.type){for($.act(ACT_SET,L3_FORWARDING,null,null,{__ifAliasName:d.name,__ifName:"",defaultConnectionService:""}),t=0;t<portMappingList.length;t++)$.act(ACT_ADD,-1!=$.qd.type.search("ppp")?WAN_PPP_CONN_PORTMAPPING:WAN_IP_CONN_PORTMAPPING,null,d.__stack,portMappingList[t]);for(t=0;t<portTriggerList.length;t++)$.act(ACT_ADD,-1!=$.qd.type.search("ppp")?PPP_CONN_PORTTRIGGERING:IP_CONN_PORTTRIGGERING,null,d.__stack,portTriggerList[t])}ips=$.act(ACT_GS,WAN_IP_CONN,null,dslStack,["Name","ConnectionType","AddressingType","ExternalIPAddress","SubnetMask","DefaultGateway","DNSServers"]),ppps=$.act(ACT_GS,WAN_PPP_CONN,null,dslStack,["Name","TransportType","Username","Password"]),adsls=$.act(ACT_GS,WAN_DSL_LINK_CFG,null,dslStack,["Enable","AutoConfig","DestinationAddress","LinkType","ATMEncapsulation"]),INCLUDE_VDSLWAN&&(vdsls=$.act(ACT_GS,WAN_PTM_LINK_CFG,null,dslStack,["Enable","X_TP_Used","X_TP_VID"])),e=function(){chkIptvRet=chkIptvAvailable(),1==bIptvAvailable?doAddIptvConn(chkIptvRet):($.removeLoading(),$.act(ACT_OP,ACT_IPTV_UPDATE_DSL_IPTV_CFG,null,null),$.exe(),1==$.qd.internetDiag||2==$.qd.internetDiag?loadSubPage("qsDiag.htm"):$.qf.next())},$.exe(function(s){if(s)return $.removeLoading(),void $.alert(s);if(INCLUDE_VOIP&&$.qd.dsl.voip){if(chkVoipRet=chkVoipAvailable(),1!=bVoipAvailable)return void e();doAddVoipConn(chkVoipRet,e)}else e()})})};setDefaultHostname(),INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType&&$.qd.vlan?i=$.qd.vlan.__stack:(!INCLUDE_VDSLWAN||INCLUDE_VDSLWAN&&"adsl"==$.qd.dslType)&&$.qd.vc&&(i=$.qd.vc.__stack),""==i?(p=!0,a=INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType?$.act(ACT_ADD,WAN_CONN_DEVICE,null,$.qd.vdsl.wan):$.act(ACT_ADD,WAN_CONN_DEVICE,null,$.qd.adsl.wan),$.exe(function(s){if(s)return $.removeLoading(),void $.alert(s);if(i=a.__stack,"adsl"==$.qd.dslType)$.act(ACT_SET,WAN_DSL_LINK_CFG,i,null,{enable:1,destinationAddress:"PVC:"+$.qd.dsl.vpi+"/"+$.qd.dsl.vci,LinkType:("pppoa"==$.qd.type?"PPPoA":"ipoa"==$.qd.type&&"IPoA")||"EoA",ATMEncapsulation:$.qd.dsl.ATM});else if(INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType){var t;t="Other"!=$.qd.dsl.isp&&specialIspList[$.qd.country]&&specialIspList[$.qd.country][$.qd.dsl.isp]&&specialIspList[$.qd.country][$.qd.dsl.isp].X_TP_802_1P?specialIspList[$.qd.country][$.qd.dsl.isp].X_TP_802_1P:-1,$.act(ACT_SET,WAN_PTM_LINK_CFG,i,null,{enable:1,X_TP_Used:1,X_TP_VlanEnabled:0==$.qd.dsl.vid?0:1,X_TP_VID:$.qd.dsl.vid,X_TP_QosMark:t})}c(i)})):(p=!1,c(i)),$.act(ACT_OP,ACT_IPTV_UPDATE_DSL_IPTV_CFG,null,null),$.exe()}function goNext(){var t=!1;if($.qd.isSetCountry)$.act(ACT_SET,LOCAL,null,null,{ispIndex:$.qd.dsl.ispIdx,ispName:$.qd.dsl.isp});else{for(var s=0;s<regionCodeInfo.length&&$.qd.country!=regionCodeInfo[s][4];s++);if(s>=regionCodeInfo.length)return;$.act(ACT_SET,LOCAL,null,null,{Country:regionCodeInfo[s][1].substring(0,2)}),$.act(ACT_SET,LOCAL,null,null,{ispIndex:$.qd.dsl.ispIdx,ispName:$.qd.dsl.isp}),$.act(ACT_SET,TIME,null,null,["localTimeZone="+$.qd.timezone])}if(collectDslParams(),INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType){if(0!=$.qd.dsl.vid&&$.num($.qd.dsl.vid,[1,4094],!0))return $("#vid").focus(),$("#vid").select(),$.alert(CMM_WAN_INVALID_VID);$.qd.vlan=void 0,$(vdsls).each(function(){if($.stkPop(this.__stack)==dslStack&&$.qd.dsl.vid==this.X_TP_VID)return $.qd.vlan=this,!1})}else{if($.num($.qd.dsl.vpi,[0,255],!0))return $("#vpi").focus(),$("#vpi").select(),$.alert(ERR_WAN_VPI_VCI_INVAD);if($.num($.qd.dsl.vci,[1,65535],!0))return $("#vci").focus(),$("#vci").select(),$.alert(ERR_WAN_VPI_VCI_INVAD);if(INCLUDE_WAN_VLAN&&0!=$.qd.dsl.vtag&&$.num($.qd.dsl.vtag,[1,4094],!0))return $("#vtag").select(),$.alert(ERR_WAN_VLAN_ID_INVALID);$.qd.vc=void 0,pvc="PVC:"+parseInt($.qd.dsl.vpi,10)+"/"+parseInt($.qd.dsl.vci,10),$(adsls).each(function(){this.destinationAddress===pvc&&($.qd.vc=this)})}if(connType=$("#"+$.qd.dslType+"ConnectionType").data("value"),$.qd.type=connType,(!INCLUDE_MER||"dhcp"!=connType||"Sky(MER)_VDSL"!=$.qd.dsl.isp&&("Other"!=$.qd.dsl.isp||1!=$.qd.dhcp.merEnabled)||($("#div_dhcp_mer").triggerHandler("addAttrs"),0!=$("#div_dhcp_mer").triggerHandler("chkValidation")))&&($("#div_"+connType).triggerHandler("addAttrs"),0!=$("#div_"+connType).triggerHandler("chkValidation"))){if("Other"==$.qd.dsl.isp&&"adsl"==$.qd.dslType&&("pppoa"==$.qd.type?$.qd.dsl.ATM="VCMUX":$.qd.dsl.ATM="LLC"),!INCLUDE_WAN_MODE||"DSL"==$.qd.sysMode)if($.qd.del=[],0==bDelGateway&&$.qd.gw&&$.qd.del.push({stack:$.qd.gw.__stack,type:$.qd.gw.transportType?"ppp":"ip",name:$.qd.gw.name}),iptvConn.name&&$.qd.del.push({stack:iptvConn.__stack,type:iptvConn.transportType?"ppp":"ip",name:iptvConn.name}),voipConn.name&&$.qd.del.push({stack:voipConn.__stack,type:voipConn.transportType?"ppp":"ip",name:voipConn.name}),INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType&&$.qd.vlan)$($.qd.conns).each(function(){$.stkPop(this.__stack)!=$.qd.vlan.__stack||$.qd.gw&&this.name==$.qd.gw.name||$.qd.del.push({stack:this.__stack,type:this.transportType?"ppp":"ip",name:this.name})});else if(INCLUDE_VDSLWAN&&"adsl"!=$.qd.dslType||!$.qd.vc||"IPoA"!=$.qd.vc.linkType&&"PPPoA"!=$.qd.vc.linkType&&"ipoa"!=$.qd.type&&"pppoa"!=$.qd.type&&$.qd.dsl.ATM==$.qd.vc.ATMEncapsulation){if(!$.qd.gw&&8<=$.qd.conns.length){var a=0;$($.qd.conns).each(function(){if("IP_Bridged"==this.connectionType)a?this.__stack>$.qd.del[0].__stack&&($.qd.del[0]={stack:this.__stack,type:this.transportType?"ppp":"ip",name:this.name}):(a=1,$.qd.del[0]={stack:this.__stack,type:this.transportType?"ppp":"ip",name:this.name});else if(a)return void $.removeLoading();$.qd.del[0]={stack:this.__stack,type:this.transportType?"ppp":"ip",name:this.name}})}}else $($.qd.conns).each(function(){$.stkPop(this.__stack)!=$.qd.vc.__stack||$.qd.gw&&this.name==$.qd.gw.name||$.qd.del.push({stack:this.__stack,type:this.transportType?"ppp":"ip",name:this.name})});if($.addLoading($("#next")),$.qd.del&&$.qd.del.length){for(var d=[],e=[];instance=$.qd.del.shift();)stack=$.stkPop(instance.stack),$.act(ACT_DEL,"ppp"==instance.type?WAN_PPP_CONN:WAN_IP_CONN,instance.stack),$.inArray(stack,d)||d.push(stack);for(;stack=d.shift();)e.push($.act(ACT_GET,WAN_CONN_DEVICE,stack));$.exe(function(s){if(s)return $.removeLoading(),void $.alert(s);for(bDelGateway=!0;instance=e.shift();)0==instance.WANIPConnectionNumberOfEntries&&0==instance.WANPPPConnectionNumberOfEntries&&($.act(ACT_DEL,WAN_CONN_DEVICE,instance.__stack),t=!0,INCLUDE_VDSLWAN&&"vdsl"==$.qd.dslType?$.qd.vlan&&instance.__stack==$.qd.vlan.__stack&&($.qd.vlan=void 0):$.qd.vc&&instance.__stack==$.qd.vc.__stack&&($.qd.vc=void 0));1==t?$.exe(function(s){if(s)return $.removeLoading(),void $.alert(s);doAddConnection()}):doAddConnection()})}else doAddConnection()}}function goPrev(){1==$("#vdsl_radio").prop("checked")?dslType="vdsl":1==$("#adsl_radio").prop("checked")?dslType="adsl":$.qd.dslType;var s=$("#"+$.qd.dslType+"ConnectionType option:selected").val();switch($.qd.type=s,$.qd.internetDiag){case 1:loadSubPage("qsIsp.htm");break;case 2:loadSubPage("qsDiag.htm");break;default:$("#div_"+s).triggerHandler("addAttrs"),$.qf.prev()}}function getForwardingParams(){var s;if(""!=gatewayStack){if("ppp"==gatewayType||"pppoa"==gatewayType)portMappingList=$.act(ACT_GS,WAN_PPP_CONN_PORTMAPPING,null,gatewayStack),portTriggerList=$.act(ACT_GS,PPP_CONN_PORTTRIGGERING,null,gatewayStack);else{if("ip"!=gatewayType&&"ipoa"!=gatewayType)return void $.alert("Unknow connection type: "+gatewayType);portMappingList=$.act(ACT_GS,WAN_IP_CONN_PORTMAPPING,null,gatewayStack),portTriggerList=$.act(ACT_GS,IP_CONN_PORTTRIGGERING,null,gatewayStack)}(s=$.exe())&&$.alert(s)}}function chkVoipAvailable(){var s,t,a="",d={},e={},p={step:0,connDevStk:"",voipStk:""},i=0,n=0,o=!1,_={},l=!1,c=!1,v=!1,r=0,A=0;if(!$.qd.dsl.voip)return bVoipAvailable=!1,p;if($.each(ppps,function(){o||-1==this.name.search("voip")||(o=!0,_=this,p.voipStk=this.__stack)}),$.each(ips,function(){o||-1==this.name.search("voip")||(o=!0,_=this,p.voipStk=this.__stack)}),$.each(ppps,function(){r++,o&&$.stkPop(this.__stack,1)==$.stkPop(_.__stack,1)&&A++}),$.each(ips,function(){r++,o&&$.stkPop(this.__stack,1)==$.stkPop(_.__stack,1)&&A++}),s=$.qd.dsl.voip.connType,t="VC-MUX"==$.qd.dsl.voip.encapMode?"VCMUX":$.qd.dsl.voip.encapMode,"adsl"==$.qd.dsl.voip.dslType){if($.qd.dsl.voip.vpi==$.qd.dsl.vpi&&$.qd.dsl.voip.vci==$.qd.dsl.vci&&("PPPoA"==s||"IPoA"==s||"pppoa"==$.qd.type||"ipoa"==$.qd.type||$.qd.dsl.voip.encapMode!=$.qd.dsl.ATM))return bVoipAvailable=!1,p;if(a="PVC:"+$.qd.dsl.voip.vpi+"/"+$.qd.dsl.voip.vci,$.each(adsls,function(){if(this.destinationAddress==a)return d=this,!(v=!0)}),$.each(ppps,function(){$.stkPop(this.__stack,1)==d.__stack&&n++}),$.each(ips,function(){$.stkPop(this.__stack,1)==d.__stack&&i++}),1==v&&(c="PPPoA"==s||"IPoA"==s||"PPPoA"==d.linkType||"IPoA"==d.linkType,l=t!=d.ATMEncapsulation,c||l))return 0<i?bVoipAvailable=!1:0==n?(p.step=0==o?4:1==A?9:10,p.connDevStk=d.__stack):1==n&&1==o&&$.stkPop(_.__stack,1)==d.__stack?(p.step=5,p.connDevStk=d.__stack):bVoipAvailable=!1,p;o?v?($.stkPop(_.__stack,1)==d.__stack?p.step=1:p.step=1==A?6:1,p.connDevStk=d.__stack):p.step=1==A?5:2:8<=r?bVoipAvailable=!1:v?(p.step=7,p.connDevStk=d.__stack):p.step=8}else if(INCLUDE_VDSLWAN&&"vdsl"==$.qd.dsl.voip.dslType){if($.qd.dsl.voip.vid==$.qd.dsl.vid)return bVoipAvailable=!1,p;bVidExisted=!1,$.each(vdsls,function(){if(1==this.X_TP_Used&&this.X_TP_VID==$.qd.dsl.voip.vid)return e=this,!(bVidExisted=!0)}),bVidExisted?(i=n=0,$.each(ppps,function(){$.stkPop(this.__stack,1)==e.__stack&&n++}),$.each(ips,function(){$.stkPop(this.__stack,1)==e.__stack&&i++}),1<=i?bVoipAvailable=!1:1==n?o&&$.stkPop(_.__stack,1)==e.__stack?p.step=1:bVoipAvailable=!1:p.step=0==o?7:1==A?6:1,p.connDevStk=e.__stack):o?p.step=1==A?5:2:8<=r?bVoipAvailable=!1:p.step=8}return p}function chkIptvAvailable(){var s,t,a="",d={},e={},p={step:0,connDevStk:"",iptvStk:""},i=0,n=0,o=!1,_={},l=!1,c=!1,v=!1,r=0,A=0;if(!$.qd.dsl.iptv)return bIptvAvailable=!1,p;if($.each(ips,function(){r++,-1!=this.name.search("iptv")&&(o=!0,_=this,p.iptvStk=this.__stack),1==o&&$.stkPop(_.__stack,1)==$.stkPop(this.__stack,1)&&A++}),$.each(ppps,function(){r++,1==o&&$.stkPop(_.__stack,1)==$.stkPop(this.__stack,1)&&A++}),s=$.qd.dsl.iptv.connType,t="VC-MUX"==$.qd.dsl.iptv.encapMode?"VCMUX":$.qd.dsl.iptv.encapMode,"adsl"==$.qd.dsl.iptv.dslType){if($.qd.dsl.iptv.vpi==$.qd.dsl.vpi&&$.qd.dsl.iptv.vci==$.qd.dsl.vci&&("PPPoA"==s||"IPoA"==s||"pppoa"==$.qd.type||"ipoa"==$.qd.type||$.qd.dsl.iptv.encapMode!=$.qd.dsl.ATM))return bIptvAvailable=!1,p;if(a="PVC:"+$.qd.dsl.iptv.vpi+"/"+$.qd.dsl.iptv.vci,$.each(adsls,function(){if(this.destinationAddress==a)return d=this,!(v=!0)}),$.each(ppps,function(){$.stkPop(this.__stack,1)==d.__stack&&n++}),$.each(ips,function(){$.stkPop(this.__stack,1)==d.__stack&&i++}),1==v&&(c="PPPoA"==s||"IPoA"==s||"PPPoA"==d.linkType||"IPoA"==d.linkType,l=t!=d.ATMEncapsulation,c||l))return 0<n?bIptvAvailable=!1:0==i?(p.step=0==o?4:1==A?9:10,p.connDevStk=d.__stack):1==i?(1==o&&$.stkPop(_.__stack,1)==d.__stack?p.step=5:bIptvAvailable=!1,p.connDevStk=d.__stack):bIptvAvailable=!1,p;o?v?$.stkPop(_.__stack,1)==d.__stack?p.step=1:p.step=1==A?6:1:p.step=1==A?5:2:8<=r?bIptvAvailable=!1:p.step=v?7:8,p.connDevStk=d.__stack}else if(INCLUDE_VDSLWAN&&"vdsl"==$.qd.dsl.iptv.dslType){if($.qd.dsl.iptv.vid==$.qd.dsl.vid)return bIptvAvailable=!1,p;bVidExisted=!1,$.each(vdsls,function(){if(1==this.X_TP_Used&&this.X_TP_VID==$.qd.dsl.iptv.vid)return e=this,!(bVidExisted=!0)}),bVidExisted?(i=n=0,$.each(ppps,function(){$.stkPop(this.__stack,1)==e.__stack&&n++}),$.each(ips,function(){$.stkPop(this.__stack,1)==e.__stack&&i++}),1<=n?bIptvAvailable=!1:1==i?o&&$.stkPop(_.__stack,1)==e.__stack?p.step=1:bIptvAvailable=!1:p.step=0==o?7:1==A?6:1,p.connDevStk=e.__stack):o?p.step=1==A?5:2:8<=r?bIptvAvailable=!1:p.step=8}return p}</script>
<div id="quicksetup_dsl_container">
    <form class="pure-form pure-form-aligned">
        <p id="t_dslSettingNote">Enter the parameters if your ISP provided some. Otherwise, click Next directly to continue.</p>
        <div id="div_dslType">
            <b id="t_l2IntfType">L2 Interface Type:</b>
            <input type="radio" name="radio_l2_intf_type" id="vdsl_radio">
            <label>VDSL</label>
            <input type="radio" name="radio_l2_intf_type" id="adsl_radio">
            <label>ADSL</label>
        </div>
        <div id="div_adsl">
            <p id="t_adslVlanNote" class="nd">If you use Telekom BNG line, please enable VLAN.</p>
            <div id="div_vpi">
                <b class="T_vpi">VPI:</b>
                <input type="text" class="xl" id="vpi" value="8">
            </div>
            <div id="div_vci">
                <b class="T_vci">VCI:</b>
                <input type="text" class="xl" id="vci" value="35">
            </div>
            <div id="div_adslTag">
                <div id="div_enTag">
                    <b class="T_vlan">VLAN ID:</b>
                    <input type="checkbox" class="xl" id="envtag">
                    <label class="T_envlan">Enable VLAN ID</label>
                </div>
                <div id="div_vtag" class="nd">
                    <b class="T_vlanrange">VLAN ID(1-4094):</b>
                    <input type="text" class="xl" maxlength="4" id="vtag" value="7">
                </div>
            </div>
            <div id="div_adslConnType">
                <b class="T_conntype">Connection Type:</b>
                <select id="adslConnectionType" class="xl">
                    <option class="T_c_qsPPPoE" value="ppp">PPPoE</option>
                    <option class="T_c_qsPPPoA" value="pppoa">PPPoA</option>
                    <option class="T_c_qsDynIp" value="dhcp">Dynamic IP</option>
                    <option class="T_c_qsStaIp" value="staip">Static IP</option>
                    <option class="T_c_qsIPoA" value="ipoa">IPoA</option>
                    <option class="T_bridge" value="br">Bridge</option>
                </select>
            </div>
        </div>
        <div id="div_vdsl" class="nd">
            <div id="div_enVlan">
                <b id="t_vlan">VLAN:</b>
                <input type="checkbox" class="xl" id="envid">
                <label id="t_enVid">Enable VLAN ID</label>
            </div>
            <div id="div_vid" class="nd">
                <b id="t_tag">VLAN ID(1-4094):</b>
                <input type="text" class="xl" id="vid" value="1">
            </div>
            <div id="div_enMer" class="nd">
                <b>MER:</b>
                <input type="checkbox" class="xl" id="enmer">
                <label class="T_enable">Enable</label>
            </div>
            <div id="div_vdslConnType">
                <b class="T_conntype">Connection Type:</b>
                <select id="vdslConnectionType" class="xl">
                    <option class="T_c_qsPPPoE" value="ppp">PPPoE</option>
                    <option class="T_c_qsDynIp" value="dhcp">Dynamic IP</option>
                    <option class="T_c_qsStaIp" value="staip">Static IP</option>
                    <option class="T_bridge" value="br">Bridge</option>
                </select>
            </div>
        </div>
        <div id="div_connType">
            <div id="div_ppp" class="nd">
                <div>
                    <b class="T_pppoeusr">User Name:</b>
                    <input type="text" class="xl" id="ppp_username" maxlength="255">
                </div>
                <div>
                    <b class="T_pppoepwd">Password:</b>
                    <input type="password" class="xl" id="ppp_password" maxlength="255">
                </div>
                <div>
                    <b class="T_cfmpwd">Confirm Password:</b>
                    <input type="password" class="xl" id="ppp_cfmpassword" maxlength="255">
                </div>
            </div>
            <div id="div_pppoa" style="display:none">
                <div>
                    <b class="T_pppoausr">User Name:</b>
                    <input type="text" class="xl" id="pppoa_username" maxlength="255">
                </div>
                <div>
                    <b class="T_pppoapwd">Password:</b>
                    <input type="password" class="xl" id="pppoa_password" maxlength="255">
                </div>
                <div>
                    <b class="T_cfmpwd">Confirm Password:</b>
                    <input type="password" class="xl" id="pppoa_cfmpassword" maxlength="255">
                </div>
            </div>
            <div id="div_dhcp" style="display:none">
            </div>
            <div id="div_dhcp_mer" style="display:none">
            	<div>
                    <b>Username:</b>
                    <input type="text" class="xl" id="dynamicip_username" maxlength="255">
                </div>
                <div>
                    <b>Password:</b>
                    <input type="password" class="xl" id="dynamicip_password" maxlength="255">
                </div>
            </div>
            <div id="div_staip" style="display:none">
                <div>
                    <b class="T_c_ipaddr">IP Address:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="staip">
                </div>
                <div>
                    <b class="T_c_mask">Subnet Mask:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="staipmask">
                </div>
                <div>
                    <b class="T_c_gw">Gateway:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="staipgw">
                </div>
                <div>
                    <b class="T_c_priDns">DNS Server:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="staipdns1">
                </div>
                <div>
                    <b class="T_c_secDns">Secondary DNS Server:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="staipdns2">
                    <span class="T_optional">(Optional)</span>
                </div>
            </div>
            <div id="div_ipoa" style="display:none">
                <div>
                    <b class="T_c_ipaddr">IP Address:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="ipoa">
                </div>
                <div>
                    <b class="T_c_mask">Subnet Mask:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="ipoamask">
                </div>
                <div>
                    <b class="T_c_gw">Gateway:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="ipoagw">
                </div>
                <div>
                    <b class="T_c_priDns">DNS Server:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="ipoadns1">
                </div>
                <div>
                    <b class="T_c_secDns">Secondary DNS Server:</b>
                    <input type="text" class="xl" maxlength="15" value="0.0.0.0" id="ipoadns2">
                    <span class="T_optional">(Optional)</span>
                </div>
            </div>
            <div id="div_br" style="display:none">
            </div>
        </div>
    </form>
</div>
<div class="inline-btn-right quicksetup-button-container">
    <div class="inline">
        <button type="submit" class="green T_back" id="back" onclick="goPrev()">Back</button>
    </div>
    <div class="inline">
        <button type="submit" class="green T_next" id="next" onclick="goNext()">Next</button>
    </div>
</div>
<script language="javascript">var currDslMode="";function init(){if(INCLUDE_WAN_VLAN&&"Telekom(Privat)_ADSL"==$.qd.dsl.isp&&$("#t_adslVlanNote").removeClass("nd"),INCLUDE_WAN_VLAN||$("#div_adslTag").addClass("nd"),$("#div_ppp").bind("initAttrs",initPPPoEAttrs),$("#div_ppp").bind("addAttrs",addPPPoEAttrs),$("#div_ppp").bind("chkValidation",chkPPPoEAttrs),$("#div_pppoa").bind("initAttrs",initPPPoAAttrs),$("#div_pppoa").bind("addAttrs",addPPPoAAttrs),$("#div_pppoa").bind("chkValidation",chkPPPoAAttrs),$("#div_staip").bind("initAttrs",initStaticIpAttrs),$("#div_staip").bind("addAttrs",addStaticIpAttrs),$("#div_staip").bind("chkValidation",chkStaticIpAttrs),$("#div_ipoa").bind("initAttrs",initIPoAAttrs),$("#div_ipoa").bind("addAttrs",addIPoAAttrs),$("#div_ipoa").bind("chkValidation",chkIPoAAttrs),$("#div_dhcp").bind("initAttrs",initDynamicIPAttrs),!INCLUDE_MER||"Sky(MER)_VDSL"!=$.qd.dsl.isp&&"Other"!=$.qd.dsl.isp||($.qd.dhcp={},$("#div_dhcp_mer").bind("addAttrs",addDynamicIPAttrs),$("#div_dhcp_mer").bind("chkValidation",chkDynamicIPAtts),"Other"==$.qd.dsl.isp&&($("#div_enMer").removeClass("nd"),$("#enmer").on("click",doEnabledMer))),$("#div_br").bind("initAttrs",initBridgeAttrs),INCLUDE_VDSLWAN&&($("#vdslConnectionType").click(function(){$("#div_vdsl").hasClass("nd")||showConnType($("#vdslConnectionType").data("value")),INCLUDE_MER&&("Sky(MER)_VDSL"==$.qd.dsl.isp||"Other"==$.qd.dsl.isp&&1==$.qd.dhcp.merEnabled)&&$("#div_dhcp_mer").show("fast")}),$("#envid").on("click",doEnableVid)),INCLUDE_WAN_VLAN&&$("#envtag").on("click",doEnableVtag),$("#adsl_radio").on("click",function(){doDslTypeChange("adsl")}),$("#adslConnectionType").click(function(){$("#div_adsl").hasClass("nd")||showConnType($("#adslConnectionType").data("value"))}),"Other"==$.qd.dsl.isp&&INCLUDE_VDSLWAN&&"Unknown"==$.qd.currDslType?$("#div_dslType").removeClass("nd"):$("#div_dslType").addClass("nd"),INCLUDE_VDSLWAN&&($("#"+$.qd.dslType+"_radio").prop("checked",!0),doDslTypeChange($.qd.dslType)),getGatewayInfo(),"Other"!=$.qd.dsl.isp&&specialIspList[$.qd.country]&&specialIspList[$.qd.country][$.qd.dsl.isp]){var d=specialIspList[$.qd.country][$.qd.dsl.isp];switch($.qd.type){case"ppp":$.qd.ppp=$.qd.ppp||{},d.usrname&&($.qd.ppp.usr=d.usrname),d.passwd&&($.qd.ppp.pwd=d.passwd);break;case"pppoa":$.qd.pppoa=$.qd.pppoa||{},d.usrname&&($.qd.pppoa.usr=d.usrname),d.passwd&&($.qd.pppoa.pwd=d.passwd)}}INCLUDE_VOIP&&getVoiceInfo(),initConnType(),getForwardingParams()}!function(){if($.tpInit(init),INCLUDE_VDSLWAN){var t,n={};$("#vdsl_radio").on("click",function(){doDslTypeChange("vdsl")}),t=$.act(ACT_GL,WAN_COMMON_INTF_CFG,null,null,["WANAccessType"]),n=$.act(ACT_GL,WAN_DSL_INTF_CFG,null,null,["LinkEncapsulationUsed","X_TP_SupportAdslMode"]),$.exe(function(d){if(d)$.alert(d);else for(var i=0;i<t.length;i++){var s;if("DSL"==t[i].WANAccessType)if("G.992.3_Annex_K_ATM"==n[i].linkEncapsulationUsed?currDslMode="adsl":"G.993.2_Annex_K_PTM"==n[i].linkEncapsulationUsed&&(currDslMode="vdsl"),INCLUDE_VDSLWAN)s=n[i].X_TP_SupportAdslMode.split(";"),$.each(s,function(){"ADSL Auto Sync-up"==this.split(":")[0]?adslAnnexType="Annex "+this.split(":")[1]:"VDSL2"==this.split(":")[0]&&(vdslAnnexType="Annex "+this.split(":")[1])})}})}}()</script>
