<script language="javascript">var ASCII="0123456789ABCDEFabcdefGHIJKLMNOPQRSTUVWXYZghijklmnopqrstuvwxyz`~!@#$^&*()-=_+[]{};:'\"\\|/?.,<>/% ";function isHex(e,i){e=e.toLowerCase();for(var t=0;t<e.length;t++)if(!("0"<=e.charAt(t)&&e.charAt(t)<="9"||"a"<=e.charAt(t)&&e.charAt(t)<="f"))return 0!=i&&$.alert(ERR_WLAN_WEP_KEY_HEX_INVALID),!1;return 0!=parseInt(e,16)||(0!=i&&$.alert(ERR_WLAN_WEP_KEY_HEX_INVALID),!1)}function wepOnfocus(e){$.id("keynum"+e).checked=!0}function setKey(){for(var e=1;e<=4;e++){if(0==$.id("length"+e).value){if($.id("key"+e).disabled=!0,$.id("keynum"+e).disabled=!0,1==$.id("keynum"+e).checked)0==(t=(e+1)%4)&&(t=4),$.id("keynum"+t).checked=!0}else $.id("key"+e).disabled=!1,$.id("keynum"+e).disabled=!1,1==$.id("wepKeyType").value?($.id("key"+e).value=$.id("key"+e).value.substr(0,Math.floor($.id("length"+e).value/4)),$.id("key"+e).maxLength=$.id("length"+e).value/4):2==$.id("wepKeyType").value&&($.id("key"+e).value=$.id("key"+e).value.substr(0,Math.floor($.id("length"+e).value/8)),$.id("key"+e).maxLength=$.id("length"+e).value/8);for(var i=0;i<$.id("length"+e).options.length;i++){var t;0!=(t=parseInt($.id("length"+e).options[i].value))&&(1==$.id("wepKeyType").value?$.id("length"+e).options[i].text=t+24+"bits ("+t/4+" "+m_str.wephex+")":$.id("length"+e).options[i].text=t+24+"bits ("+t/8+" "+m_str.wepchar+")")}}}function disableWEP(){$.id("secWEP").disabled=!0,$.id("wepAuthType").disabled=!0,$.id("wepKeyType").disabled=!0;var e=1;for(e=1;e<=4;e++)$.id("keynum"+e).disabled=!0,$.id("key"+e).disabled=!0,$.id("length"+e).disabled=!0}function disableWPA(){$.id("secWPA").disabled=!0,$.id("wpaAuthType").disabled=!0,$.id("wpaCipher").disabled=!0,$.id("wpaSerIP").disabled=!0,$.id("wpaSerPort").disabled=!0,$.id("wpaSerPwd").disabled=!0,$.id("wpainterval").disabled=!0}function getParam(){0==$.id("apsec").value?(beaconType=wlanObj.beaconType,basicAuthenticationMode=wlanObj.basicAuthenticationMode,WEPKeyIndex=wlanObj.WEPKeyIndex,wepList=$.act(ACT_GS,LAN_WLAN_WEPKEY,null,wlanObj.__stack,["WEPKey"]),$.exe(),$.each(wepList,function(e,i){wepKeyArray[i]=this.WEPKey}),wepLevel=wlanObj.WEPEncryptionLevel.split(","),basicEncryptionModes=wlanObj.basicEncryptionModes,WPAAuthenticationMode=wlanObj.WPAAuthenticationMode,WPAEncryptionModes=wlanObj.WPAEncryptionModes,IEEE11iAuthenticationMode=wlanObj.IEEE11iAuthenticationMode,IEEE11iEncryptionModes=wlanObj.IEEE11iEncryptionModes,X_TP_PreSharedKey=wlanObj.X_TP_PreSharedKey,X_TP_GroupKeyUpdateInterval=wlanObj.X_TP_GroupKeyUpdateInterval,X_TP_RadiusServerIP=wlanObj.X_TP_RadiusServerIP,X_TP_RadiusServerPort=wlanObj.X_TP_RadiusServerPort,X_TP_RadiusServerPassword=wlanObj.X_TP_RadiusServerPassword):INCLUDE_LAN_WLAN_MSSID&&(getVapObj($.id("apsec").value),beaconType=vapObj.beaconType,basicAuthenticationMode=vapObj.basicAuthenticationMode,WEPKeyIndex=vapObj.WEPKeyIndex,wepList=$.act(ACT_GS,LAN_WLAN_MSSIDWEPKEY,null,vapObj.__stack,["WEPKey"]),$.exe(),$.each(wepList,function(e,i){wepKeyArray[i]=this.WEPKey}),wepLevel=wlanObj.WEPEncryptionLevel.split(","),basicEncryptionModes=vapObj.basicEncryptionModes,WPAAuthenticationMode=vapObj.WPAAuthenticationMode,WPAEncryptionModes=vapObj.WPAEncryptionModes,IEEE11iEncryptionModes=vapObj.IEEE11iEncryptionModes,IEEE11iAuthenticationMode=vapObj.IEEE11iAuthenticationMode,X_TP_PreSharedKey=vapObj.preSharedKey,X_TP_GroupKeyUpdateInterval=vapObj.groupKeyUpdateInterval,X_TP_RadiusServerIP=vapObj.radiusServerIP,X_TP_RadiusServerPort=vapObj.radiusServerPort,X_TP_RadiusServerPassword=vapObj.radiusServerPassword)}function initWEPShow(){var t,e="";for(t=1;t<=4;t++){e="",e+='<b class="item L"><span class="T T_key">'+s_str.key+"</span> "+t+":&nbsp;&nbsp;<input type=radio name=keyNum id=keynum"+t+" value="+t+" /></b>"+("<input type=text class=text maxLength=32 size=32 id=key"+t+" onfocus=wepOnfocus("+t+") />")+" "+("<select name=length"+t+" class=list id=length"+t+" onchange=setKey()></select>"),$.h($.id("wepKeySet"+t),e)}for("None"==basicAuthenticationMode?$.id("wepAuthType").selectedIndex=1:"SharedAuthentication"==basicAuthenticationMode?$.id("wepAuthType").selectedIndex=2:"Auto"==basicAuthenticationMode&&($.id("wepAuthType").selectedIndex=0),$.id("keynum"+WEPKeyIndex).checked=!0,t=1;t<=4;t++)$.id("key"+t).value=wepKeyArray[t-1];for(t=1;t<=4;t++)for(;0<$.id("length"+t).options.length;)$.id("length"+t).remove(0);for($.each(wepLevel,function(){for(t=1;t<=4;t++){var i=$.c("option");if("Disabled"==(i.value=this))i.text=m_str.disabled,i.value=0;else{var e=this.split("-");i.text=parseInt(e[0])+24+"bit",i.value=parseInt(e[0])}try{$.id("length"+t).add(i,null)}catch(e){$.id("length"+t).add(i)}}}),$.id("wepKeyType").selectedIndex=0,t=1;t<=4;t++)if(1==$.id("keynum"+t).checked)for(var i=0;i<wepLevel.length;i++)if("Disabled"!=wepLevel[i]){var a=wepLevel[i].split("-");if($.id("key"+t).value.length==parseInt(a[0])/8){$.id("wepKeyType").selectedIndex=1;break}}for(t=1;t<=4;t++){var n;n=1==$.id("wepKeyType").value?4*$.id("key"+t).value.length:8*$.id("key"+t).value.length;for(i=0;i<$.id("length"+t).options.length;i++)$.id("length"+t).options[i].value==n&&($.id("length"+t).selectedIndex=i)}setKey()}function secTypeInit(){"Basic"==beaconType&&"None"==basicEncryptionModes?$.id("secNone").checked=!0:"Basic"==beaconType&&"WEPEncryption"==basicEncryptionModes?$.id("secWEP").checked=!0:"WPA"==beaconType?"PSKAuthentication"==WPAAuthenticationMode?$.id("secPSK").checked=!0:$.id("secWPA").checked=!0:"11i"!=beaconType&&"WPAand11i"!=beaconType||("PSKAuthentication"==IEEE11iAuthenticationMode?$.id("secPSK").checked=!0:$.id("secWPA").checked=!0)}function initWPAShow(){"WPAand11i"==beaconType&&"EAPAuthentication"==WPAAuthenticationMode?($.id("wpaAuthType").selectedIndex=0,"TKIPEncryption"==IEEE11iEncryptionModes?$.id("wpaCipher").selectedIndex=1:"AESEncryption"==IEEE11iEncryptionModes?$.id("wpaCipher").selectedIndex=2:$.id("wpaCipher").selectedIndex=0,$.id("wpaSerPwd").value=X_TP_RadiusServerPassword,$.id("wpainterval").value=X_TP_GroupKeyUpdateInterval,$.id("wpaSerIP").value=X_TP_RadiusServerIP,$.id("wpaSerPort").value=X_TP_RadiusServerPort,$.id("wpaSerPwd").value=X_TP_RadiusServerPassword):"WPA"==beaconType&&"EAPAuthentication"==WPAAuthenticationMode?($.id("wpaAuthType").selectedIndex=1,"TKIPEncryption"==WPAEncryptionModes?$.id("wpaCipher").selectedIndex=1:"AESEncryption"==WPAEncryptionModes?$.id("wpaCipher").selectedIndex=2:$.id("wpaCipher").selectedIndex=0):"11i"==beaconType&&"EAPAuthentication"==IEEE11iAuthenticationMode?($.id("wpaAuthType").selectedIndex=2,"TKIPEncryption"==IEEE11iEncryptionModes?$.id("wpaCipher").selectedIndex=1:"AESEncryption"==IEEE11iEncryptionModes?$.id("wpaCipher").selectedIndex=2:$.id("wpaCipher").selectedIndex=0):($.id("wpaAuthType").selectedIndex=0,$.id("wpaCipher").selectedIndex=0),$.id("wpaSerPwd").value=X_TP_RadiusServerPassword,$.id("wpainterval").value=X_TP_GroupKeyUpdateInterval,$.id("wpaSerIP").value=X_TP_RadiusServerIP,$.id("wpaSerPort").value=X_TP_RadiusServerPort}function initPSKShow(){"WPAand11i"==beaconType&&"PSKAuthentication"==WPAAuthenticationMode?($.id("pskAuthType").selectedIndex=0,"TKIPEncryption"==IEEE11iEncryptionModes?$.id("pskCipher").selectedIndex=1:"AESEncryption"==IEEE11iEncryptionModes?$.id("pskCipher").selectedIndex=2:$.id("pskCipher").selectedIndex=0):"WPA"==beaconType&&"PSKAuthentication"==WPAAuthenticationMode?($.id("pskAuthType").selectedIndex=1,"TKIPEncryption"==WPAEncryptionModes?$.id("pskCipher").selectedIndex=1:"AESEncryption"==WPAEncryptionModes?$.id("pskCipher").selectedIndex=2:$.id("pskCipher").selectedIndex=0):"11i"==beaconType&&"PSKAuthentication"==IEEE11iAuthenticationMode?($.id("pskAuthType").selectedIndex=2,"TKIPEncryption"==IEEE11iEncryptionModes?$.id("pskCipher").selectedIndex=1:"AESEncryption"==IEEE11iEncryptionModes?$.id("pskCipher").selectedIndex=2:$.id("pskCipher").selectedIndex=0):($.id("pskAuthType").selectedIndex=0,$.id("pskCipher").selectedIndex=0),$.id("pskSecret").value=X_TP_PreSharedKey,$.id("interval").value=X_TP_GroupKeyUpdateInterval}function initShow(e){var i;if(INCLUDE_LAN_WLAN_MSSID&&1<vapList.length&&$.removeClass($.id("MssidSel"),"nd"),e&&INCLUDE_LAN_WLAN_MSSID&&$.addLoading($.id("apsec")),getWlanObj(),getParam(),secTypeInit(),initWEPShow(),initPSKShow(),initWPAShow(),INCLUDE_LAN_WLAN_MSSID&&1==mssidObj.multiSSIDEnable)for(i=0;i<vapList.length;i++)if(1==vapList[i].enable){disableWEP(),$.removeClass($.id("mssidTip"),"nd");break}1==qssEn&&(disableWEP(),disableWPA(),$.removeClass($.id("qssTip"),"nd")),"n-only"==wlanObj.standard&&($.id("secWEP").disabled=!0,$.id("pskCipher").selectedIndex=2,$.id("pskCipher").disabled=!0,$.id("wpaCipher").selectedIndex=2,$.id("wpaCipher").disabled=!0,$.removeClass($.id("11nTip"),"nd")),e&&INCLUDE_LAN_WLAN_MSSID&&$.removeLoading($.id("apsec"))}function checkWEP(){if(1==qssEn)return $.alert(ERR_WLAN_QSS_WEP_CONFLICT),!1;var e;for(e=1;e<=4;e++){if(1==$.id("keynum"+e).checked&&0==$.id("length"+e).value)return $.alert(ERR_WLAN_WEP_NO_KEY),!1;if(0!=$.id("length"+e).value){if(1==$.id("wepKeyType").value){if(!isHex($.id("key"+e).value,1))return $.id("key"+e).focus(),$.id("key"+e).select(),!1}else if($.asc($.id("key"+e).value,!0))return $.alert(ERR_WLAN_WEP_KEY_ASCII_INVALID),$.id("key"+e).focus(),$.id("key"+e).select(),!1;if($.id("key"+e).value.length<$.id("length"+e).value/(1==$.id("wepKeyType").value?4:8))return $.alert(ERR_WLAN_WEP_KEY_LENGTH_INVALID),$.id("key"+e).focus(),$.id("key"+e).select(),!1}}return!0}function checkWPA(){if($.ifip($.id("wpaSerIP").value))return $.id("wpaSerIP").focus(),$.id("wpaSerIP").select(),!1;if(0==$.id("wpaSerPort").value&&($.id("wpaSerPort").value=1812),65535<$.id("wpaSerPort").value||$.id("wpaSerPort").value<1)return $.alert(ERR_WLAN_WPA_PORT_INVALID),$.id("wpaSerPort").focus(),$.id("wpaSerPort").select(),!1;var e=$.id("wpaSerPwd").value;return 0==e.length?($.alert(ERR_WLAN_WPA_PWD_EMPTY),$.id("wpaSerPwd").focus(),$.id("wpaSerPwd").select(),!1):64<e.length?($.alert(ERR_WLAN_WPA_PWD_INVALID),$.id("wpaSerPwd").focus(),$.id("wpaSerPwd").select(),!1):$.num($.id("wpainterval").value,0,[30,999999999],!0)?($.alert(ERR_WLAN_WPA_INTERVAL_INVALID),$.id("wpainterval").focus(),$.id("wpainterval").select(),!1):1!=qssEn||($.alert(ERR_WLAN_QSS_WPA_CONFLICT),!1)}function checkPSK(){var e=$.id("pskSecret").value;if(0==e.length)return $.alert(ERR_WLAN_WPA_PSK_EMPTY),$.id("pskSecret").focus(),$.id("pskSecret").select(),!1;if(e.length<8)return $.alert(ERR_WLAN_WPA_PSK_LENGTH_INVALID),$.id("pskSecret").focus(),$.id("pskSecret").select(),!1;if(64<=e.length){if(!isHex(e,0))return $.alert(ERR_WLAN_WPA_PSK_HEX_INVALID),$.id("pskSecret").focus(),$.id("pskSecret").select(),!1;$.id("pskSecret").value=$.id("pskSecret").value.substr(0,64)}else if($.asc(e,!0))return $.alert(ERR_WLAN_WPA_PSK_ASCII_INVALID),$.id("pskSecret").focus(),$.id("pskSecret").select(),!1;return $.num($.id("interval").value,0,[30,999999999],!0)?($.alert(ERR_WLAN_WPA_INTERVAL_INVALID),!1):1!=qssEn||1!=$.id("pskCipher").value||($.alert(ERR_WLAN_QSS_TKIP_CONFLICT),!1)}function checkValue(){return 1==$.id("secNone").checked||(1==$.id("secWEP").checked?checkWEP():1==$.id("secPSK").checked?checkPSK():1==$.id("secWPA").checked&&checkWPA())}function doWlanSubmit(){if(1==$.id("secNone").checked)$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=Basic","BasicEncryptionModes=None","BasicAuthenticationMode=None"]);else if(1==$.id("secWEP").checked){var e,i=1;e="auto"==$.id("wepAuthType").value?"Auto":"shared"==$.id("wepAuthType").value?"SharedAuthentication":"None",$.each(wepList,function(e,i){var t;t=0==$.id("length"+(i+1)).value?"":$.id("key"+(i+1)).value,$.act(ACT_SET,LAN_WLAN_WEPKEY,this.__stack,null,["WEPKey="+t])});for(i=1;i<=4&&1!=$.id("keynum"+i).checked;i++);$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=Basic","WEPKeyIndex="+i,"BasicAuthenticationMode="+e,"BasicEncryptionModes=WEPEncryption"])}else if(1==$.id("secPSK").checked){var t=parseInt($.id("interval").value,10);a=0==$.id("pskCipher").value?"TKIPandAESEncryption":1==$.id("pskCipher").value?"TKIPEncryption":"AESEncryption",0==$.id("pskAuthType").value?$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=WPAand11i","WPAEncryptionModes="+a,"WPAAuthenticationMode=PSKAuthentication","IEEE11iAuthenticationMode=PSKAuthentication","IEEE11iEncryptionModes="+a,"X_TP_PreSharedKey="+$.id("pskSecret").value,"X_TP_GroupKeyUpdateInterval="+t]):1==$.id("pskAuthType").value?$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=WPA","WPAAuthenticationMode=PSKAuthentication","WPAEncryptionModes="+a,"X_TP_PreSharedKey="+$.id("pskSecret").value,"X_TP_GroupKeyUpdateInterval="+t]):$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=11i","IEEE11iAuthenticationMode=PSKAuthentication","IEEE11iEncryptionModes="+a,"X_TP_PreSharedKey="+$.id("pskSecret").value,"X_TP_GroupKeyUpdateInterval="+t])}else if(1==$.id("secWPA").checked){var a;t=parseInt($.id("wpainterval").value,10);a=0==$.id("wpaCipher").value?"TKIPandAESEncryption":1==$.id("wpaCipher").value?"TKIPEncryption":"AESEncryption",0==$.id("wpaAuthType").value?$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=WPAand11i","WPAAuthenticationMode=EAPAuthentication","WPAEncryptionModes="+a,"IEEE11iAuthenticationMode=EAPAuthentication","IEEE11iEncryptionModes="+a,"X_TP_GroupKeyUpdateInterval="+t,"X_TP_RadiusServerIP="+$.id("wpaSerIP").value,"X_TP_RadiusServerPort="+$.id("wpaSerPort").value,"X_TP_RadiusServerPassword="+$.id("wpaSerPwd").value]):1==$.id("wpaAuthType").value?$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=WPA","WPAAuthenticationMode=EAPAuthentication","WPAEncryptionModes="+a,"X_TP_GroupKeyUpdateInterval="+t,"X_TP_RadiusServerIP="+$.id("wpaSerIP").value,"X_TP_RadiusServerPort="+$.id("wpaSerPort").value,"X_TP_RadiusServerPassword="+$.id("wpaSerPwd").value]):$.act(ACT_SET,LAN_WLAN,wlanObj.__stack,null,["BeaconType=11i","IEEE11iAuthenticationMode=EAPAuthentication","IEEE11iEncryptionModes="+a,"X_TP_GroupKeyUpdateInterval="+t,"X_TP_RadiusServerIP="+$.id("wpaSerIP").value,"X_TP_RadiusServerPort="+$.id("wpaSerPort").value,"X_TP_RadiusServerPassword="+$.id("wpaSerPwd").value])}$.exe(function(e){e||initShow(0),$.removeLoading()})}function doSubmit(){INCLUDE_LAN_WLAN_MSSID&&0<$.id("apsec").value?doVapSubmit():doWlanSubmit()}function reboot(){$.loadMain("restart.htm")}function doSave(e){checkValue()&&($.addLoading(e),doSubmit())}if(INCLUDE_LAN_WLAN_MSSID){function getVapObj(t){var a=1;$.each(vapList,function(e,i){INCLUDE_LAN_WLAN_GUESTNETWORK&&this.name==guestNetObj.name||(a==t&&(vapObj=this),a++)})}function initSelect(){(t=$.c("option")).text=wlanObj.SSID,$.flag||(t.innerHTML=wlanObj.SSID.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")),t.value=0;try{$.id("apsec").add(t,null)}catch(e){$.id("apsec").add(t)}if(1==mssidObj.multiSSIDEnable){var e=1,i=0;for(e=1;e<=vapList.length;e++)if((!INCLUDE_LAN_WLAN_GUESTNETWORK||vapList[e-1].name!=guestNetObj.name)&&(getVapObj(++i),1==vapObj.enable)){var t;(t=$.c("option")).text=vapObj.SSID,$.flag||(t.innerHTML=vapObj.SSID.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")),t.value=i;try{$.id("apsec").add(t,null)}catch(e){$.id("apsec").add(t)}}}}function doVapSubmit(){if(getVapObj($.id("apsec").value),1==$.id("secNone").checked)$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=Basic","BasicEncryptionModes=None","BasicAuthenticationMode=None"]);else if(1==$.id("secWEP").checked){var e,i=1;for("open"==$.id("wepAuthType").value?e="None":"shared"==$.id("wepAuthType").value?e="SharedAuthentication":"auto"==$.id("wepAuthType").value&&(e="Auto"),$.each(wepList,function(e,i){var t;t=0==$.id("length"+(i+1)).value?"":$.id("key"+(i+1)).value,$.act(ACT_SET,LAN_WLAN_MSSIDWEPKEY,this.__stack,null,["WEPKey="+t])}),i=1;i<=4&&1!=$.id("keynum"+i).checked;i++);$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=Basic","WEPKeyIndex="+i,"BasicEncryptionModes=WEPEncryption","BasicAuthenticationMode="+e])}else if(1==$.id("secPSK").checked){var t=parseInt($.id("interval").value,10);a=0==$.id("pskCipher").value?"TKIPandAESEncryption":1==$.id("pskCipher").value?"TKIPEncryption":"AESEncryption",0==$.id("pskAuthType").value?$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=WPAand11i","WPAAuthenticationMode=PSKAuthentication","WPAEncryptionModes="+a,"IEEE11iAuthenticationMode=PSKAuthentication","IEEE11iEncryptionModes="+a,"PreSharedKey="+$.id("pskSecret").value,"GroupKeyUpdateInterval="+t]):1==$.id("pskAuthType").value?$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=WPA","WPAAuthenticationMode=PSKAuthentication","WPAEncryptionModes="+a,"PreSharedKey="+$.id("pskSecret").value,"GroupKeyUpdateInterval="+t]):$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=11i","IEEE11iAuthenticationMode=PSKAuthentication","IEEE11iEncryptionModes="+a,"PreSharedKey="+$.id("pskSecret").value,"GroupKeyUpdateInterval="+t])}else if($.id("secWPA").checked=!0){var a;t=parseInt($.id("wpainterval").value,10);a=0==$.id("wpaCipher").value?"TKIPandAESEncryption":1==$.id("wpaCipher").value?"TKIPEncryption":"AESEncryption",0==$.id("wpaAuthType").value?$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=WPAand11i","WPAAuthenticationMode=EAPAuthentication","WPAEncryptionModes="+a,"IEEE11iAuthenticationMode=EAPAuthentication","IEEE11iEncryptionModes="+a,"GroupKeyUpdateInterval="+t,"RadiusServerIP="+$.id("wpaSerIP").value,"RadiusServerPort="+$.id("wpaSerPort").value,"RadiusServerPassword="+$.id("wpaSerPwd").value]):1==$.id("wpaAuthType").value?$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=WPA","WPAAuthenticationMode=EAPAuthentication","WPAEncryptionModes="+a,"GroupKeyUpdateInterval="+t,"RadiusServerIP="+$.id("wpaSerIP").value,"RadiusServerPort="+$.id("wpaSerPort").value,"RadiusServerPassword="+$.id("wpaSerPwd").value]):$.act(ACT_SET,LAN_WLAN_MSSIDENTRY,vapObj.__stack,null,["BeaconType=11i","IEEE11iAuthenticationMode=EAPAuthentication","IEEE11iEncryptionModes="+a,"GroupKeyUpdateInterval="+t,"RadiusServerIP="+$.id("wpaSerIP").value,"RadiusServerPort="+$.id("wpaSerPort").value,"RadiusServerPassword="+$.id("wpaSerPwd").value])}$.exe(function(e){e?$.removeLoading():(vapList=$.act(ACT_GS,LAN_WLAN_MSSIDENTRY,null,wlanObj.__stack,["Name","Enable","SSID","SSIDAdvertisementEnable","isolateClients","BeaconType","BasicAuthenticationMode","WEPKeyIndex","BasicEncryptionModes","WPAEncryptionModes","WPAAuthenticationMode","IEEE11iEncryptionModes","IEEE11iAuthenticationMode","PreSharedKey","GroupKeyUpdateInterval","radiusServerIP","radiusServerPort","radiusServerPassword"]),$.exe(function(e){e||initShow($.id("apsec").value),$.removeLoading()}))})}}function getWlanObj(){var e=$.act(ACT_GL,LAN_WLAN,null,null,["name","SSID","Enable","X_TP_Configuration_Modified","beaconType","Standard","WEPEncryptionLevel","WEPKeyIndex","BasicEncryptionModes","BasicAuthenticationMode","WPAEncryptionModes","WPAAuthenticationMode","IEEE11iEncryptionModes","IEEE11iAuthenticationMode","X_TP_PreSharedKey","X_TP_GroupKeyUpdateInterval","X_TP_RadiusServerIP","X_TP_RadiusServerPort","X_TP_RadiusServerPassword"]);$.exe(),wlanObj=e[0],INCLUDE_LAN_WLAN_MSSID&&(mssidObj=$.act(ACT_GET,LAN_WLAN_MULTISSID,wlanObj.__stack,null,["MultiSSIDEnable"])),wpsObj=$.act(ACT_GET,LAN_WLAN_WPS,wlanObj.__stack,null,["Enable"]),$.exe()}</script>
<p class="et T" id="et">Wireless Security Settings</p>
<div class="con1 L">
<p class="ct"></p>
<p class="bl"></p>
<div class="con2">
<p class="nd" id="11nTip"><i class="T" id="t_note1">Note: WEP security and TKIP encryption are not supported in 11n only mode.</i></p>
<p class="nd" id="qssTip"><i class="T" id="t_note2">Note: WEP security, WPA/WPA2-Enterprise authentication and TKIP encryption are not supported with WPS enabled.</i></p>
<p class="nd" id="mssidTip"><i class="T" id="t_note3">Note: WEP encryption are not supported with Multi SSID enabled.</i></p>
<p><i id="t_note4" class="T">For network security, it is strongly recommended to enable wireless security and use WPA-PSK AES encryption.</i></p>
<p class="br"></p>
<div class="nd" id="MssidSel">
<p>
  <b class="item L">SSID:</b><select id="apsec" name="apsec" style="width:200px" onchange="initShow(1)"></select>
</p>
<p class="br"></p>
</div>
<p><input name="secType" type="radio" value="0" id="secNone"> <b class="T T_wldissec">Disable Wireless Security</b></p>
<p class="br"></p>
<p><input name="secType" type="radio" value="3" id="secPSK"> <b>WPA/WPA2 - Personal<span class="T T_recom">(Recommended)</span></b></p>
<p><b class="item L T T_authtype">Authentication Type:</b> <select id="pskAuthType" name="pskAuthType" class="M">
<option value="0" class="T T_auto">Auto</option>
<option value="1">WPA-PSK</option>
<option value="2">WPA2-PSK</option>
</select></p>
<p><b class="item L T T_encryption">Encryption:</b> <select id="pskCipher" name="pskCipher" class="M">
<option value="0" id="tag_auto" class="T T_auto">Auto</option>
<option value="1">TKIP</option>
<option value="2">AES</option>
</select></p>
<p><b class="item L T T_wlpwd">Password:</b> <input type="text" id="pskSecret" class="text" value="" size="40" maxlength="64"></p>
<p><b class="item L">&nbsp;</b>&nbsp; <span class="T T_pskpwdwarn">(Enter ASCII characters between 8 and 63 or Hexadecimal characters between 8 and 64.)</span></p>
<p><b class="item L T" id="t_time">Group Key Update Period:</b> <input id="interval" type="text" class="text" value="" size="9" maxlength="9"> (<span class="T T_seconds">seconds</span>, <span class="T" id="t_timeval">minimum is 30, 0 means no update</span>)</p>
<p class="br"></p>
<p><input name="secType" type="radio" value="2" id="secWPA"> <b>WPA/WPA2 - Enterprise</b></p>
<p><b class="item L T T_authtype">Authentication Type:</b> <select id="wpaAuthType" name="wpaAuthType" class="M">
<option value="0" class="T T_auto">Auto</option>
<option value="1">WPA</option>
<option value="2">WPA2</option>
</select></p>
<p><b class="item L T T_encryption">Encryption:</b> <select id="wpaCipher" name="wpaCipher" class="M">
<option value="0" id="tag_auto" class="T T_auto">Auto</option>
<option value="1">TKIP</option>
<option value="2">AES</option>
</select></p>
<p><b class="item L T" id="t_srvIp">RADIUS Server IP:</b> <input type="text" id="wpaSerIP" class="text" value="" size="15" maxlength="15"></p>
<p><b class="item L T" id="t_srvPort">RADIUS Server Port:</b> <input type="text" id="wpaSerPort" class="text" value="" size="5" maxlength="5"><span class="T" id="t_wlRadiusPort">(1-65535, 0 stands for default port 1812)</span></p>
<p><b class="item L T" id="t_srvPwd">RADIUS Server Password:</b> <input type="text" id="wpaSerPwd" class="text" value="" size="40" maxlength="64"></p>
<p><b class="item L T" id="t_wlSec_t19">Group Key Update Period:</b> <input id="wpainterval" type="text" class="text" value="" size="9" maxlength="9"><span class="T" id="t_wlSec_t20">(in second, minimum is 30, 0 means no update)</span></p>
<p class="br"></p>
<p><input name="secType" type="radio" value="1" id="secWEP"> <b>WEP</b></p>
<p><b class="item L T T_authtype">Authentication Type:</b> <select id="wepAuthType" name="webAuthType" class="M">
<option value="auto" class="T T_auto">Auto</option>
<option value="open" class="T T_opensys">Open System</option>
<option value="shared" class="T T_sharekey">Shared Key</option>
</select></p>
<p><b class="item L T" id="t_weptype">WEP Key Format:</b> <select id="wepKeyType" name="wepKeyType" onchange="setKey()" class="M">
<option value="1" class="T" id="t_hex">Hexadecimal</option>
<option value="2">ASCII</option>
</select></p>
<p><b class="item L T" id="t_selkey">Selected Key:</b><b class="fl T" style="width:276px" id="t_wepkey">WEP Key</b><b class="T T_keytype">Key Type</b></p>
<p id="wepKeySet1"></p><p id="wepKeySet2"></p><p id="wepKeySet3"></p><p id="wepKeySet4"></p>
</div>
<p class="bl"></p>
<p class="tail" id="tail">
<input type="button" class="button L T T_save" value="Save" onclick="doSave(this)">
</p>
</div>
<script language="javascript">$.loadHelp("wlSec_h.htm");var beaconType,basicAuthenticationMode,WEPKeyIndex,wepLevel,basicEncryptionModes,WPAEncryptionModes,WPAAuthenticationMode,IEEE11iAuthenticationMode,X_TP_PreSharedKey,X_TP_RadiusServerIP,X_TP_RadiusServerPort,X_TP_RadiusServerPassword,wepList,wpsObj,wlanEn,qssEn,wlanObj,wepKeyArray=new Array(4),wlanList=$.act(ACT_GL,LAN_WLAN,null,null,["name","SSID","Enable","X_TP_Band","X_TP_Configuration_Modified","beaconType","Standard","WEPEncryptionLevel","WEPKeyIndex","BasicEncryptionModes","BasicAuthenticationMode","WPAEncryptionModes","WPAAuthenticationMode","IEEE11iEncryptionModes","IEEE11iAuthenticationMode","X_TP_PreSharedKey","X_TP_GroupKeyUpdateInterval"]);if(INCLUDE_LAN_WLAN_MSSID)var mssidObj,vapObj;if($.exe()||($.each(wlanList,function(){"2.4GHz"==this.X_TP_Band&&(wlanObj=this)}),wepList=$.act(ACT_GL,LAN_WLAN_WEPKEY,null,wlanObj.__stack,["WEPKey"]),wpsObj=$.act(ACT_GET,LAN_WLAN_WPS,wlanObj.__stack,null,["Enable"]),INCLUDE_LAN_WLAN_MSSID&&(mssidObj=$.act(ACT_GET,LAN_WLAN_MULTISSID,wlanObj.__stack,null,["MultiSSIDEnable"])),$.exe(),wlanEn=wlanObj.enable,qssEn=wpsObj.enable),INCLUDE_LAN_WLAN_MSSID){var vapList=$.act(ACT_GS,LAN_WLAN_MSSIDENTRY,null,wlanObj.__stack,["Name","Enable","SSID","SSIDAdvertisementEnable","isolateClients","BeaconType","BasicAuthenticationMode","WEPKeyIndex","BasicEncryptionModes","WPAEncryptionModes","WPAAuthenticationMode","IEEE11iEncryptionModes","IEEE11iAuthenticationMode","PreSharedKey","GroupKeyUpdateInterval","radiusServerIP","radiusServerPort","radiusServerPassword"]);if(INCLUDE_LAN_WLAN_GUESTNETWORK)var guestNetObj=$.act(ACT_GET,LAN_WLAN_GUESTNET,wlanObj.__stack,null,["Name"]);$.exe()}initShow(0),INCLUDE_LAN_WLAN_MSSID&&initSelect()</script>
