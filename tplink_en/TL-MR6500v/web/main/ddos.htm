<style>td.notice{vertical-align:top;width:230px;margin:0;text-align:left;padding-top:15px}label.notice_lbl{padding-top:5px}td.value{text-align:left}</style>
<h3 id="t_firewall">SPI Firewall</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="button-group-container" id="enableFirewallV4">
            <b id="t_v4" class="xl">IPv4 SPI Firewall:</b>
            <ul>
                <li>
                    <button id="enableFirewallV4On" class="fst" value="on">On</button>
                </li>
                <li>
                    <button id="enableFirewallV4Off" class="lst" value="off">Off</button>
                </li>
            </ul>
        </div>
    </form>
</div>
<h3 id="t_dos">DoS Protection</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="button-group-container" id="enableDoSProtection">
            <b id="t_en" class="m">Enable DoS Protection</b>
            <ul>
                <li>
                    <button id="enableDoSProtectionOn" class="fst" value="on">On</button>
                </li>
                <li>
                    <button id="enableDoSProtectionOff" class="lst" value="off">Off</button>
                </li>
            </ul>
            <div style="display:inline-block;vertical-align:middle">
                <div style="display:table;margin-left:9px">
                    <div id="enable-ddos-tips" style="display:table-cell;width:240px;color:#b2b2b2;height:30px;line-height:15px">
                    </div>
                </div>
            </div>
        </div>
        <br>
        <b id="t_icmpfilter" class="xl">ICMP-FLOOD Attack Filtering:</b>
        <select id="ICMPFiltering">
            <option class="T_c_off" value="0">Off</option>
            <option class="T_c_low" value="1">Low</option>
            <option class="T_c_mid" value="2">Middle</option>
            <option class="T_c_hig" value="3">High</option>
        </select>
        <b id="t_udpfilter" class="xl">UDP-FLOOD Attack Filtering:</b>
        <select id="UDPFiltering">
            <option class="T_c_off" value="0">Off</option>
            <option class="T_c_low" value="1">Low</option>
            <option class="T_c_mid" value="2">Middle</option>
            <option class="T_c_hig" value="3">High</option>
        </select>
        <b id="t_tcpfilter" class="xl">TCP-FLOOD Attack Filtering:</b>
        <select id="TCPSYNFiltering">
            <option class="T_c_off" value="0">Off</option>
            <option class="T_c_low" value="1">Low</option>
            <option class="T_c_mid" value="2">Middle</option>
            <option class="T_c_hig" value="3">High</option>
        </select>
        <button type="submit" class="green T_save" id="saveDosProtection">Save</button>
    </form>
</div>
<h3 id="t_list">Blocked DoS Host List</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <div class="table-op">
            <div class="panel-title" id="t_blockNum"></div>
            <div class="table-btn">
                <span id="refreshDosHostList" class="refresh-icon"></span>
                <label class="T_refresh">Refresh</label>
                <span id="clearDosHostList" class="delete-icon"></span>
                <label class="T_del">Delete</label>
            </div>
        </div>
        <table id="tableBlockedDosHostList">
            <thead></thead>
            <tbody id="bodyBlockedDosHostList">
            </tbody>
        </table>
    </form>
</div>
<h3 id="t_levelset">Dos Protection Level Settings</h3>
<div class="content-container">
    <form class="pure-form pure-form-aligned">
        <table id="tblDos">
            <tbody>
                <tr>
                    <td class="notice">
                        <label id="t_icmplevel" class="notice_lbl">ICMP-FLOOD Protection Level:</label>
                    </td>
                    <td class="value">
                        <div id="icmpLow" class="inline">
                            <b class="T_c_lowth">Low Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                        <div id="icmpMiddle" class="inline">
                            <b class="T_c_midth">Middle Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                        <div id="icmpHigh" class="inline">
                            <b class="T_c_higth">High Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="notice">
                        <label id="t_udplevel" class="notice_lbl">UDP-FLOOD Protection Level:</label>
                    </td>
                    <td class="value">
                        <div id="udpLow" class="inline">
                            <b class="T_c_lowth">Low Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                        <div id="udpMiddle" class="inline">
                            <b class="T_c_midth">Middle Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                        <div id="udpHigh" class="inline">
                            <b class="T_c_higth">High Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td class="notice">
                        <label id="t_tcplevel" class="notice_lbl">TCP-SYN-FLOOD Protection Level:</label>
                    </td>
                    <td class="value">
                        <div id="tcpLow" class="inline">
                            <b class="T_c_lowth">Low Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                        <div id="tcpMiddle" class="inline">
                            <b class="T_c_midth">Middle Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                        <div id="tcpHigh" class="inline">
                            <b class="T_c_higth">High Thresholds:</b>
                            <input type="text" class="s" value="" maxlength="4" required>
                        </div>
                        <div class="inline">
                            <p class="T_c_unit">(5~3600) Packets/Secs</p>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <button type="submit" class="green T_save" id="saveDosLevel">Save</button>
    </form>
</div>
<script language="javascript">!function(){var L;function b(){var l=new Array,i=$.act(ACT_GL,DOS_HOST,null,null);$.exe(function(e){e?$("#t_blockNum").append(0):($.each(i,function(e){l.push([{text:'<div><input type="checkbox" id="'+e+'" class="table-select-one" /><label></label></div>',width:"5%"},{text:e+1,width:"5%"},{text:$.num2ip(parseInt(this.ipAddress)),width:"15%"},{text:this.macAddress,width:"15%"},{text:"<span class='table-grid-icon edit-trash-icon'></span>",width:"15%"}]),L[e+1]=this.__stack}),$.initTableBody($("#tableBlockedDosHostList"),l),$.tablePages($("#tableBlockedDosHostList"),5),$("#t_blockNum").append(l.length),$("span.edit-trash-icon").click(function(){var e=$(this).parents("tr").find("td:eq(1)").text();if(e<0||""==e)return!0;$.act(ACT_DEL,DOS_HOST,L[e],null),$.exe(function(e){e||$.reload()})}))})}$.tpInit(function(){L=[];var e=$("#icmpLow").find("input").val(),l=$("#icmpMiddle").find("input").val(),i=$("#icmpHigh").find("input").val(),t=$("#udpLow").find("input").val(),n=$("#udpMiddle").find("input").val(),a=$("#udpHigh").find("input").val(),d=$("#tcpLow").find("input").val(),o=$("#tcpMiddle").find("input").val(),c=$("#tcpHigh").find("input").val(),s=[{text:'<div><input type="checkbox" id="checkbox_1" class="table-select-all" /><label></label><div>',width:"5%"},{text:table_str.id,width:"5%"},{text:table_str.ip,width:"15%"},{text:table_str.mac,width:"15%"},{text:table_str.modify,width:"5%"}];$.initTableHead($("#tableBlockedDosHostList"),s),$("#tableBlockedDosHostList").tpTable(b),$("#enableSPIFirewall_on").click(function(){$(this).addClass("selected"),$("#enableSPIFirewall_off").removeClass("selected")}),$("#enableSPIFirewall_off").click(function(){$(this).addClass("selected"),$("#enableSPIFirewall_on").removeClass("selected")});var p=$.act(ACT_GET,FIREWALL,null,null,["enableSpiFirewall"]),u=$.act(ACT_GET,DDOS_CFG,null,null),r=$.act(ACT_GET,STAT_CFG,null,null,["enable"]),v=$.act(ACT_GET,ALG_CFG,null,null);if(!$.exe()){var h=p.enableSpiFirewall;r.enable;1==h?$("#enableFirewallV4On").addClass("selected"):$("#enableFirewallV4Off").addClass("selected"),$("#enableFirewallV4").tpBtnGroup(),e=u.icmpLevelLow,l=u.icmpLevelMiddle,i=u.icmpLevelHigh,t=u.udpLevelLow,n=u.udpLevelMiddle,a=u.udpLevelHigh,d=u.synLevelLow,o=u.synLevelMiddle,c=u.synLevelHigh,$("#icmpLow").find("input").val(e),$("#icmpMiddle").find("input").val(l),$("#icmpHigh").find("input").val(i),$("#udpLow").find("input").val(t),$("#udpMiddle").find("input").val(n),$("#udpHigh").find("input").val(a),$("#tcpLow").find("input").val(d),$("#tcpMiddle").find("input").val(o),$("#tcpHigh").find("input").val(c),Number(v.hw_nat_enable)&&$("#enable-ddos-tips").html($.tpLang.ddos_nstr.t_enable_tips),1==u.enable&&1==r.enable?$("#enableDoSProtectionOn").addClass("selected"):$("#enableDoSProtectionOff").addClass("selected"),1==u.enableIcmpFilter?u.icmpThreshold==e?$('#ICMPFiltering option[value="1"]').prop("selected","selected"):u.icmpThreshold==l?$('#ICMPFiltering option[value="2"]').prop("selected","selected"):u.icmpThreshold==i&&$('#ICMPFiltering option[value="3"]').prop("selected","selected"):0==u.enableIcmpFilter&&$('#ICMPFiltering option[value="0"]').prop("selected","selected"),1==u.enableUdpFilter?u.udpThreshold==t?$('#UDPFiltering option[value="1"]').prop("selected","selected"):u.udpThreshold==n?$('#UDPFiltering option[value="2"]').prop("selected","selected"):u.udpThreshold==a&&$('#UDPFiltering option[value="3"]').prop("selected","selected"):0==u.enableUdpFilter&&$('#UDPFiltering option[value="0"]').prop("selected","selected"),1==u.enableSynFilter?u.synThreshold==d?$('#TCPSYNFiltering option[value="1"]').prop("selected","selected"):u.synThreshold==o?$('#TCPSYNFiltering option[value="2"]').prop("selected","selected"):u.synThreshold==c&&$('#TCPSYNFiltering option[value="3"]').prop("selected","selected"):0==u.enableSynFilter&&$('#TCPSYNFiltering option[value="0"]').prop("selected","selected")}function f(){var l=0,e=$("#tableBlockedDosHostList").find("tbody tr td"),i=e.find("span.checkbox-click").parents("tr");e.find("span.checkbox-click").each(function(){var e=$(this).parents("tr").find("td:eq(1)").text();if(1==l&&e--,e<0||""==e)return!0;$.act(ACT_DEL,DOS_HOST,L[e],null),l=1}),i.remove();var t=0;$("#tableBlockedDosHostList").find("thead tr th").each(function(){t++}),$.addEmptyBody($("#tableBlockedDosHostList"),t),$.exe(function(e){e||$.reload()})}$("#refreshDosHostList").on("click",function(e){$.addLoading($("#refreshDosHostList"),200,function(){$.reload()})}),$("#clearDosHostList").on("click",function(e){$.confirm(c_str.del_choosed,f,null)}),$("#enableFirewallV4On").on("click",function(){$.addLoading($(this)),$.act(ACT_SET,FIREWALL,null,null,["enableSpiFirewall=1"]),$.exe(function(e){$.removeLoading(),e||($.removeLoading(),$.reload())})}),$("#enableFirewallV4Off").on("click",function(){$.addLoading($(this)),$.act(ACT_SET,FIREWALL,null,null,["enableSpiFirewall=0"]),$.exe(function(e){$.removeLoading(),e||($.removeLoading(),$.reload())})})}),$("#enableDoSProtectionOn").click(function(){var i=$.act(ACT_GET,ALG_CFG,null,null);if($.exe(),"1"==i.hw_nat_enable)$.confirm(c_str.dos_hwnat_conflict,function(){i.hw_nat_enable="0",$.act(ACT_SET,ALG_CFG,null,null,i),$.exe(function(e){e||($.removeLoading(),$.reload())});var e={enable:1},l={enable:1};$.act(ACT_SET,DDOS_CFG,null,null,e),$.act(ACT_SET,STAT_CFG,null,null,l),$.exe(function(e){e||$.reload()})},function(){$.reload()});else{var e={enable:1},l={enable:1};$.act(ACT_SET,DDOS_CFG,null,null,e),$.act(ACT_SET,STAT_CFG,null,null,l),$.exe(function(e){e||$.reload()})}}),$("#enableDoSProtectionOff").click(function(){var e={enable:0};$.act(ACT_SET,DDOS_CFG,null,null,e),$.exe(function(e){e||$.reload()})}),$("#delete-icon").click(function(){var e=$("#tableBlockedDosHostList").find("tbody tr td"),l=e.find("span.checkbox-click").parents("tr");e.find("span.checkbox-click").each(function(){var e=$(this).parents("tr").find("td:eq(1)").text();if(e<0||""==e)return!0;$.act(ACT_DEL,DOS_HOST,L[e],null)}),l.remove();var i=0;$("#tableBlockedDosHostList").find("thead tr th").each(function(){i++}),$.addEmptyBody($("#tableBlockedDosHostList"),i),$.exe(function(e){e||$.reload()})}),$("#saveDosProtection").click(function(){$.addLoading($(this)),function(e){var l={};l.enableIcmpFilter=0==$("#ICMPFiltering").data("value")?0:1,1==$("#ICMPFiltering").data("value")?l.icmpThreshold=$("#icmpLow").find("input").val():2==$("#ICMPFiltering").data("value")?l.icmpThreshold=$("#icmpMiddle").find("input").val():3==$("#ICMPFiltering").data("value")&&(l.icmpThreshold=$("#icmpHigh").find("input").val());l.enableUdpFilter=0==$("#UDPFiltering").data("value")?0:1,1==$("#UDPFiltering").data("value")?l.udpThreshold=$("#udpLow").find("input").val():2==$("#UDPFiltering").data("value")?l.udpThreshold=$("#udpMiddle").find("input").val():3==$("#UDPFiltering").data("value")&&(l.udpThreshold=$("#udpHigh").find("input").val());l.enableSynFilter=0==$("#TCPSYNFiltering").data("value")?0:1,1==$("#TCPSYNFiltering").data("value")?l.synThreshold=$("#tcpLow").find("input").val():2==$("#TCPSYNFiltering").data("value")?l.synThreshold=$("#tcpMiddle").find("input").val():3==$("#TCPSYNFiltering").data("value")&&(l.synThreshold=$("#tcpHigh").find("input").val());$.act(ACT_SET,DDOS_CFG,null,null,l),$.exe(function(e){$.removeLoading(),e||$.reload()})}()}),$("#saveDosLevel").click(function(){$.addLoading($(this)),function(){var e={};e.icmpLevelLow=$("#icmpLow").find("input").val(),e.icmpLevelMiddle=$("#icmpMiddle").find("input").val(),e.icmpLevelHigh=$("#icmpHigh").find("input").val();var l=$("#ICMPFiltering").data("value");e.icmpThreshold="1"==l?e.icmpLevelLow:"2"==l?e.icmpLevelMiddle:"3"==l?e.icmpLevelHigh:e.icmpLevelLow,e.udpLevelLow=$("#udpLow").find("input").val(),e.udpLevelMiddle=$("#udpMiddle").find("input").val(),e.udpLevelHigh=$("#udpHigh").find("input").val();var i=$("#UDPFiltering").data("value");e.udpThreshold="1"==i?e.udpLevelLow:"2"==i?e.udpLevelMiddle:"3"==i?e.udpLevelHigh:e.udpLevelLow,e.synLevelLow=$("#tcpLow").find("input").val(),e.synLevelMiddle=$("#tcpMiddle").find("input").val(),e.synLevelHigh=$("#tcpHigh").find("input").val();var t=$("#TCPSYNFiltering").data("value");e.synThreshold="1"==t?e.synLevelLow:"2"==t?e.synLevelMiddle:"3"==t?e.synLevelHigh:e.synLevelLow,$.act(ACT_SET,DDOS_CFG,null,null,e),$.exe(function(e){$.removeLoading(),e||$.reload()})}()})}()</script>
