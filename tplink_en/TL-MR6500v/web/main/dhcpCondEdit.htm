<script>var condOptStack;function initCondEdit(){if(isEdit){$("#groupView").removeClass("nd"),$("#groupSel").addClass("nd"),$.each(brLanList,function(){condPoolList[condEditIndex].__stack.split(",")[0]==this.__stack.split(",")[0]&&$("#brName").html(this.bridgeName)}),$("#dev").val(condPoolList[condEditIndex].X_TP_DeviceName),$("#vid").val(condPoolList[condEditIndex].vendorClassID),$("#gw").tpAddress("val",condPoolList[condEditIndex].IPRouters),$("#sip").tpAddress("val",condPoolList[condEditIndex].minAddress),$("#eip").tpAddress("val",condPoolList[condEditIndex].maxAddress),$("#devType option[value="+condPoolList[condEditIndex].X_TP_DeviceType+"]").prop("selected","selected"),$("#condEn").prop("checked",1==condPoolList[condEditIndex].enable);var e=$.act(ACT_GS,LAN_DHCP_COND_SRV_POOL_OPT,null,condPoolList[condEditIndex].__stack,["tag","value"]);!$.exe()&&0<e.length&&(condOptStack=e[0].__stack,"STB"==condPoolList[condEditIndex].X_TP_DeviceType?($("#stbOptVal").val(e[0].value),$("#dns1").tpAddress("val",condPoolList[condEditIndex].DNSServers.split(",")[0]),$("#dns2").tpAddress("val",condPoolList[condEditIndex].DNSServers.split(",")[1])):"STB"!=condPoolList[condEditIndex].X_TP_DeviceType&&"Unknown"!=condPoolList[condEditIndex].X_TP_DeviceType&&($("#optCode option[value="+e[0].tag+"]").prop("selected","selected"),$("#optVal").val(e[0].value)))}else $("#groupView").addClass("nd"),$("#groupSel").removeClass("nd"),$.each(brLanList,function(){var e="<option value="+this.__stack+">"+this.bridgeName+"</option>";$("#groupSelection").append(e)});showDevType()}function showDevType(){"STB"==$("#devType").data("value")?($("#stbOpt").removeClass("nd"),$("#resvOpt").addClass("nd")):"Unknown"==$("#devType").data("value")?($("#stbOpt").addClass("nd"),$("#resvOpt").addClass("nd")):($("#stbOpt").addClass("nd"),$("#resvOpt").removeClass("nd"))}function clickOK(){var e;if(!$.isname($("#dev").val()))return $.alert(ERR_DHCP_COND_POOL_DEV_NAME_INVALID),(e=$("#dev"))&&(e.focus(),e.select()),!1;if(""==$("#dev").val())return $.alert(ERR_DHCP_COND_POOL_DEV_NAME_EMPTY),(e=$("#dev"))&&(e.focus(),e.select()),!1;if(""==$("#vid").val())return $.alert(ERR_DHCP_COND_POOL_VID_EMPTY),(e=$("#vid"))&&(e.focus(),e.select()),!1;if(-1!=$("#vid").val().indexOf('"'))return $.alert(ERR_DHCP_COND_POOL_VID_INVAD),(e=$("#vid"))&&(e.focus(),e.select()),!1;if($.ifip($("#sip").tpAddress("val"),!0))return $.alert(ERR_DHCP_COND_POOL_START_IP_INVAD),$("#sip").tpAddress("focus"),!1;if($.ifip($("#eip").tpAddress("val"),!0))return $.alert(ERR_DHCP_COND_POOL_END_IP_INVAD),$("#eip").tpAddress("focus"),!1;if(0==parseInt($("#sip").tpAddress("val").split(".")[3],10)||255==parseInt($("#sip").tpAddress("val").split(".")[3],10))return $.alert(ERR_DHCP_START_IP_INVAD_1),$("#sip").tpAddress("focus"),!1;if(0==parseInt($("#eip").tpAddress("val").split(".")[3],10)||255==parseInt($("#eip").tpAddress("val").split(".")[3],10))return $.alert(ERR_DHCP_END_IP_INVAD_1),$("#eip").tpAddress("focus"),!1;if(!$.isOrderIp($("#sip").tpAddress("val"),$("#eip").tpAddress("val")))return $.alert(ERR_TC_IP_ORDER_INVAD),$("#eip").tpAddress("focus"),!1;if($.ifip($("#gw").tpAddress("val"),!0))return $.alert(ERR_DHCP_COND_POOL_GW_INVAD),$("#gw").tpAddress("focus"),!1;if("STB"==$("#devType").data("value")){if(""==$("#stbOptVal").val())return $.alert(ERR_DHCP_COND_POOL_OPT_VAL_EMPTY),(e=$("#optVal"))&&(e.focus(),e.select()),!1;if($.ifip($("#dns1").tpAddress("val"),!0))return $.alert(ERR_DHCP_COND_DNS1_INVAD),void $("#dns1").tpAddress("focus");if(""!=$("#dns2").tpAddress("val")&&"0.0.0.0"!=$("#dns2").tpAddress("val")&&$.ifip($("#dns2").tpAddress("val"),!0))return $.alert(ERR_DHCP_COND_DNS2_INVAD),void $("#dns2").tpAddress("focus")}else if("STB"!=$("#devType").data("value")&&"Unknown"!=$("#devType").data("value")&&""==$("#optVal").val())return $.alert(ERR_DHCP_COND_POOL_OPT_VAL_EMPTY),(e=$("#optVal"))&&(e.focus(),e.select()),!1;var d={};if(d.X_TP_DeviceName=$("#dev").val(),d.vendorClassID=$("#vid").val(),d.IPRouters=$("#gw").tpAddress("val"),d.minAddress=$("#sip").tpAddress("val"),d.maxAddress=$("#eip").tpAddress("val"),d.X_TP_DeviceType=$("#devType").data("value"),d.DNSServers=(""!=$("#dns1").tpAddress("val")?$("#dns1").tpAddress("val"):"0.0.0.0")+","+(""!=$("#dns2").tpAddress("val")?$("#dns2").tpAddress("val"):"0.0.0.0"),d.enable=1==$("#condEn").prop("data-checked")?1:0,isEdit)$.act(ACT_SET,LAN_DHCP_COND_SRV_POOL,condPoolList[condEditIndex].__stack,null,d),"Unknown"!=condPoolList[condEditIndex].X_TP_DeviceType&&"Unknown"==d.X_TP_DeviceType?$.act(ACT_DEL,LAN_DHCP_COND_SRV_POOL_OPT,condOptStack,null,null):"Unknown"==condPoolList[condEditIndex].X_TP_DeviceType&&"Unknown"!=d.X_TP_DeviceType?$.act(ACT_ADD,LAN_DHCP_COND_SRV_POOL_OPT,null,condPoolList[condEditIndex].__stack,["tag="+("STB"==d.X_TP_DeviceType?240:$("#optCode").data("value")),"value="+("STB"==d.X_TP_DeviceType?$("#stbOptVal").val():$("#optVal").val())]):"Unknown"!=condPoolList[condEditIndex].X_TP_DeviceType&&"Unknown"!=d.X_TP_DeviceType&&$.act(ACT_SET,LAN_DHCP_COND_SRV_POOL_OPT,condOptStack,null,["tag="+("STB"==d.X_TP_DeviceType?240:$("#optCode").data("value")),"value="+("STB"==d.X_TP_DeviceType?$("#stbOptVal").val():$("#optVal").val())]),$.exe(function(e){e||($.removeLoading(),$.reload())});else{var t=$("#groupSelection").data("value"),s=$.act(ACT_ADD,LAN_DHCP_COND_SRV_POOL,null,t,d);if("Unknown"!=d.X_TP_DeviceType){if($.exe())return;$.act(ACT_ADD,LAN_DHCP_COND_SRV_POOL_OPT,null,s.__stack,["tag="+("STB"==d.X_TP_DeviceType?240:$("#optCode").data("value")),"value="+("STB"==d.X_TP_DeviceType?$("#stbOptVal").val():$("#optVal").val())])}$.exe(function(e){e||$.removeLoading(),$.reload()})}}function clickCancel(){$.reload()}</script>
<div class="content-container" id="add">
    <form class="pure-form pure-form-aligned">
        <div id="groupView" class="pure-control-group">
            <label class="label-title T_c_group">Group:</label>
            <span class="text" id="brName"></span>
        </div>
        <div>
            <b id="t_facility">Facility:</b>
            <input type="text" id="dev" required>
        </div>
        <div>
            <b id="t_vendor">Vendor ID:</b>
            <input type="text" id="vid" required>
        </div>
        <div>
            <b id="t_poolstart">Start IP Address:</b>
            <input type="text" id="sip" required class="ip-address">
        </div>
        <div>
            <b id="t_poolend">End IP Address:</b>
            <input type="text" id="eip" required class="ip-address">
        </div>
        <div>
            <b class="T_defgw">Default Gateway:</b>
            <input type="text" id="gw" required class="ip-address">
        </div>
        <div>
            <b id="t_devtype">Device Type:</b>
            <select class="l" id="devType">
                <option id="t_pc" value="PC">PC</option>
                <option id="t_camera" value="Camera">Camera</option>
                <option id="t_hgw" value="HGW">HGW</option>
                <option id="t_stb" value="STB">STB</option>
                <option id="t_phone" value="Phone">Phone</option>
                <option id="t_unkown" value="Unknown">Unknown</option>
            </select>
        </div>
        <div id="resvOpt">
            <div>
                <b id="t_addopt1">Add Option:</b>
                <select class="l" id="optCode">
                    <option id="t_opt241" value="241" selected="selected">Option 241</option>
                    <option id="t_opt242" value="242">Option 242</option>
                    <option id="t_opt243" value="243">Option 243</option>
                    <option id="t_opt244" value="244">Option 244</option>
                    <option id="t_opt245" value="245">Option 245</option>
                </select>
            </div>
            <div>
                <b id="t_optval1">Option Value:</b>
                <input type="text" id="optVal" maxlength="127" required>
            </div>
        </div>
        <div id="stbOpt">
            <div class="pure-control-group">
                <label class="label-title" id="t_addopt2">Add Option:</label>
                <span class="T_option">Option</span>
                <span>240</span>
            </div>
            <div>
                <b id="t_optval2">Option Value:</b>
                <input id="stbOptVal" type="text" maxlength="127">
            </div>
            <div>
                <b class="T_dns">DNS Server:</b>
                <input id="dns1" type="text" maxlength="15" class="ip-address">
            </div>
            <div>
                <b class="T_secdns">Secondary DNS Server:</b>
                <input id="dns2" type="text" maxlength="15" class="ip-address">
            </div>
        </div>
        <div id="groupSel">
            <b class="T_group">Group:</b>
            <select class="l" id="groupSelection">
            </select>
        </div>
        <div>
            <b></b>
            <input type="checkbox" id="condEn" checked="true">
            <label class="T_c_enable">Enable this entry</label>
        </div>
        <p class="br"></p>
        <div class="inline-btn-right">
            <button type="submit" class="green inline T_cancel" id="editCondPoolCancel">Cancel</button>
            <button type="submit" class="green inline T_save" id="editCondPoolOK">Save</button>
        </div>
        <p class="br"></p>
    </form>
</div>
<script>$("#devType").on("click",function(n){showDevType()}),$("#editCondPoolOK").on("click",function(n){$.addLoading($(this)),clickOK()}),$("#editCondPoolCancel").on("click",function(n){clickCancel()}),$.tpInit(initCondEdit)</script>
