<script language="javascript">var checkeds=new Array,tlb=$.id("dialPlanTlb"),voipDialPlan=[],voipAccounts=[];function freshTable(){if(voipDialPlanTmp=$.act(ACT_GL,XTP_IGD_MULTIISPDP_LIST,null,null,["attr","prefix","replace"]),0==$.exe()){voipDialPlan=[],$.each(voipDialPlanTmp,function(e,l){(parseInt(this.attr,10)&BARRING_MASK)>>>BARRING_MASK!=0&&voipDialPlan.push(this)});for(var c,r,e=tlb.rows.length,l=1;l<e;l++)tlb.deleteRow(1);var o=[];for(var a in checkeds)o[a]=!1;for(var a in $.each(voipDialPlan,function(e,l){var a,i=this.prefix,n=parseInt(this.attr,10);c=tlb.insertRow(-1),(r=c.insertCell(-1)).innerHTML=i,r=c.insertCell(-1);var t=(n&BARRING_MASK)>>>BARRING_SHIFT;a=(4&t?"PSTN / ":"")+(2&t?n_str.voice_dialplan.t_name8:"")+(1&t?n_str.voice_dialplan.t_name9:""),r.innerHTML=a.length?a.slice(0,-3):"",r=c.insertCell(-1),$.addClass(r,"tc"),r.innerHTML="<input type='checkbox' onclick='selectOnclick(\""+i+"\")' "+(checkeds[i]?"checked='checked'":"")+" /> ",r=c.insertCell(-1),$.addClass(r,"tc"),r.innerHTML="<span class='a T T_edit' onclick='editOnclick(\""+i+"\")'>"+m_str.edit+"</span>",o[i]=!0}),checkeds)0==o[a]&&(checkeds[a]=null);var i=!0,n=!0;0<voipDialPlan.length&&(i=!1),voipDialPlan.length<20&&(n=!1),$.id("selectAll").disabled=i,$.id("unselectAll").disabled=i,$.id("remove").disabled=i,$.id("add").disabled=n}}function initDialPlan(){$.auto(freshTable,VOICE_FRESH_TIME,!0)}function selectOnclick(e){checkeds[e]=!checkeds[e],freshTable()}function editOnclick(e){var l;for(freshTable(),l=0;l<voipDialPlan.length&&voipDialPlan[l].prefix!=e;l++);if(l<voipDialPlan.length){var a=new Object;a.item=voipDialPlan[l],$.loadMain("voice_addforbiddencall.htm",a)}else $.alert(ERR_VOIP_DIALPLAN_DEL)}function addOnclick(){freshTable(),20<=voipDialPlan.length&&$.alert(ERR_VOIP_TOO_MANY_DIALPLAN);var e=new Object;e.item=null,$.loadMain("voice_addforbiddencall.htm",e)}function selectAllOnclick(a){$.each(voipDialPlan,function(e,l){checkeds[this.prefix]=a}),freshTable()}function removeOnclick(e){var a=!1;if($.each(voipDialPlan,function(e,l){!0===checkeds[this.prefix]&&(a=!0)}),0!=a){freshTable(),$.addLoading(e);for(var l=voipDialPlan.length-1;0<=l;l--)!0===checkeds[voipDialPlan[l].prefix]&&(checkeds[voipDialPlan[l].prefix]=!1,attr=parseInt(voipDialPlan[l].attr,10),(attr&ENABLE_MASK)>>>ENABLE_SHIFT!=0||(attr&EMERGENCY_MASK)>>>EMERGENCY_SHIFT!=0?(temp={},temp.attr=attr&~BARRING_MASK,$.act(ACT_SET,XTP_IGD_MULTIISPDP_LIST,voipDialPlan[l].__stack,null,temp)):$.act(ACT_DEL,XTP_IGD_MULTIISPDP_LIST,voipDialPlan[l].__stack,null,null));actForSendMsg(),$.exe(function(e){e||$.reload()})}}</script>
<p class="et"><b class="T T_forbiddencall">Forbidden Call</b></p>
<div class="con1 XXL">
<p class="ct T T_forbiddencall">Forbidden Call</p>
<p class="bl"></p>
<div class="con2">
	<p class="T" id="t_info">Maximum 20 entries can be configured.</p>
	<p class="br"></p>
	<table id="dialPlanTlb" align="center" class="bdr XXXL" cellpadding="0" cellspacing="0">
		<tr>
			<th class="T T_prefix">Prefix</th>
			<th class="T" id="t_forbidden">Forbidden</th>
			<th class="T T_remove">Remove</th>
			<th class="T T_edit">Edit</th>
		</tr>
	</table>
</div>
<p class="bl"></p>
<p class="tail">
	<input type="button" id="add" class="button L T T_add" value="Add" onclick="addOnclick()">
	<input type="button" id="selectAll" class="button L T T_selectall" value="Select All" onclick="selectAllOnclick(!0)">
	<input type="button" id="unselectAll" class="button L T T_unselectall" value="Deselect All" onclick="selectAllOnclick(!1)">
	<input type="button" id="remove" class="button L T T_remove" value="Remove" onclick="removeOnclick(this)">
</p>
</div>
<script language="javascript">$.loadHelp(),initDialPlan()</script>
