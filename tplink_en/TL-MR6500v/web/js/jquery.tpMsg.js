!function($){"use strict";function TpMsg(elem,options){this.type=options.type,this.title=options.title,this.initialised=!1,this.elem=$(elem),this.content=options.content||"",this.yes=options.yes||"",this.no=options.no||"",this.callbackOk=options.callbackOk||"",this.callbackNo=options.callbackNo||"",this.closeFlag=options.closeFlag||0}TpMsg.prototype={constructor:TpMsg,init:function(){var isProgressBar="progress-bar"==this.type,isComplexMsg="complex-msg"==this.type,isSuccess="toast-success"==this.type,isFail="toast-fail"==this.type,inHTML="";return inHTML+='<div class="msg-wrap">',inHTML+=isProgressBar?"":'<a class="widget-close msg-close" href="javascript:void(0);"></a>',inHTML+='<div class="msg-content-wrap">',this.title&&(inHTML+='<h3 class="widget-title msg-title">',inHTML+='<span class="msg-title-container">'+this.title+"</span>",inHTML+="</h3>"),inHTML+='<div class="widget-content msg-content-container">',isComplexMsg?inHTML+='<div id="complexMsg"></div>':(inHTML+='<div class="grid-warning-msg">',inHTML+=isProgressBar?"":'<span class="icon '+(isSuccess?"icon-success":isFail?"icon-fail":"")+'"></span>',inHTML+='<span class="text"'+(isProgressBar?'style="display:inline;"':"")+">"+this.content+"</span>",inHTML+="</div>"),inHTML+="</div>",inHTML+="</div>",inHTML+="</div>","progress-bar"==this.type||isComplexMsg||(inHTML+='<div class="msg-btn-container">',inHTML+='<div class="msg-btn-wrap">',("confirm"==this.type||isComplexMsg)&&(inHTML+='<div class="button-container in-line">',inHTML+='<button type="button" class="button-buttonlarge green pure-button btn-msg btn-msg-no btn-confirm">',inHTML+="<span>"+this.no+"</span>",inHTML+="</button>",inHTML+="</div>"),inHTML+='<div class="button-container in-line">',inHTML+='<button type="button" class="button-buttonlarge green pure-button btn-msg btn-msg-ok btn-confirm">',inHTML+=isSuccess||isFail?"<span>"+$.tpLang.m_str.ok+"</span>":"<span>"+this.yes+"</span>",inHTML+="</button>",inHTML+="</div>",inHTML+="</div>",inHTML+="</div>"),inHTML='<div class="position-top-left"></div>'+(inHTML='<div class="position-top-center"></div>'+(inHTML='<div class="position-top-right"></div>'+(inHTML='<div class="position-center-left">'+(inHTML='<div class="position-center-right">'+inHTML+"</div>")+"</div>"))),inHTML+='<div class="position-bottom-left"></div>',inHTML+='<div class="position-bottom-center"></div>',inHTML='<div class="msg-container-wrapper">'+(inHTML+='<div class="position-bottom-right"></div>')+"</div>",this.elem.html(inHTML).addClass("widget-container msg-container grid-popup-msg msg-container-center"),this._attachEvent(),this},destroy:function(){return this.initialised=!1,this.elem.off(".tpMsg").removeData("tpMsg").empty(),this},_attachEvent:function(){if(!this.initialised){var self=this,defaultOps=function(e){(e.preventDefault(),$.removeLoading(),"complex-msg"!=this.type)?$.hideCover():(0==$("div.mask#complex-mask").length?$('<div id="complex-mask" class="mask"><div id="complex-cover-loading"></div></div>').appendTo($("body#mainBody")):$("div.mask#complex-mask")).fadeOut(200,function(){$(this).css("display","none")});this.elem.hide(),$("body").off(".tpMsg");try{this.activeEl&&this.activeEl.focus()}catch(e){}};this.elem.on("click.tpMsg","a.msg-close",function(e){defaultOps.call(self,e),1==self.closeFlag||self.callbackNo&&self.callbackNo()}),this.elem.on("click.tpMsg","button.btn-msg-ok",function(e){defaultOps.call(self,e),self.callbackOk&&self.callbackOk()}),"confirm"==this.type&&this.elem.on("click.tpMsg","button.btn-msg-cancel",function(e){defaultOps.call(self,e)}).on("click.tpMsg","button.btn-msg-no",function(e){defaultOps.call(self,e),self.callbackNo&&self.callbackNo()})}},_getActiveEl:function(){var self=this;$("body").on("keydown.tpMsg",function(){if(void 0===self.activeEl&&(self.activeEl=document.activeElement),"complex-msg"!=self.type)return!1}).on("mousedown.tpMsg",function(){void 0===self.activeEl&&(self.activeEl=document.activeElement)})},show:function(){(this._getActiveEl(),"complex-msg"!=this.type)?$.showCover():(0==$("div.mask#complex-mask").length?$('<div id="complex-mask" class="mask"><div id="complex-cover-loading"></div></div>').appendTo($("body#mainBody")):$("div.mask#complex-mask")).fadeIn(200,function(){$(this).css("display","block"),$.browser.msie&&$(this).css("filter","alpha(opacity=70)")});this.elem.show()},hide:function(){($.removeLoading(),"complex-msg"!=this.type)?$.hideCover():(0==$("div.mask#complex-mask").length?$('<div id="complex-mask" class="mask"><div id="complex-cover-loading"></div></div>').appendTo($("body#mainBody")):$("div.mask#complex-mask")).fadeOut(200,function(){$(this).css("display","none")});this.elem.hide(),$("body").off(".tpMsg");try{this.activeEl&&this.activeEl.focus()}catch(e){}this.destroy()}},TpMsg.options={type:"alert",yes:$.tpLang?$.tpLang.m_str.yes:"Yes",no:$.tpLang?$.tpLang.m_str.no:"No"},$.fn.tpLteSmsTips=function(options){options=$.extend({},options);var tmp=$(this),inHTML="";inHTML+='<div class="msg-wrap" style="border: none; background : #54c7e2;">',inHTML+='<a class="widget-close msg-close" href="javascript:void(0);" style="display: none;"></a>',inHTML+='<div class="msg-content-wrap">',this._title&&(inHTML+='<h3 class="widget-title msg-title">',inHTML+='<span class="msg-title-container"></span>',inHTML+="</h3>"),inHTML+='<div class="widget-content msg-content-container">',inHTML+='<div class="grid-warning-msg">',inHTML+='<span class="icon"></span>',inHTML+='<span class="text" style="color: #ffffff; font-size: 16px;"></span>',inHTML+="</div>",inHTML+="</div>",inHTML+="</div>",inHTML+="</div>",inHTML+='<div class="msg-btn-container" style="display: none;">',inHTML+='<div class="msg-btn-wrap">',inHTML+='<div class="button-container in-line">',inHTML+='<button type="button" class="button-button green pure-button btn-msg btn-msg-ok btn-alert">',inHTML+="<span>"+m_str.ok+"</span>",inHTML+="</button>",inHTML+="</div>",inHTML+="</div>",inHTML='<div class="position-top-left" style="display: none;"></div>'+(inHTML='<div class="position-top-center" style="display: none;"></div>'+(inHTML='<div class="position-top-right" style="display: none;"></div>'+(inHTML='<div class="position-center-left">'+(inHTML='<div class="position-center-right">'+(inHTML+="</div>")+"</div>")+"</div>"))),inHTML+='<div class="position-bottom-left" style="display: none;"></div>',inHTML+='<div class="position-bottom-center" style="display: none;"></div>',inHTML+='<div class="position-bottom-right" style="display: none;"></div>',tmp.empty(),tmp.append($(inHTML)).addClass("container widget-container msg-container grid-popup-msg").css({"z-index":"999",display:"none",background:"#54c7e2",opacity:"0.7"}),tmp.delegate("a.msg-close","click",function(e){e.preventDefault(),$.removeLoading(),$.hideCover(),tmp.fadeOut(200,function(){tmp.css("display","none")})}).delegate("button.btn-msg-ok","click",function(e){e.preventDefault(),$.removeLoading(),$.hideCover(),tmp.fadeOut(200,function(){tmp.css("display","none")})})},$.fn.tpMsg=function(option){return this.each(function(){var $this=$(this),data=$this.data("tpMsg"),options="object"==typeof option&&option;options=$.extend(!0,{},TpMsg.options,options),data||((data=new TpMsg(this,options)).init(),$this.data("tpMsg",data)),"string"==typeof option&&data[option]()})},$.extend({alertPC:function(){var i,str,content,errno=arguments[0],l=arguments.length;if(!0===arguments[l-1])return errno;for(str="string"==typeof errno?errno:e_str[errno]||e_str[ERR_UNKOWN],i=1;i<l;i++)str=str.replace("$",arguments[i]);content="string"==typeof errno?str:"<strong>"+$.tpLang.m_str.errno+": "+errno+"</strong><br />"+str;var $alertContainer=$("div.alert-container"),options={type:"alert",content:content,yes:$.tpLang.m_str.ok};return $alertContainer.length?($alertContainer.tpMsg("destroy").tpMsg(options),$alertContainer.removeClass("progress-bar")):($alertContainer=$('<div id="alert-container" class="alert-container"></div>').appendTo($("body#mainBody"))).tpMsg(options),$alertContainer.tpMsg("show"),errno},alertAsnycPC:function(args){"number"==typeof args&&$.alert.call($,args)},lteSmsTips:function(iconChose,str,timeOut){if(null!=iconChose&&str){(null==timeOut||timeOut<800)&&(timeOut=800);var activeObj,tmp=$("div.lteSmsTips-container");0==iconChose?(tmp.find("span.icon").removeClass("correct-icon-lteSmsTips"),tmp.find("span.icon").addClass("false-icon-lteSmsTips")):1==iconChose&&(tmp.find("span.icon").removeClass("false-icon-lteSmsTips"),tmp.find("span.icon").addClass("correct-icon-lteSmsTips")),tmp.find("span.text").html($.turnqss(str)),$.setCentralPosition(tmp),$.lock(),$.showCover(),tmp.fadeIn(500,function(){tmp.css("display","block")}),$("body").on("mousedown.focus",function(e){void 0===activeObj&&(activeObj=document.activeElement)}),$("body").on("keydown.focus",function(e){return!1}),tmp.delegate("button.btn-msg-ok","click.focus",function(e){activeObj.focus(),$("body").off("mousedown.focus"),$("body").off("keydown.focus"),tmp.undelegate("button.btn-msg-ok","click.focus"),tmp.undelegate("a.msg-close","click.focus")}),tmp.delegate("a.msg-close","click.focus",function(e){activeObj.focus(),$("body").off("mousedown.focus"),$("body").off("keydown.focus"),tmp.undelegate("button.btn-msg-ok","click.focus"),tmp.undelegate("a.msg-close","click.focus")});setTimeout(function(){tmp.fadeOut(500,function(){$("body").mousedown(),$("a.msg-close").click()})},timeOut)}},initTpLteSmsTips:function(){(0==$("div.lteSmsTips-container").length?$('<div id="lteSmsTips-container" class="lteSmsTips-container"></div>').appendTo($("body")):$("div.lteSmsTips-container")).tpLteSmsTips()},confirm:function(str,ok,no,replaceStr,okStr,cancelStr){if(void 0!==replaceStr)str=str.replace("$",replaceStr);var $confirmContainer=$("div.alert-container"),options={type:"confirm",content:str,yes:okStr||$.tpLang.m_str.yes,no:cancelStr||$.tpLang.m_str.no,closeFlag:"lteBackup"==replaceStr?1:0,callbackOk:$.isFunction(ok)?ok:"",callbackNo:$.isFunction(no)?no:""};$confirmContainer.length?($confirmContainer.tpMsg("destroy").tpMsg(options),$confirmContainer.removeClass("progress-bar")):($confirmContainer=$('<div id="alert-container" class="alert-container"></div>').appendTo($("body#mainBody"))).tpMsg(options),$confirmContainer.tpMsg("show")},complexMsg:function(path,title,ok,no,callbackOk,callbackNo){var $confirmContainer=$("div.alert-container-complex-msg"),options={type:"complex-msg"};$confirmContainer.length?$confirmContainer.tpMsg("destroy").tpMsg(options):($confirmContainer=$('<div id="complex-msg-container" class="alert-container-complex-msg"></div>').appendTo($("body#mainBody"))).tpMsg(options),$confirmContainer.find(".msg-container-wrapper").addClass("complex-msg"),$.loadPage("complexMsg",path),$confirmContainer.find("div.msg-wrap").css("max-height",$(window).height()-150),$confirmContainer.tpMsg("show")},toast:function(success,str){if(0==success){if(null==str)str=$.tpLang.m_str.fail}else if(null==str)str=$.tpLang.m_str.success;var options={type:"toast"+(0==success?"-fail":"-success"),content:str},$toastContainer=$("div.alert-container");return $toastContainer.length?($toastContainer.tpMsg("destroy").tpMsg(options),$toastContainer.removeClass("progress-bar")):($toastContainer=$('<div id="alert-container" class="alert-container"></div>').appendTo($("body#mainBody"))).tpMsg(options),$toastContainer.tpMsg("show"),$toastContainer},progressBar:function(){var str=arguments[0],$barContainer=$("div.alert-container"),options={type:"progress-bar",content:str};return $barContainer.length?($barContainer.tpMsg("destroy").tpMsg(options),$barContainer.addClass("progress-bar")):($barContainer=$('<div id="alert-container" class="alert-container progress-bar"></div>').appendTo($("body#mainBody"))).tpMsg(options),$barContainer.tpMsg("show"),$barContainer},hint:function(text){var $alertContainer=$("div.alert-container"),options={type:"alert",content:text,yes:$.tpLang.m_str.ok};$alertContainer.length?$alertContainer.tpMsg("destroy").tpMsg(options):($alertContainer=$('<div id="alert-container" class="alert-container"></div>').appendTo($("body#mainBody"))).tpMsg(options),$alertContainer.tpMsg("show")},hideMsg:function(){$("div.alert-container").tpMsg("hide")},prompt:function(successed,text,time){var $prompt=$("#global-form-prompt");0==$prompt.length&&($prompt=$('<div id="global-form-prompt" class="form-prompt" ><div class="bg"></div><div class="content"><span class="icon"></span><span class="text text-successed"></span><span class="text text-failed"></span></div></div>').appendTo("body")),successed?($prompt.removeClass("failed").addClass("successed"),text=text||$.tpLang.s_str.saved,$prompt.find("span.text-successed").html(text)):($prompt.addClass("failed").removeClass("successed"),text=text||$.tpLang.ddns_nstr.fail,$prompt.find("span.text-failed").html(text)),$.setFixedCentral($prompt),$prompt.showCold(),setTimeout(function(){$prompt.hideCold()},time||900)}})}(jQuery);