!function($){function TPModal(id,options){this.element=$("#"+id),this.id=this.element.prop("id"),this.options=$.extend({},TPModal.prototype.options,options),this._create(options),$.isFunction(this._init)&&this.init()}TPModal.prototype={constructor:TPModal,options:{className:"",confirmBtn:{str:$.tpLang.m_str.ok,className:null,callback:null,show:!0,disabled:!1},cancelBtn:{str:$.tpLang.m_str.cancel,callback:null,className:null,show:!0,disabled:!1},closeIcon:{show:!0,callback:null},animation:!1,showCallback:null,hideCallback:null,zIndex:"auto",coverZIndex:"auto",cover:!0,width:"auto",global:!0,init:null},_create:function(){var tmpBtnCtn,inHTML="";(inHTML+='<div class="msg-wrap">',inHTML+='<div class="msg-content-wrap">',inHTML+='<div class="widget-content msg-content-container">',inHTML+="</div>",inHTML+="</div>",inHTML='<div class="position-top-left"></div>'+(inHTML='<div class="position-top-center"></div>'+(inHTML='<div class="position-top-right"></div>'+(inHTML='<div class="position-center-left">'+(inHTML='<div class="position-center-right">'+(inHTML='<div class="scroll-outer"><div class="scroll-layer">'+(inHTML+="</div>")+"</div></div>")+"</div>")+"</div>"))),inHTML+='<div class="position-bottom-left"></div>',inHTML+='<div class="position-bottom-center"></div>',inHTML='<div class="modal-container"><div class="modal-wrapper">'+(inHTML+='<div class="position-bottom-right"></div>')+"</div></div>",this.container=$(inHTML),this.container.prop("id",this.id+"-container").addClass(this.options.className),this.options.global?this.container.appendTo($("#global-window-area")):this.container.insertBefore(this.element),this.element.appendTo(this.container.find(".widget-content.msg-content-container")),this.container.addClass("widget-container msg-container"),this.options.closeIcon&&this.options.closeIcon.show&&(this.closeIcon=$('<a class="widget-close msg-close" href="javascript:void(0);"></a>').appendTo(this.container.find(".position-center-right"))),this.options.confirmBtn)&&($(inHTML='<div class="msg-btn-container"><div class="msg-btn-wrap"></div></div>').appendTo(this.container.find(".scroll-layer")),this.options.cancelBtn&&(tmpBtnCtn=$('<div class="button-container in-line"><button type="button" class="green pure-button tp-btn-custom"></button></div>').appendTo(this.container.find(".msg-btn-wrap")),this.cancelBtn=tmpBtnCtn.find("button"),this.cancelBtn.addClass(this.options.cancelBtn.className),this._setOption("cancelBtn",this.options.cancelBtn)),this.options.confirmBtn&&(tmpBtnCtn=$('<div class="button-container in-line"><button type="button" class="green pure-button tp-btn-custom"></button></div>').appendTo(this.container.find(".msg-btn-wrap")),this.confirmBtn=tmpBtnCtn.find("button"),this.confirmBtn.addClass(this.options.confirmBtn.className),this._setOption("confirmBtn",this.options.confirmBtn)));"auto"!=this.options.width&&this.container.width(this.options.width),"number"==typeof this.options.zIndex&&this.container.zIndex(this.options.zIndex),this._registerHandler(),$.isFunction(this.options.init)&&this.options.init()},show:function(){var me=this;this.container.show(),"auto"==me.options.width&&me.container.css("minWidth",me.container.css("width")),me._setFixedCentral(),this.container.find(".scroll-layer").niceScroll({cursorcolor:"#36444b",cursoropacitymax:.15,cursoropacitymin:.15,touchbehavior:!1,cursorwidth:"8px",cursorborder:"0",cursorborderradius:"4px",horizrailenabled:!1}),$.isFunction(me.options.showCallback)&&me.options.showCallback(),me.options.cover&&$.su.mask.show(this.id,"auto"==this.options.coverZIndex||this.options.coverZIndex,this.container)},hide:function(){var me=this;this.container.hide(0,function(){$.isFunction(me.options.hideCallback)&&me.options.hideCallback()}),me.options.cover&&$.su.mask.hide(this.id)},_setOption:function(key,value){var me=this;"cancelBtn"==key?($.extend(me.options.cancelBtn,value),void 0!==value.disabled&&me.cancelBtn.prop("disabled",me.options.cancelBtn.disabled),void 0!==value.str&&me.cancelBtn.html("<span>"+me.options.cancelBtn.str+"</span>"),void 0!==value.show&&(value.show?me.cancelBtn.show():me.cancelBtn.hide())):"confirmBtn"==key&&($.extend(me.options.confirmBtn,value),void 0!==value.disabled&&me.confirmBtn.prop("disabled",me.options.confirmBtn.disabled),void 0!==value.str&&me.confirmBtn.html("<span>"+me.options.confirmBtn.str+"</span>"),void 0!==value.show&&(value.show?me.confirmBtn.show():me.confirmBtn.hide()))},_registerHandler:function(){var me=this;me.options.global&&$(window).on("beforeLoadPage."+me.id,function(){me._destroy()}),me.confirmBtn&&me.confirmBtn.on("click",function(){var callback=me.options.confirmBtn.callback;$.isFunction(callback)?!1!==callback()&&me.hide():me.hide()}),me.cancelBtn&&me.cancelBtn.on("click",function(){var callback=me.options.cancelBtn.callback;$.isFunction(callback)?!1!==callback()&&me.hide():me.hide()}),me.closeIcon&&me.closeIcon.on("click",function(e){e.stopPropagation();var callback=me.options.closeIcon.callback;!me.options.closeIcon.callback&&me.options.cancelBtn&&me.options.cancelBtn.callback&&(callback=me.options.cancelBtn.callback),$.isFunction(callback)?!1!==callback()&&me.hide():me.hide()}),$(window).on("resize."+this.id,function(){me._setFixedCentral()})},_setFixedCentral:function(){var me=this.container,posX=parseInt(($(window).width()-me.width())/2,10),posY=parseInt(($(window).height()-me.height())/2,10);posX<0&&(posX=0),posY<50&&(posY=50),me.css({left:posX,top:posY,bottom:"auto",right:"auto",position:"fixed"}),me.find(".scroll-layer").css({maxHeight:$(window).height()-posY-75})},_unregisterHandlers:function(){$(window).off("."+this.id)},_destroy:function(){this._unregisterHandlers(),$(this).removeData("tpModal"),this.container.remove()}},$.fn.tpModal=function(options){var result,arg=arguments;return this.each(function(){var obj=$(this).data("tpModal");if(obj||"destroy"==options)"option"==options?result=obj._setOption.apply(obj,Array.prototype.slice.call(arg,1)):"destroy"==options?(result=obj._destroy(),$(this).removeData("tpModal")):$.isFunction(obj[options])?result=obj[options].apply(obj,Array.prototype.slice.call(arg,1)):obj.refresh();else{var instance=new TPModal(this.id,options);$(this).data("tpModal",instance)}}),result}}(jQuery);