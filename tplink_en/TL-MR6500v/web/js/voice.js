var VOICE_FRESH_TIME=1e4,VOICE_$$capTmp$$=$.act(ACT_GL,VOICE_CAP,null,null,["MaxLineCount","Regions","X_TP_LocaleList","X_TP_TransportList","X_TP_SupportUsbVM"]),VOICE_$$capTmp1$$=$.act(ACT_GL,VOICE_CAP_SIP,null,null,["Transports"]);$.exe(),$.local&&((VOICE_$$capTmp$$=[])[0]={},VOICE_$$capTmp$$[0].maxLineCount=2,VOICE_$$capTmp$$[0].X_TP_FxONum=1,(VOICE_$$capTmp1$$=[])[0]={});var SUPPORT_PSTN,VOICE_CAPABILITIES=VOICE_$$capTmp$$[0],VOICE_CAP_SIP=VOICE_$$capTmp1$$[0];SUPPORT_PSTN=0;var int_MAX=2147483647;TPLINK_T38="X_TP_T38",TPLINK_NTE="X_TP_NTE";var ENABLE_MASK=255,BARRING_MASK=65280;BARRING_MASK=INCLUDE_DECT?(ENABLE_MASK=255,65280):(ENABLE_MASK=3840,61440);var STRIP_MASK=983040,LENGTH_MASK=32505856,POUND_MASK=33554432,TIMEOUT_MASK=67108864,PSTN_MASK=134217728,SIP_MASK=4026531840,ENABLE_SHIFT=0,BARRING_SHIFT=0;BARRING_SHIFT=INCLUDE_DECT?(ENABLE_SHIFT=0,8):(ENABLE_SHIFT=8,12);var STRIP_SHIFT=16,LENGTH_SHIFT=20,POUND_SHIFT=25,TIMEOUT_SHIFT=26,PSTN_SHIFT=27,SIP_SHIFT=28,MDMVS_LAN=s_str.voiplan,MDMVS_ANY_WAN=s_str.voipwan,MDMVS_IP_ROUTED=s_str.voiproute,MDMVS_IP_BRIDGED=s_str.voipbridge,valueOfPSTN=0,valueOfAuto=4294967295,CLOGTYPE_BIT_IDLE=0,CLOGTYPE_BIT_OUTGOING_VOIP=1,CLOGTYPE_BIT_OUTGOING_PSTN=2,CLOGTYPE_BIT_INCOMING_VOIP=3,CLOGTYPE_BIT_INCOMING_PSTN=4,CLOGTYPE_BIT_CONNECTED=5,CLOGTYPE_BIT_CONF=6,CLOGTYPE_BIT_FORWARD=7,CLOGTYPE_BIT_REMOTE_FORWARD=8,CLOGTYPE_BIT_REJECT=9,CLOGTYPE_BIT_DND=10,CLOGTYPE_BIT_TRANSFER=11,CLOGTYPE_BIT_REMOTE_TRANSFER=12,CLOGTYPE_BIT_UNKNOWN=13;function delAllOption(sel){for(;sel.length;)sel.remove(0)}function addOption(sel,value,text,selected){var opt=$.c("option");try{sel.add(opt,null)}catch(e){sel.add(opt)}opt.value=value,opt.text=text,selected&&(opt.selected=!0)}function setSelectValue(sel,value1){var option=sel.options;if(option){var value=(value1+="").replace(/(^\s*)|(\s*$)/g,"");if(option.length){var i=0;for(i=0;i<option.length;i++)if(option[i].value==value){sel.value=value;break}i>=option.length&&(sel.value=option[0].value)}else sel.value=""}}function setFocus(ctrl){ctrl.focus(),ctrl.select&&ctrl.select()}function getValue(id,paraName,min,max,noReplace,errPreHook){var retv,ctrl=$("#"+id);if(retv=noReplace?$("#"+id).prop("value"):$("#"+id).prop("value").replace(/(^\s*)|(\s*$)/g,""),$.asc(retv,!0))throw $.alert(ERR_VOIP_CHAR_ERROR),setFocus(ctrl),!1;if(0!=min&&0==retv.length)throw errPreHook&&errPreHook(),$.alert(ERR_VOIP_NOT_EMPTY,"("+paraName+")"),setFocus(ctrl),!1;if(min>retv.length||retv.length>max)throw errPreHook&&errPreHook(),min==max?$.alert(ERR_VOIP_VALUE_LEN_ERROR,"("+paraName+" "+s_str.len+":"+min+")"):$.alert(ERR_VOIP_NUMBER_OUT_RANGE,"("+paraName+" "+s_str.range+":"+min+" - "+max+")"),setFocus(ctrl),!1;return retv}function getNumValue(id,paraName,min,max,canBeNull){var ctrl=$("#"+id),retv=$("#"+id).prop("value").replace(/(^\s*)|(\s*$)/g,"");if(0==retv.length){if(canBeNull)return"";throw $.alert(ERR_VOIP_NOT_EMPTY,"("+paraName+")"),setFocus(ctrl),!1}if($.num(retv,[min,max],!0))throw $.alert(ERR_VOIP_NUMBER_OUT_RANGE,"("+paraName+" "+s_str.range+":"+min+" - "+max+")"),setFocus(ctrl),!1;return parseInt(retv,10)}function getNumValue1(id,paraName,min,max,canBeNull){var ctrl=$("#"+id),retv=$("#"+id).prop("value").replace(/(^\s*)|(\s*$)/g,"");if(0==retv.length){if(canBeNull)return"";throw $.alert(ERR_VOIP_NOT_EMPTY,"("+paraName+")"),setFocus(ctrl),!1}var exp=new RegExp(/\D/);if(1==isNaN(retv)||1==exp.test(retv))throw $.alert(ERR_VOIP_VALUE_INVALID,"("+paraName+")"),ctrl.get(0).value=retv,setFocus(ctrl),!1;if($.num(retv,[min,max],!0))throw $.alert(ERR_VOIP_NUMBER_OUT_RANGE,"("+paraName+" "+s_str.range+":"+min+" - "+max+")"),ctrl.get(0).value=""+parseInt(retv,10),setFocus(ctrl),!1;return parseInt(retv,10)}function checkBlank(ctrl,name,errPreHook){if(1==new RegExp(/\s/).test(ctrl.get(0).value))throw errPreHook&&errPreHook(),$.alert(ERR_VOIP_VALUE_FORMAT_ERROR,"("+name+")"),setFocus(ctrl),!1}function checkSpecial(ctrl,name){if(/["'\\;:<@]/.test(ctrl.get(0).value))throw $.alert(ERR_VOIP_CONTAIN_ILLEGAL_CHAR,"("+name+")"),setFocus(ctrl),!1}function removeZeroFromIp(ip){var ret,val=[];if(!(ret=ip.match(/^(\d{1,})\.(\d{1,})\.(\d{1,})\.(\d{1,})$/)))return!1;for(var i=1;i<=4;i++)val[i]=parseInt(ret[i],10);return val[1]+"."+val[2]+"."+val[3]+"."+val[4]}function checkNum(ctrl,name){var regv=new RegExp(/\D/),retv=ctrl.get(0).value;if(1==regv.test(retv))throw $.alert(ERR_VOIP_VALUE_INVALID,"("+name+")"),setFocus(ctrl),!1}function isIP(str){return 1==new RegExp(/^\d{1,}(\.\d{1,}){3}/).test(str)}function getIP(ctrl,name,errPreHook){var retv=ctrl.get(0).value;if(!1===(retv=removeZeroFromIp(retv))||0!=$.ifip(retv,!0))throw errPreHook&&errPreHook(),$.alert(ERR_VOIP_INVALID_IP,"("+name+")"),setFocus(ctrl),!1;return retv}function isNoProp(obj){for(i in obj)return!1;return!0}function X_TP_CallFireWallCfg_checkExist(ctrl,name,checkWhite){var voipWhiteLists,voipBlackLists,retTmp={},voipX_TP_CallFireWallCfg=$.act(ACT_GET,XTP_IGD_CALL_FIREWALL_CFG,null,null,["IncomingWhiteList","IncomingBlackList"]);if(0==$.exe()){var tmpFunc;if(voipWhiteLists=voipX_TP_CallFireWallCfg.incomingWhiteList.split("|"),voipBlackLists=voipX_TP_CallFireWallCfg.incomingBlackList.split("|"),(tmpFunc=function(list){0<list.length&&""==list[list.length-1]&&list.pop(),0<list.length&&""==list[0]&&list.shift()})(voipWhiteLists),tmpFunc(voipBlackLists),retTmp.stack=voipX_TP_CallFireWallCfg.__stack,retTmp.list=checkWhite?voipWhiteLists:voipBlackLists,30<=retTmp.list.length)throw $.alert(ERR_VOIP_ENTRY_MAX_ERROR),!1;return(tmpFunc=function(list,flag){0==flag?name=menu_str.callfwwl:1==flag&&(name=menu_str.callfwbl),$.each(list,function(arg){if(ctrl.get(0).value==this.replace(/(^\s*)|(\s*$)/g,""))throw alert(e_str[ERR_VOIP_LIST_CONFILICT]+name),setFocus(ctrl),!1})})(voipWhiteLists,0),tmpFunc(voipBlackLists,1),retTmp}}function actForSendMsg(){var tmp={__sendMsgFlag:1};$.act(ACT_SET,XTP_VOICE_PROCESS,VOICE_CAPABILITIES.__stack,null,tmp)}function addIntf(intfId,interfaceName){var tmp,id_index,checkid,labelname,handsetList=$.act(ACT_GL,VOICE_PROF_LINE,null,null,["X_TP_PhoneName","X_TP_InternalNumber","X_TP_PhoneType"]);0==$.exe()&&$.each(handsetList,function(arg,index){if(tmp="",id_index=-1,"FXS"==this.X_TP_PhoneType)checkid=intfId+(id_index=index+1),labelname=this.X_TP_PhoneName,tmp="<input type='checkbox' id='"+checkid+"'/><label for="+checkid+">"+labelname+"</label> &nbsp;",interfaceName.push(checkid),$.h($.id("intf"+id_index),tmp);else if("DECT"==this.X_TP_PhoneType){var handsetInfo=$.act(ACT_GET,XTP_DECT_HANDSET_INFO,this.__stack,null,["status"]);if(0!=$.exe())return;0!=handsetInfo.status&&(checkid=intfId+(id_index=index+1),labelname=this.X_TP_PhoneName,tmp="<input type='checkbox' id='"+checkid+"'/><label for="+checkid+">"+labelname+"</label> &nbsp;",interfaceName.push(checkid),$.h($.id("intf"+id_index),tmp))}})}