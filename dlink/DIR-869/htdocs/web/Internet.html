<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css?v=20191126101002"/> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate1.js"></script> <script>$(document).ready(function(){presetCheckBox("enableVLAN_staticIP",true);presetCheckBox("enableVLAN_DynamicIP",true);presetCheckBox("enableVLAN_PPPoE",true);$("div.checkbox_on"||"div.checkbox_off").click(function(c){var d=c.target.id+"_ck";if(c.target.getAttribute("class")=="checkbox_on"){var b=I18N("j","Disabled");c.target.setAttribute("class","checkbox_off");c.target.setAttribute("className","checkbox_off");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+" checked>"+b;document.getElementById(d).checked=false;if(d=="enableVLAN_staticIP_ck"||d=="enableVLAN_DynamicIP_ck"||d=="enableVLAN_PPPoE_ck"){document.getElementById("advancedBlock_VLANSetting").style.display="none";document.getElementById("advancedBlock_hr").style.display="none"}changeFlag=true;save_button_changed()}else{var a=I18N("j","Enabled");c.target.setAttribute("class","checkbox_on");c.target.setAttribute("className","checkbox_on");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+' checked="">'+a;document.getElementById(d).checked=true;if(d=="enableVLAN_staticIP_ck"||d=="enableVLAN_DynamicIP_ck"||d=="enableVLAN_PPPoE_ck"){document.getElementById("advancedBlock_VLANSetting").style.display="inline";document.getElementById("advancedBlock_hr").style.display="inline"}changeFlag=true;save_button_changed()}});InitWAN()});</script> <script type="text/javascript">var HNAP=new HNAP_XML();var init_macaddr;var bootuptime=60;var timer;var current_wantype;var devicemode_org;var xml_GetNetworkSettings=HNAP.GetXML("GetNetworkSettings");var lan_IPAddr=xml_GetNetworkSettings.Get("GetNetworkSettingsResponse/IPAddress");var xml_GetGuestZoneSettings=HNAP.GetXML("GetGuestZoneRouterSettings");var lan_IPAddr_g=xml_GetGuestZoneSettings.Get("GetGuestZoneRouterSettingsResponse/IPAddress");var redirect_url=lan_IPAddr;var xml_GetIPv6Status=HNAP.GetXML("GetIPv6Status");var xml_GetIPv6PppoeSettings=HNAP.GetXML("GetIPv6PppoeSettings");var wan_IPv6type=xml_GetIPv6Status.Get("GetIPv6StatusResponse/IPv6_ConnectionType");var PppoeNewSession=xml_GetIPv6PppoeSettings.Get("GetIPv6PppoeSettingsResponse/IPv6_PppoeNewSession");var xml_GetWLanRadioSettings=HNAP.GetXML("GetWLanRadioSettings");var lan_macaddr=xml_GetWLanRadioSettings.Get("GetWLanRadioSettingsResponse/MacAddress");var lanmac=lan_macaddr.split(":");var xml_GetWanSettings=HNAP.GetXML("GetWanSettings");var hostname=xml_GetWanSettings.Get("GetWanSettingsResponse/HostName");var xml_GetDeviceFeature=HNAP.GetXML("GetDeviceFeatureAlpha");var feature_vlan=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureVLAN");var feature_nat=xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureNAT");var xml_GetVlanSettings=HNAP.GetXML("GetVlanSettings");var xml_GetNATSettings=HNAP.GetXML("GetNATSettings");var NAT_disable=xml_GetNATSettings.Get("GetNATSettingsResponse/Disable");var xml_GetOtherWanSettings=HNAP.GetXML("GetOtherWanSettings");function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function StrToUpperCase(a){a=a.toUpperCase();return a}function InitMACList(){var d=HNAP.GetXML("GetClientInfo");var b=document.getElementById("clone_mac_DynamicIP");var a=document.getElementById("clone_mac_StaticIP");var c=document.getElementById("clone_ComputerIpByPPPoE");var g=d.Get("GetClientInfoResponse/ClientInfoLists/ClientInfo#");for(var e=1;e<=g;e++){var f=StrToUpperCase(d.Get("GetClientInfoResponse/ClientInfoLists/ClientInfo:"+e+"/MacAddress"));b.options.add(new Option(f,e));a.options.add(new Option(f,e));c.options.add(new Option(f,e))}}function ChangeConnectType(au){var M=document.getElementById("generalBlock_staticIP");var aj=document.getElementById("generalBlock_DynamicIP");var X=document.getElementById("generalBlock_PPPoE");var u=document.getElementById("generalBlock_PPTP");var h=document.getElementById("generalBlock_L2TP");var D=document.getElementById("generalBlock_DSLite");var C=document.getElementById("advancedBlock");var at=document.getElementById("advancedBlock_staticIP");var d=document.getElementById("advancedBlock_DynamicIP");var l=document.getElementById("advancedBlock_PPPoE");var c=document.getElementById("advancedBlock_PPTP");var af=document.getElementById("advancedBlock_L2TP");var W=document.getElementById("advancedBlock_DSLite");var w=document.getElementById("advancedBlock_Ru_PPPoE");var ao=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Type");switch(au){case"STATIC":M.style.display="inline";X.style.display="none";u.style.display="none";h.style.display="none";C.style.display="none";at.style.display="inline";d.style.display="none";l.style.display="none";c.style.display="none";af.style.display="none";W.style.display="none";w.style.display="none";var n=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/IPAddress");document.getElementById("iPAddress_StaticIP").value=n;var am=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_StaticIP").value=am;var o=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Gateway");document.getElementById("defaultGateway_StaticIP").value=o;var s=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_StaticIP").value=s;var an=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_StaticIP").value=an;var T=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MTU");document.getElementById("mtu_StaticIP_Input").value=T;var J="";var ab=document.getElementById("mtu_StaticIP");if(T=="1500"){J="AUTO";document.getElementById("mtu_StaticIP_Input").style.display="none"}else{J="MANUAL";document.getElementById("mtu_StaticIP_Input").style.display="inline"}COMM_SetSelectValue(ab,J);var R=StrToUpperCase(xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacAddress"));var b=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_StaticIP").value=COMM_ToBOOL(b)?R:"";init_macaddr=COMM_ToBOOL(b)?R:"";break;case"DHCP":M.style.display="none";X.style.display="none";u.style.display="none";h.style.display="none";C.style.display="none";at.style.display="none";d.style.display="inline";l.style.display="none";c.style.display="none";af.style.display="none";W.style.display="none";w.style.display="none";break;case"PPPoE":M.style.display="none";X.style.display="inline";u.style.display="none";h.style.display="none";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="inline";c.style.display="none";af.style.display="none";W.style.display="none";w.style.display="none";if(ao=="StaticPPPoE"||ao=="DHCPPPPoE"){var f=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Username");document.getElementById("userName_PPPoE").value=f;var m=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Password");document.getElementById("password_PPPoE").value=m;var B="";var G=document.getElementById("addressMode_PPPoE");if(ao=="DHCPPPPoE"){B="DYNAMICIP";document.getElementById("ipAddress_PPPoE").value=""}else{if(ao=="StaticPPPoE"){B="STATICIP";var ag=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/IPAddress");document.getElementById("ipAddress_PPPoE").value=ag}}ChangeAddrMode(B,au);$("#addressMode_PPPoE").selectbox("detach");COMM_SetSelectValue(G,B);$("#addressMode_PPPoE").selectbox("attach");var v=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ServiceName");document.getElementById("serviceName_PPPoE").value=v;var aq=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS:2/Primary");document.getElementById("primaryDNSAddress_PPPoE").value=aq;var N=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS:2/Secondary");document.getElementById("secondaryDNSAddress_PPPoE").value=N;var ap=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/PPPMTU");document.getElementById("mtu_PPPoE_Input").value=ap;var V="";var t=document.getElementById("mtu_PPPoE");if(ap=="1492"){V="AUTO";document.getElementById("mtu_PPPoE_Input").style.display="none"}else{V="MANUAL";document.getElementById("mtu_PPPoE_Input").style.display="inline"}$("#mtu_PPPoE").selectbox("detach");COMM_SetSelectValue(t,V);$("#mtu_PPPoE").selectbox("attach");var i=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/AutoReconnect");var ai=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MaxIdleTime");var aa="";var L=document.getElementById("reconnectMode_PPPoE");switch(i){case"true":aa="ALWAYSON";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true;break;case"false":if(ai==0){aa="MANUAL";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true}else{aa="ONDEMAND";document.getElementById("maxIdleTime_PPPoE_tr").style.display="table-row";document.getElementById("maximumIdleTime_PPPoE").value=ai/60;document.getElementById("maximumIdleTime_PPPoE").disabled=false}break}$("#reconnectMode_PPPoE").selectbox("detach");COMM_SetSelectValue(L,aa);$("#reconnectMode_PPPoE").selectbox("attach");var R=StrToUpperCase(xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacAddress"));var b=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_PPPoE").value=COMM_ToBOOL(b)?R:"";init_macaddr=COMM_ToBOOL(b)?R:""}break;case"PPTP":M.style.display="none";X.style.display="none";u.style.display="inline";h.style.display="none";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="none";c.style.display="inline";af.style.display="none";W.style.display="none";w.style.display="none";if(ao=="StaticPPTP"||ao=="DynamicPPTP"){var ah=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Username");document.getElementById("userName_PPTP").value=ah;var ac=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Password");document.getElementById("password_PPTP").value=ac;var B="";var G=document.getElementById("addressMode_PPTP");if(ao=="DynamicPPTP"){B="DYNAMICIP"}else{if(ao=="StaticPPTP"){B="STATICIP";var I=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/IPAddress");document.getElementById("ipAddress_PPTP").value=I;var A=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/SubnetMask");document.getElementById("subnetMask_PPTP").value=A;var z=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/Gateway");document.getElementById("gatewayIP_PPTP").value=z}}ChangeAddrMode(B,au);$("#addressMode_PPTP").selectbox("detach");COMM_SetSelectValue(G,B);$("#addressMode_PPTP").selectbox("attach");var y=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_PPTP").value=y;var P=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS:2/Primary");document.getElementById("primaryDNSAddress_PPTP").value=P;var r=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS:2/Secondary");document.getElementById("secondaryDNSAddress_PPTP").value=r;var al=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/PPPMTU");document.getElementById("mtu_PPTP_Input").value=al;var H="";var O=document.getElementById("mtu_PPTP");if(al=="1400"){H="AUTO";document.getElementById("mtu_PPTP_Input").style.display="none"}else{H="MANUAL";document.getElementById("mtu_PPTP_Input").style.display="inline"}$("#mtu_PPTP").selectbox("detach");COMM_SetSelectValue(O,H);$("#mtu_PPTP").selectbox("attach");var k=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/AutoReconnect");var ae=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MaxIdleTime");var ar="";var E=document.getElementById("reconnectMode_PPTP");switch(k){case"true":ar="ALWAYSON";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true;break;case"false":if(ae==0){ar="MANUAL";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true}else{ar="ONDEMAND";document.getElementById("maximumIdleTime_PPTP").value=ae/60;document.getElementById("maximumIdleTime_PPTP").disabled=false}break}$("#reconnectMode_PPTP").selectbox("detach");COMM_SetSelectValue(E,ar);$("#reconnectMode_PPTP").selectbox("attach")}break;case"L2TP":M.style.display="none";X.style.display="none";u.style.display="none";h.style.display="inline";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="none";c.style.display="none";af.style.display="inline";W.style.display="none";w.style.display="none";if(ao=="StaticL2TP"||ao=="DynamicL2TP"){var U=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Username");document.getElementById("userName_L2TP").value=U;var p=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/Password");document.getElementById("password_L2TP").value=p;var B="";var G=document.getElementById("addressMode_L2TP");if(ao=="DynamicL2TP"){B="DYNAMICIP"}else{if(ao=="StaticL2TP"){B="STATICIP";var ak=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/IPAddress");document.getElementById("ipAddress_L2TP").value=ak;var ad=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/SubnetMask");document.getElementById("subnetMask_L2TP").value=ad;var x=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/StaticPPP/Gateway");document.getElementById("gatewayIP_L2TP").value=x}}ChangeAddrMode(B,au);$("#addressMode_L2TP").selectbox("detach");COMM_SetSelectValue(G,B);$("#addressMode_L2TP").selectbox("attach");var S=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_L2TP").value=S;var a=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS:2/Primary");document.getElementById("primaryDNSAddress_L2TP").value=a;var Q=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/ConfigDNS:2/Secondary");document.getElementById("secondaryDNSAddress_L2TP").value=Q;var K=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/PPPMTU");document.getElementById("mtu_L2TP_Input").value=K;var e="";var g=document.getElementById("mtu_L2TP");if(K=="1400"){e="AUTO";document.getElementById("mtu_L2TP_Input").style.display="none"}else{e="MANUAL";document.getElementById("mtu_L2TP_Input").style.display="inline"}$("#mtu_L2TP").selectbox("detach");COMM_SetSelectValue(g,e);$("#mtu_L2TP").selectbox("attach");var Z=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/AutoReconnect");var F=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MaxIdleTime");var Y="";var q=document.getElementById("reconnectMode_L2TP");switch(Z){case"true":Y="ALWAYSON";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true;break;case"false":if(F==0){Y="MANUAL";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true}else{Y="ONDEMAND";document.getElementById("maximumIdleTime_L2TP").value=F/60;document.getElementById("maximumIdleTime_L2TP").disabled=false}break}$("#reconnectMode_L2TP").selectbox("detach");COMM_SetSelectValue(q,Y);$("#reconnectMode_L2TP").selectbox("attach")}break;case"DSLite":M.style.display="none";X.style.display="none";u.style.display="none";h.style.display="none";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="none";c.style.display="none";af.style.display="none";W.style.display="inline";w.style.display="none";break;case"Ru_PPPoE":M.style.display="none";X.style.display="inline";u.style.display="none";h.style.display="none";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="inline";c.style.display="none";af.style.display="none";W.style.display="none";w.style.display="inline";break;case"Ru_PPTP":M.style.display="none";X.style.display="none";u.style.display="inline";h.style.display="none";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="none";c.style.display="inline";af.style.display="none";W.style.display="none";w.style.display="none";break;case"Ru_L2TP":M.style.display="none";X.style.display="none";u.style.display="none";h.style.display="inline";C.style.display="none";at.style.display="none";d.style.display="none";l.style.display="none";c.style.display="none";af.style.display="inline";W.style.display="none";w.style.display="none";break}DisplayMACClone(au);if(feature_vlan=="true"){VLANSetting(au)}if(feature_nat=="true"){NATSetting()}}function InitWAN(){var ao=HNAP.GetXML("GetDeviceFeatureAlpha");var aj=HNAP.GetXML("GetIPv6Status");var aA=HNAP.GetXML("GetRouterLanSettings");var N=ao.Get("GetDeviceFeatureAlphaResponse/FeatureBridge");var av=ao.Get("GetDeviceFeatureAlphaResponse/FeatureRepeater");var ax=ao.Get("GetDeviceFeatureAlphaResponse/FeatureIPv6");var aC=ao.Get("GetDeviceFeatureAlphaResponse/FeatureExtender");var aN=ao.Get("GetDeviceFeatureAlphaResponse/FeatureAP");var ak=ao.Get("GetDeviceFeatureAlphaResponse/FeatureRussia");if(ak=="true"){$("#connect_type").append('<option value="Ru_PPPoE">Russia PPPoE (Dual Access)</option>');$("#connect_type").append('<option value="Ru_PPTP">Russia PPTP (Dual Access)</option>');$("#connect_type").append('<option value="Ru_L2TP">Russia L2TP (Dual Access)</option>')}if(ax){document.getElementById("FUNC_IPv6").style.display="block"}else{document.getElementById("FUNC_IPv6").style.display="none"}if(aN=="true"){$("#device_mode").append('<option value="AP">AP Mode</option>')}if(N=="true"){$("#device_mode").append('<option value="BRIDGE">Bridge Mode</option>')}if(av=="true"){$("#device_mode").append('<option value="REPEATER">Repeater Mode</option>')}if(aC=="true"){$("#device_mode").append('<option value="EXTENDER">Extender Mode</option>')}var I=document.getElementById("device_mode");var aM=xml_GetWanSettings.Get("GetWanSettingsResponse/Type");var L=document.getElementById("connect_type");var ag;var aG=false;if(aM.indexOf("Bridged")>=0||aM.indexOf("Ap")>=0||aM.indexOf("Extender")>=0){aG=true}else{aG=false}if(aG){devicemode_org="BRIDGE";if(aM.indexOf("Extender")>=0){devicemode_org="EXTENDER"}else{if(aM.indexOf("Ap")>=0){devicemode_org="AP"}}document.getElementById("FUNC_IPv6").style.display="none";document.getElementById("directions").innerHTML=I18N("j","Use this section to configure your Internet Connection type.")}else{devicemode_org="ROUTER";document.getElementById("directions").innerHTML=I18N("j","Use this section to configure your Internet Connection type. There are several connection types to choose from Static IP, DHCP, PPPoE, PPTP, L2TP, and DS-Lite. If you are unsure of your connection method, please contact your Internet Service Provider. Note:  If using the PPPoE option, you will need to remove or disable any PPPoE client software on your computers.")}COMM_SetSelectValue(I,devicemode_org);ConnectTypeList(devicemode_org);switch(aM){case"Static":case"StaticAp":case"StaticBridged":case"StaticExtender":ag="STATIC";var u=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("iPAddress_StaticIP").value=u;var ai=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_StaticIP").value=ai;var x=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("defaultGateway_StaticIP").value=x;var T=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_StaticIP").value=T;var B=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_StaticIP").value=B;var aE=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_StaticIP_Input").value=aE;var m="";var aq=document.getElementById("mtu_StaticIP");if(aE=="1500"){m="AUTO";document.getElementById("mtu_StaticIP_Input").style.display="none"}else{m="MANUAL";document.getElementById("mtu_StaticIP_Input").style.display="inline"}COMM_SetSelectValue(aq,m);if(aM=="Static"){var aa=StrToUpperCase(xml_GetWanSettings.Get("GetWanSettingsResponse/MacAddress"));var R=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_StaticIP").value=COMM_ToBOOL(R)?aa:"";init_macaddr=COMM_ToBOOL(R)?aa:""}break;case"DHCP":case"DynamicAp":case"DynamicBridged":case"DynamicExtender":ag="DHCP";document.getElementById("hostName_DynamicIP").value=hostname;var D=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_DynamicIP").value=D;var d=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_DynamicIP").value=d;var b=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_DynamicIP_Input").value=b;var f="";var aD=document.getElementById("mtu_DynamicIP");if(b=="1500"){f="AUTO";document.getElementById("mtu_DynamicIP_Input").style.display="none"}else{f="MANUAL";document.getElementById("mtu_DynamicIP_Input").style.display="inline"}COMM_SetSelectValue(aD,f);if(aM=="DHCP"){var aa=StrToUpperCase(xml_GetWanSettings.Get("GetWanSettingsResponse/MacAddress"));var R=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_DynamicIP").value=COMM_ToBOOL(R)?aa:"";init_macaddr=COMM_ToBOOL(R)?aa:""}break;case"DHCPPPPoE":case"StaticPPPoE":ag="PPPoE";var c=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPPoE").value=c;var l=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPPoE").value=l;var k="";var aL=document.getElementById("addressMode_PPPoE");if(aM=="DHCPPPPoE"){k="DYNAMICIP";document.getElementById("ipAddress_PPPoE").value=""}else{if(aM=="StaticPPPoE"){k="STATICIP";var w=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPPoE").value=w}}ChangeAddrMode(k,ag);COMM_SetSelectValue(aL,k);var S=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serviceName_PPPoE").value=S;var U=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPPoE").value=U;var C=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPPoE").value=C;var aF=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPPoE_Input").value=aF;var af="";var n=document.getElementById("mtu_PPPoE");if(aF=="1492"){af="AUTO";document.getElementById("mtu_PPPoE_Input").style.display="none"}else{af="MANUAL";document.getElementById("mtu_PPPoE_Input").style.display="inline"}COMM_SetSelectValue(n,af);var aJ=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var O=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var a="";var am=document.getElementById("reconnectMode_PPPoE");switch(aJ){case"true":a="ALWAYSON";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true;break;case"false":if(O==0){a="MANUAL";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true}else{a="ONDEMAND";document.getElementById("maximumIdleTime_PPPoE").value=O/60;document.getElementById("maximumIdleTime_PPPoE").disabled=false}break}COMM_SetSelectValue(am,a);var aa=StrToUpperCase(xml_GetWanSettings.Get("GetWanSettingsResponse/MacAddress"));var R=xml_GetOtherWanSettings.Get("GetOtherWanSettingsResponse/MacCloneEnable");document.getElementById("macAddress_PPPoE").value=COMM_ToBOOL(R)?aa:"";init_macaddr=COMM_ToBOOL(R)?aa:"";break;case"DynamicPPTP":case"StaticPPTP":ag="PPTP";var Z=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPTP").value=Z;var at=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPTP").value=at;var k="";var aL=document.getElementById("addressMode_PPTP");if(aM=="DynamicPPTP"){k="DYNAMICIP"}else{if(aM=="StaticPPTP"){k="STATICIP"}}var aH=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPTP").value=aH;var o=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_PPTP").value=o;var y=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_PPTP").value=y;ChangeAddrMode(k,ag);COMM_SetSelectValue(aL,k);var ae=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_PPTP").value=ae;var v=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPTP").value=v;var aO=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPTP").value=aO;var G=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPTP_Input").value=G;var aI="";var al=document.getElementById("mtu_PPTP");if(G=="1400"){aI="AUTO";document.getElementById("mtu_PPTP_Input").style.display="none"}else{aI="MANUAL";document.getElementById("mtu_PPTP_Input").style.display="inline"}COMM_SetSelectValue(al,aI);var s=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var aw=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var Y="";var ac=document.getElementById("reconnectMode_PPTP");switch(s){case"true":Y="ALWAYSON";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true;break;case"false":if(aw==0){Y="MANUAL";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true}else{Y="ONDEMAND";document.getElementById("maximumIdleTime_PPTP").value=aw/60;document.getElementById("maximumIdleTime_PPTP").disabled=false}break}COMM_SetSelectValue(ac,Y);break;case"DynamicL2TP":case"StaticL2TP":ag="L2TP";var r=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_L2TP").value=r;var P=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_L2TP").value=P;var k="";var aL=document.getElementById("addressMode_L2TP");if(aM=="DynamicL2TP"){k="DYNAMICIP"}else{if(aM=="StaticL2TP"){k="STATICIP"}}var X=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_L2TP").value=X;var J=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_L2TP").value=J;var A=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_L2TP").value=A;ChangeAddrMode(k,ag);COMM_SetSelectValue(aL,k);var ah=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_L2TP").value=ah;var az=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_L2TP").value=az;var ab=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_L2TP").value=ab;var F=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_L2TP_Input").value=F;var i="";var aK=document.getElementById("mtu_L2TP");if(F=="1400"){i="AUTO";document.getElementById("mtu_L2TP_Input").style.display="none"}else{i="MANUAL";document.getElementById("mtu_L2TP_Input").style.display="inline"}COMM_SetSelectValue(aK,i);var E=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var au=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var h="";var z=document.getElementById("reconnectMode_L2TP");switch(E){case"true":h="ALWAYSON";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true;break;case"false":if(au==0){h="MANUAL";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true}else{h="ONDEMAND";document.getElementById("maximumIdleTime_L2TP").value=au/60;document.getElementById("maximumIdleTime_L2TP").disabled=false}break}COMM_SetSelectValue(z,h);break;case"DsLite":ag="DSLite";var H=xml_GetWanSettings.Get("GetWanSettingsResponse/DsLite_Configuration");ChangeDSLiteConfig(H);var K=document.getElementById("configuration_DSLite");COMM_SetSelectValue(K,H);var ad=xml_GetWanSettings.Get("GetWanSettingsResponse/DsLite_AFTR_IPv6Address");document.getElementById("afterIPv6Address_DSLite").value=ad;var ap=xml_GetWanSettings.Get("GetWanSettingsResponse/DsLite_B4IPv4Address");var q=ap.split(".");var aB=q[q.length-1];document.getElementById("b4IPv4Address_DSLite").value=aB;var t=aj.Get("GetIPv6StatusResponse/IPv6_WanAddress/string");if(t!=""){document.getElementById("wanIPv6Address_DSLite").innerHTML=t}else{document.getElementById("wanIPv6Address_DSLite").innerHTML="N/A"}var e=aj.Get("GetIPv6StatusResponse/IPv6_DefaultGateway");if(e!=""){document.getElementById("ipv6WanDefaultGateway_DSLite").innerHTML=e}else{document.getElementById("ipv6WanDefaultGateway_DSLite").innerHTML="N/A"}break;case"Ru_DHCPPPPoE":case"Ru_StaticPPPoE":ag="Ru_PPPoE";var c=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPPoE").value=c;var l=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPPoE").value=l;var k="";var aL=document.getElementById("addressMode_PPPoE");if(aM=="Ru_DHCPPPPoE"){k="DYNAMICIP";document.getElementById("ipAddress_PPPoE").value=""}else{if(aM=="Ru_StaticPPPoE"){k="STATICIP";var w=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPPoE").value=w}}ChangeAddrMode(k,ag);COMM_SetSelectValue(aL,k);var S=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serviceName_PPPoE").value=S;var U=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPPoE").value=U;var C=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPPoE").value=C;var aF=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPPoE_Input").value=aF;var af="";var n=document.getElementById("mtu_PPPoE");if(aF=="1492"){af="AUTO";document.getElementById("mtu_PPPoE_Input").style.display="none"}else{af="MANUAL";document.getElementById("mtu_PPPoE_Input").style.display="inline"}COMM_SetSelectValue(n,af);var aJ=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var O=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime")/60;var a="";var am=document.getElementById("reconnectMode_PPPoE");switch(aJ){case"true":a="ALWAYSON";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true;break;case"false":if(O==0){a="MANUAL";document.getElementById("maxIdleTime_PPPoE_tr").style.display="none";document.getElementById("maximumIdleTime_PPPoE").value=0;document.getElementById("maximumIdleTime_PPPoE").disabled=true}else{a="ONDEMAND";document.getElementById("maximumIdleTime_PPPoE").value=O/60;document.getElementById("maximumIdleTime_PPPoE").disabled=false}break}COMM_SetSelectValue(am,a);var W="";var ar=document.getElementById("addressMode_Ru_PPPoE");var M=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/Type");var p="Ru_PPPoE_WAN";if(M=="DHCPPPPoE"){k="DYNAMICIP";document.getElementById("ipAddress_Ru_PPPoE").value=""}else{if(M=="StaticPPPoE"){k="STATICIP";var Q=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/IPAddress");document.getElementById("ipAddress_Ru_PPPoE").value=Q;var ay=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/SubnetMask");document.getElementById("subnetMask_Ru_PPPoE").value=ay;var g=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/Gateway");document.getElementById("gatewayIP_Ru_PPPoE").value=g;var an=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/DNS/Primary");document.getElementById("primaryDNSAddress_Ru_PPPoE").value=an;var V=xml_GetWanSettings.Get("GetWanSettingsResponse/RussiaPPP/DNS/Secondary");document.getElementById("secondaryDNSAddress_Ru_PPPoE").value=V}}ChangeAddrMode(k,p);COMM_SetSelectValue(ar,k);break;case"Ru_DynamicPPTP":case"Ru_StaticPPTP":ag="Ru_PPTP";var Z=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_PPTP").value=Z;var at=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_PPTP").value=at;var k="";var aL=document.getElementById("addressMode_PPTP");if(aM=="Ru_DynamicPPTP"){k="DYNAMICIP";document.getElementById("ipAddress_PPTP").value=""}else{if(aM=="Ru_StaticPPTP"){k="STATICIP";var aH=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_PPTP").value=aH;var o=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_PPTP").value=o;var y=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_PPTP").value=y}}ChangeAddrMode(k,ag);COMM_SetSelectValue(aL,k);var ae=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_PPTP").value=ae;var v=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_PPTP").value=v;var aO=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_PPTP").value=aO;var G=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_PPTP_Input").value=G;var aI="";var al=document.getElementById("mtu_PPTP");if(G=="1400"){aI="AUTO";document.getElementById("mtu_PPTP_Input").style.display="none"}else{aI="MANUAL";document.getElementById("mtu_PPTP_Input").style.display="inline"}COMM_SetSelectValue(al,aI);var s=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var aw=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var Y="";var ac=document.getElementById("reconnectMode_PPTP");switch(s){case"true":Y="ALWAYSON";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true;break;case"false":if(aw==0){Y="MANUAL";document.getElementById("maxIdleTime_PPTP_tr").style.display="none";document.getElementById("maximumIdleTime_PPTP").value=0;document.getElementById("maximumIdleTime_PPTP").disabled=true}else{Y="ONDEMAND";document.getElementById("maximumIdleTime_PPTP").value=aw/60;document.getElementById("maximumIdleTime_PPTP").disabled=false}break}COMM_SetSelectValue(ac,Y);break;case"Ru_DynamicL2TP":case"Ru_StaticL2TP":ag="Ru_L2TP";var r=xml_GetWanSettings.Get("GetWanSettingsResponse/Username");document.getElementById("userName_L2TP").value=r;var P=xml_GetWanSettings.Get("GetWanSettingsResponse/Password");document.getElementById("password_L2TP").value=P;var k="";var aL=document.getElementById("addressMode_L2TP");if(aM=="Ru_DynamicL2TP"){k="DYNAMICIP";document.getElementById("ipAddress_L2TP").value=""}else{if(aM=="Ru_StaticL2TP"){k="STATICIP";var X=xml_GetWanSettings.Get("GetWanSettingsResponse/IPAddress");document.getElementById("ipAddress_L2TP").value=X;var J=xml_GetWanSettings.Get("GetWanSettingsResponse/SubnetMask");document.getElementById("subnetMask_L2TP").value=J;var A=xml_GetWanSettings.Get("GetWanSettingsResponse/Gateway");document.getElementById("gatewayIP_L2TP").value=A;document.getElementById("ipAddress_L2TP").disabled=false;document.getElementById("subnetMask_L2TP").disabled=false;document.getElementById("gatewayIP_L2TP").disabled=false}}ChangeAddrMode(k,ag);COMM_SetSelectValue(aL,k);var ah=xml_GetWanSettings.Get("GetWanSettingsResponse/ServiceName");document.getElementById("serverIPAddress_L2TP").value=ah;var az=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Primary");document.getElementById("primaryDNSAddress_L2TP").value=az;var ab=xml_GetWanSettings.Get("GetWanSettingsResponse/ConfigDNS/Secondary");document.getElementById("secondaryDNSAddress_L2TP").value=ab;var F=xml_GetWanSettings.Get("GetWanSettingsResponse/MTU");document.getElementById("mtu_L2TP_Input").value=F;var i="";var aK=document.getElementById("mtu_L2TP");if(F=="1400"){i="AUTO";document.getElementById("mtu_L2TP_Input").style.display="none"}else{i="MANUAL";document.getElementById("mtu_L2TP_Input").style.display="inline"}COMM_SetSelectValue(aK,i);var E=xml_GetWanSettings.Get("GetWanSettingsResponse/AutoReconnect");var au=xml_GetWanSettings.Get("GetWanSettingsResponse/MaxIdleTime");var h="";var z=document.getElementById("reconnectMode_L2TP");switch(E){case"true":h="ALWAYSON";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true;break;case"false":if(au==0){h="MANUAL";document.getElementById("maxIdleTime_L2TP_tr").style.display="none";document.getElementById("maximumIdleTime_L2TP").value=0;document.getElementById("maximumIdleTime_L2TP").disabled=true}else{h="ONDEMAND";document.getElementById("maximumIdleTime_L2TP").value=au/60;document.getElementById("maximumIdleTime_L2TP").disabled=false}break}COMM_SetSelectValue(z,h);break}$("#vlan_lan_1").selectbox();$("#vlan_lan_2").selectbox();$("#vlan_lan_3").selectbox();$("#vlan_lan_4").selectbox();$("#vlan_wlan").selectbox();$("#vlan_wlan_gz").selectbox();current_wantype=ag;ChangeConnectType(ag);COMM_SetSelectValue(L,ag);$("#device_mode").selectbox();$("#connect_type").selectbox("detach");$("#connect_type").selectbox();$("#mtu_StaticIP").selectbox();$("#clone_mac_StaticIP").selectbox();$("#mtu_DynamicIP").selectbox();$("#clone_mac_DynamicIP").selectbox();$("#addressMode_PPPoE").selectbox();$("#reconnectMode_PPPoE").selectbox();$("#mtu_PPPoE").selectbox();$("#clone_ComputerIpByPPPoE").selectbox();$("#addressMode_PPTP").selectbox();$("#reconnectMode_PPTP").selectbox();$("#mtu_PPTP").selectbox();$("#addressMode_L2TP").selectbox();$("#reconnectMode_L2TP").selectbox();$("#mtu_L2TP").selectbox();$("#configuration_DSLite").selectbox();$("#addressMode_Ru_PPPoE").selectbox()}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:2000,type:"GET",success:function(a){SaveWAN()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SaveWAN(){var h=HNAP.GetXML("SetWanSettings");var n=document.getElementById("connect_type").value;var i=document.getElementById("device_mode").value;var e=document.getElementById("iPAddress_StaticIP").value;switch(n){case"STATIC":if(i=="BRIDGE"){h.Set("SetWanSettings/Type","StaticBridged")}else{if(i=="AP"){h.Set("SetWanSettings/Type","StaticAp")}else{if(i=="EXTENDER"){h.Set("SetWanSettings/Type","StaticExtender")}else{h.Set("SetWanSettings/Type","Static");h.Set("SetWanSettings/MacAddress",document.getElementById("macAddress_StaticIP").value)}}}h.Set("SetWanSettings/IPAddress",e);h.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_StaticIP").value);h.Set("SetWanSettings/Gateway",document.getElementById("defaultGateway_StaticIP").value);h.Set("SetWanSettings/MTU",document.getElementById("mtu_StaticIP_Input").value);var p=document.getElementById("mtu_StaticIP").value;if(p=="AUTO"){h.Set("SetWanSettings/MTU","1500")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_StaticIP_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_StaticIP").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_StaticIP").value);break;case"DHCP":if(i=="BRIDGE"){h.Set("SetWanSettings/Type","DynamicBridged")}else{if(i=="AP"){h.Set("SetWanSettings/Type","DynamicAp")}else{if(i=="EXTENDER"){h.Set("SetWanSettings/Type","DynamicExtender")}else{h.Set("SetWanSettings/Type","DHCP");h.Set("SetWanSettings/MacAddress",document.getElementById("macAddress_DynamicIP").value)}}}h.Set("SetWanSettings/MTU",document.getElementById("mtu_DynamicIP_Input").value);var f=document.getElementById("mtu_DynamicIP").value;if(f=="AUTO"){h.Set("SetWanSettings/MTU","1500")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_DynamicIP_Input").value)}h.Set("SetWanSettings/HostName",document.getElementById("hostName_DynamicIP").value);h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_DynamicIP").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_DynamicIP").value);break;case"PPPoE":h.Set("SetWanSettings/Username",document.getElementById("userName_PPPoE").value);h.Set("SetWanSettings/Password",document.getElementById("password_PPPoE").value);var a=document.getElementById("addressMode_PPPoE").value;if(a=="DYNAMICIP"){h.Set("SetWanSettings/Type","DHCPPPPoE");h.Set("SetWanSettings/IPAddress","")}else{if(a=="STATICIP"){h.Set("SetWanSettings/Type","StaticPPPoE");h.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPPoE").value)}}h.Set("SetWanSettings/MacAddress",document.getElementById("macAddress_PPPoE").value);h.Set("SetWanSettings/ServiceName",document.getElementById("serviceName_PPPoE").value);var l=document.getElementById("reconnectMode_PPPoE").value;switch(l){case"ALWAYSON":h.Set("SetWanSettings/AutoReconnect","true");h.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPPoE").value*60);break;case"MANUAL":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime","0");break}var m=document.getElementById("mtu_PPPoE").value;if(m=="AUTO"){h.Set("SetWanSettings/MTU","1492")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_PPPoE_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPPoE").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPPoE").value);break;case"PPTP":h.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_PPTP").value);h.Set("SetWanSettings/Username",document.getElementById("userName_PPTP").value);h.Set("SetWanSettings/Password",document.getElementById("password_PPTP").value);var a=document.getElementById("addressMode_PPTP").value;if(a=="DYNAMICIP"){h.Set("SetWanSettings/Type","DynamicPPTP");h.Set("SetWanSettings/IPAddress","");h.Set("SetWanSettings/SubnetMask","");h.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){h.Set("SetWanSettings/Type","StaticPPTP");h.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPTP").value);h.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_PPTP").value);h.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_PPTP").value)}}var l=document.getElementById("reconnectMode_PPTP").value;switch(l){case"ALWAYSON":h.Set("SetWanSettings/AutoReconnect","true");h.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPTP").value*60);break;case"MANUAL":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime","0");break}var m=document.getElementById("mtu_PPTP").value;if(m=="AUTO"){h.Set("SetWanSettings/MTU","1400")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_PPTP_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPTP").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPTP").value);break;case"L2TP":h.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_L2TP").value);h.Set("SetWanSettings/Username",document.getElementById("userName_L2TP").value);h.Set("SetWanSettings/Password",document.getElementById("password_L2TP").value);var a=document.getElementById("addressMode_L2TP").value;if(a=="DYNAMICIP"){h.Set("SetWanSettings/Type","DynamicL2TP");h.Set("SetWanSettings/IPAddress","");h.Set("SetWanSettings/SubnetMask","");h.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){h.Set("SetWanSettings/Type","StaticL2TP");h.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_L2TP").value);h.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_L2TP").value);h.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_L2TP").value)}}var l=document.getElementById("reconnectMode_L2TP").value;switch(l){case"ALWAYSON":h.Set("SetWanSettings/AutoReconnect","true");h.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_L2TP").value*60);break;case"MANUAL":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime","0");break}var m=document.getElementById("mtu_L2TP").value;if(m=="AUTO"){h.Set("SetWanSettings/MTU","1400")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_L2TP_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_L2TP").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_L2TP").value);break;case"DSLite":h.Set("SetWanSettings/Type","DsLite");var g=document.getElementById("configuration_DSLite").value;h.Set("SetWanSettings/DsLite_Configuration",g);var d=document.getElementById("b4IPv4Address_DSLite").value;if(d!=""){h.Set("SetWanSettings/DsLite_B4IPv4Address","192.0.0."+d)}h.Set("SetWanSettings/DsLite_AFTR_IPv6Address",document.getElementById("afterIPv6Address_DSLite").value);break;case"Ru_PPPoE":h.Set("SetWanSettings/Username",document.getElementById("userName_PPPoE").value);h.Set("SetWanSettings/Password",document.getElementById("password_PPPoE").value);var a=document.getElementById("addressMode_PPPoE").value;if(a=="DYNAMICIP"){h.Set("SetWanSettings/Type","Ru_DHCPPPPoE");h.Set("SetWanSettings/IPAddress","")}else{if(a=="STATICIP"){h.Set("SetWanSettings/Type","Ru_StaticPPPoE");h.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPPoE").value)}}h.Set("SetWanSettings/ServiceName",document.getElementById("serviceName_PPPoE").value);var l=document.getElementById("reconnectMode_PPPoE").value;switch(l){case"ALWAYSON":h.Set("SetWanSettings/AutoReconnect","true");h.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPPoE").value*60);break;case"MANUAL":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime","0");break}var m=document.getElementById("mtu_PPPoE").value;if(m=="AUTO"){h.Set("SetWanSettings/MTU","1492")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_PPPoE_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPPoE").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPPoE").value);var o=document.getElementById("addressMode_Ru_PPPoE").value;if(o=="DYNAMICIP"){h.Set("SetWanSettings/RussiaPPP/Type","DHCPPPPoE");h.Set("SetWanSettings/RussiaPPP/IPAddress","");h.Set("SetWanSettings/RussiaPPP/SubnetMask","");h.Set("SetWanSettings/RussiaPPP/Gateway","");h.Set("SetWanSettings/RussiaPPP/DNS/Primary","");h.Set("SetWanSettings/RussiaPPP/DNS/Secondary","")}else{if(o=="STATICIP"){h.Set("SetWanSettings/RussiaPPP/Type","StaticPPPoE");h.Set("SetWanSettings/RussiaPPP/IPAddress",document.getElementById("ipAddress_Ru_PPPoE").value);h.Set("SetWanSettings/RussiaPPP/SubnetMask",document.getElementById("subnetMask_Ru_PPPoE").value);h.Set("SetWanSettings/RussiaPPP/Gateway",document.getElementById("gatewayIP_Ru_PPPoE").value);h.Set("SetWanSettings/RussiaPPP/DNS/Primary",document.getElementById("primaryDNSAddress_Ru_PPPoE").value);h.Set("SetWanSettings/RussiaPPP/DNS/Secondary",document.getElementById("secondaryDNSAddress_Ru_PPPoE").value)}}break;case"Ru_PPTP":h.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_PPTP").value);h.Set("SetWanSettings/Username",document.getElementById("userName_PPTP").value);h.Set("SetWanSettings/Password",document.getElementById("password_PPTP").value);var a=document.getElementById("addressMode_PPTP").value;if(a=="DYNAMICIP"){h.Set("SetWanSettings/Type","Ru_DynamicPPTP");h.Set("SetWanSettings/IPAddress","");h.Set("SetWanSettings/SubnetMask","");h.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){h.Set("SetWanSettings/Type","Ru_StaticPPTP");h.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_PPTP").value);h.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_PPTP").value);h.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_PPTP").value)}}var l=document.getElementById("reconnectMode_PPTP").value;switch(l){case"ALWAYSON":h.Set("SetWanSettings/AutoReconnect","true");h.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_PPTP").value*60);break;case"MANUAL":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime","0");break}var m=document.getElementById("mtu_PPTP").value;if(m=="AUTO"){h.Set("SetWanSettings/MTU","1400")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_PPTP_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_PPTP").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_PPTP").value);break;case"Ru_L2TP":h.Set("SetWanSettings/ServiceName",document.getElementById("serverIPAddress_L2TP").value);h.Set("SetWanSettings/Username",document.getElementById("userName_L2TP").value);h.Set("SetWanSettings/Password",document.getElementById("password_L2TP").value);var a=document.getElementById("addressMode_L2TP").value;if(a=="DYNAMICIP"){h.Set("SetWanSettings/Type","Ru_DynamicL2TP");h.Set("SetWanSettings/IPAddress","");h.Set("SetWanSettings/SubnetMask","");h.Set("SetWanSettings/Gateway","")}else{if(a=="STATICIP"){h.Set("SetWanSettings/Type","Ru_StaticL2TP");h.Set("SetWanSettings/IPAddress",document.getElementById("ipAddress_L2TP").value);h.Set("SetWanSettings/SubnetMask",document.getElementById("subnetMask_L2TP").value);h.Set("SetWanSettings/Gateway",document.getElementById("gatewayIP_L2TP").value)}}var l=document.getElementById("reconnectMode_L2TP").value;switch(l){case"ALWAYSON":h.Set("SetWanSettings/AutoReconnect","true");h.Set("SetWanSettings/MaxIdleTime","0");break;case"ONDEMAND":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime",document.getElementById("maximumIdleTime_L2TP").value*60);break;case"MANUAL":h.Set("SetWanSettings/AutoReconnect","false");h.Set("SetWanSettings/MaxIdleTime","0");break}var m=document.getElementById("mtu_L2TP").value;if(m=="AUTO"){h.Set("SetWanSettings/MTU","1400")}else{h.Set("SetWanSettings/MTU",document.getElementById("mtu_L2TP_Input").value)}h.Set("SetWanSettings/ConfigDNS/Primary",document.getElementById("primaryDNSAddress_L2TP").value);h.Set("SetWanSettings/ConfigDNS/Secondary",document.getElementById("secondaryDNSAddress_L2TP").value);break}var k=HNAP.SetXML("SetWanSettings",h);var q=k.Get("SetWanSettingsResponse/SetWanSettingsResult");var b;if(feature_vlan=="true"){b=SaveVLAN(i,n)}if(q=="REBOOT"||b=="REBOOT"){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="inline";document.getElementById("SuccessREBOOT").style.display="none";var c;if(i==devicemode_org){c=I18N("j","Rebooting")}else{if(i=="BRIDGE"||i=="AP"||i=="EXTENDER"){if(n=="STATIC"){redirect_url=e}else{if(n=="DHCP"){redirect_url=hostname+lanmac[4]+lanmac[5]+".local"}}c=I18N("j","The device is changing to bridge mode.");if(i=="AP"){c=I18N("j","The device is changing to ap mode.")}else{if(i=="EXTENDER"){c=I18N("j","The device is changing to Extender mode.")}}}else{c=I18N("j","The device is changing to router mode.")}}document.getElementById("Font_Color_Red").innerHTML=c;document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000);setTimeout("clearTimeout("+timer+");SavingFinishBlock()",bootuptime*1000);Reboot()}else{if(q=="ERROR_SERVICENAME"){alert(I18N("j","The service name is invalid."))}else{document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="inline";document.getElementById("waitDeviceReboot").style.display="none";document.getElementById("SuccessREBOOT").style.display="none";if(i=="BRIDGE"||i=="AP"||i=="EXTENDER"){if(n=="STATIC"){redirect_url=e}else{if(n=="DHCP"){redirect_url="192.168.0.50"}}setTimeout("RedirectToURL()",1000)}else{setTimeout("window.location.reload()",1000)}}}}function Reboot(){var a=HNAP.GetXML("Reboot");HNAP.SetXML("Reboot",a)}function ReciprocalBootupTime(){bootuptime--;document.getElementById("reciprocal_Number_Reboot").innerHTML=bootuptime+" "+I18N("j","Sec");timer=setTimeout("ReciprocalBootupTime()",1000)}function SavingFinishBlock(){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("waitSettingFinish").style.display="none";document.getElementById("waitDeviceReboot").style.display="none";document.getElementById("SuccessREBOOT").style.display="inline"}function RedirectToURL(){window.location.href="http://"+redirect_url}function ListMACAddress(b,a,c){if(a==0){document.getElementById("macAddress_"+c).value=init_macaddr}else{document.getElementById("macAddress_"+c).value=b.options[a].text}}function ListMACAddressByPPPoE_Select(b,a){if(a==0){document.getElementById("macAddress_PPPoE").value=tmp_MACAddress}else{document.getElementById("macAddress_PPPoE").value=b.options[a].text}}function ChangeMTU(a,b){switch(a){case"AUTO":document.getElementById("mtu_"+b+"_tr").style.display="none";document.getElementById("mtu_"+b+"_Input").style.display="none";break;case"MANUAL":document.getElementById("mtu_"+b+"_tr").style.display="inline";document.getElementById("mtu_"+b+"_Input").style.display="inline";break}}function ChangeAddrMode(a,b){switch(b){case"PPPoE":if(a=="DYNAMICIP"){document.getElementById("ipAddress_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_tr").style.display="table-row"}}break;case"PPTP":case"L2TP":if(a=="DYNAMICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="none";document.getElementById("subnetMask_"+b+"_tr").style.display="none";document.getElementById("gatewayIP_"+b+"_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="table-row";document.getElementById("subnetMask_"+b+"_tr").style.display="table-row";document.getElementById("gatewayIP_"+b+"_tr").style.display="table-row"}}break;case"Ru_PPPoE":if(a=="DYNAMICIP"){document.getElementById("ipAddress_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_tr").style.display="table-row"}}break;case"Ru_PPPoE_WAN":if(a=="DYNAMICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="none";document.getElementById("subnetMask_"+b+"_tr").style.display="none";document.getElementById("gatewayIP_"+b+"_tr").style.display="none";document.getElementById("primaryDNSAddress_"+b+"_tr").style.display="none";document.getElementById("secondaryDNSAddress_"+b+"_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_"+b+"_tr").style.display="table-row";document.getElementById("subnetMask_"+b+"_tr").style.display="table-row";document.getElementById("gatewayIP_"+b+"_tr").style.display="table-row";document.getElementById("primaryDNSAddress_"+b+"_tr").style.display="table-row";document.getElementById("secondaryDNSAddress_"+b+"_tr").style.display="table-row"}}break;case"Ru_PPTP":if(a=="DYNAMICIP"){document.getElementById("ipAddress_PPTP_tr").style.display="none";document.getElementById("subnetMask_PPTP_tr").style.display="none";document.getElementById("gatewayIP_PPTP_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_PPTP_tr").style.display="table-row";document.getElementById("subnetMask_PPTP_tr").style.display="table-row";document.getElementById("gatewayIP_PPTP_tr").style.display="table-row"}}break;case"Ru_L2TP":if(a=="DYNAMICIP"){document.getElementById("ipAddress_L2TP_tr").style.display="none";document.getElementById("subnetMask_L2TP_tr").style.display="none";document.getElementById("gatewayIP_L2TP_tr").style.display="none"}else{if(a=="STATICIP"){document.getElementById("ipAddress_L2TP_tr").style.display="table-row";document.getElementById("subnetMask_L2TP_tr").style.display="table-row";document.getElementById("gatewayIP_L2TP_tr").style.display="table-row"}}break}}function ChangeReconnectMode(a,b){switch(a){case"ALWAYSON":case"MANUAL":document.getElementById("maxIdleTime_"+b+"_tr").style.display="none";document.getElementById("maximumIdleTime_"+b).value="0";break;case"ONDEMAND":document.getElementById("maximumIdleTime_"+b).disabled=false;document.getElementById("maximumIdleTime_"+b).value="5";document.getElementById("maxIdleTime_"+b+"_tr").style.display="table-row";break}}function ChangeDSLiteConfig(a){switch(a){case"Dhcpv6Option":document.getElementById("afterIPv6Address_DSLite_tr").style.display="none";break;case"Manual":document.getElementById("afterIPv6Address_DSLite_tr").style.display="table-row";break}}function DisplayMACClone(a){var b=document.getElementById("device_mode").value;switch(a){case"STATIC":if(b=="BRIDGE"||b=="AP"||b=="EXTENDER"){document.getElementById("mac_clone_StaticIP_tr").style.display="none"}else{if(b=="ROUTER"){document.getElementById("mac_clone_StaticIP_tr").style.display="table-row"}}break;case"DHCP":if(b=="BRIDGE"||b=="AP"||b=="EXTENDER"){document.getElementById("mac_clone_DynamicIP_tr").style.display="none"}else{if(b=="ROUTER"){document.getElementById("mac_clone_DynamicIP_tr").style.display="table-row"}}break}}function ConnectTypeList(b){$("#connect_type").children().remove();var c=HNAP.GetXML("GetDeviceFeatureAlpha");var a=c.Get("GetDeviceFeatureAlphaResponse/FeatureRussia");switch(b){case"BRIDGE":case"AP":case"EXTENDER":$("#connect_type").append('<option value="STATIC">Static IP</option>');$("#connect_type").append('<option value="DHCP">Dynamic IP (DHCP)</option>');break;case"ROUTER":if(a=="true"){$("#connect_type").append('<option value="STATIC">Static IP</option>');$("#connect_type").append('<option value="DHCP">Dynamic IP (DHCP)</option>');$("#connect_type").append('<option value="PPPoE">PPPoE</option>');$("#connect_type").append('<option value="PPTP">PPTP</option>');$("#connect_type").append('<option value="L2TP">L2TP</option>');$("#connect_type").append('<option value="DSLite">DS-Lite</option>');$("#connect_type").append('<option value="Ru_PPPoE">Russia PPPoE (Dual Access)</option>');$("#connect_type").append('<option value="Ru_PPTP">Russia PPTP (Dual Access)</option>');$("#connect_type").append('<option value="Ru_L2TP">Russia L2TP (Dual Access)</option>')}else{$("#connect_type").append('<option value="STATIC">Static IP</option>');$("#connect_type").append('<option value="DHCP">Dynamic IP (DHCP)</option>');$("#connect_type").append('<option value="PPPoE">PPPoE</option>');$("#connect_type").append('<option value="PPTP">PPTP</option>');$("#connect_type").append('<option value="L2TP">L2TP</option>');$("#connect_type").append('<option value="DSLite">DS-Lite</option>')}break}}function ChangeDeviceMode(b){$("#connect_type").selectbox("detach");ConnectTypeList(b);var a=document.getElementById("connect_type");if(current_wantype=="STATIC"||current_wantype=="DHCP"){current_wantype=current_wantype}else{current_wantype="DHCP"}DisplayMACClone(current_wantype);ChangeConnectType(current_wantype);COMM_SetSelectValue(a,current_wantype);$("#connect_type").selectbox("attach")}function ReplaceEmpty(a,b){a.value=a.value.replace(/\s/g,"")}function VLANSetting(e){var h=document.getElementById("device_mode").value;var a=xml_GetVlanSettings.Get("GetVlanSettingsResponse/active");var g=document.getElementById("show_enableVLAN_staticIP");var c=document.getElementById("show_enableVLAN_DynamicIP");var b=document.getElementById("show_enableVLAN_PPPoE");var d=document.getElementById("advancedBlock_hr");var f=document.getElementById("advancedBlock_VLANSetting");if(h!="ROUTER"){g.style.display="none";c.style.display="none";b.style.display="none";d.style.display="none";f.style.display="none";return}$("#vlan_lan_1").selectbox("detach");$("#vlan_lan_2").selectbox("detach");$("#vlan_lan_3").selectbox("detach");$("#vlan_lan_4").selectbox("detach");$("#vlan_wlan").selectbox("detach");$("#vlan_wlan_gz").selectbox("detach");if(e=="STATIC"){g.style.display="table-row";document.getElementById("inter_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/interid_dhcp");document.getElementById("voip_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/voipid_dhcp");document.getElementById("iptv_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/iptvid_dhcp");document.getElementById("vlan_lan_1").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan1_dhcp");document.getElementById("vlan_lan_2").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan2_dhcp");document.getElementById("vlan_lan_3").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan3_dhcp");document.getElementById("vlan_lan_4").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan4_dhcp");document.getElementById("vlan_wlan").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/wlanport/wlan01_dhcp");document.getElementById("vlan_wlan_gz").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/wlanport/wlan02_dhcp");if(a=="1"){presetCheckBox("enableVLAN_staticIP",true);presetCheckBox("enableVLAN_DynamicIP",true);presetCheckBox("enableVLAN_PPPoE",true);d.style.display="inline";f.style.display="inline"}else{presetCheckBox("enableVLAN_staticIP",false);presetCheckBox("enableVLAN_DynamicIP",false);presetCheckBox("enableVLAN_PPPoE",false);d.style.display="none";f.style.display="none"}}else{if(e=="DHCP"){c.style.display="table-row";document.getElementById("inter_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/interid_dhcp");document.getElementById("voip_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/voipid_dhcp");document.getElementById("iptv_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/iptvid_dhcp");document.getElementById("vlan_lan_1").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan1_dhcp");document.getElementById("vlan_lan_2").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan2_dhcp");document.getElementById("vlan_lan_3").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan3_dhcp");document.getElementById("vlan_lan_4").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan4_dhcp");document.getElementById("vlan_wlan").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/wlanport/wlan01_dhcp");document.getElementById("vlan_wlan_gz").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/wlanport/wlan02_dhcp");if(a=="1"){presetCheckBox("enableVLAN_staticIP",true);presetCheckBox("enableVLAN_DynamicIP",true);presetCheckBox("enableVLAN_PPPoE",true);d.style.display="inline";f.style.display="inline"}else{presetCheckBox("enableVLAN_staticIP",false);presetCheckBox("enableVLAN_DynamicIP",false);presetCheckBox("enableVLAN_PPPoE",false);d.style.display="none";f.style.display="none"}}else{if(e=="PPPoE"){b.style.display="table-row";document.getElementById("inter_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/interid_dhcp");document.getElementById("voip_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/voipid_dhcp");document.getElementById("iptv_vlanid").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/iptvid_dhcp");document.getElementById("vlan_lan_1").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan1_dhcp");document.getElementById("vlan_lan_2").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan2_dhcp");document.getElementById("vlan_lan_3").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan3_dhcp");document.getElementById("vlan_lan_4").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/lanport/lan4_dhcp");document.getElementById("vlan_wlan").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/wlanport/wlan01_dhcp");document.getElementById("vlan_wlan_gz").value=xml_GetVlanSettings.Get("GetVlanSettingsResponse/wlanport/wlan02_dhcp");if(a=="1"){presetCheckBox("enableVLAN_staticIP",true);presetCheckBox("enableVLAN_DynamicIP",true);presetCheckBox("enableVLAN_PPPoE",true);d.style.display="inline";f.style.display="inline"}else{presetCheckBox("enableVLAN_staticIP",false);presetCheckBox("enableVLAN_DynamicIP",false);presetCheckBox("enableVLAN_PPPoE",false);d.style.display="none";f.style.display="none"}}else{presetCheckBox("enableVLAN_staticIP",false);presetCheckBox("enableVLAN_DynamicIP",false);presetCheckBox("enableVLAN_PPPoE",false);d.style.display="none";f.style.display="none"}}}$("#vlan_lan_1").selectbox("attach");$("#vlan_lan_2").selectbox("attach");$("#vlan_lan_3").selectbox("attach");$("#vlan_lan_4").selectbox("attach");$("#vlan_wlan").selectbox("attach");$("#vlan_wlan_gz").selectbox("attach")}function SaveVLAN(g,c){var b=HNAP.GetXML("SetVlanSettings");b.Set("SetVlanSettings/devmode",g);b.Set("SetVlanSettings/wantype",c);if(g=="ROUTER"){var f=document.getElementById("enableVLAN_staticIP_ck").checked;var e=document.getElementById("enableVLAN_DynamicIP_ck").checked;var d=document.getElementById("enableVLAN_PPPoE_ck").checked;if(c=="STATIC"){if(f=="1"){b.Set("SetVlanSettings/active","1");b.Set("SetVlanSettings/interid_dhcp",document.getElementById("inter_vlanid").value);b.Set("SetVlanSettings/voipid_dhcp",document.getElementById("voip_vlanid").value);b.Set("SetVlanSettings/iptvid_dhcp",document.getElementById("iptv_vlanid").value);b.Set("SetVlanSettings/lanport/lan1_dhcp",document.getElementById("vlan_lan_1").value);b.Set("SetVlanSettings/lanport/lan2_dhcp",document.getElementById("vlan_lan_2").value);b.Set("SetVlanSettings/lanport/lan3_dhcp",document.getElementById("vlan_lan_3").value);b.Set("SetVlanSettings/lanport/lan4_dhcp",document.getElementById("vlan_lan_4").value);b.Set("SetVlanSettings/wlanport/wlan01_dhcp",document.getElementById("vlan_wlan").value);b.Set("SetVlanSettings/wlanport/wlan02_dhcp",document.getElementById("vlan_wlan_gz").value)}else{b.Set("SetVlanSettings/active","0")}}else{if(c=="DHCP"){if(e=="1"){b.Set("SetVlanSettings/active","1");b.Set("SetVlanSettings/interid_dhcp",document.getElementById("inter_vlanid").value);b.Set("SetVlanSettings/voipid_dhcp",document.getElementById("voip_vlanid").value);b.Set("SetVlanSettings/iptvid_dhcp",document.getElementById("iptv_vlanid").value);b.Set("SetVlanSettings/lanport/lan1_dhcp",document.getElementById("vlan_lan_1").value);b.Set("SetVlanSettings/lanport/lan2_dhcp",document.getElementById("vlan_lan_2").value);b.Set("SetVlanSettings/lanport/lan3_dhcp",document.getElementById("vlan_lan_3").value);b.Set("SetVlanSettings/lanport/lan4_dhcp",document.getElementById("vlan_lan_4").value);b.Set("SetVlanSettings/wlanport/wlan01_dhcp",document.getElementById("vlan_wlan").value);b.Set("SetVlanSettings/wlanport/wlan02_dhcp",document.getElementById("vlan_wlan_gz").value)}else{b.Set("SetVlanSettings/active","0")}}else{if(c=="PPPoE"){if(d=="1"){b.Set("SetVlanSettings/active","1");b.Set("SetVlanSettings/interid_dhcp",document.getElementById("inter_vlanid").value);b.Set("SetVlanSettings/voipid_dhcp",document.getElementById("voip_vlanid").value);b.Set("SetVlanSettings/iptvid_dhcp",document.getElementById("iptv_vlanid").value);b.Set("SetVlanSettings/lanport/lan1_dhcp",document.getElementById("vlan_lan_1").value);b.Set("SetVlanSettings/lanport/lan2_dhcp",document.getElementById("vlan_lan_2").value);b.Set("SetVlanSettings/lanport/lan3_dhcp",document.getElementById("vlan_lan_3").value);b.Set("SetVlanSettings/lanport/lan4_dhcp",document.getElementById("vlan_lan_4").value);b.Set("SetVlanSettings/wlanport/wlan01_dhcp",document.getElementById("vlan_wlan").value);b.Set("SetVlanSettings/wlanport/wlan02_dhcp",document.getElementById("vlan_wlan_gz").value)}else{b.Set("SetVlanSettings/active","0")}}else{b.Set("SetVlanSettings/active","0")}}}if(f=="1"||e=="1"||d=="1"){b.Set("SetVlanSettings/lanport/lan1",SetVlanid(document.getElementById("vlan_lan_1").value));b.Set("SetVlanSettings/lanport/lan2",SetVlanid(document.getElementById("vlan_lan_2").value));b.Set("SetVlanSettings/lanport/lan3",SetVlanid(document.getElementById("vlan_lan_3").value));b.Set("SetVlanSettings/lanport/lan4",SetVlanid(document.getElementById("vlan_lan_4").value));b.Set("SetVlanSettings/wlanport/wlan01",SetVlanid(document.getElementById("vlan_wlan").value));b.Set("SetVlanSettings/wlanport/wlan02",SetVlanid(document.getElementById("vlan_wlan_gz").value))}}else{b.Set("SetVlanSettings/active","0")}var a=HNAP.SetXML("SetVlanSettings",b);return a.Get("SetVlanSettingsResponse/SetVlanSettingsResult")}function SetVlanid(a){var b;switch(a){case"internet":b=document.getElementById("inter_vlanid").value;break;case"voip":b=document.getElementById("voip_vlanid").value;break;case"iptv":b=document.getElementById("iptv_vlanid").value;break}return b}function get_mac(a){var b=new Array();if(a.search(":")!=-1){var d=a.split(":")}else{var d=a.split("-")}for(var c=0;c<=6;c++){b[c]=""}if(a!=""){for(var c=1;c<=d.length;c++){b[c]=d[c-1]}b[0]=a}return b}function is_valid_mac(a){if(a.length>2){return false}return is_hexdigit(a)}function verify_mac(a,b){mac=get_mac(a);if(parseInt(mac[1],16)%2){return false}for(j=1;j<=6;j++){if(!is_valid_mac(mac[j])){return false}if(mac[j].length==1){mac[j]="0"+mac[j]}}if(b){b.value=mac[1]+":"+mac[2]+":"+mac[3]+":"+mac[4]+":"+mac[5]+":"+mac[6]}return true}function is_hexdigit(b){if(b.length==0){return false}for(var a=0;a<b.length;a++){if(b.charAt(a)<="9"&&b.charAt(a)>="0"){continue}if(b.charAt(a)<="F"&&b.charAt(a)>="A"){continue}if(b.charAt(a)<="f"&&b.charAt(a)>="a"){continue}return false}return true};</script> <script type="text/javascript">$(function(){$("select").change(function(){save_button_changed()});$("input").keydown(function(){save_button_changed()})});</script> </head> <body> <form name="internet_form" id="internet_form" method="POST" action=""> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Internet");</script></div> <div id="wallimage"><img src="image/internet_page.png" alt="" width="195" height="119"/></div> <div id="directions"> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script> >> <script>I18N("h","Internet");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> <li id="FUNC_IPv6" style="display:block"><a href="javascript:CheckHTMLStatus('Internet_IPv6');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h","IPv6");</script></div></a></li> </ul> </div> <br/> <div id="main"> <div id="devicemode_block" style="display:none;"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Device Mode");</script>:</th> <td> <div class="styled-select"> <select id="device_mode" name="device_mode" onChange="ChangeDeviceMode(this.value)"> <option value="ROUTER">Router Mode</option> </select> </div> </td> </tr> </tbody> </table> <hr/> </div> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","My Internet Connection is");</script>:</th> <td> <div class="styled-select"> <select id="connect_type" name="connect_type" onChange="ChangeConnectType(this.value);"> <option value="STATIC">Static IP</option> <option value="DHCP">Dynamic IP (DHCP)</option> <option value="PPPoE">PPPoE</option> <option value="PPTP">PPTP</option> <option value="L2TP">L2TP</option> <option value="DSLite">DS-Lite</option> </select> </div> <input class="styled-text" type="text" name="value_Session" size="1" id="value_Session" value="1" style="visibility: hidden; position: absolute; width: 0px; height: 0px;"> </td> </tr> </tbody> </table> <div id="generalBlock_staticIP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","IP Address");</script>:</th> <td><input class="styled-text" type="text" name="iPAddress_StaticIP" size="27" maxlength="15" id="iPAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Subnet Mask");</script>:</th> <td><input class="styled-text" type="text" name="subnetMask_StaticIP" size="27" maxlength="15" id="subnetMask_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Default Gateway");</script>:</th> <td><input class="styled-text" type="text" name="defaultGateway_StaticIP" size="27" maxlength="15" id="defaultGateway_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td><input class="styled-text" type="text" name="primaryDNSAddress_StaticIP" size="27" maxlength="15" id="primaryDNSAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> </tbody> </table> </div> </div> <div id="generalBlock_PPPoE" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName_PPPoE" size="27" maxlength="255" id="userName_PPPoE"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_PPPoE" size="27" maxlength="255" id="password_PPPoE"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select name="reconnectMode_PPPoE" id="reconnectMode_PPPoE" onChange="ChangeReconnectMode(this.value, 'PPPoE')"> <option value="ALWAYSON">Always on</option> <option value="ONDEMAND" selected>On demand</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td></td> </tr> <tr id="maxIdleTime_PPPoE_tr"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_PPPoE" id="maximumIdleTime_PPPoE" value="5" maxlength="5">&nbsp;&nbsp;<script>I18N("h","minutes");</script></td> <td></td> </tr> </tbody> </table> </div> <div id="generalBlock_PPTP" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","PPTP Server IP Address");</script>:</th> <td><input class="styled-text" type="text" name="serverIPAddress_PPTP" size="27" maxlength="32" id="serverIPAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName_PPTP" size="27" maxlength="64" id="userName_PPTP"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_PPTP" size="27" maxlength="64" id="password_PPTP"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select name="reconnectMode_PPTP" id="reconnectMode_PPTP" onChange="ChangeReconnectMode(this.value, 'PPTP')"> <option value="ALWAYSON">Always on</option> <option value="ONDEMAND" selected>On demand</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td></td> </tr> <tr id="maxIdleTime_PPTP_tr"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_PPTP" id="maximumIdleTime_PPTP" value="5" maxlength="5">&nbsp;&nbsp;<script>I18N("h","minutes");</script></td> <td></td> </tr> </tbody> </table> </div> <div id="generalBlock_L2TP" style="display:none"> <table class="block"> <tbody> <tr> <th><script>I18N("h","L2TP Server IP Address");</script>:</th> <td><input class="styled-text" type="text" name="serverIPAddress_L2TP" size="27" maxlength="32" id="serverIPAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName_L2TP" size="27" maxlength="64" id="userName_L2TP"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password_L2TP" size="27" maxlength="64" id="password_L2TP"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select name="reconnectMode_L2TP" id="reconnectMode_L2TP" onChange="ChangeReconnectMode(this.value, 'L2TP')"> <option value="ALWAYSON">Always on</option> <option value="ONDEMAND" selected>On demand</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td></td> </tr> <tr id="maxIdleTime_L2TP_tr"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_L2TP" size="15" id="maximumIdleTime_L2TP" value="5" maxlength="5">&nbsp;&nbsp;<script>I18N("h","minutes");</script></td> <td></td> </tr> </tbody> </table> </div> <div class="advButton" onclick="showAdv('advancedBlock');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="advancedBlock" style="display:none"> <div id="advancedBlock_staticIP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td width="200px"><input class="styled-text" type="text" name="secondaryDNSAddress_StaticIP" size="27" maxlength="15" id="secondaryDNSAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> <td></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_StaticIP" id="mtu_StaticIP" onChange="ChangeMTU(this.value, 'StaticIP')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_StaticIP_tr"><input class="styled-text" type="text" name="mtu_StaticIP_Input" size="3" maxlength="5" id="mtu_StaticIP_Input" value="1500" style="display: none;" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="mac_clone_StaticIP_tr"> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" name="macAddress_StaticIP" size="27" maxlength="17" id="macAddress_StaticIP" onchange="ReplaceEmpty(this, this.value)"></td> <td> <div class="styled-select"> <select name="clone_mac_StaticIP" id="clone_mac_StaticIP" onChange="ListMACAddress(this, this.value, 'StaticIP')"> <option value="0">&lt;&lt; MAC Address</option> </select> </div> </td> </tr> <tr id="show_enableVLAN_staticIP" style="display:none"> <th><script>I18N("h","VLAN");</script>:</th> <td><div id="enableVLAN_staticIP"><input type="checkbox" name="enableVLAN_staticIP" id="enableVLAN_staticIP_ck"></div></td> </tr> </tbody> </table> </div> <div id="advancedBlock_DynamicIP" style="display:inline"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Host Name");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="hostName_DynamicIP" size="27" maxlength="25" id="hostName_DynamicIP"></td> <td></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_DynamicIP" size="27" maxlength="15" id="primaryDNSAddress_DynamicIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_DynamicIP" size="27" maxlength="15" id="secondaryDNSAddress_DynamicIP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_DynamicIP" id="mtu_DynamicIP" onChange="ChangeMTU(this.value, 'DynamicIP')"> <option value="AUTO">Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_DynamicIP_tr"><input class="styled-text" type="text" name="mtu_DynamicIP_Input" size="3" maxlength="5" id="mtu_DynamicIP_Input" value="1500" style="display: none;" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="mac_clone_DynamicIP_tr"> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" name="macAddress_DynamicIP" size="27" maxlength="17" id="macAddress_DynamicIP" onchange="ReplaceEmpty(this, this.value)"></td> <td> <div class="styled-select"> <select name="clone_mac_DynamicIP" id="clone_mac_DynamicIP" onChange="ListMACAddress(this, this.value, 'DynamicIP')"> <option value="0">&lt;&lt; MAC Address</option> </select> </div> </td> </tr> <tr id="show_enableVLAN_DynamicIP" style="display:none"> <th><script>I18N("h","VLAN");</script>:</th> <td><div id="enableVLAN_DynamicIP"><input type="checkbox" name="enableVLAN_DynamicIP" id="enableVLAN_DynamicIP_ck"></div></td> </tr> </tbody> </table> </div> <div id="advancedBlock_PPPoE" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_PPPoE" id="addressMode_PPPoE" onChange="ChangeAddrMode(this.value, 'PPPoE')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_tr" style="display:none;"> <th><script>I18N("h","IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_PPPoE" id="ipAddress_PPPoE" size="27" maxlength="15" id="ipAddress" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Service Name");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="serviceName_PPPoE" size="27" maxlength="25" id="serviceName_PPPoE"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_PPPoE" size="27" maxlength="15" id="primaryDNSAddress_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_PPPoE" size="27" maxlength="15" id="secondaryDNSAddress_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_PPPoE" id="mtu_PPPoE" onChange="ChangeMTU(this.value, 'PPPoE')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> <td id="mtu_PPPoE_tr"><input class="styled-text" type="text" name="mtu_PPPoE_Input" size="3" maxlength="5" id="mtu_PPPoE_Input" value="1492" style="display: none;"></td> </tr> <tr> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" name="macAddress_PPPoE" size="27" maxlength="17" id="macAddress_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> <td> <div class="styled-select"> <select name="clone_ComputerIpByPPPoE" id="clone_ComputerIpByPPPoE" onChange="ListMACAddressByPPPoE_Select(this, this.value)"> <option value="0">&lt;&lt; MAC Address</option> </select> </div> </td> </tr> <tr id="show_enableVLAN_PPPoE" style="display:none"> <th><script>I18N("h","VLAN");</script>:</th> <td><div id="enableVLAN_PPPoE"><input type="checkbox" name="enableVLAN_PPPoE" id="enableVLAN_PPPoE_ck"></div></td> </tr> </tbody> </table> </div> <div id="advancedBlock_Ru_PPPoE" style="display:none"> <table class="block" border="0"> <tbody> <tr> <td><div class="title"><script>I18N("h","WAN Physical Settings");</script></div></td> </tr> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_Ru_PPPoE" id="addressMode_Ru_PPPoE" onChange="ChangeAddrMode(this.value, 'Ru_PPPoE_WAN')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_Ru_PPPoE" size="27" maxlength="15" id="ipAddress_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="subnetMask_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Subnet Mask");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="subnetMask_Ru_PPPoE" size="27" maxlength="15" id="subnetMask_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="gatewayIP_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Gateway IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="gatewayIP_Ru_PPPoE" size="27" maxlength="15" id="gatewayIP_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="primaryDNSAddress_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_Ru_PPPoE" size="27" maxlength="15" id="primaryDNSAddress_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="secondaryDNSAddress_Ru_PPPoE_WAN_tr" style="display: none;"> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_Ru_PPPoE" size="27" maxlength="15" id="secondaryDNSAddress_Ru_PPPoE" onchange="ReplaceEmpty(this, this.value)"></td> </tr> </tbody> </table> </div> <div id="advancedBlock_PPTP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_PPTP" id="addressMode_PPTP" onChange="ChangeAddrMode(this.value, 'PPTP')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_PPTP_tr" style="display: none;"> <th><script>I18N("h","PPTP IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_PPTP" size="27" maxlength="15" id="ipAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="subnetMask_PPTP_tr" style="display: none;"> <th><script>I18N("h","PPTP Subnet Mask");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="subnetMask_PPTP" size="27" maxlength="15" id="subnetMask_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="gatewayIP_PPTP_tr" style="display: none;"> <th><script>I18N("h","PPTP Gateway IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="gatewayIP_PPTP" size="27" maxlength="15" id="gatewayIP_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_PPTP" size="27" maxlength="15" id="primaryDNSAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_PPTP" size="27" maxlength="15" id="secondaryDNSAddress_PPTP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_PPTP" id="mtu_PPTP" onChange="ChangeMTU(this.value, 'PPTP')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_PPTP_tr"><input class="styled-text" type="text" name="mtu_PPTP_Input" size="3" maxlength="5" id="mtu_PPTP_Input" value="1400" style="display: none;"></td> </tr> </tbody> </table> </div> <div id="advancedBlock_L2TP" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td width="200px"> <div class="styled-select"> <select name="addressMode_L2TP" id="addressMode_L2TP" onChange="ChangeAddrMode(this.value, 'L2TP')"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> <td></td> </tr> <tr id="ipAddress_L2TP_tr" style="display: none;"> <th><script>I18N("h","L2TP IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="ipAddress_L2TP" size="27" maxlength="15" id="ipAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="subnetMask_L2TP_tr" style="display: none;"> <th><script>I18N("h","L2TP Subnet Mask");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="subnetMask_L2TP" size="27" maxlength="15" id="subnetMask_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr id="gatewayIP_L2TP_tr" style="display: none;"> <th><script>I18N("h","L2TP Gateway IP Address");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="gatewayIP_L2TP" size="27" maxlength="15" id="gatewayIP_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="primaryDNSAddress_L2TP" size="27" maxlength="15" id="primaryDNSAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td colspan="2"><input class="styled-text" type="text" name="secondaryDNSAddress_L2TP" size="27" maxlength="15" id="secondaryDNSAddress_L2TP" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td> <div class="styled-select"> <select name="mtu_L2TP" id="mtu_L2TP" onChange="ChangeMTU(this.value, 'L2TP')"> <option value="AUTO" selected>Auto</option> <option value="MANUAL">Manual</option> </select> </div> </td> <td id="mtu_L2TP_tr"><input class="styled-text" type="text" name="mtu_L2TP_Input" size="3" maxlength="5" id="mtu_L2TP_Input" value="1400" style="display: none;"></td> </tr> </tbody> </table> </div> <div id="advancedBlock_DSLite" style="display:none"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","DS-Lite Configuration");</script>:</th> <td> <div class="styled-select"> <select name="configuration_DSLite" id="configuration_DSLite" onChange="ChangeDSLiteConfig(this.value)"> <option value="Dhcpv6Option">DS-Lite DHCPv6 Option</option> <option value="Manual">Manual Configuration</option> </select> </div> </td> </tr> <tr id="afterIPv6Address_DSLite_tr" style="display: none;"> <th><script>I18N("h","AFTR IPv6 Address");</script>:</th> <td><input class="styled-text" type="text" name="afterIPv6Address_DSLite" size="27" maxlength="39" id="afterIPv6Address_DSLite" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","B4 IPv4 Address");</script>:</th> <td>192.0.0.&nbsp;<input class="styled-text" style="width: 50px;" type="text" name="b4IPv4Address_DSLite" size="3" maxlength="3" id="b4IPv4Address_DSLite" onchange="ReplaceEmpty(this, this.value)"></td> </tr> <tr> <th><script>I18N("h","WAN IPv6 Address");</script>:</th> <td><label name="wanIPv6Address_DSLite" id="wanIPv6Address_DSLite">N/A</label></td> </tr> <tr> <th><script>I18N("h","IPv6 WAN Default Gateway");</script>:</th> <td><label name="ipv6WanDefaultGateway_DSLite" id="ipv6WanDefaultGateway_DSLite">N/A</label></td> </tr> </tbody> </table> </div> <div id="advancedBlock_hr" style="display:none"> <hr/> </div> <div id="advancedBlock_VLANSetting" style="display:none"> <table class="block" border="0"> <tbody> <tr> <td><div class="title"><script>I18N("h","VLAN BRIDGE");</script></div></td> </tr> <tr> <th><script>I18N("h","Internet VLan ID");</script>:</th> <td><input class="styled-text" type="text" name="inter_vlanid" size="27" maxlength="4" id="inter_vlanid">&nbsp;&nbsp;(2~4094)</td> </tr> <tr> <th><script>I18N("h","IPTV VLan ID");</script>:</th> <td><input class="styled-text" type="text" name="iptv_vlanid" size="27" maxlength="4" id="iptv_vlanid">&nbsp;&nbsp;(2~4094)</td> </tr> <tr> <th><script>I18N("h","VoIP VLan ID");</script>:</th> <td><input class="styled-text" type="text" name="voip_vlanid" size="27" maxlength="4" id="voip_vlanid">&nbsp;&nbsp;(2~4094)</td> </tr> </tbody> </table> <table class="mainTable" border="0" cellspacing="0" style="top:5px"> <thead> <tr> <th style="width:690px"><script>I18N("h","Interface");</script></th> <th><script>I18N("h","WAN Connection");</script></th> </tr> </thead> <tbody> <tr> <td><script>I18N("h","LAN Port1");</script></td> <td> <div class="styled-select"> <select id="vlan_lan_1" name="vlan_lan_1"> <option value="internet">Internet</option> <option value="iptv">IPTV</option> <option value="voip">VoIP</option> </select> </div> </td> </tr> <tr> <td><script>I18N("h","LAN Port2");</script></td> <td> <div class="styled-select"> <select id="vlan_lan_2" name="vlan_lan_2"> <option value="internet">Internet</option> <option value="iptv">IPTV</option> <option value="voip">VoIP</option> </select> </div> </td> </tr> <tr> <td><script>I18N("h","LAN Port3");</script></td> <td> <div class="styled-select"> <select id="vlan_lan_3" name="vlan_lan_3"> <option value="internet">Internet</option> <option value="iptv">IPTV</option> <option value="voip">VoIP</option> </select> </div> </td> </tr> <tr> <td><script>I18N("h","LAN Port4");</script></td> <td> <div class="styled-select"> <select id="vlan_lan_4" name="vlan_lan_4"> <option value="internet">Internet</option> <option value="iptv">IPTV</option> <option value="voip">VoIP</option> </select> </div> </td> </tr> <tr> <td><script>I18N("h","Wireless");</script></td> <td> <div class="styled-select"> <select id="vlan_wlan" name="vlan_wlan"> <option value="internet">Internet</option> <option value="iptv">IPTV</option> <option value="voip">VoIP</option> </select> </div> </td> </tr> <tr> <td><script>I18N("h","Wireless Guest Zone");</script></td> <td> <div class="styled-select"> <select id="vlan_wlan_gz" name="vlan_wlan_gz"> <option value="internet">Internet</option> <option value="iptv">IPTV</option> <option value="voip">VoIP</option> </select> </div> </td> </tr> </tbody> </table> </div> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td><center><div id="Loading_pop_image2"></div></center></td> </tr> <tr> <td><label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"> <script>I18N("h","Your changes are being saved.");</script> </td> </tr> </tbody> </table> <table class="myAlertPop_table" id="waitDeviceReboot" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Loading_pop_image"></div></center> </td> </tr> <tr> <td><label id="reciprocal_Number_Reboot"/></td> </tr> <tr> <td id="Font_Color_Red"></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="SuccessREBOOT" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td> <center><div id="Information_pop_image"></div></center> </td> </tr> <tr> <td> <div id="dialog_msg_black"> <script>I18N("h","The new settings have been saved.");</script> </div> </td> </tr> <tr> <td> <center> <div id="Confirm_btn" onclick="RedirectToURL()" style="cursor:pointer"> <script>I18N("h","OK");</script> </div> </center> </td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </div> </form> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$("#serverIPAddress_PPTP").attr("placeholder",I18N("j","IP or Domain name"));$("#serverIPAddress_L2TP").attr("placeholder",I18N("j","IP or Domain name"));function a(d){if(d!="PPPoE"&&wan_IPv6type=="IPv6_PPPoE"&&PppoeNewSession=="SharedWithIPv4"){return false}else{return true}}function b(d){if(d=="DSLite"&&(wan_IPv6type=="IPv6_IPv6InIPv4Tunnel"||wan_IPv6type=="IPv6_6To4"||wan_IPv6type=="IPv6_6RD"||wan_IPv6type=="IPv6_LinkLocalOnly")){return false}else{return true}}$.validator.addMethod("checkSetValues",function(z,g){var p=g.id;var r="";var k=document.getElementById("connect_type").value;if(!a(k)){if(p=="value_Session"){return I18N("j","IPv6 PPPoE is share with IPv4 PPPoE. Please change IPv6 WAN protocol to PPPoE at first.")}}else{if(!b(k)){if(p=="value_Session"){return I18N("j","Please choose one IPv6 connection type besides Link-Local Only, 6to4, 6rd, and IPv6 in IPv4 Tunnel !")}}else{switch(k){case"STATIC":var h=document.getElementById("iPAddress_StaticIP").value;var t=document.getElementById("primaryDNSAddress_StaticIP").value;var f=document.getElementById("subnetMask_StaticIP").value;var B=COMM_IPv4MASK2INT(f);if(p=="iPAddress_StaticIP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}var l=document.getElementById("device_mode").value;if(l=="ROUTER"&&f!=""&&(COMM_IPv4NETWORK(z,B)==COMM_IPv4NETWORK(lan_IPAddr,B))){return I18N("j","The network id is the same with LAN.")}if(l=="ROUTER"&&f!=""&&(COMM_IPv4NETWORK(z,B)==COMM_IPv4NETWORK(lan_IPAddr_g,B))){return I18N("j","The network id is the same with GuestZone.")}}}if(p=="subnetMask_StaticIP"){if(z==""||z==null){return I18N("j","Please enter a subnet mask.")}else{var B=COMM_IPv4MASK2INT(z);if(B<=0||B>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(B<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(p=="defaultGateway_StaticIP"){if(z==""||z==null){return I18N("j","Please enter a gateway address.")}else{if(f!=""){if(!COMM_ValidV4HOST(z,B)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(h!=""){if(z==h){return I18N("j","Please enter a valid gateway address. (e.g. 192.168.0.1)")}if(COMM_IPv4NETWORK(z,B)!=COMM_IPv4NETWORK(h,B)){return I18N("j","The default gateway should be in the same network.")}}}}}if(p=="primaryDNSAddress_StaticIP"){if(z==""||z==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(h!=""&&z==h){return I18N("j","The dns server cannot be equal to the IP address.")}}}if(p=="secondaryDNSAddress_StaticIP"&&z!=""){if(t==""||t==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(p=="mtu_StaticIP_Input"&&$("#mtu_StaticIP")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1500<z){return I18N("j","The MTU value should be 1280 ~ 1500.")}}if(p=="macAddress_StaticIP"&&z!=""){if(z=="00:00:00:00:00:00"||!COMM_IsMAC(z)){return I18N("j","Text field contains illegal characters.")}if(!verify_mac(z,p)){return I18N("j","err_Check_Mac")}}break;case"DHCP":var n=document.getElementById("primaryDNSAddress_DynamicIP").value;if(p=="hostName_DynamicIP"&&z!=""){if(!(/(^[A-Za-z0-9_-]+$)/.test(z))){return I18N("j","Invaild hostname.")}}if(p=="primaryDNSAddress_DynamicIP"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(p=="secondaryDNSAddress_DynamicIP"&&z!=""){if(n==""||n==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==n){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(p=="mtu_DynamicIP_Input"&&$("#mtu_DynamicIP")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1500<z){return I18N("j","The MTU value should be 1280 ~ 1500.")}}if(p=="macAddress_DynamicIP"&&z!=""){if(z=="00:00:00:00:00:00"||!COMM_IsMAC(z)){return I18N("j","Text field contains illegal characters.")}if(!verify_mac(z,p)){return I18N("j","err_Check_Mac")}}break;case"PPPoE":var o=document.getElementById("addressMode_PPPoE").value;var D=document.getElementById("primaryDNSAddress_PPPoE").value;if(p=="userName_PPPoE"&&(z==""||z==null)){return I18N("j","Please enter a username.")}if(p=="password_PPPoE"&&(z==""||z==null)){return I18N("j","Please enter a password.")}if(p=="serviceName_PPPoE"&&z!=""){if(!(/(^[A-Za-z0-9_-]+$)/.test(z))){return I18N("j","The service name is invalid.")}}if(p=="primaryDNSAddress_PPPoE"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(p=="secondaryDNSAddress_PPPoE"&&z!=""){if(D==""||D==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==D){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(o=="STATICIP"&&p=="ipAddress_PPPoE"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="macAddress_PPPoE"&&z!=""){if(z=="00:00:00:00:00:00"||!COMM_IsMAC(z)){return I18N("j","Text field contains illegal characters.")}if(!verify_mac(z,p)){return I18N("j","err_Check_Mac")}}if(p=="mtu_PPPoE_Input"&&$("#mtu_PPPoE")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1492<z){return I18N("j","The MTU value should be 1280 ~ 1492.")}}if(p=="maximumIdleTime_PPPoE"&&(!COMM_IsDigit(z)||z<=0)){return I18N("j","Please enter a value")}break;case"PPTP":var u=document.getElementById("addressMode_PPTP").value;var v=document.getElementById("primaryDNSAddress_PPTP").value;var q=document.getElementById("ipAddress_PPTP").value;var f=document.getElementById("subnetMask_PPTP").value;var B=COMM_IPv4MASK2INT(f);if(p=="serverIPAddress_PPTP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}}if(p=="userName_PPTP"&&(z==""||z==null)){return I18N("j","Please enter a username.")}if(u=="STATICIP"){if(p=="ipAddress_PPTP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="subnetMask_PPTP"){if(z==""||z==null){return I18N("j","Please enter a subnet mask.")}else{var B=COMM_IPv4MASK2INT(z);if(B<=0||B>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(B<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(p=="gatewayIP_PPTP"){if(z==""||z==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(f!=""){if(q!=""){if(z==q){return I18N("j","Please enter a valid gateway address. (e.g. 192.168.0.1)")}if(COMM_IPv4NETWORK(z,B)!=COMM_IPv4NETWORK(q,B)){return I18N("j","The default gateway should be in the same network.")}}}}}if(p=="primaryDNSAddress_PPTP"){if(z==""||z==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(p=="primaryDNSAddress_PPTP"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="secondaryDNSAddress_PPTP"&&z!=""){if(v==""||v==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==v){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(p=="mtu_PPTP_Input"&&$("#mtu_PPTP")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1460<z){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(p=="maximumIdleTime_PPTP"&&(!COMM_IsDigit(z)||z<=0)){return I18N("j","Please enter a value")}break;case"L2TP":var s=document.getElementById("addressMode_L2TP").value;var e=document.getElementById("primaryDNSAddress_L2TP").value;var y=document.getElementById("ipAddress_L2TP").value;var f=document.getElementById("subnetMask_L2TP").value;var B=COMM_IPv4MASK2INT(f);if(p=="serverIPAddress_L2TP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}}if(p=="userName_L2TP"&&(z==""||z==null)){return I18N("j","Please enter a username.")}if(s=="STATICIP"){if(p=="ipAddress_L2TP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="subnetMask_L2TP"){if(z==""||z==null){return I18N("j","Please enter a subnet mask.")}else{var B=COMM_IPv4MASK2INT(z);if(B<=0||B>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(B<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(p=="gatewayIP_L2TP"){if(z==""||z==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(f!=""){if(y!=""){if(z==y){return I18N("j","Please enter a valid gateway address. (e.g. 192.168.0.1)")}if(COMM_IPv4NETWORK(z,B)!=COMM_IPv4NETWORK(y,B)){return I18N("j","The default gateway should be in the same network.")}}}}}if(p=="primaryDNSAddress_L2TP"){if(z==""||z==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(p=="primaryDNSAddress_L2TP"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="secondaryDNSAddress_L2TP"&&z!=""){if(e==""||e==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==e){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(p=="mtu_L2TP_Input"&&$("#mtu_L2TP")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1460<z){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(p=="maximumIdleTime_L2TP"&&(!COMM_IsDigit(z)||z<=0)){return I18N("j","Please enter a value")}break;case"DSLite":var d=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;var w=document.getElementById("configuration_DSLite").value;if(w=="Manual"&&p=="afterIPv6Address_DSLite"){if(z==""||z==null){return I18N("j","Please enter an IPv6 address.")}else{if(!d.test(z)){return I18N("j","Please enter a valid IPv6 address. (e.g. 2001::1)")}}}if(p=="b4IPv4Address_DSLite"){var x=parseInt(document.getElementById("b4IPv4Address_DSLite").value);if(x>=8||x<=1){return I18N("j","Please enter a valid IP address. (e.g. 192.0.0.2)")}}break;case"Ru_PPPoE":var o=document.getElementById("addressMode_PPPoE").value;var D=document.getElementById("primaryDNSAddress_PPPoE").value;var i=document.getElementById("addressMode_Ru_PPPoE").value;var A=document.getElementById("primaryDNSAddress_Ru_PPPoE").value;if(p=="userName_PPPoE"&&(z==""||z==null)){return I18N("j","Please enter a username.")}if(p=="password_PPPoE"&&(z==""||z==null)){return I18N("j","Please enter a password.")}if(p=="primaryDNSAddress_PPPoE"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}if(p=="secondaryDNSAddress_PPPoE"&&z!=""){if(D==""||D==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==D){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(o=="STATICIP"&&p=="ipAddress_PPPoE"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="mtu_PPPoE_Input"&&$("#mtu_PPPoE")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1492<z){return I18N("j","The MTU value should be 1280 ~ 1492.")}}if(p=="maximumIdleTime_PPPoE"&&(!COMM_IsDigit(z)||z<=0)){return I18N("j","Please enter a value")}if(i=="STATICIP"){if(p=="ipAddress_Ru_PPPoE"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="subnetMask_Ru_PPPoE"){if(z==""||z==null){return I18N("j","Please enter a subnet mask.")}else{var B=COMM_IPv4MASK2INT(z);if(B<=0||B>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(B<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(p=="gatewayIP_Ru_PPPoE"){if(z==""||z==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="primaryDNSAddress_Ru_PPPoE"){if(z==""||z==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="secondaryDNSAddress_Ru_PPPoE"&&z!=""){if(A==""||A==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==A){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}}break;case"Ru_PPTP":var u=document.getElementById("addressMode_PPTP").value;var v=document.getElementById("primaryDNSAddress_PPTP").value;if(p=="serverIPAddress_PPTP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="userName_PPTP"&&(z==""||z==null)){return I18N("j","Please enter a username.")}if(p=="password_PPTP"&&(z==""||z==null)){return I18N("j","Please enter a password.")}if(u=="STATICIP"){if(p=="ipAddress_PPTP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="subnetMask_PPTP"){if(z==""||z==null){return I18N("j","Please enter a subnet mask.")}else{var B=COMM_IPv4MASK2INT(z);if(B<=0||B>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(B<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(p=="gatewayIP_PPTP"){if(z==""||z==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="primaryDNSAddress_PPTP"){if(z==""||z==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(p=="primaryDNSAddress_PPTP"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="secondaryDNSAddress_PPTP"&&z!=""){if(v==""||v==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==v){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(p=="mtu_PPTP_Input"&&$("#mtu_PPTP")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1460<z){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(p=="maximumIdleTime_PPTP"&&!COMM_IsDigit(z)){return I18N("j","Please enter a value")}break;case"Ru_L2TP":var s=document.getElementById("addressMode_L2TP").value;var e=document.getElementById("primaryDNSAddress_L2TP").value;if(p=="serverIPAddress_L2TP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="userName_L2TP"&&(z==""||z==null)){return I18N("j","Please enter a username.")}if(p=="password_L2TP"&&(z==""||z==null)){return I18N("j","Please enter a password.")}if(s=="STATICIP"){if(p=="ipAddress_L2TP"){if(z==""||z==null){return I18N("j","Please enter an IP address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="subnetMask_L2TP"){if(z==""||z==null){return I18N("j","Please enter a subnet mask.")}else{var B=COMM_IPv4MASK2INT(z);if(B<=0||B>32){return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)")}if(B<8){return I18N("j","The router would not support the subnet mask which length is less than Class A.")}}}if(p=="gatewayIP_L2TP"){if(z==""||z==null){return I18N("j","Please enter a gateway address.")}else{if(!COMM_ValidV4Format(z)||!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="primaryDNSAddress_L2TP"){if(z==""||z==null){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}else{if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}}else{if(p=="primaryDNSAddress_L2TP"&&z!=""){if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}}}if(p=="secondaryDNSAddress_L2TP"&&z!=""){if(e==""||e==null){return I18N("j","Please enter a primary dns server")}if(!COMM_ValidV4Addr(z)){return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)")}if(z==e){return I18N("j","Secondary DNS server should not be the same as Primary DNS server.")}}if(p=="mtu_L2TP_Input"&&$("#mtu_L2TP")[0].value=="MANUAL"){if(!COMM_IsInteger(z)||z<1280||1460<z){return I18N("j","The MTU value should be 1280 ~ 1460.")}}if(p=="maximumIdleTime_L2TP"&&!COMM_IsDigit(z)){return I18N("j","Please enter a value")}break}var m=document.getElementById("enableVLAN_staticIP_ck").checked;var j=document.getElementById("enableVLAN_DynamicIP_ck").checked;var C=document.getElementById("enableVLAN_PPPoE_ck").checked;if(m=="1"||j=="1"||C=="1"){if(p=="inter_vlanid"||p=="iptv_vlanid"||p=="voip_vlanid"){if(!COMM_IsInteger(z)||z<2||4094<z){return I18N("j","The VID value should be 2 ~ 4094.")}}if(p=="inter_vlanid"){if(z==document.getElementById("iptv_vlanid").value){return I18N("j","Internet VID is same with IPTV VID.")}if(z==document.getElementById("voip_vlanid").value){return I18N("j","Internet VID is same with VoIP VID.")}}if(p=="iptv_vlanid"){if(z==document.getElementById("inter_vlanid").value){return I18N("j","IPTV VID is same with Internet VID.")}if(z==document.getElementById("voip_vlanid").value){return I18N("j","IPTV VID is same with VoIP VID.")}}if(p=="voip_vlanid"){if(z==document.getElementById("inter_vlanid").value){return I18N("j","VoIP VID is same with Internet VID.")}if(z==document.getElementById("iptv_vlanid").value){return I18N("j","VoIP VID is same with IPTV VID.")}}}}}return""},"");$("#internet_form").validate({submitHandler:function(d){CheckConnectionStatus()}});var c=$("#iPAddress_StaticIP, #subnetMask_StaticIP, #defaultGateway_StaticIP, #primaryDNSAddress_StaticIP, #secondaryDNSAddress_StaticIP, #hostName_DynamicIP, #primaryDNSAddress_DynamicIP, #secondaryDNSAddress_DynamicIP, #userName_PPPoE, #password_PPPoE, #ipAddress_PPPoE, #serviceName_PPPoE, #primaryDNSAddress_PPPoE, #secondaryDNSAddress_PPPoE, #serverIPAddress_PPTP, #userName_PPTP, #password_PPTP, #ipAddress_PPTP, #subnetMask_PPTP, #gatewayIP_PPTP, #primaryDNSAddress_PPTP, #secondaryDNSAddress_PPTP, #serverIPAddress_L2TP, #userName_L2TP, #password_L2TP, #ipAddress_L2TP, #subnetMask_L2TP, #gatewayIP_L2TP, #primaryDNSAddress_L2TP, #secondaryDNSAddress_L2TP, #afterIPv6Address_DSLite, #value_Session, #mtu_StaticIP_Input, #mtu_DynamicIP_Input, #mtu_PPPoE_Input, #mtu_PPTP_Input, #mtu_L2TP_Input, #b4IPv4Address_DSLite, #maximumIdleTime_PPPoE, #macAddress_PPPoE, #maximumIdleTime_PPTP, #maximumIdleTime_L2TP, #macAddress_DynamicIP, #macAddress_StaticIP, #ipAddress_Ru_PPPoE, #subnetMask_Ru_PPPoE, #gatewayIP_Ru_PPPoE, #primaryDNSAddress_Ru_PPPoE, #secondaryDNSAddress_Ru_PPPoE, #inter_vlanid, #voip_vlanid, #iptv_vlanid");$.each(c,function(e,d){$(this).rules("add",{checkSetValues:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Settings");InitMACList();InitWAN();</script> </html>