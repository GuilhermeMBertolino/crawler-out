!function(){var root=this,fuzzy={};"undefined"!=typeof exports?module.exports=fuzzy:root.fuzzy=fuzzy,fuzzy.simpleFilter=function(pattern,array){return array.filter(function(str){return fuzzy.test(pattern,str)})},fuzzy.test=function(pattern,str){return null!==fuzzy.match(pattern,str)},fuzzy.match=function(pattern,str,opts){opts=opts||{};var len,ch,patternIdx=0,result=[],totalScore=0,currScore=0,pre=opts.pre||"",post=opts.post||"",compareString=opts.caseSensitive&&str||String(str).toLowerCase();len=str?str.length:"",pattern=opts.caseSensitive&&pattern||String(pattern).toLowerCase();for(var idx=0;len>idx;idx++)ch=str[idx],compareString[idx]===pattern[patternIdx]?(ch=pre+ch+post,patternIdx+=1,currScore+=1+currScore):currScore=0,totalScore+=currScore,result[result.length]=ch;return patternIdx===pattern.length?(totalScore=compareString===pattern?1/0:totalScore,{rendered:result.join(""),score:totalScore}):null},fuzzy.filter=function(pattern,arr,opts){return arr&&0!==arr.length?"string"!=typeof pattern?arr:(opts=opts||{},arr.reduce(function(prev,element,idx,arr){var str=element;opts.extract&&(str=opts.extract(element));var rendered=fuzzy.match(pattern,str,opts);return null!=rendered&&(prev[prev.length]={string:rendered.rendered,score:rendered.score,index:idx,original:element}),prev},[]).sort(function(a,b){var compare=b.score-a.score;return compare?compare:a.index-b.index})):[]}}();