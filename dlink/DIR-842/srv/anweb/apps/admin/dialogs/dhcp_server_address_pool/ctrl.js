"use strict";function DHCPServerAddressPoolDialogCtrl($scope,funcs){function getLabel(start,end){return start+" - "+end}function getIPv4RangeList(fullRange,exclList){var address=funcs.ipv4.address;return getRangeList(fullRange,exclList,address.compare,address.inc,address.dec).map(function(e){return{label:getLabel(e.start,e.end),value:{start:e.start,end:e.end}}})}function getIPv6RangeList(fullRange,exclList,prefix){var address=funcs.ipv6.address;return getRangeList(fullRange,exclList,address.compare,address.inc,address.dec).map(function(e){var start=funcs.ipv6.subnet.splitToNetworkAndNode(e.start,prefix).node,end=funcs.ipv6.subnet.splitToNetworkAndNode(e.end,prefix).node;return{label:getLabel(start,end),value:{start:start,end:end}}})}function getRangeList(fullRange,exclList,compareFunc,incFunc,decFunc){if(!exclList.length)return[{start:fullRange.start,end:fullRange.end}];var sortedExclList=exclList.filter(function(e){return compareFunc(fullRange.start,e)<=0&&compareFunc(fullRange.end,e)>=0}).sort(function(a,b){return compareFunc(a,b)}),ranges=[],point=sortedExclList[0],start=fullRange.start,end=decFunc(point),res=compareFunc(start,end);0>=res&&ranges.push({start:start,end:end}),start=incFunc(point);for(var i=1;i<sortedExclList.length;)point=sortedExclList[i],end=decFunc(point),res=compareFunc(start,end),0>=res&&ranges.push({start:start,end:end}),start=incFunc(point),i++;return res=compareFunc(start,fullRange.end),0>=res&&ranges.push({start:start,end:fullRange.end}),ranges}var data=$scope.ngDialogData;$scope.range={},$scope.range.list=[];var fullRange,exclList;if(4==data.ipVersion)fullRange=funcs.ipv4.subnet.getNetworkRange(data.ip,data.mask),exclList=[data.ip],data.gateway&&exclList.push(data.gateway),$scope.range.list=getIPv4RangeList(fullRange,exclList),$scope.range.value=$scope.range.list[0].value;else if(6==data.ipVersion){var arr=data.ipPrefix.split("/"),ip=arr[0],prefix=arr[1];fullRange=funcs.ipv6.subnet.getNetworkRange(ip,prefix),exclList=[ip],data.gateway&&exclList.push(data.gateway),$scope.range.list=getIPv6RangeList(fullRange,exclList,prefix),$scope.range.value=$scope.range.list[0].value}$scope.dialog={apply:function(){$scope.closeThisDialog($scope.range.value)},cancel:function(){$scope.closeThisDialog(null)}}}