"use strict";function DHCPOptionsDialogCtrl($scope,funcs,dhcpOptions,translate,$timeout){$scope.knownOptionsArr=dhcpOptions.arr,$scope.knownOptionsInx=dhcpOptions.inx,$scope.getCaption=dhcpOptions.getCaption,$scope.usedOptionsInx={},$scope.ngDialogData.option||($scope.ngDialogData.option={Option:0});var option=$scope.ngDialogData.option;$scope.option={Option:option.Option.toString(),Value:option.Value,Force:option.Force},$timeout(function(){var selector='option[value="'+$scope.option.Option+'"]';document.querySelector(selector).setAttribute("selected","selected")},100);var usedOptions=$scope.ngDialogData.usedOptions;for(var i in usedOptions)$scope.usedOptionsInx[usedOptions[i].Option]=!0;$scope.submit=function(form){form.$valid&&($scope.option.Option=parseInt($scope.option.Option),$scope.closeThisDialog($scope.option))},$scope.changed=function(){var option=$scope.ngDialogData.option;return option.Option!=$scope.option.Option||option.Value!=$scope.option.Value||option.Force!=$scope.option.Force},$scope.validate=function(value,param){function isNumber(data){return/(^-?[0-9]+$)/.test(data)?!0:!1}function isAscii(str){return/^[\000-\177]*$/.test(str)}function isHex(data){return/(^(0x)?[0-9a-fA-F]+$)/.test(data)?!0:!1}value&&(value=value.replace(/(^\s+|\s+$)/g,""));var ipList,i,ipMask,tempArr,temp,elemCount,netPrefix,gw,net,prefix,mask,ipIp,domainList,hostList,hexArr,findElem,errors=[];switch(param||value&&errors.push("dhcp_options_not_selected"),value&&value.length>64&&errors.push(translate("msg_maxlength_symb")+" 64"),param){case"mask":value&&!funcs.is.mask(value)&&errors.push("msg_invalid_mask");break;case"ip":value&&!funcs.is.ipv4(value)&&errors.push("msg_invalid_ipv4");break;case"moreIP":if(value)for(ipList=value.split(","),ipList.length>_.uniq(ipList).length&&errors.push("dhcp_options_invalid_value"),i=0;i<ipList.length;i++)funcs.is.ipv4(ipList[i])||errors.push("dhcp_options_invalid_value");break;case"moreIPOr0":if(value&&"0"!=value){var ipList=value.split(",");ipList.length>_.uniq(ipList).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<ipList.length;i++)funcs.is.ipv4(ipList[i])||errors.push("dhcp_options_invalid_value")}break;case"ipMask":value&&(ipMask=value.split("/"),(!funcs.is.ipv4(ipMask[0])||!isNumber(ipMask[1])||ipMask[1]<1||ipMask[1]>32)&&errors.push("dhcp_options_invalid_value"));break;case"ipMaskIp":if(value){tempArr=value.split(","),tempArr.length&&tempArr.length%2!=0&&errors.push("dhcp_options_invalid_value"),temp=[],elemCount=0;for(var i=0;i<tempArr.length/2;i++)temp[i]=tempArr[elemCount]+","+tempArr[elemCount+1],elemCount+=2;temp.length>_.uniq(temp).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<temp.length;i++)netPrefix=temp[i].split(",")[0],gw=temp[i].split(",")[1],net=netPrefix.split("/")[0],prefix=netPrefix.split("/")[1],mask=funcs.ipv4.mask["long"](prefix),netPrefix&&gw||errors.push("dhcp_options_invalid_value"),net&&prefix&&(net!=funcs.ipv4.subnet.getNetworkAddress(net,mask)||!isNumber(prefix)||1>prefix||prefix>32||!funcs.is.ipv4(gw)||gw==funcs.ipv4.subnet.getNetworkAddress(net,mask))&&errors.push("dhcp_options_invalid_value")}break;case"ipIp":value&&(ipIp=value.split(","),funcs.is.ipv4(ipIp[0])&&funcs.is.ipv4(ipIp[1])&&ipIp[0]!=ipIp[1]||errors.push("dhcp_options_invalid_value"));break;case"domain":value&&!funcs.is.hostname(value)&&errors.push("msg_invalid_domain");break;case"hostname":value=value.replace(/(^\s+|\s+$)/g,""),value&&!/^([a-zA-Zа-яА-Я]([а-яА-Яa-zA-Z0-9\-]{0,62}[а-яА-Яa-zA-Z0-9]){0,1})$/.test(value)&&errors.push("msg_invalid_hostname");break;case"vendor":break;case"moreDomain":if(value){domainList=_.compact(value.split(",")),domainList.length>_.uniq(domainList).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<domainList.length;i++)funcs.is.domain(domainList[i])||errors.push("dhcp_options_invalid_value")}break;case"moreHost":if(value){hostList=_.compact(value.split(",")),hostList.length>_.uniq(hostList).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<hostList.length;i++)funcs.is.domain(hostList[i])||funcs.is.ipv4(hostList[i])||errors.push("dhcp_options_invalid_value")}break;case"host":!value||funcs.is.domain(value)||funcs.is.ipv4(value)||errors.push("msg_invalid_host");break;case"string":value&&!isAscii(value)&&errors.push("dhcp_options_invalid_value");break;case"hex":value&&(hexArr=value.split(":"),findElem=_.find(hexArr,function(elem){return 2!=elem.length||!isHex(elem)}),void 0!=findElem&&errors.push("dhcp_options_invalid_value"));break;case"bool":value&&"0"!=value&&"1"!=value&&errors.push("dhcp_options_invalid_value");break;case"8unsig":value&&(!isNumber(value)||0>value||value>255)&&errors.push("dhcp_options_invalid_value");break;case"16unsig":value&&(!isNumber(value)||0>value||value>65535)&&errors.push("dhcp_options_invalid_value");break;case"16unsigMin576":value&&(!isNumber(value)||576>value||value>65535)&&errors.push("dhcp_options_invalid_value");break;case"16unsigMin68":value&&(!isNumber(value)||68>value||value>65535)&&errors.push("dhcp_options_invalid_value");break;case"32unsig":value&&(!isNumber(value)||0>value||value>4294967295)&&errors.push("dhcp_options_invalid_value");break;case"32sig":value&&(!isNumber(value)||-2147483648>value||value>2147483647)&&errors.push("dhcp_options_invalid_value");break;case"32sigMin0":value&&(!isNumber(value)||0>value||value>2147483647)&&errors.push("dhcp_options_invalid_value")}return errors.length?errors[0]:null}}