"use strict";!function(){angular.module("app").controller("dynPortMappingInfoCtrl",["$scope","$state","funcs","translate","snackbars","dynPortMappingUtil",function($scope,$state,funcs,translate,snackbars,util){function activate(){function success(){var _util$getConfig$Rules;portMapping.rules=null!==(_util$getConfig$Rules=util.getConfig().Rules)&&void 0!==_util$getConfig$Rules?_util$getConfig$Rules:[],portMapping.attrs=util.getAttrs(),portMapping.isActivate=!0,$scope.$emit("pageload")}function error(response){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"})}util.pull().then(success,error)}function add(){$state.go(currentState+".upnpParam.add")}function edit(item,inx){$state.go(currentState+".upnpParam.edit",{inx:inx})}$scope.portMapping={isActivate:!1,rules:null,attrs:null,add:add,edit:edit,remove:function(items){function success(){snackbars.add("msg_rpc_remove_success"),activate()}function error(){snackbars.add("msg_rpc_remove_error")}if(confirm(translate("upnp_mapping_warn_remove_rules"))){var overlay=$scope.overlay.circular,overlayId=overlay.start(),indexes=_.pluck(items,"__index");util.removeRules(indexes).then(success)["catch"](error)["finally"](overlay.stop.bind(overlay,overlayId))}},getItemIface:function(item){if("iface"==item.IfaceType){var ifaces=portMapping.attrs.Ifaces,extIfaceName=_.findWhere(ifaces.ExternalInterface[item.InternalInterface],{value:item.ExternalInterface}).name,intIfaceName=_.findWhere(ifaces.InternalInterface,{value:item.InternalInterface}).name;return"st_not_selected"==extIfaceName&&(extIfaceName=translate(extIfaceName)),"st_not_selected"==intIfaceName&&(intIfaceName=translate(intIfaceName)),intIfaceName+" / "+extIfaceName}if("wan_group"==item.IfaceType){var wanGroups=portMapping.attrs.WANGroup,groupNum=_.findWhere(wanGroups,{value:item.WANGroup});return groupNum?groupNum.name:""}},getItemShort:function(item){return translate(item.DefaultPolicy)}};var portMapping=$scope.portMapping,currentState=$state.current.name.split(".");currentState.pop(),currentState=currentState.join("."),activate()}])}();