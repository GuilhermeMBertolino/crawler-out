"use strict";!function(){angular.module("app").service("wifiClientUtil",["devinfo","funcs",function(devinfo,funcs){var constants={CONFIG_WIFI_SITES:"Device.Statistics.WiFi.Radio.*.SiteSurvey.",CONFIG_WIFI_STATISTICS:"Device.Statistics.WiFi.Radio.",CONFIG_CONNECTIONS:"Device.Network.Connection."};return{pullScan:function(band,$scope){var inx,pathScan,constList=[];return $scope.isSeparateClient?(inx="2.4GHz"==band?$scope.radio.Inx:$scope.radio5G.Inx,pathScan=constants.CONFIG_WIFI_STATISTICS+inx+".SiteSurvey.",constList.push(pathScan)):constList.push(constants.CONFIG_WIFI_SITES),devinfo.once(constList.join("|"),{timeout:6e4}).then(function(data){var data=_.pick(data,_.values(constList));return data})},startUpdateClientStatus:function(cb,$scope,band){var paths={"2.4GHz":{EndPount:"".concat(constants.CONFIG_WIFI_STATISTICS).concat($scope.radio.Inx,".EndPoint"),Channel:"".concat(constants.CONFIG_WIFI_STATISTICS).concat($scope.radio.Inx,".Channel"),RadioEP:"Device.WiFi.Radio.".concat($scope.radio.Inx,".EndPoint")}};$scope.radio5G&&(paths["5GHz"]={EndPount:"".concat(constants.CONFIG_WIFI_STATISTICS).concat($scope.radio5G.Inx,".EndPoint"),Channel:"".concat(constants.CONFIG_WIFI_STATISTICS).concat($scope.radio5G.Inx,".Channel"),RadioEP:"Device.WiFi.Radio.".concat($scope.radio5G.Inx,".EndPoint")});var area=band&&paths[band]?Object.values(paths[band]):Object.values(paths["2.4GHz"]).concat(Object.values(paths["5GHz"]));devinfo.subscribe(area.join("|"),function(data){if(data){var result=!1,bands=band?[band]:["2.4GHz","5GHz"];bands.forEach(function(b){var path=paths[b].EndPount,channelPath=paths[b].Channel,epPatch=paths[b].RadioEP;if(data[path]){var info=Object.values(funcs.fetchBranch(data[path],path+".")),channel=funcs.fetchBranch(data[channelPath],channelPath),ep=Object.values(funcs.fetchBranch(data[epPatch],epPatch+".")),prefix=result?"".concat(b,"_"):"";ep[0]&&ep[0].Enable&&(result||(result={}),result["".concat(prefix,"Band")]=bands.length>1?b:void 0,result["".concat(prefix,"Connect")]=!!info[0].Info.BSSID,result["".concat(prefix,"SignalStrength")]=result["".concat(prefix,"Connect")]?info[0].Info.SignalStrength:void 0,result["".concat(prefix,"RSSI")]=result["".concat(prefix,"Connect")]?info[0].Info.RSSI:void 0,result["".concat(prefix,"Channel")]=channel)}}),cb&&cb(result)}},$scope)},checkEncryptionType:function(band,standart,encType){switch(encType){case"WEP":case"TKIP":return"2.4GHz"==band?-1==standart.indexOf("n"):"a"==standart;default:return!0}},checkConns:function(iface){if(!iface)return Promise.resolve([]);var result=[];return devinfo.once(constants.CONFIG_CONNECTIONS).then(function(data){var input;return data[constants.CONFIG_CONNECTIONS]?(input=funcs.fetchBranch(data[constants.CONFIG_CONNECTIONS],constants.CONFIG_CONNECTIONS),_.each(funcs.newConfig.normalize(input),function(elem){_.each(funcs.newConfig.normalize(elem),function(obj){(obj.BaseInterface==iface||obj.Interface==iface)&&result.push(obj.Name)})}),result):void 0})["catch"](function(){return Promise.reject()})}}}])}();