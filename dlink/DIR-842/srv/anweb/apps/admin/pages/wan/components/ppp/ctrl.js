"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){var i,arr2;for((null==len||len>arr.length)&&(len=arr.length),i=0,arr2=new Array(len);len>i;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i["return"]||_i["return"]()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){return Array.isArray(arr)?arr:void 0}angular.module("app").controller("WanPppCtrl",["$scope","wanPageCommon",function($scope,wanPageCommon){function setSelectAuthProtocols(){var authProt;conn.EncryptionProtocol&&"None"!=conn.EncryptionProtocol?($scope.selectAuthProtocols=collectAuthProtocols.filter(function(prot){return"MS-CHAP"==prot.value||"MS-CHAP-V2"==prot.value}),authProt=conn.AuthenticationProtocol,"MS-CHAP"!=authProt&&"MS-CHAP-V2"!=authProt&&(conn.AuthenticationProtocol=$scope.selectAuthProtocols[0].value)):$scope.selectAuthProtocols=collectAuthProtocols}var conn=$scope.conn;$scope.onDemand="OnDemand"==conn.ConnectionTrigger,$scope.usernameLabel=autoconf.BR2_PACKAGE_ANWEB_CUSTOM_AVANTA_50858?"username_from_agreement":"username",$scope.passwordLabel=autoconf.BR2_PACKAGE_ANWEB_CUSTOM_AVANTA_50858?"password_from_agreement":"password";var altConnectionTrigger=$scope.onDemand?"AlwaysOn":conn.ConnectionTrigger;$scope.onEncProtChange=setSelectAuthProtocols;var collectAuthProtocols=[{name:"AUTO",value:"AUTO"},{name:"PAP",value:"PAP"},{name:"CHAP",value:"CHAP"},{name:"MS-CHAP",value:"MS-CHAP"},{name:"MS-CHAPv2",value:"MS-CHAP-V2"}];"mobileinet"!=$scope.common.contype&&setSelectAuthProtocols(),$scope.onDemandChange=function(){conn.ConnectionTrigger=$scope.onDemand?"OnDemand":altConnectionTrigger},$scope.validationStaticIP=function(){var ip=conn.StaticIPAddress0;if(ip)if($scope.common.isIpv6){if(!funcs.is.ipv6(ip))return"msg_invalid_ipv6"}else if(!funcs.is.ipv4)return"msg_invalid_ipv4";return null},$scope.showOnDemand=function(){return!autoconf.BR2_PACKAGE_ANWEB_DSYSINIT||!/v6|dual/.test($scope.common.contype)},wanPageCommon.supportDualLAN&&($scope.disabledDuallan=function(){var duallan=$scope.common.duallan;return duallan&&duallan.__has?!1:!0}),$scope.validationUsername=function(){var _conn$Username$match,allowed,_ref,_ref2,postfix;return conn.Username&&$scope.customRules.AllowedWANPPPUsernames&&(allowed=$scope.customRules.AllowedWANPPPUsernames,_ref=null!==(_conn$Username$match=conn.Username.match(/@.+$/))&&void 0!==_conn$Username$match?_conn$Username$match:[null],_ref2=_slicedToArray(_ref,1),postfix=_ref2[0],!allowed.includes(postfix))?"msg_invalid_ppp_username":null}}]);