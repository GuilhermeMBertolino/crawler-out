<HTML><HEAD><TITLE>D-Link ADSL Router</TITLE>
<META http-equiv=Content-Type content="text/html">
<META http-equiv=Pragma content=no-cache><LINK 
href="stylemain.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript src="util.js"></SCRIPT>

<SCRIPT language=JavaScript src="menu.js"></SCRIPT>
<SCRIPT language=javascript>
<!-- hide
var wsc_proc_status = '<%ejGetWl(wsc_proc_status)%>';
var wsc_timeout = '<%ejGetWl(wsc_timeout)%>';
var wsc_process = '';
//wsc_proc_status = 3;
var proc_status
var stop = 0;
var request = false;
try {
  request = new XMLHttpRequest();
} 
catch (trymicrosoft) 
{
  try {
    request = new ActiveXObject("Msxml2.XMLHTTP");
  } catch (othermicrosoft) {
    try {
      request = new ActiveXObject("Microsoft.XMLHTTP");
    } catch (failed) {
      request = false;
    }  
  }
}

if (!request)
{
  alert("Error initializing XMLHttpRequest!");
}



function frmLoad() {
   writepage();
   writetime();
   setInterval("checkAutoScan()", 1000);

}

function FAIL() {
	var code = 'location = "wlbtnfail.html"';
	eval(code);
}

function SUCCEED() {
	var code = 'location = "wlbtnsucc.html"';
	eval(code);
}

function checkAutoScan() {
   var loc = 'wlbtntest.wl';
	getCustomerInfo();

}

function getCustomerInfo() 
{
  var url = "wlbtntest.wl";
  request.open("GET", url, true);
  request.onreadystatechange = updatePage;
  request.send(null);
}

function updatePage() 
{

  if (request.readyState == 4) {
    if (request.status == 200) {
	parserequest();  
	//writepage();  
	stop = writepage(); 
   if(stop == 1)
   {
       clearInterval(intervalProcess);
   }	
        writetime();
    }
  }
}


function parserequest(){

var reback = new Array();
var retext = request.responseText;
//alert(retext);
reback = retext.split(":");
wsc_proc_status = reback[0];
wsc_timeout = reback[1];
wsc_process = reback[2];

}


function openurl(url){
var retinfo;	
var objxml=new ActiveXObject("microsoft.xmlhttp"); 
	objxml.open("get",url,false); 
	objxml.send(); 
	retinfo=objxml.responsetext; 
	if (objxml.status=="200"){ 
		return retinfo; 
	} 
	else{ 
	return "-2"; 
	} 
}

/* 20100929, Linus Shi, begin mod to fix bug#9879, mark: 09291005 */
function writepage()
{
    if ( wsc_proc_status == '0') 
	{
        msg = 'AP button pushed or PIN entered';
    } 
	else if (wsc_proc_status == '1' && proc_status == '6')
	{
        msg = '<font color=red>Connetion Successfully</font>';
        SUCCEED();
    } 
	else if (wsc_proc_status== '2' && wsc_timeout != 120)
	{ 
        msg = '<font color=red>Connetion Successfully</font>';
		SUCCEED();//Yocheng try yo open it.
    } 
	else if (wsc_proc_status== '3')
	{ 
        msg = '<font color=red>Fail due to message error</font>';
		//FAIL();
    } 
    else if (wsc_proc_status=='4') 
	{
        msg = '<font color=red>Fail due to time out</font>';
        FAIL();   
    } 
	else if (wsc_proc_status=='6') 
    {
        msg = 'WPS protocol begun with station';	  
stop = 1 
SUCCEED(); 
    } 
    else 
    {
        msg = 'Please wait...';
    }
	
    msg += '<br><br><br>';
    document.getElementById("autoinfo").innerHTML = msg;
    proc_status	= wsc_proc_status;
return stop;//Yocheng try to addd.
}
/* 20100929, Linus Shi, end ---------------------- mark: 09291005 */

/*
function writepage(){

if (wsc_process != '4') {
 if ( wsc_proc_status == '1' || wsc_proc_status == '0') {

if (wsc_process == '0') {
       msg = 'Restarting Wireless process.';
} else {
       msg = 'Adding wireless device: Started.';
}

    } else if (wsc_proc_status== '2'){ 
       msg = 'Adding wireless device: <font color=red>Succeeded.</font>';
	SUCCEED();
    } else if (wsc_proc_status== '3'){ 
       msg = 'Adding wireless device: <font color=red>Session Time-Out.</font>';
       FAIL();
    } else if (wsc_proc_status=='4') {
       msg = 'Adding wireless device: <font color=red>Session Time-Out.</font>';
       FAIL();
    } else if (wsc_proc_status=='5') {
       msg = 'Adding wireless device: In progress.';
    } else if (wsc_proc_status=='6') {
       msg = 'Adding wireless device: In progress.';
    } else if (wsc_proc_status=='7') {
       msg = 'Station Message Done';
    } else {
       msg = 'Please wait...';
    }

} else {
       msg = 'Adding wireless device: <font color=red>Session Time-Out</font>';
       FAIL();
}
       msg += '<br><br><br>';
    document.getElementById("autoinfo").innerHTML = msg;
}
*/
function writetime(){
 time_msg = wsc_timeout;
 //document.getElementById("counttime").innerHTML = time_msg;
 lbwpamode.innerHTML=time_msg; 
}



// done hiding -->
</SCRIPT>
</HEAD>
<BODY onLoad="frmLoad()">
<BLOCKQUOTE>
  <SCRIPT language=JavaScript>
TabHeader="Setup";
SideItem="Wireless Settings";
HelpItem="diwireless";
</SCRIPT>

  <SCRIPT type=text/javascript>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</SCRIPT>

 <FORM>
  <TABLE id=box_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>ADD WIRELESS DEVICE WITH WPS(WI-FI PROTECTED SETUP) WIZARD </TD></TR>
    <TR>
      <TD class=content>
        <P>This wizard is designed to assist you in connecting your wireless device
		to your router.It will guide you through step-by-step instructions on how to 
		get your wireless device connected.Click the button below to begin.</P></TD></TR></TBODY></TABLE>
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>Virtual Push Button</TD></TR>
    <TR>
      <TD class=content>
        <P>Please press down the Push Button (Physicall or virtual) on the wireless
            device you are adding to your wireless network within <font color=red><LABEL id=lbwpamode name="lbwpamode"></LABEL></font> &nbsp;seconds ...</P><BR>
            <div id = autoinfo></div>
</TD></TR></TBODY></TABLE>
 </FORM>
  <SCRIPT type=text/javascript>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</SCRIPT>
</BLOCKQUOTE></BODY></HTML>
