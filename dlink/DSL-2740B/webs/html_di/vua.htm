<html>
<head>
<meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<link rel='STYLESHEET' type='text/css' href='stylemain.css'>
<script language='JavaScript' src='menu.js'></script> 
<script language='JavaScript' src='util.js'></script> 
<SCRIPT language="JavaScript">
<!--
   var ua1 = '<%ejGetvoipUA(line1)%>';//ua1 = '2001 0 2001 5060 2001 2001 1 1 1 2004 1 0 0';
   var ua2 = '<%ejGetvoipUA(line2)%>';//ua2 = ' 0     0 0 0    ';
   var which = '<%ejGetvoipUA(whichone)%>';//which = '0';
   
   var entry 
   if(which == '1')
      ua = ua2;
   else
      ua = ua1;
	entry = ua.split(' ');

   function ChLine(cb){
	  var value=getSelect(cb);
	  if(value == '0'){
		 ua = ua1;
	  }
	  else if(value == '1'){
		 ua = ua2;
	  }
	  var entry = ua.split(' ');

	  with ( document.forms[0] ) {
	     phonenumber.value = entry[0];
		 setSelect(enablephone,entry[1]);
         name.value = entry[2];
         uaport.value = entry[3];
			if( uaport.value == "")
				uaport.value = "5060";
         authname.value = entry[4];
         authpasswd.value = entry[5];
		 conpasswd.value = entry[5];
		 T1.value = entry[9];
		 setSelect(callTransfer, entry[6]);
		 setSelect(callConference, entry[7]);
		 setSelect(callWaiting, entry[8]);
		 
		 if(parseInt(entry[10]) != 1&& parseInt(entry[11]) != 1&& parseInt(entry[12]) != 1)
			callForward.selectedIndex = 1;
		 else
			callForward.selectedIndex = 0;
			hideforward();
			
		 setCheck(C1,entry[10]);
		 stAkt();
		 if(entry[10] == '0'){
			setCheck(C2,entry[11]);
			setCheck(C3,entry[12]);
		 }
		 
      }
   }

var recheck = false;
var check2;
var check3;
function stAkt(){

 if (document.forms[0].C1.checked){
    check2 = document.forms[0].C2.checked;
    check3 = document.forms[0].C3.checked;
    recheck = true;
    document.forms[0].C2.checked = false;
    document.forms[0].C3.checked = false;
    document.forms[0].C2.disabled = true;
    document.forms[0].C3.disabled = true;
 }
 else{
    if (recheck){
       document.forms[0].C2.checked = check2;
       document.forms[0].C3.checked = check3;
    }
    recheck = false;
    document.forms[0].C2.disabled = false;
    document.forms[0].C3.disabled = false;
 }
 //dnssrv();
 //usedomain();
}
/*
function dnssrv(){
 if (document.forms[0].C4.checked) {
    document.forms[0].C5.disabled = true;
    document.forms[0].C5.checked = true;
    document.getElementById('autoprefix').style.display="";
    document.getElementById('port').style.display="none";
 }
 else{
     document.getElementById('autoprefix').style.display="none";
     document.getElementById('port').style.display="";
  }
}
function usedomain(){
 if (document.forms[0].C6.checked) {
     document.getElementById('usedomain').style.display="";
 }
 else{
     document.getElementById('usedomain').style.display="none";
 }
}*/
   
   function frmLoad() {
      with ( document.forms[0] ) {
	     phonenumber.value = entry[0];
		 setSelect(enablephone,entry[1]);
		 setSelect(line,which);
         name.value = entry[2];
         uaport.value = entry[3];
			if( uaport.value == "")
				uaport.value = "5060";
         authname.value = entry[4];
         authpasswd.value = entry[5];
         conpasswd.value = entry[5];		 
		 T1.value = entry[9];
		 setSelect(callTransfer, entry[6]);
		 setSelect(callConference, entry[7]);
		 setSelect(callWaiting, entry[8]);
		 
		 setCheck(C1,entry[10]);
		 stAkt(); 
		 if(entry[10] == '0'){
			setCheck(C2,entry[11]);
			setCheck(C3,entry[12]);
		 }
		 
		 if(parseInt(entry[10]) != 1&& parseInt(entry[11]) != 1&& parseInt(entry[12]) != 1)			
			callForward.selectedIndex = 1;
		 else
			callForward.selectedIndex = 0;
			hideforward();
      }
   }
   function btnApply(){
      var loc = 'voipcfg.cmd?action=uacfg';
      with ( document.forms[0] ) {
	     loc += '&enablephone=' + getSelect(enablephone);
		 loc += '&line=' + getSelect(line);
		 if(phonenumber.value==""){
		 	alert("Phone number could not be empty.");
			return;
		 }
		 if(validNumber(phonenumber.value) == false){
		    alert("Invalid phone number!");
			return;
		  }
		 loc += '&sipnumber=' + phonenumber.value;
		 loc += '&displayname=' + name.value;
		  if(uaport.value==""){
		 	alert("User Agent Port could not be empty.");
			return;		  	
		  }
		 if(isValidPort(uaport.value) == false){
		    alert("Invalid port!");
			return;
		  }
		 loc += '&uaport=' + uaport.value;
		 if(conpasswd.value != authpasswd.value){
		    alert("The passwords do not match.");
			return;
		 }
		 loc += '&authname=' + authname.value;
		 loc += '&password=' + authpasswd.value;
		 
		 if(callForward.selectedIndex == 0){	
		 
		 if(validNumber(T1.value) == false){
		    alert("Invalid forward number!");
			return;
		  }
			
 		loc += '&sipcallnum=' + document.forms[0].T1.value;

		if(C1.checked == true) 
		   loc += '&sipaws1=1'  ;
		else
		   loc += '&sipaws1=0' ;
      		if(C2.checked == true) 
		   loc += '&sipaws2=1'  ;
		else
		   loc += '&sipaws2=0' ;
      		if(C3.checked == true) 
		   loc += '&sipaws3=1';
		else
		   loc += '&sipaws3=0';
		}else{
			loc += '&sipcallnum=0&sipaws1=0&sipaws2=0&sipaws3=0';
		}
		loc += '&callWaiting='+getSelect(callWaiting);
		loc += '&callTransfer='+getSelect(callTransfer);
		loc += '&callConference='+getSelect(callConference);
	  }
      var code = 'location="' + loc + '"';
      eval(code);
   }
function hideforward(){
if(document.forms[0].callForward.selectedIndex == 0)
	showhide("forward", 1);
else
	showhide("forward", 0);
}
//-->
</SCRIPT>


<body onLoad="frmLoad()">
<script language="JavaScript">
TabHeader="Voice";
SideItem="User Agent";
HelpItem="useragent";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
<form onload='frmLoad()'>
	<table id=box_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				VOIP Configuration
			</td>										
		</tr>
		<tr>
			<td class=content>				
				The Router can be configured to handle voice signals over the Internet Protocol (Voice Over IP - VOIP).<br><br>
			</td>
		</tr>
	</table>
	<table id=body_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				User Agent Configuration
			</td>										
		</tr>
		<tr>
			<td class=content>


<table class=formarea border="0" cellpadding="0" cellspacing="0">
        <tr>
            <td class=form_label>Same Phone Number:</td>
            <td><select  name="enablephone" size="1">
			<option value='1'>Enable</option>
			<option value='0'>Disable</option>
			</select>
            </td>
        </tr>
        <tr >
            <td class=form_label>Line:</td>
            <td><select name="line" size="1" onChange='ChLine(this)'>
            		<option value='0'>line 1</option>
            		<option value='1'>line 2</option>
            		</select>
            	</td>
        </tr>
        <tr >
            <td class=form_label>Phone Number:</td>
            <td><input type="text" name="phonenumber" size="24" maxlength="31"></td>
        </tr>
        <tr >
            <td class=form_label>Display Name:</td>
            <td><input type="text" name="name" size="24" maxlength="31"></td>
        </tr>
        <tr >
            <td class=form_label>User Agent Port:</td>
            <td><input type="text" name="uaport" size="8" maxlength="31"></td>
        </tr>
        <tr >
            <td class=form_label>Auth Usename:</td>
            <td><input type="text" name="authname" size="24" maxlength="31"></td>
        </tr>
        <tr >
            <td class=form_label>Auth Password:</td>
            <td><input type="password" name="authpasswd" size="24" maxlength="31"></td>
        </tr>
        <tr >
            <td class=form_label>Confirm Password:</td>
            <td><input type="password" name="conpasswd" size="24" maxlength="31"></td>
        </tr>
        <tr >
            <td class=form_label>Call Waiting:</td>
            <td><select  name="callWaiting" size="1">
		     <option value='1'>Enable</option>
		     <option value='0'>Disable</option>
	          </select>
	   </td>
        </tr>
        <tr >
            <td class=form_label>Call Transfer:</td>
            <td><select  name="callTransfer" size="1">
		     <option value='1'>Enable</option>
		     <option value='0'>Disable</option>
	          </select>
	   </td>
        </tr>
        <tr >
            <td class=form_label>Conference Call:</td>
            <td><select  name="callConference" size="1">
		     <option value='1'>Enable</option>
		     <option value='0'>Disable</option>
	          </select>
	   </td>
        </tr>

        <tr >
            <td class=form_label>Call Forward:</td>
            <td><select name="callForward" size="1" onchange='hideforward()'>
		     <option value='1'>Enable</option>
		     <option value='0'>Disable</option>
	          </select>
	   </td>
        </tr>
    </table>	  
	
      </td>										
		</tr>
	</table>
	<div class="box" id='forward'> 
	<table id=body_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Forward setting
			</td>										
		</tr>
		<tr>
			<td class=content>

<table class=formarea border="0" cellpadding="0" cellspacing="0">
    <tr >
       <td class=form_label>Forward number:</td>
      <td><input type="text" name="T1" size="24" maxlength='31' value=''></td>
    </tr>
   <tr>
       <td class=form_label0>Forward immediately:</td>
       <td><input type=checkbox name="C1" onclick=stAkt()></td>
    </tr>
  <tr>
       <td class=form_label0>Forward no answer:</td>
       <td><input type=checkbox name="C2" onclick=stAkt()></td>
    </tr>
 <tr>
       <td class=form_label0>Forward  occupied:</td>
       <td><input type=checkbox name="C3" onclick=stAkt()></td>
    </tr>
 </table>	
      </td>										
		</tr>
	</table></div>
<br>
<center><input name='button1' class=button_submit type=button value='Apply' onClick='btnApply()'>&nbsp;&nbsp;&nbsp;&nbsp;
				    <input name='button2' class=button_submit type=button value="Cancel" onClick="window.location.href='vua.htm'"></center>	
	
</form>	
	
<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>	
</body>
</html>

