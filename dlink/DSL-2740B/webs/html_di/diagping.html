<html > 
<head>
<meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<link rel="stylesheet" href='stylemain.css' type='text/css'>
<script language="javascript" src="portName.js"></script>
<script language="JavaScript" src="menu.js"></script>
<script language="javascript">  

var xmlRequest ;

if (window.XMLHttpRequest)
{ //code for IE7+, Firefox, Chrome, Opera, Safari
	xmlRequest = new XMLHttpRequest();
} else { //code for IE6, IE5
	xmlRequest = new ActiveXObject("Microsoft.XMLHTTP");
}

function updatePingResult()
{
	if ((xmlRequest.readyState == 4) && (xmlRequest.status == 200)) {
		document.getElementById("pingResult").innerHTML = xmlRequest.responseText;
	}
}
	
function frmLoad()
{
	with (document.forms[0]) {
		ping4.disabled = 0;
		stop4.disabled = 1;
		ping6.disabled = 0;
		stop6.disabled = 1;
	}
}

function btnPing4()
{
	var url = 'diagping.cmd?action=ping4';
	with (document.forms[0]) {
		if (ipv4ping.value == '') {
			alert("Please Enter a IPV4 Host Name or IP Address!");
			return;
		}
		ping4.disabled = 1;
		stop4.disabled = 0;
		ping6.disabled = 1;
		stop6.disabled = 1;
		url += '&target=' + ipv4ping.value;
	}
	xmlRequest.open("GET", url, true);
	//xmlRequest.onreadystatechange = updatePingResult;
	xmlRequest.send(null);
}

function btnPing4Stop()
{
	var url = 'diagping.cmd?action=ping4Stop';
	with (document.forms[0]) {
		ping4.disabled = 0;
		stop4.disabled = 1;
		ping6.disabled = 0;
		stop6.disabled = 1;
	}
	xmlRequest.open("GET", url, true);
	xmlRequest.onreadystatechange = updatePingResult;
	xmlRequest.send(null);
}

function btnPing6()
{
	var url = 'diagping.cmd?action=ping6';
	with (document.forms[0]) {
		if (ipv6ping.value == '') {
			alert("Please Enter a IPV6 Host Name or IP Address!");
			return;
		}
		ping4.disabled = 1;
		stop4.disabled = 1;
		ping6.disabled = 1;
		stop6.disabled = 0;
		url += '&target=' + ipv6ping.value;
	}
	xmlRequest.open("GET", url, true);
	//xmlRequest.onreadystatechange = updatePingResult;
	xmlRequest.send(null);
}

function btnPing6Stop()
{
	var url = 'diagping.cmd?action=ping6Stop';
	with (document.forms[0]) {
		ping4.disabled = 0;
		stop4.disabled = 1;
		ping6.disabled = 0;
		stop6.disabled = 1;
	}
	xmlRequest.open("GET", url, true);
	xmlRequest.onreadystatechange = updatePingResult;
	xmlRequest.send(null);
}

</script>
</head>
<body onload='frmLoad()'>
<blockquote>

<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Ping Test";
HelpItem="diag";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
<form>
	<table id=box_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>ping test</td>
		</tr>
		<tr>
			<td class=content>
				<p>Ping Test sends "ping" packets to test a computer on the Internet.</p>
			</td>
		</tr>
	</table>

	<table id=body_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>ping test</td>
		</tr>
		<tr>
			<td class=content>
	  	                <TABLE class=formarea>
		                <tr>
					<td class=form_label>Host Name or IP Address&nbsp;:</td>
					<td><input type='text' name='ipv4ping' id='ipv4pingTag' size='24' maxlength='64'></TD>
					<td><input type='button' value='Ping' id='ping4' onClick='btnPing4()'></td>
					<td><input type='button' value='Stop' id='stop4' onClick='btnPing4Stop()'></td>
				</tr>
				</TABLE>
			</td>
		</tr>
	</table>

	<table id=body_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>IPv6 PING TEST</td>
		</tr>
		<tr>
			<td class=content>
	  	                <TABLE class=formarea>
		                <tr>
					<td class=form_label>Host Name or IPV6 Address&nbsp;:</td>
					<td><input type='text' name='ipv6ping' id='ipv6pingTag' size='24' maxlength='64'></TD>
					<td><input type='button' value='Ping' id='ping6' onClick='btnPing6()'></td>
					<td><input type='button' value='Stop' id='stop6' onClick='btnPing6Stop()'></td>
				</tr>
				</TABLE>
			</td>
		</tr>
	</table>
<BR>

	<table id=body_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>ping result</td>
		</tr>
		<tr>
			<td class=content>
				<p>Enter a host name or IP address above and click Ping.</p>
			</td>
		</tr>
		<tr>
			<td class=content>
               		<div id=pingResult>
               			<TABLE class=formlisting>
	                  		<TBODY>
	                  		</TBODY>
				</TABLE>
			</div>
      			</td>
	      	</tr>
	</table>

</form>
<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
</blockquote>
   </body>
</html>
