<html>
  <head>
    <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
    <link rel="stylesheet" href='stylemain.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide
var dateTime = '<%ejGet(manualDateTimeStr)%>';
var startYear=2005;
var manualConfigTime = '<%ejGet(isManual)%>';
var quicksetup = '0'; //this value is obsolete
var buildDaylight='1';
var dstenable = '<%ejGet(use_dst)%>';

var mandatetime = dateTime.split(":");
var mandatetime_year = mandatetime[0];
var mandatetime_month = mandatetime[1];
var mandatetime_day = mandatetime[2];
var mandatetime_hour = mandatetime[3];
var mandatetime_min = mandatetime[4];
var mandatetime_sec = mandatetime[5];


var ntp1 = '<%ejGetTime(ntpServer1)%>';
var ntp2 = '<%ejGetTime(ntpServer2)%>';
var ntp_enabled = "<%ejGetTime(ntp_enabled)%>";
var tz_name = '<%ejGetTime(timezone)%>';
var tz_offset = '<%ejGetTime(dst_offset)%>';
var dst_start = '<%ejGetTime(dst_start)%>';
var dst_end = '<%ejGetTime(dst_end)%>';

var from_day = 0;
var to_day = 0;
var manu_fromday = '<%ejGetTime(from_day)%>';
var manu_today = '<%ejGetTime(to_day)%>';
var manu_offset = '<%ejGetTime(dst_offset)%>';


var dststart  = dst_start.split(":");
var dst_start_month =dststart[0];
var dst_start_days =dststart[1];  
var dst_start_daytype = dststart[2]; 
var dst_start_time = dststart[3]; 

var dstend = dst_end.split(":");
var dst_end_month =  dstend[0];
var dst_end_days = dstend[1]; 
var dst_end_daytype = dstend[2]; 
var dst_end_time = dstend[3];

var ntpServers = new Array();

ntpServers[0] = 'ntp1.dlink.com';
ntpServers[1] = 'ntp.dlink.com.tw';
//ntpServers[2] = 'clock.fmt.he.net';
//ntpServers[3] = 'clock.nyc.he.net';
//ntpServers[4] = 'clock.sjc.he.net';
//ntpServers[5] = 'clock.via.net';
//ntpServers[6] = 'ntp1.tummy.com';
//ntpServers[7] = 'time.cachenetworks.com';
//ntpServers[8] = 'time.nist.gov';

/* 20111122, Zaki,Add Southern Northern Hemisphere,it is refer to google earth, mark: 11221853*/
var timeZones = new Array();

timeZones[0] =[ '(GMT-12:00) International Date Line West' ,''];
timeZones[1] = ['(GMT-11:00) Midway Island, Samoa' ,'Northern'];
timeZones[2] = ['(GMT-10:00) Hawaii' ,'Northern'];
timeZones[3] =[ '(GMT-09:00) Alaska' ,'Northern'];
timeZones[4] = ['(GMT-08:00) Pacific Time, Tijuana' ,'Northern'];
timeZones[5] = ['(GMT-07:00) Arizona, Mazatlan' ,'Northern'];
timeZones[6] = ['(GMT-07:00) Chihuahua, La Paz' ,'Northern'];
timeZones[7] =[ '(GMT-07:00) Mountain Time' ,'Northern'];
timeZones[8] =[ '(GMT-06:00) Central America' ,'Northern'];
timeZones[9] = ['(GMT-06:00) Central Time' ,'Northern'];
timeZones[10] = ['(GMT-06:00) Guadalajara, Mexico City, Monterrey' ,'Northern'];
timeZones[11] = ['(GMT-06:00) Saskatchewan' ,'Northern'];
timeZones[12] = ['(GMT-05:00) Bogota, Lima, Quito' ,'Northern'];
timeZones[13] =[ '(GMT-05:00) Eastern Time' ,'Northern'];
timeZones[14] = ['(GMT-05:00) Indiana' ,'Northern'];
timeZones[15] = ['(GMT-04:00) Atlantic Time' ,'Northern'];
timeZones[16] = ['(GMT-04:00) Caracas, La Paz' ,'Northern'];
timeZones[17] = ['(GMT-04:00) Santiago' ,'Northern'];
timeZones[18] = ['(GMT-03:30) Newfoundland' ,'Northern'];
timeZones[19] = ['(GMT-03:00) Brasilia' ,'Northern'];
timeZones[20] = ['(GMT-03:00) Buenos Aires, Georgetown' ,'Northern'];
timeZones[21] = ['(GMT-03:00) Greenland' ,'Northern'];
timeZones[22] = ['(GMT-02:00) Mid-Atlantic' ,'Northern'];
timeZones[23] = ['(GMT-01:00) Azores' ,'Northern'];
timeZones[24] = ['(GMT-01:00) Cape Verde Is.' ,'Northern'];
timeZones[25] = ['(GMT-00:00) Casablanca, Monrovia' ,'Northern'];
timeZones[26] = ['(GMT-00:00) Greenwich Mean Time: Dublin, Edinburgh, Lisbon, London' ,'Northern'];
timeZones[27] = ['(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna' ,'Northern'];
timeZones[28] = ['(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague' ,'Northern'];
timeZones[29] = ['(GMT+01:00) Brussels, Copenhagen, Madrid, Paris' ,'Northern'];
timeZones[30] = ['(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb' ,'Northern'];
timeZones[31] = ['(GMT+01:00) West Central Africa' ,'Northern'];
timeZones[32] = ['(GMT+02:00) Athens, Istanbul, Minsk' ,'Northern'];
timeZones[33] = ['(GMT+02:00) Bucharest' ,'Northern'];
timeZones[34] = ['(GMT+02:00) Cairo' ,'Northern'];
timeZones[35] = ['(GMT+02:00) Harare, Pretoria' ,'Southern'];
timeZones[36] = ['(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius' ,'Northern'];
timeZones[37] = ['(GMT+02:00) Jerusalem' ,'Northern'];
timeZones[38] = ['(GMT+03:00) Baghdad' ,'Northern'];
timeZones[39] = ['(GMT+03:00) Kuwait, Riyadh' ,'Northern'];
timeZones[40] = ['(GMT+03:00) Moscow, St. Petersburg, Volgograd' ,'Northern'];
timeZones[41] = ['(GMT+03:00) Nairobi' ,'Southern'];
timeZones[42] = ['(GMT+03:30) Tehran' ,'Northern'];
timeZones[43] = ['(GMT+04:00) Abu Dhabi, Muscat' ,'Northern'];
timeZones[44] = ['(GMT+04:00) Baku, Tbilisi, Yerevan' ,'Northern'];
timeZones[45] = ['(GMT+04:30) Kabul' ,'Northern'];
timeZones[46] = ['(GMT+05:00) Ekaterinburg' ,'Northern'];
timeZones[47] = ['(GMT+05:00) Islamabad, Karachi, Tashkent' ,'Northern'];
timeZones[48] = ['(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi' ,'Northern'];
timeZones[49] = ['(GMT+05:45) Kathmandu' ,'Northern'];
timeZones[50] = ['(GMT+06:00) Almaty, Novosibirsk' ,'Northern'];
timeZones[51] = ['(GMT+06:00) Astana, Dhaka' ,'Northern'];
timeZones[52] = ['(GMT+06:00) Sri Jayawardenepura' ,'Northern'];
timeZones[53] = ['(GMT+06:30) Rangoon' ,'Northern'];
timeZones[54] = ['(GMT+07:00) Bangkok, Hanoi, Jakarta' ,'Northern'];
timeZones[55] = ['(GMT+07:00) Krasnoyarsk' ,'Northern'];
timeZones[56] = ['(GMT+08:00) Beijing, Chongquing, Hong Kong, Urumqi' ,'Northern'];
timeZones[57] = ['(GMT+08:00) Irkutsk, Ulaan Bataar' ,'Northern'];
timeZones[58] = ['(GMT+08:00) Kuala Lumpur, Singapore' ,'Northern'];
timeZones[59] = ['(GMT+08:00) Perth' ,'Southern'];
timeZones[60] = ['(GMT+08:00) Taipei' ,'Northern'];
timeZones[61] = ['(GMT+09:00) Osaka, Sapporo, Tokyo' ,'Northern'];
timeZones[62] = ['(GMT+09:00) Seoul' ,'Northern'];
timeZones[63] = ['(GMT+09:00) Yakutsk' ,'Northern'];
timeZones[64] = ['(GMT+09:30) Adelaide' ,'Southern'];
timeZones[65] = ['(GMT+09:30) Darwin' ,'Southern'];
timeZones[66] = ['(GMT+10:00) Brisbane' ,'Southern'];
timeZones[67] = ['(GMT+10:00) Canberra, Melbourne, Sydney' ,'Southern'];
timeZones[68] = ['(GMT+10:00) Guam, Port Moresby' ,'Southern'];
timeZones[69] = ['(GMT+10:00) Hobart' ,'Southern'];
timeZones[70] = ['(GMT+10:00) Vladivostok' ,'Southern'];
timeZones[71] = ['(GMT+11:00) Magadan' ,'Southern'];
timeZones[72] = ['(GMT+11:00) Solomon Is., New Caledonia' ,'Southern'];
timeZones[73] = ['(GMT+12:00) Auckland, Wellington' ,'Southern'];
timeZones[74] = ['(GMT+12:00) Fiji, Kamchatka, Marshall Is.' ,'Southern'];
  /* 20111122, Zaki, end --------------------- mark: 11221853*/

var ret_hour;
var ret_min;
var ret_day;

function parseDate()
{
	var d = new Date(dateTime);

	if (isNaN(d.getDate()))
	{
		return;
	}

	with (document.forms[0]) {
	    mnualMonth.selectedIndex = d.getMonth();		
    	mnualDay.selectedIndex = d.getDate() - 1;
	    mnualHour.selectedIndex = d.getHours();
    	mnualMin.selectedIndex = d.getMinutes();
	    mnualSec.selectedIndex = d.getSeconds();
		if ((d.getFullYear() - startYear) >= 0)
			mnualYear.selectedIndex = d.getFullYear() - startYear;
	}
}

function btnGetSysDate()
{
	var d = new Date();

	with (document.forms[0]) {
    	mnualYear.selectedIndex = d.getFullYear() - startYear;
	    mnualMonth.selectedIndex = d.getMonth();
    	mnualDay.selectedIndex = d.getDate() - 1;
	    mnualHour.selectedIndex = d.getHours();
    	mnualMin.selectedIndex = d.getMinutes();
	    mnualSec.selectedIndex = d.getSeconds();
	}

}

function getTimeZoneIndex(timeZoneName) {
  var i = 0, ret = 4;  // default to Pacific time

  for ( var i = 0; i < timeZones.length; i++ ) {
    if ( timeZones[i][0].search(timeZoneName) != -1 )
      break;
  }

  if ( i < timeZones.length )
    ret = i;

  return ret;
}

function getTimeZoneOffsetIndex(seconds_offset){
	var i = 0 , ret = 0;
	with(document.forms[0]){

	for(var i=0; i<8; i++){
		if(dstOffset[i].value == seconds_offset) 
		break;

	}
	if(i<8)
		ret = i;
		
	return ret;

	}

}

function getTimeZoneName(idx) {
  var str = timeZones[idx][0];
  var ret = '';

  ret = str.substr(12);

  return ret;
}

function getTimeZoneOffset(idx) 
{
    var str = timeZones[idx][0];
    var ret = '';

    //if ( idx != 25 && idx != 26 )
    ret = str.substr(4, 6); /* 20101214, Linus Shi, mod to fix bug#10575, mark: 12141052 */

    return ret;
}

function writeTimeZoneList() {
	for( var i = 0; i < timeZones.length; i++ )
		document.writeln("<option value=" + getTimeZoneOffset(i) + ">" + timeZones[i][0] + "</option>");
}

function ntpChange(optionlist,textbox) {
  if( optionlist[optionlist.selectedIndex].value == "Other" )
  {
    textbox.disabled = false;
  }
  else {
  	textbox.value = "";
    textbox.disabled = true;
  }
}

/* Ali-20101220, begin,
 * Get the start and end DST day
 */
function isLeapyear(year) {
	if ((year % 400) == 0 || ((year % 4) == 0 && (year % 100) != 0))
		return 1 ;
	else
		return 0 ;
}

var yearDay = new Array();
yearDay[0] = 365 ;
yearDay[1] = 366 ;

var monthDay1 = new Array() ;
monthDay1[0] = 31 ;
monthDay1[1] = 28 ;
monthDay1[2] = 31 ;
monthDay1[3] = 30 ;
monthDay1[4] = 31 ;
monthDay1[5] = 30 ;
monthDay1[6] = 31 ;
monthDay1[7] = 31 ;
monthDay1[8] = 30 ;
monthDay1[9] = 31 ;
monthDay1[10] = 30 ;
monthDay1[11] = 31 ;

var monthDay2 = new Array() ;
monthDay2[0] = 31 ;
monthDay2[1] = 29 ;
monthDay2[2] = 31 ;
monthDay2[3] = 30 ;
monthDay2[4] = 31 ;
monthDay2[5] = 30 ;
monthDay2[6] = 31 ;
monthDay2[7] = 31 ;
monthDay2[8] = 30 ;
monthDay2[9] = 31 ;
monthDay2[10] = 30 ;
monthDay2[11] = 31 ;

function convertDate() {
	var yearClass = new Date() ;
	var year = yearClass.getFullYear() ;
	var month ;
	var nWeek ;
	var day ;
	var totalDay = 0 ;
	var i = 2000 ; //Initial to year 2000
	var wDay = 0;
	var lastDay = 0 ;
	var retDay = 0 ;
	var j ;

	if (year < 2000) return ;
	with(document.forms[0]) {
		month = dstStartMonth.selectedIndex + 1;
		nWeek = dstStartWeek.selectedIndex + 1 ;
		day = dstStartDW.selectedIndex ;
		for (i=2000; i < year; ++i)
			totalDay += yearDay[isLeapyear(i)] ;
	
		for (i=0; i<month-1; ++i) {
			if (isLeapyear(year))
				totalDay += monthDay2[i] ;
			else
				totalDay += monthDay1[i] ;
		}

		wDay = (totalDay + 6)%7 ;
		if (nWeek == 1) {
			if (day < wDay)
				return -1 ;
			else
				retDay += (day - wDay + 1) ;
		} else {
			retDay += (6 - wDay + 1) ;
			for (i=1; i < nWeek-1; ++i)
				retDay += 7 ;
	
			if (isLeapyear(year)) {
				if ((retDay + 7) > monthDay2[month-1]) {
					lastDay = monthDay2[month-1] - retDay - 1 ;
					if (day > lastDay)
						return -1 ;
				}
			} else {
				if ((retDay + 7) > monthDay1[month-1]) {
					lastDay = monthDay1[month-1] - retDay - 1 ;
					if (day > lastDay)
						return -1 ;
				}
			}
	
			retDay += (day + 1) ;
		}
	
		from_day = retDay ;
	
		// to_day
		totalDay = 0 ;
		month = dstEndMonth.selectedIndex + 1;
		nWeek = dstEndWeek.selectedIndex + 1 ;
		day = dstEndDW.selectedIndex ;
		retDay = 0 ;
		wDay = 0 ;
		lastDay = 0 ;

		/* 20111124, Zaki,go beyond the year,  mark: 11241453*/
		if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
			(dstStartMonth.selectedIndex > dstEndMonth.selectedIndex)) {
			year++;
		} else if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
				(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
			   (dstStartWeek.selectedIndex > dstEndWeek.selectedIndex)) {
			year++; 
		} else if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
				(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
                               (dstStartWeek.selectedIndex == dstEndWeek.selectedIndex) &&
			   (dstStartDW.selectedIndex > dstEndDW.selectedIndex)) {
			year++;
		} else if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
				(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
                               (dstStartWeek.selectedIndex == dstEndWeek.selectedIndex) &&
                               (dstStartDW.selectedIndex == dstEndDW.selectedIndex) &&
			   (dstStartTime.selectedIndex >= dstEndTime.selectedIndex)) {
			year++; 
		} 
	 	 /* 20111124, Zaki, end --------------------- mark: 11241453*/
			
		for (i=2000; i < year; ++i)
			totalDay += yearDay[isLeapyear(i)] ;
	
		for (i=0; i<month-1; ++i) {
			if (isLeapyear(year))
				totalDay += monthDay2[i] ;
			else
				totalDay += monthDay1[i] ;
		}
			
		wDay = (totalDay + 6)%7 ;
		if (nWeek == 1) {
			if (day < wDay)
				return 0 ;
			else
				retDay += (day - wDay + 1) ;
		} else {
			retDay += (6 - wDay + 1) ;
			for (i=1; i < nWeek-1; ++i)
				retDay += 7 ;
	
			if (isLeapyear(year)) {
				if ((retDay + 7) > monthDay2[month-1]) {
					lastDay = monthDay2[month-1] - retDay - 1 ;
					if (day > lastDay)
						return 0 ;
				}
			} else {
				if ((retDay + 7) > monthDay1[month-1]) {
					lastDay = monthDay1[month-1] - retDay - 1 ;
					if (day > lastDay)
						return 0 ;
				}
			}
	
			retDay += (day + 1) ;
		}

		to_day = retDay ;
	}

	return 1 ;
}

/* Ali-20101220, end,
 * Get the start and end DST day
 */



/*
function convertDate(){
	
	var w1,w2,c,y,m1,m2,d; 
	var D1,N1,M1,D2,N2,M2;
	var qz,wz;
	c = 20;
	var year = new Date();	
	y =  year.getFullYear() - 2000;
	d = 1;
with(document.forms[0]){	
	m1 = dstStartMonth.selectedIndex + 1;
	if(m1==1)
		m1 =  13;
	else if(m1==2)
		m1 = 14;
	qz = Math.floor(26*(m1+1)/10);
	w1 = c/4 - 2*c + y + Math.floor(y/4) + qz + d -1;
	if(w1>=7)
		w1 = w1%7;
	while(w1<0)
		w1 = w1 + 7;
	D1 = w1;
	N1 = dstStartWeek.selectedIndex + 1;
	M1 = dstStartDW.selectedIndex;
	from_day = (7-D1) + (N1-1)*7 - (7-M1) + 1;
	
	m2 = dstEndMonth.selectedIndex + 1;
	if(m2==1)
		m2 =  13;
	else if(m2==2)
		m2 = 14;
	wz = Math.floor(26*(m2+1)/10);
	w2 = c/4 - 2*c + y + Math.floor(y/4) + wz + d -1;
	while(w2<0)
		w2 = w2+7;
	if(w2>=7)
		w2 = w2%7;
	D2 =  w2;
	N2 = dstEndWeek.selectedIndex + 1;
	M2 = dstEndDW.selectedIndex;	
      to_day = (7-D2) + (N2-1)*7 - (7-M2) + 1;	
}
}
*/

function convertWeekday(){

	var w1,w2,c,y,m1,m2,d; 
	var D1,N1,M1,D2,N2,M2;
	var qz,wz;
	c = 20;
	var year = new Date();	
	y =  year.getFullYear() - 2000;
	d = 1;
with(document.forms[0]){	
	m1 = '<%ejGetTime(from_month)%>';
	if(m1==1)
		m1 =  13;
	else if(m1==2)
		m1 = 14;
        //change m1 from string to int
        m1 = eval(m1);
	qz = Math.floor(26*(m1+1)/10);
	w1 = c/4 - 2*c + y + Math.floor(y/4) + qz + d -1;
	if(w1>=7)
		w1 = w1%7;
	while(w1<0)
		w1 = w1 + 7;
	D1 = w1;
	M1 =  '<%ejGetTime(from_weekday)%>';
	from_day = manu_fromday;
	
	N1 = ((from_day-1) - (M1-D1))/7 + 1;
	dstStartWeek.selectedIndex = N1 -1;
	
	m2 = '<%ejGetTime(to_month)%>';
	if(m2==1)
		m2 =  13;
	else if(m2==2)
		m2 = 14;
        //change m2 from string to int
        m2 = eval(m2);
	wz = Math.floor(26*(m2+1)/10);
	w2 = c/4 - 2*c + y + Math.floor(y/4) + wz + d -1;
	while(w2<0)
		w2 = w2+7;
	if(w2>=7)
		w2 = w2%7;
	D2 =  w2;
	M2 = '<%ejGetTime(to_weekday)%>';	
      	to_day = manu_today;
		
	N2 = ((to_day-1) - (M2-D2))/7 + 1; 
	dstEndWeek.selectedIndex = N2 -1;

}


}


function btnApply() {
	var ret ;
	
  with( document.forms[0] ) {
  	
    	if( ntpEnabled.checked == true){
			//
			var loc = 'sntpservercfg.cgi?ntp_enabled=1&isManual=0&quickSetup=0'
			// if it is from quick setup
			if (quicksetup == '1'){
	    	 	loc = 'wizsntpservercfg.cgi?ntp_enabled=1&isManual=0&quickSetup=1';
	  		}

			//ntp server 1
      		loc += '&ntpServer1=';
      		if( ntpServer1.selectedIndex == ntpServers.length ) {
        		if( ntpServerOther1.value.length == 0 ) { // == Other
          			alert('First time server is other, but Other field is blank');
          			return;
		 		} else if(!isValidName(ntpServerOther1.value, "First time server")){        
			  		return;
				} else if (isSrv(ntpServerOther1.value)== true){  // add by jack,2008.7.16
					alert ("Not an legal ntp server!");
					return;
				}
				else {
          			loc += ntpServerOther1.value;
        		}
      		} else {
        		loc += ntpServer1[ntpServer1.selectedIndex].value;
      		}
			//ntp server 2
      		loc += '&ntpServer2=';
      		if( ntpServer2.selectedIndex == ntpServers.length + 1 ) {
        		if( ntpServerOther2.value.length == 0 ) { // == Other
          			alert('Second time server is other, but Other field is blank');
          			return;
        		} else if(!isValidName(ntpServerOther2.value, "Second tome server")){        
			  		return;
        		} else if (isSrv(ntpServerOther2.value)== true){  // add by jack,2008.7.16
					alert ("Not an legal ntp server!");
					return;
				}else {
	          		loc += ntpServerOther2.value;
        		}
      		} else {
        		if( ntpServer2.selectedIndex > 0 )
          			loc += ntpServer2[ntpServer2.selectedIndex].value;
      		}

			/* 20101214, Linus Shi, mod to fix bug#10575, mark: 12141052 */
			loc += '&timezone_offset=' + cboTimeZone[cboTimeZone.selectedIndex].value;
      		loc += '&timezone=' + getTimeZoneName(cboTimeZone.selectedIndex);
			/* 20101214, Linus Shi, end ----------------- mark: 12141052 */

		if(tz_daylight.checked == true){
			ret = convertDate();
			if (ret < 0) {
				alert("The dstStart time does not have the day in that week.") ;
				return;
			} else if (ret == 0) {
				alert("The dstEnd time does not have the day in that week.") ;
				return;
			} else ;

/* 20120410, Tick,Add Southern Northern Hemisphere,it is refer to google earth,  mark: 543543543*/
			if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
				(dstStartMonth.selectedIndex > dstEndMonth.selectedIndex)) {
				; //Correct
			} else if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
					(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
				      (dstStartWeek.selectedIndex > dstEndWeek.selectedIndex)) {
				; //Correct
			} else if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
					(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
                                   (dstStartWeek.selectedIndex == dstEndWeek.selectedIndex) &&
				   (dstStartDW.selectedIndex > dstEndDW.selectedIndex)) {
				; //Correct
			} else if ((timeZones[cboTimeZone.selectedIndex][1]!='Northern')&&
					(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
                                   (dstStartWeek.selectedIndex == dstEndWeek.selectedIndex) &&
                                   (dstStartDW.selectedIndex == dstEndDW.selectedIndex) &&
				   (dstStartTime.selectedIndex >= dstEndTime.selectedIndex)) {
				; //nothing to do
			} else if (timeZones[cboTimeZone.selectedIndex][1]!= 'Northern'){
				alert("End time is later than Start time  , please set again.");
                                return;
			}

			if ((timeZones[cboTimeZone.selectedIndex][1]=='Northern')&&
				(dstStartMonth.selectedIndex < dstEndMonth.selectedIndex)) {
				; //Correct
			} else if ((timeZones[cboTimeZone.selectedIndex][1]=='Northern')&&
					(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
				      (dstStartWeek.selectedIndex < dstEndWeek.selectedIndex)) {
				; //Correct
			} else if ((timeZones[cboTimeZone.selectedIndex][1]=='Northern')&&
					(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
                                   (dstStartWeek.selectedIndex == dstEndWeek.selectedIndex) &&
				   (dstStartDW.selectedIndex < dstEndDW.selectedIndex)) {
				; //Correct
			} else if ((timeZones[cboTimeZone.selectedIndex][1]=='Northern')&&
					(dstStartMonth.selectedIndex == dstEndMonth.selectedIndex) &&
                                   (dstStartWeek.selectedIndex == dstEndWeek.selectedIndex) &&
                                   (dstStartDW.selectedIndex == dstEndDW.selectedIndex) &&
				   (dstStartTime.selectedIndex <= dstEndTime.selectedIndex)) {
				; //nothing to do
			} else if (timeZones[cboTimeZone.selectedIndex][1]== 'Northern'){
				alert("Start time is later than End time, please set again.");
                                return;
			}
	 /* 20120410, Tick, end --------------------- mark: 543543543*/
	  
			//if(dstStartMonth.selectedIndex>dstEndMonth.selectedIndex){
			//	alert("dstStartMonth is later than dstEndMonth,  please set afrsh.");
			//	return;
			//}	

			loc += '&from_day=' + from_day;
			loc += '&from_month=' + (dstStartMonth.selectedIndex + 1);
            		loc += '&from_week=' + dstStartWeek[dstStartWeek.selectedIndex].value ;
			loc += '&from_weekday=' + dstStartDW.selectedIndex;	
			loc += '&from_hour=' + dstStartTime.selectedIndex;
			loc += '&to_month=' + (dstEndMonth.selectedIndex + 1);
            		loc += '&to_week=' + dstEndWeek[dstEndWeek.selectedIndex].value ;	
			loc += '&to_day=' + to_day;
			loc += '&to_weekday=' + dstEndDW.selectedIndex;
			loc += '&to_hour=' + dstEndTime.selectedIndex;
			loc += '&dst_offset=' + dstOffset[dstOffset.selectedIndex].value; 
			loc += '&use_dst=1';
		}else
			loc += '&use_dst=0';	  
    }
	else
	{
		if (quicksetup == '1'){
  			//var loc = 'wizwan.html';
    	 		loc = 'wizmanualtime.cgi?ntp_enabled=0&isManual=1&use_dst=0';
                    loc += '&quickSetup=1';
			
  		}else{
 
    	 	loc = 'manualtime.cgi?ntp_enabled=0&isManual=1&use_dst=0';
	
   			if(!isDateValid(mnualYear[mnualYear.selectedIndex].value, mnualMonth[mnualMonth.selectedIndex].value, mnualDay[mnualDay.selectedIndex].value))
   			{
      				alert('Date is not Valid');
      				return;
    		}

    		loc += '&manualDateTimeStr=' + mnualYear[mnualYear.selectedIndex].value + ":" + mnualMonth[mnualMonth.selectedIndex].value+ ":" + mnualDay[mnualDay.selectedIndex].value+ ":" + mnualHour[mnualHour.selectedIndex].value+ ":" + mnualMin[mnualMin.selectedIndex].value+ ":" + mnualSec[mnualSec.selectedIndex].value;
  		}
    }
  }

  	var code = 'location="' + loc + '"';
 	//alert(code);
  	eval(code);
	//window.location.reload(code);
}

function frmLoad() {
  var i = 0;


  parseDate();


 if (quicksetup != 1){

	if (manualConfigTime == '1'){
	  if( document.getElementById )
    	document.getElementById('mnualConfig').style.visibility = 'visible';
	  else
    	if(!document.layers)
	      document.all.mnualConfig.style.visibility = 'visible';
	}
}
  with (document.forms[0]) {
	if (quicksetup != 1){
    		if( manualConfigTime == "1" ) {
      			ntpEnabled.checked = false;
    		} else {
    			if( ntp_enabled == "1" ) 
      				ntpEnabled.checked = true;
			else
				ntpEnabled.checked = false;
       	}

    if( ntp1.length ) {
      for( i = 0; i < ntpServers.length; i++ ) {
        if( ntp1 == ntpServers[i] ) {
          ntpServer1.selectedIndex = i;
          break;
        }
      }
      if( i == ntpServers.length ) {
        ntpServer1.selectedIndex = i; // Set to 'Other'
        ntpServerOther1.value = ntp1;
      }
    }
    ntpChange(ntpServer1,ntpServerOther1);

    if( ntp2.length ) {
      for( i = 0; i < ntpServers.length; i++ ) {
        if( ntp2 == ntpServers[i] ) {
          ntpServer2.selectedIndex = i+1;
          break;
        }
      }
      if( i == ntpServers.length ) {
        ntpServer2.selectedIndex = i+1; // Set to 'Other'
        ntpServerOther2.value = ntp2;
      }
    }
    ntpChange(ntpServer2,ntpServerOther2);

    cboTimeZone.selectedIndex = getTimeZoneIndex(tz_name);
	
	 //var tzoffstr=tz_offset.split(":");
	 //var tzoffseconds = tzoffstr[0]*3600 + tzoffstr[1]*60;
	 //alert(tz_offset+'==>'+ tzoffseconds);
    dstOffset.selectedIndex = getTimeZoneOffsetIndex(tz_offset);	
    ntpEnblChange();
		setButtonInfo.style.display = 'inline';
		wizButtonInfo.style.display = 'none';
		
    if(buildDaylight == '1'){
//    	  var use_dst="0";
//	      var dst_offset="-7200";
//    	  var dst_start_info="0:0:1:0";
//	      var dst_end_info="0:0:1:0";
//    	  var dst_start=dst_start_info.split(":");
//	      var dst_end=dst_end_info.split(":");
      
    	  if(dstenable == '1'){
	      	tz_daylight.checked=true;
		hideDST();
		//convertWeekday();
			
    		dstStartMonth.selectedIndex = '<%ejGetTime(from_month)%>' -1;
			dstStartWeek.selectedIndex = '<%ejGetTime(from_week)%>' - 1 ;
		dstStartDW.selectedIndex = '<%ejGetTime(from_weekday)%>';
    		dstStartTime.selectedIndex = '<%ejGetTime(from_hour)%>';		
    		dstEndMonth.selectedIndex = '<%ejGetTime(to_month)%>' -1;
			dstEndWeek.selectedIndex = '<%ejGetTime(to_week)%>' - 1;
		dstEndDW.selectedIndex = '<%ejGetTime(to_weekday)%>';
    		dstEndTime.selectedIndex = '<%ejGetTime(to_hour)%>';
			for(i = 0; i<8; i++){	
				if(dstOffset[i].value == manu_offset)
					dstOffset.selectedIndex = i;	
			}	
			
    	  }else{
	  		tz_daylight.checked=false;
		   	hideDST();
    	  }
//    	  dstOffset.selectedIndex=getSelectIndex(dstOffset,dst_offset);

		mnualMonth.selectedIndex =  mandatetime_month -1;		
    		mnualDay.selectedIndex = mandatetime_day -1;
	    	mnualHour.selectedIndex = mandatetime_hour;
    		mnualMin.selectedIndex = mandatetime_min;
	    	mnualSec.selectedIndex = mandatetime_sec;

		if ((mandatetime_year - startYear) >= 0)
			mnualYear.selectedIndex = mandatetime_year - startYear;
		
    		if (manualConfigTime == '1'){		
    			ntpEnabled.checked = false;	
			ntpEnblChange();		
    		}else {    		
       		if( ntp_enabled == "1" ) 
      				ntpEnabled.checked = true;
			else
				ntpEnabled.checked = false;
			ntpEnblChange();	
    		}
/*			
	      dstStartMonth.selectedIndex=dst_start[0];
    	  dstStartTime.selectedIndex=dst_start[3];
	      dstEndMonth.selectedIndex=dst_end[0];
    	  dstEndTime.selectedIndex=dst_end[3];
//	      if(buildDaylightWeek == '1')
			{
	      	dstStartWeek.selectedIndex=dst_start[1];
    	  	dstStartDW.selectedIndex=dst_start[2]-1;
      		dstEndWeek.selectedIndex=dst_end[1];
	      	dstEndDW.selectedIndex=dst_end[2]-1;
    	  	}
	  	changeDST();	
*/
	  	
    	}
	} else{
		setButtonInfo.style.display = 'none';
		wizButtonInfo.style.display = 'inline';
		btnGetSysDate();
		if(buildDaylight == '1'){
			hideDST();
		}
		ntpEnblChange();
	}
  }
}

function hideNtpConfig(hide) {
	var status = false;

	if(hide)
		status = true;

	if( document.getElementById )
		document.getElementById('ntpConfig').disabled = status;
	else if(!document.layers)
		document.all.ntpConfig.disabled = status;

	with (document.forms[0]) {
		ntpServer1.disabled = status;
		ntpServerOther1.disabled = status;
		ntpServer2.disabled = status;
		ntpServerOther2.disabled = status;
		cboTimeZone.disabled = status;	
		tz_daylight.disabled = status;	// add by rome
		if(tz_daylight.checked && status)
			tz_daylight.checked = !status;
	}
	
	changeDST();							// add by rome
	
	if(hide)
		state = 0;
	else
		state = 1;

	with (document.forms[0]) {
		mnualYear.disabled = state;
		mnualMonth.disabled = state;
		mnualDay.disabled = state;
		mnualHour.disabled = state;
		mnualMin.disabled = state;
		mnualSec.disabled = state;
		btnGetSys.disabled = state;
		manualtime.disabled = state;
	}
}

function ntpEnblChange() {
  with(document.forms[0]){	
  if( document.forms[0].ntpEnabled.checked ){
    hideNtpConfig(0);
    //fixed 2 RD_ONLY @20070412-Roger-TECOM	
    ntpChange(ntpServer1,ntpServerOther1);	
    ntpChange(ntpServer2,ntpServerOther2);	
  }else
    hideNtpConfig(1);

  }

}

function writeNtpList(needed) {
	if(!needed)
		document.writeln("<option value=None>None</option>");
	for( var i = 0; i < ntpServers.length; i++ )
		document.writeln("<option value=" + ntpServers[i] + ">" + ntpServers[i] + "</option>");
	document.writeln("<option value=Other>Other</option>");
}

function writeYearList() {
  for( var i = 2005; i <= 2037; i++ )
    document.writeln("<option value=" + i + ">" + i + "</option>");
}

function writeDayList() {
  for( var i = 1; i <= 31; i++ )
    document.writeln("<option value=" + i + ">" + i + "</option>");
}

function writeHourList() {
  for( var i = 0; i <= 23; i++ )
    document.writeln("<option value=" + i + ">" + i + "</option>");
}

function writeMinSecList() {
  for( var i = 0; i <= 59; i++ )
    document.writeln("<option value=" + i + ">" + i + "</option>");
}

function getSelectIndex(optionlist,val) {
  var i = 0;
  var ret=0;

  for ( i = 0; i < optionlist.length; i++ ) {
    if ( optionlist[i].value == val )
      break;
  }
  if ( i < optionlist.length )
    ret = i;
  return ret;
}
function btnCancel(){
   var loc = 'internet.html';

   var code = 'location="' + loc + '"';

   eval(code);

}

function btnBack(){
   var loc = 'wizpass.html';

   var code = 'location="' + loc + '"';

   eval(code);

}


function changeDST(){
	
with (document.forms[0]) {
	
	hideDST();
	var hour;
	var min;
	var i;
	var currtime =   '<%ejGet(manualDateTimeStr)%>';
	
	var curdatetime = currtime.split(":");
	var curdatetime_year = curdatetime[0];
	var curdatetime_month = curdatetime[1];
	var curdatetime_day = curdatetime[2];
	var curdatetime_hour = curdatetime[3];
	var curdatetime_min = curdatetime[4];
	var curdatetime_sec = curdatetime[5];
	
	
	if(tz_daylight.checked == false && dstenable == 1){

		hour = Math.floor(dstOffset[dstOffset.selectedIndex].value/3600);
		min = ((dstOffset[dstOffset.selectedIndex].value)%3600)/60;

		ret_day = curdatetime_day;
		ret_hour = curdatetime_hour - hour;
		ret_min = curdatetime_min - min;
	
		if(ret_hour < 0 ){
			ret_hour = ret_hour + 24;
			ret_day = ret_day - 1;
			}
		else if(ret_hour > 24){
			ret_hour = ret_hour - 24;
			ret_day = ret_day + 1;
			}
		
		if(ret_min < 0 ){
			ret_min = ret_min + 60;
			ret_hour = ret_hour - 1;

		}
		else if(ret_min > 60){
			ret_min = ret_min - 60;
			ret_hour = ret_hour + 1;
		}

		
		for(i=0;i<31;i++){
			if(mnualDay[i].value == ret_day)
				mnualDay.selectedIndex = i;
			}
		for(i=0;i<24;i++){
			if(mnualHour[i].value == ret_hour)
				mnualHour.selectedIndex = i;
			}
		for(i=0;i<60;i++){
			if(mnualMin[i].value == ret_min)
				mnualMin.selectedIndex = i;
			}
		
		
	}	
   }

}

function hideDST(){
	var status = true;
	with (document.forms[0]) {
		if (tz_daylight.checked == true && tz_daylight.disabled ==false){	// rome 
			status = false;
		}
	}
	if( document.getElementById ){
		document.getElementById('dstOffset').disabled = status;
		document.getElementById('dstStartMonth').disabled = status;
		document.getElementById('dstStartTime').disabled = status;
		document.getElementById('dstEndMonth').disabled = status;
		document.getElementById('dstEndTime').disabled = status;
	//    if(buildDaylightWeek == '1')
		{
			document.getElementById('dstStartWeek').disabled = status;
			document.getElementById('dstStartDW').disabled = status;
			document.getElementById('dstEndWeek').disabled = status;
			document.getElementById('dstEndDW').disabled = status;
		}
	}else{
		if(!document.layers)
				document.all.dstOffset.disabled = status;
				document.all.dstStartMonth.disabled = status;
				document.all.dstStartTime.disabled = status;
				document.all.dstEndMonth.disabled = status;
				document.all.dstEndTime.disabled = status;
	//    if(buildDaylightWeek == '1')
			{
				document.all.dstStartWeek.disabled = status;
				document.all.dstStartDW.disabled = status;
				document.all.dstEndWeek.disabled = status;
				document.all.dstEndDW.disabled = status;
			}
	}
}

function setNTPServer() {
	with (document.forms[0]) {
		tz_ntp.value = ntpServer1[ntpServer1.selectedIndex].value;
	}

}
function writeOffsetList()
{
	document.write("<OPTION value=-7200>-2:00</OPTION>");
	document.write("<OPTION value=-5400>-1:30</OPTION>");
	document.write("<OPTION value=-3600>-1:00</OPTION>");
	document.write("<OPTION value=-1800>-0:30</OPTION>");
	document.write("<OPTION value=1800>+0:30</OPTION>");
	document.write("<OPTION value=3600>+1:00</OPTION>");
	document.write("<OPTION value=5400>+1:30</OPTION>");
	document.write("<OPTION value=7200>+2:00</OPTION>");
}
function writeMonthList()
{
	document.write("<OPTION value=1>Jan</OPTION>"); 
	document.write("<OPTION value=2>Feb</OPTION>"); 
	document.write("<OPTION value=3>Mar</OPTION>"); 
	document.write("<OPTION value=4>Apr</OPTION>");
	document.write("<OPTION value=5>May</OPTION>"); 
	document.write("<OPTION value=6>Jun</OPTION>");
	document.write("<OPTION value=7>Jul</OPTION>");
	document.write("<OPTION value=8>Aug</OPTION>"); 
	document.write("<OPTION value=9>Sep</OPTION>");
	document.write("<OPTION value=10>Oct</OPTION>"); 
	document.write("<OPTION value=11>Nov</OPTION>"); 
	document.write("<OPTION value=12>Dec</OPTION>");
}
function wirteWeekList()
{
	document.write("<OPTION value=1>1st</OPTION>"); 
	document.write("<OPTION value=2>2nd</OPTION>"); 
	document.write("<OPTION value=3>3rd</OPTION>");
	document.write("<OPTION value=4>4th</OPTION>");
	document.write("<OPTION value=5>5th</OPTION>");
	document.write("<OPTION value=6>6th</OPTION>");
}
function wirteWeekDayList()
{
	document.write("<OPTION value=0 selected>Sun</OPTION>");
	document.write("<OPTION value=1>Mon</OPTION>"); 
	document.write("<OPTION value=2>Tue</OPTION>");
	document.write("<OPTION value=3>Wed</OPTION>");
	document.write("<OPTION value=4>Thu</OPTION>");
	document.write("<OPTION value=5>Fri</OPTION>");
	document.write("<OPTION value=6>Sat</OPTION>");
}
function writeHourList()
{
   document.write("<OPTION value=0>12 am</OPTION>");
   document.write("<OPTION value=1>1 am</OPTION>"); 
   document.write("<OPTION value=2>2 am</OPTION>");
   document.write("<OPTION value=3>3 am</OPTION>");
   document.write("<OPTION value=4>4 am</OPTION>");
   document.write("<OPTION value=5>5 am</OPTION>");
   document.write("<OPTION value=6>6 am</OPTION>"); 
   document.write("<OPTION value=7>7 am</OPTION>");
   document.write("<OPTION value=8>8 am</OPTION>");
   document.write("<OPTION value=9>9 am</OPTION>");
   document.write("<OPTION value=10>10 am</OPTION>");
   document.write("<OPTION value=11>11 am</OPTION>");
   document.write("<OPTION value=12>12 pm</OPTION>");
   document.write("<OPTION value=13>1 pm</OPTION>");
   document.write("<OPTION value=14>2 pm</OPTION>"); 
   document.write("<OPTION value=15>3 pm</OPTION>");
   document.write("<OPTION value=16>4 pm</OPTION>");
   document.write("<OPTION value=17>5 pm</OPTION>");
   document.write("<OPTION value=18>6 pm</OPTION>");
   document.write("<OPTION value=19>7 pm</OPTION>"); 
   document.write("<OPTION value=20>8 pm</OPTION>");
   document.write("<OPTION value=21>9 pm</OPTION>");
   document.write("<OPTION value=22>10 pm</OPTION>");
   document.write("<OPTION value=23>11 pm</OPTION>");
}
function writeDaylight()
{
	
	document.write(" <TR><TD class=form_label_30><LABEL for=tz_daylight>Enable Daylight Saving&nbsp;:</LABEL></TD>");
	document.write("     <TD><INPUT id=tz_daylight type=checkbox onclick='changeDST()'></TD>");
	
	document.write(" </TR>");
	document.write(" <TR><TD colspan=2></TD></TR>");
	document.write(" <TR><TD class=form_label_30>Daylight Saving Offset&nbsp;:</TD>");
	document.write(" <TD><SELECT id=dstOffset >");
	writeOffsetList();
	document.write(" </SELECT></TD>");
	document.write(" </TR>");
	document.write(" <TR><TD colspan=2></TD></TR>");
	// if(buildDaylightWeek == '1')
	{
		document.write("<TR>");
		document.write("<TD class=form_label_top width=30%>Daylight Saving Dates&nbsp;:</TD>");
		//document.write("<TD></TD>");
		document.write("<TD>");
		//document.write("<TR><TD></TD><TD>");
		document.write("<TABLE id=formarea cellSpacing=5 cellPadding=10 summary='' border=0>");
		document.write("<TBODY>");
		document.write("<TR>");
		document.write("<TD ></TD>");
		document.write("<TD>Month</TD>");
		document.write(" <TD>Week</TD>");
		document.write(" <TD>Day</TD>");
		document.write(" <TD>Time</TD>");
		document.write("</TR>");
		document.write("<TR>");
		document.write(" <TD>Start&nbsp;</TD>");
		document.write(" <TD><SELECT id=dstStartMonth>");
		writeMonthList();
		document.write("     </SELECT></TD>");
		document.write(" <TD><SELECT  id=dstStartWeek>");
		wirteWeekList();
		document.write("   	</SELECT></TD>");
		document.write(" <TD><SELECT  id=dstStartDW>");
		wirteWeekDayList();
		document.write("   	</SELECT></TD>");
		document.write(" <TD><SELECT  id=dstStartTime>");
		writeHourList();
		document.write("     	</SELECT></TD>");
		document.write("</TR>");
		document.write("<TR>");
		document.write(" <TD>End&nbsp;</TD>");
		document.write(" <TD><SELECT id=dstEndMonth>");
		writeMonthList();
		document.write("     </SELECT></TD>");
		document.write(" <TD><SELECT id=dstEndWeek>");
		wirteWeekList();
		document.write("   	</SELECT></TD>");
		document.write(" <TD><SELECT id=dstEndDW>");
		wirteWeekDayList();
		document.write("   	</SELECT></TD>");               
		document.write(" <TD><SELECT id=dstEndTime>");
		writeHourList();
		document.write("     	</SELECT></TD>");
		document.write("</TR>");
		document.write("</TBODY>");
		document.write("</TABLE>");
		document.write("</TD>");
		document.write("</TR>");
	}
}

// done hiding -->
    </script>
<script language="JavaScript" src="menu.js"></script>
   </head>
<body onLoad='frmLoad()'>
<blockquote>
<script language="JavaScript">

TabHeader="Setup";
SideItem="Time and Date";
HelpItem="datetime";

</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
<form>
	<table id=box_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
			
			<script language="javascript">
				document.writeln("Time");				
			</script>
				
			</td>										
		</tr>
		<tr>
			<td class=content>
				<p>
				The Time Configuration option allows you to configure, update, and maintain the correct time on the internal system clock. From this section you can set the time zone that you are in and set the NTP (Network Time Protocol) Server. Daylight Saving can also be configured to automatically adjust the time when needed.</p>				
			</td>
		</tr>
	</table>

		<table id=body_header width="690" border=0 cellSpacing=0>
			<tr><td class=topheader>Time settings</td></tr>
			<tr>
				<td class=content>					
          		<table class=formarea width="100%" border="0" cellpadding="0" cellspacing="0">
						<tr><td colspan=3></td></tr>
          			<tr>
						<td class=form_label>
							<input type='checkbox' name='ntpEnabled' onClick='ntpEnblChange()'>
						</td>
					<td class=form_label_left colspan=2>Automatically synchronize with Internet time servers</td>
          			</tr>
					<tr><td colspan=3><br></td></tr>
          			<div id='ntpConfig'>
            		<tr>
					<td class=form_label_30>First NTP time server:&nbsp;</td>
              			<td>
              				<select name='ntpServer1' size="1" onChange='ntpChange(this.form.ntpServer1,this.form.ntpServerOther1)'>
                 				<script language="javascript">writeNtpList(true);</script>
                 			</select>
              			</td>
              			<td><input type='text' name='ntpServerOther1' maxlength='39'></td>
            		</tr>
            		<tr>
										<td class=form_label_30 align=right>Second NTP time server:&nbsp;</td>
              			<td>
              				<select name='ntpServer2' size="1" onChange='ntpChange(this.form.ntpServer2,this.form.ntpServerOther2)'>
                 				<script language="javascript">writeNtpList(false);</script>
                 			</select>
              			</td>
              			<td><input type='text' name='ntpServerOther2' maxlength='39'></td>
            		</tr>
            		</div>
						<tr><td colspan=3></td></tr>
          		</table>
      		<!--/form-->
      		</td>
			</tr>
		</table>
		<table id=body_header width="690" border=0 cellSpacing=0>
			<tr>
				<td class=topheader>Time Configuration</td>										
			</tr>
			<tr>
				<td class=content>
         		<TABLE class=formarea width="100%">
              		<TBODY>
              			<TR>
				<TD class=form_label_30>Current Router Time&nbsp;:</TD>
				<!-- <TD><SPAN _INNERHTML="display_time"><%ejGetTime(dt_display_time)%></SPAN></TD> -->

				<TD><SPAN _INNERHTML="display_time">
				<script language="JavaScript" >
                  		getcurrenttime =  '<%ejGetTime(dt_display_time)%>';
				var getcurrentday_split = getcurrenttime.split(','); 
				var getcurrenttime_split = getcurrentday_split[1].split(' '); // 0 is time ,1 is date 
				var gettime_split = getcurrenttime_split[0].split(':'); 
				var getcurrentdate_split = getcurrentday_split[0].split('.'); // 0 is day ,1 is month, 2 is year 
	
				if (getcurrenttime_split[1] == 'Mon') {
                  			document.write('Monday');
				} else if (getcurrenttime_split[1] == 'Tue'){
                  			document.write('Tuesday');
				} else if (getcurrenttime_split[1] == 'Wed'){
                  			document.write('Wednesday');
				} else if (getcurrenttime_split[1] == 'Thu'){
                  			document.write('Thursday');
				} else if (getcurrenttime_split[1] == 'Fri'){
                  			document.write('Friday');
				} else if (getcurrenttime_split[1] == 'Sat'){
                  			document.write('Saturday');
				} else if (getcurrenttime_split[1] == 'Sun'){
                  			document.write('Sunday');
				} else {
                  			document.write(getcurrenttime_split[1]);
 				}

                  		document.write(', ');

				if (getcurrentdate_split[1] == '01') {
                  			document.write('January');
				} else if (getcurrentdate_split[1] == '02'){
                  			document.write('February');
				} else if (getcurrentdate_split[1] == '03'){
                  			document.write('March');
				} else if (getcurrentdate_split[1] == '04'){
                  			document.write('April');
				} else if (getcurrentdate_split[1] == '05'){
                  			document.write('May');
				} else if (getcurrentdate_split[1] == '06'){
                  			document.write('June');
				} else if (getcurrentdate_split[1] == '07'){
                  			document.write('July');
				} else if (getcurrentdate_split[1] == '08'){
                  			document.write('August');
				} else if (getcurrentdate_split[1] == '09'){
                  			document.write('September');
				} else if (getcurrentdate_split[1] == '10'){
                  			document.write('October');
				} else if (getcurrentdate_split[1] == '11'){
                  			document.write('November');
				} else if (getcurrentdate_split[1] == '12'){
                  			document.write('December');
				} else {
                			document.write(getcurrentdate_split[1]);
				}

                  		document.write(' ');
                  		document.write(getcurrentdate_split[0]);
                  		document.write(', ');
                  		document.write(getcurrentdate_split[2]);
                  		document.write(' ');
                  		document.write(getcurrenttime_split[0]);
                  		document.write(' ');
				if (gettime_split[0] >= 12) {
                  		document.write('PM');
                                } else {
                  		document.write('AM');
				}

			 	</script>
				</SPAN></TD>

                		</TR>
							<TR><TD colspan=2></TD></TR>
							<TR><TD class=form_label_30>Time Zone&nbsp;:</TD><TD></TD></TR>
							<TR>
								<TD colspan=2 align=right width="300">
									<Select id=cboTimeZone><SCRIPT language=javascript type=text/javascript>writeTimeZoneList();</SCRIPT>
									</select>
								</TD>
							</TR>
							<TR><TD colspan=2></TD></TR>
							
							<script language="javascript">
								<!-- hide
									if(buildDaylight == '1')
										writeDaylight();
									// done hiding -->
							</script>
              		</TBODY>
   				</TABLE> 
     			</td>
			</tr>
		</table>



<div id='wizButtonInfo' style={display:none;}>
<p align=center><input type='button' value="Back" onClick='btnBack()' id='back'><input id='save' type='button' value="Next" onClick='btnApply()'><input type='button' onClick='btnCancel()' value='Cancel'></p>
</div>
<script language="javascript">
	document.writeln("<div id='mnualConfig' style={visibility:visible;}>");
</script>
		<table id=body_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Set the Date and Time Manually
			</td>										
		</tr>
		<tr>
			<td class=content>
<div id="manualtime" name="manualtime">
		<table border="0"  class=formarea  cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td class=form_label_30>
					Date And Time :
				</td>
			<!--/tr>
			<tr -->
				<td><tbody>
				<tr>
					<td></td>
					<td align=right>Year:&nbsp</td>
					<td>
						<select name='mnualYear' size="1" onChange=''>
							<script language="javascript">writeYearList(false);</script>
						</select>
					</td>

					<td align=right>Month:&nbsp</td>
					<td>
							<select name='mnualMonth' size="1" onChange=''>
								<script language="javascript">writeMonthList(false);</script>
							</select>
					</td>

					<td align=right>Day:&nbsp</td>
					<td><select name='mnualDay' size="1" onChange=''>
							<script language="javascript">
								writeDayList(false);
							</script>
							</select>
					</td>
				</tr>
	
				<tr>
					<td></td>
					<td align=right>Hour:&nbsp</td>
					<td><select name='mnualHour' size="1" onChange=''>
							<script language="javascript">
								writeHourList(false);
							</script>
						</select>
					</td>
					<td align=right>Minute:&nbsp</td>
					<td>
						<select name='mnualMin' size="1" onChange=''>
							<script language="javascript">writeMinSecList(false);</script>
						</select>
					</td>
					<td align=right>Second:&nbsp</td>
					<td>
						<select name='mnualSec' size="1" onChange=''>
							<script language="javascript">writeMinSecList(false);</script>
						</select>
					</td>
				</tr>
				<tr>
					<td colspan=9>&nbsp</td>
				</tr>
				<tr>
					<td colspan=9 align=center>
						<input type=button value="Copy Your Computer's Time Settings" name="btnGetSys" onClick='btnGetSysDate()'>
					</td>
				</tr>
				</tbody>
				</td>
								
			</table>
		</div>
					</td>
				</tr>
			</table>
		</div>

		<div id='setButtonInfo' style={display:none;}>
			<p align=center><input id='save' type='button' value="Apply" onClick='btnApply()'>
				<input type='button' onClick='btnCancel()' value='Cancel'>
			</p>
		</div>
	</form>

<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
</blockquote>
</body>
</html>
