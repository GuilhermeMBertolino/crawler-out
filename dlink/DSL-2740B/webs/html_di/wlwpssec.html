<HTML><HEAD><TITLE>D-Link ADSL Router</TITLE>
<META http-equiv=Content-Type content="text/html">
<META http-equiv=Pragma content=no-cache><LINK 
href="stylemain.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript src="util.js"></SCRIPT>

<SCRIPT language=JavaScript src="menu.js"></SCRIPT>

<SCRIPT language=javascript>
<!-- hide

var ssid = '<%ejGetWl(wlSsid_wl0v0)%>';
var sessionKey='<%ejGetOther(sessionKey)%>';
function isValidWPAPskKey(val) {
   var ret = false;
   var len = val.length;
   var maxSize = 64;
   var minSize = 8;

   if ( len >= minSize && len < maxSize )
      ret = true;
   else if ( len == maxSize ) {
      for ( i = 0; i < maxSize; i++ )
         if ( isHexaDigit(val.charAt(i)) == false )
            break;
      if ( i == maxSize )
         ret = true;
   } else
      ret = false;

   return ret;
}

function btnPrev(){
  var code = 'location="wlwps.html"';
  eval(code);
}

function btnCancel(){

  var code = 'location="wireless.html"';
  eval(code);

}

function frmLoad(){

 with (document.forms[0]) 
 {
		wlssid.value=ssid;
 }
	
}

function btnNext(){
    var loc = 'wlwpssec.wl?';
	loc += 'sessionKey=' + sessionKey;
	with ( document.forms[0] ) {

			if ( wlssid.value == '' ) {
			alert('SSID should not be empty.');
			return;
		}
		var str = new String();
		str = wlssid.value;
		if ( str.length > 32 ) {
            	alert('SSID "' + wlSsid.value + '" should not be longer than 32 characters.');
            	return;
		}

		var value = wlWpaPsk.value;
		if ( isValidWPAPskKey(value) == false ) {
		alert('WPA Pre-Shared Key should be between 8 and 63 ASCII characters or 64 hexadecimal digits.');
			return;
		} 

        loc += '&Wizardmode=4';
	loc += '&Wizardssid=' + encodeUrl(wlssid.value);
	loc += '&WizardKEY=' + encodeUrl(wlWpaPsk.value);

	}
  var code = 'location="' + loc + '"';
  eval(code);
}
// done hiding -->
</SCRIPT>



</HEAD>
<BODY onload=frmLoad()>
<BLOCKQUOTE>
  <SCRIPT language=JavaScript>
TabHeader="Setup";
SideItem="Wireless Settings";
HelpItem="diwireless";
</SCRIPT>

  <SCRIPT type=text/javascript>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</SCRIPT>

  <FORM>
  <TABLE id=box_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>Add Wireless Device with WPS(Wi-Fi Protected Setup) </TD></TR>
    <TR>
      <TD class=content>
        <P>The WPA2 (Wi-Fi Protected Access)key must meet one of the following guidelines:</P>
		<P>- Between 8 and 63 characters(A longer WPA key is more secure than a short one)<BR>
		- Exactly 64 characters using 0-9 and A-F</P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label>
              <DIV>Network Name (SSID) &nbsp;:</DIV></TD>
            <TD><INPUT id=SSID maxLength=64 size=20 name='wlssid'></TD></TR>
          <TR>
            <TD class=form_label>
              <DIV>Network Key &nbsp;:</DIV></TD>
            <TD><INPUT id=SSID maxLength=64 size=20 name='wlWpaPsk'></TD></TR>
    
</TBODY></TABLE></TD></TR></TBODY></TABLE>
  <P align=center><INPUT onclick=btnPrev() type=button value="Prev">
  <INPUT onclick=btnNext() type=button value="Next">
  <INPUT onclick=btnCancel() type=button value="Cancel"></P>
  <SCRIPT type=text/javascript>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</SCRIPT>
</BLOCKQUOTE></BODY></HTML>
