<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
 		<script language="javascript" src="menu.js"></script>
            <script language="javascript">
<!-- hide
var auto = '<%ejGet(enblAutoScan)%>';
var wlAdaptor = '<%ejGetOther(sysInfo, numWlAdaptor)%>';
//var wlssid = '<%ejGetWl(wlSsid_wl0v0)%>';
//var enblWireless = '<%ejGetWl(wlEnbl_wl0v0)%>';
var enblWireless = window.parent.frames[0].wizEnabledWl;
var wlssid = window.parent.frames[0].wizSsid;
var tmp_wlssid = window.parent.frames[0].tmp_wizSsid;//20110329, Frank ,fix SSID wrong displayed after back to wizard page
//var wl_switch = '<%ejGetWl(wireless_switch)%>'; /*20091113, Roger Yu add it*/
var wl_switch = '1';
//enblWireless = 1;
//var hide = '<%ejGetWl(wlHide_wl0v0)%>';
var hide = window.parent.frames[0].wizWlhide;
//hide = 0;
//var wep = '<%ejGetWl(wlWep)%>';
var wep = window.parent.frames[0].wizWep;
var wpa = '<%ejGetWl(wlWpa)%>';
//var wpaPskKey = '<%ejGetWl(wlWpaPsk)%>';
var wpaPskKey = window.parent.frames[0].wizWpaPsk
//var bit = '1';
var setchannel = '0';
var wlCurrentChannel = '11';
//var mode = '<%ejGetWl(wlAuthMode)%>';
var mode = window.parent.frames[0].wizWlAuthMode;
var bit = '<%ejGetWl(wlKeyBit)%>';
var keyIdx = '<%ejGetWl(wlKeyIndex)%>';
//var keys = new Array("<%ejGetWl(wlKey1)%>", "<%ejGetWl(wlKey2)%>", "<%ejGetWl(wlKey3)%>", "<%ejGetWl(wlKey4)%>");
var keys = window.parent.frames[0].wizWlKey1 
//var wep = 'disabled';
var wlRefresh = '<%ejGetWl(wlRefresh)%>';
var prtcl = '<%ejGetOther(memInfo, ntwkPrtcl)%>';
var channel = new Array();
channel[0] = 'Auto Scan(recommended)';
channel[1] = '2.412 GHz - CH 1';
channel[2] = '2.417 GHz - CH 2';
channel[3] = '2.422 GHz - CH 3';
channel[4] = '2.427 GHz - CH 4';
channel[5] = '2.432 GHz - CH 5';
channel[6] = '2.437 GHz - CH 6';
channel[7] = '2.442 GHz - CH 7';
channel[8] = '2.447 GHz - CH 8';
channel[9] = '2.452 GHz - CH 9';
channel[10] = '2.457 GHz - CH 10';
channel[11] = '2.462 GHz - CH 11';
channel[12] = '2.467 GHz - CH 12';
channel[13] = '2.472 GHz - CH 13';

function wlClick(obj)
{
    with(document.forms[0])
    {
        if (wlEnbl.checked == true)
        {
            enblWireless = '1';
            SSID.disabled = false;
            document.forms[0].wlHide[0].disabled = false;
            document.forms[0].wlHide[1].disabled = false;
            document.forms[0].encryptType[0].disabled = false;
            document.forms[0].encryptType[1].disabled = false;
            document.forms[0].encryptType[2].disabled = false;
            document.forms[0].encryptType[3].disabled = false;
            encryptkey.disabled = false;
        }
        else
        {
            enblWireless = '0';
            SSID.disabled = true;
            document.forms[0].wlHide[0].disabled = true;
            document.forms[0].wlHide[1].disabled = true;
            document.forms[0].encryptType[0].disabled = true;
            document.forms[0].encryptType[1].disabled = true;
            document.forms[0].encryptType[2].disabled = true;
            document.forms[0].encryptType[3].disabled = true;
            encryptkey.disabled = true;
        }
    }
}

function frmLoad()
{
    with(document.forms[0])
    {
        //SSID.value = wlssid;
        SSID.value = tmp_wlssid;//20110329, Frank ,fix SSID wrong displayed after back to wizard page
        setCheck(wlEnbl, enblWireless);

        /* 20091113, Roger Yu, add it for wireless switch, mark: 11131546*/
        if (wl_switch == '1')
        {
            wlEnbl.disabled = false;
        }
        else
        {
            wlEnbl.disabled = true;
        }
        /* 20091113, Roger Yu, end---------------------------------- mark: 11131546*/
        
        if (hide == '0')
        {
            wlHide.item(0).checked = true;
        }
        else if (hide == '1')
        {
            wlHide.item(1).checked = true;
        }
        //	wlKeyIndex.item(keyIdx -1).checked = true;
        if (mode == 'psk')
        {
            encryptType.item(2).checked = true;
        }
        else if (mode == 'psk2')
        {
            encryptType.item(3).checked = true;
        }
        else
        {
            if (wep == 'enabled')
            {
                encryptType.item(1).checked = true;
            }
            else
            {
                encryptType.item(0).checked = true;
            }
        }
        doLabelChange();
        if (mode == 'open')
        {
            if (wep == 'enabled')
            {
                //encryptkey.value = keys[0];
				encryptkey.value = keys;
            }
        }
        else
        {
            encryptkey.value = wpaPskKey;
        }
        if (wlAdaptor == 0)
        {
            wlEnbl.disabled = true;
            SSID.disabled = true;
            document.forms[0].wlHide[0].disabled = true;
            document.forms[0].wlHide[1].disabled = true;
            document.forms[0].encryptType[0].disabled = true;
            document.forms[0].encryptType[1].disabled = true;
            document.forms[0].encryptType[2].disabled = true;
            document.forms[0].encryptType[3].disabled = true;
            encryptkey.disabled = true;
			return;
        }
        else
        {
            if (enblWireless == '0')
            {
                SSID.disabled = true;
                document.forms[0].wlHide[0].disabled = true;
                document.forms[0].wlHide[1].disabled = true;
                document.forms[0].encryptType[0].disabled = true;
                document.forms[0].encryptType[1].disabled = true;
                document.forms[0].encryptType[2].disabled = true;
                document.forms[0].encryptType[3].disabled = true;
                encryptkey.disabled = true;
            }
        }
        //wlchannel.selectedIndex = channel;
        //wlWpaGTKRekey.value = wpaGTKRekey;
        //wlKeyBit.selectedIndex = parseInt(bit);
        //wlPreauth.selectedIndex = parseInt(varPreauth);
    }
}

function writeChannel()
{
    for (var i = 0;i < channel.length;i++)
    {
        if (0 == i)
        {
            document.writeln("<option value=" + i + " selected>" + channel[i] + "</option>");
        }
        else
        {
            document.writeln("<option value=" + i + ">" + channel[i] + "</option>");
        }
    }
}

function isValidWPAPskKey(val)
{
    var ret = false;
    var len = val.length;
    var maxSize = 64;
    var minSize = 8;
    if (len >= minSize && len < maxSize)
    {
        ret = true;
    }
    else if (len == maxSize)
    {
        for (i = 0;i < maxSize;i++)
    	{
	        if (isHexaDigit(val.charAt(i)) == false)
	        {
	            break;
	        }
		}
		if (i == maxSize)
		{
			ret = true;
		}
    }
    else
    {
        ret = false;
    }
    return ret;
}

function doLabelChange()
{
    with(document.forms[0])
    {
        encryptkey.disabled = false;
        if (encryptType.item(1).checked == true)
        {
            lbMode.innerHTML = "WEP";
            lbsupportMode.innerHTML = "WEP";
            //lbnowMode.innerHTML = "WEP";
            lblkey.innerHTML = "WEP";
            lbllength.innerHTML = "(5(10) or 13(26) ASCII characters(hex digits), Example '@11xy' or '~!@#$%^&*()`,')";
            keySecInfo.style.display = 'block';
            encryptkey.value = '';
        }
        else if (encryptType.item(2).checked == true)
        {
            lbMode.innerHTML = "WPA";
            lbsupportMode.innerHTML = "WPA";
            //lbnowMode.innerHTML = "WPA";
            lblkey.innerHTML = "WPA Pre-Shared";
            lbllength.innerHTML = "(8-63 ASCII characters or 64 hexadecimal digits, Example '%Fortress123&')";
            keySecInfo.style.display = 'block';
            encryptkey.value = '';
        }
        else if (encryptType.item(3).checked == true)
        {
            lbMode.innerHTML = "WPA2";
			lbsupportMode.innerHTML = "WPA2";
            //lbnowMode.innerHTML = "WPA2";
            lblkey.innerHTML = "WPA2 Pre-Shared";
            lbllength.innerHTML = "(8-63 ASCII characters or 64 hexadecimal digits, Example '%Fortress123&')";
            keySecInfo.style.display = 'block';
            encryptkey.value = '';
        }
        else
        {
            lbMode.innerHTML = "";
            lbsupportMode.innerHTML = "";
            //lbnowMode.innerHTML = "";
            lblkey.innerHTML = "";
            lbllength.innerHTML = "";
            encryptkey.disabled = true;
            keySecInfo.style.display = 'none';
        }
    }
}

function btnReset()
{
    //var code = 'location="wizcanceldsl.cgi"';
    var code = 'location="internet.html"';
    eval(code);
}

function btnApply()
{
    var loc = 'wizlan.html';
	var value = '';
    var authMode;
    var prtcl = 'Bridge';
    if (wlAdaptor == 0)
    {
        var code = 'location="wizlan.html"';
        eval(code);
        return ;
    }
    if (enblWireless == '0')
    {
        window.parent.frames[0].wizEnabledWl = '0';

        var code = 'location="' + loc + '"';
        eval(code);
        return ;
    }
    with(document.forms[0])
    {
        if (encryptType.item(0).checked == true)
        {
            authMode = 0;
        }
        else if (encryptType.item(1).checked == true)
        {
            authMode = 1;
        }
        else if (encryptType.item(2).checked == true)
        {
            authMode = 2;
        }
        else if (encryptType.item(3).checked == true)
        {
            authMode = 3;
        }
        switch (authMode)
        {
            case 0:
                window.parent.frames[0].wizWlAuthMode = 'open';
                window.parent.frames[0].wizWep = 'disabled';
				break;
			case 1:
                window.parent.frames[0].wizWlAuthMode = 'open';
                window.parent.frames[0].wizWep = 'enabled';
				if (encryptkey.value == '')
                {
                    alert('Key cannot have an empty value.');
                    return ;
                }
                if ((isValidKey(encryptkey.value, 5) == false) && (isValidKey(encryptkey.value, 13) == false))
                {
                    alert('Key should be 5(10) or 13(26) ASCII characters(hex digits).');
                    return ;
				}
				if(encryptkey.value.length == 5 || encryptkey.value.length == 10)
				    window.parent.frames[0].wizWlKeybit = 1;
				else
				    window.parent.frames[0].wizWlKeybit = 0;
                window.parent.frames[0].wizWlKey1 = encodeUrl(encryptkey.value);
                break;
            case 2:
                window.parent.frames[0].wizWlAuthMode = 'psk';
                if (isValidWPAPskKey(encryptkey.value) == false)
                {
                    alert('Key should be between 8 and 63 ASCII characters or 64 hexadecimal digits.');
                    return ;
                }
                window.parent.frames[0].wizWpaPsk = encodeUrl(encryptkey.value);
				break;
			case 3:
                window.parent.frames[0].wizWlAuthMode = 'psk2';
                if (isValidWPAPskKey(encryptkey.value) == false)
                {
                    alert('Key should be between 8 and 63 ASCII characters or 64 hexadecimal digits.');
                    return ;
                }
                window.parent.frames[0].wizWpaPsk = encodeUrl(encryptkey.value);
                break;
        }
        if (enblWireless == '1' && SSID.value == '')
        {
            alert('SSID should not be empty.');
            return ;
        }
        var str = new String();
        str = SSID.value;
        if (str.length > 32)
        {
            alert('Wireless Network Name "' + SSID.value + '" should notbelonger than 32 characters. ');return ;
        }
        if (encodeUrl(SSID.value, "Wireless Network Name") == ERROR_ENCODE_URL)
        {
            return ;
        }
        window.parent.frames[0].wizEnabledWl = '1';
        window.parent.frames[0].wizSsid = encodeUrl(SSID.value);
        window.parent.frames[0].tmp_wizSsid = SSID.value;//20110329, Frank ,fix SSID wrong displayed after back to wizard page
        if (wlHide.item(0).checked == true)
        {
            window.parent.frames[0].wizWlhide = '0';
        }
        else if (wlHide.item(1).checked == true)
        {
            window.parent.frames[0].wizWlhide = '1';
        }
    }

	var code = 'location="' + loc + '"';
	eval(code);
}

/*
function btnApply()
{
    var loc = 'wizwlcfg.wl?';
	var value = '';
    var authMode;
    var prtcl = 'Bridge';
    if (wlAdaptor == 0)
    {
        var code = 'location="wizlan.html"';
        eval(code);
        return ;
    }
    if (enblWireless == 0)
    {
        loc = 'wizwlcfg.wl?wlSsid=' + wlssid;
        loc += '&wlEnbl=0&schedule=never';
        var code = 'location="' + loc + '"';
        eval(code);
        return ;
    }
    with(document.forms[0])
    {
        //	authMode = encryptType.selectedIndex;
        if (encryptType.item(0).checked == true)
        {
            authMode = 0;
        }
        else if (encryptType.item(1).checked == true)
        {
            authMode = 1;
        }
        else if (encryptType.item(2).checked == true)
        {
            authMode = 2;
        }
        else if (encryptType.item(3).checked == true)
        {
            authMode = 3;
        }
        switch (authMode)
        {
            case 0:
	            value += 'wlAuthMode=open&wlAuth=0&wlWep=disabled&wlSsidIdx=0';
				break;
			case 1:
                value += 'wlAuthMode=open&wlAuth=0&wlWep=enabled';
				if (encryptkey.value == '')
                {
                    alert('Key cannot have an empty value.');
                    return ;
                }
                if ((isValidKey(encryptkey.value, 5) == false) && (isValidKey(encryptkey.value, 13) == false))
                {
                    alert('Key should be 5(10) or 13(26) ASCII characters(hex digits).');
                    return ;
					}
				if(encryptkey.value.length == 5 || encryptkey.value.length == 10)
				    value += '&wlKeyBit=1';
				else
				    value += '&wlKeyBit=0';
                value += '&wlKeyIndex=1&wlKey1=' + encodeUrl(encryptkey.value);
                value += '&wlKey2=&wlKey3=&wlKey4=&wlSsidIdx=0';
                break;
            case 2:
                value += 'wlAuthMode=psk&wlAuth=0';
                if (isValidWPAPskKey(encryptkey.value) == false)
                {
                    alert('Key should be between 8 and 63 ASCII characters.');
                    return ;
                }
                value += '&wlWpaPsk=' + encodeUrl(encryptkey.value);
				value += '&wlWpaGTKRekey=0&wlWep=disabled&wlWpa=tkip+aes&wlPreauth=0&wlSsidIdx=0';
				break;
				case 3:
                value += 'wlAuthMode=psk2&wlAuth=0';
                if (isValidWPAPskKey(encryptkey.value) == false)
                {
                    alert('Key should be between 8 and 63 ASCII characters.');
                    return ;
                }
                value += '&wlWpaPsk=' + encodeUrl(encryptkey.value);
                value += '&wlWpaGTKRekey=0&wlWep=disabled&wlWpa=aes&wlPreauth=0&wlSsidIdx=0';break;
        }
        if (enblWireless == 1 && SSID.value == '')
        {
            alert('SSID should not be empty.');
            return ;
        }
        var str = new String();
        str = SSID.value;
        if (str.length > 32)
        {
            alert('Wireless Network Name "' + SSID.value + '" should notbelonger than 32 characters. ');return ;
        }
        if (encodeUrl(SSID.value, "Wireless Network Name") == ERROR_ENCODE_URL)
        {
            return ;
        }
        value += '&wlEnbl=1&schedule=always&wlSsid=' + encodeUrl(SSID.value);if (wlHide.item(0).checked == true)
        {
            value += '&wlHide=0';
        }
        else if (wlHide.item(1).checked == true)
        {
            value += '&wlHide=1';
        }
    }

   value += '&wlWscConfig=ap-pbc';
   value += '&wsc_apLockCap=1'; 

    loc += value;
	var code = 'location="' + loc + '"';
	eval(code);
}
*/

function btnBack()
{
    var loc;
    //if ( prtcl == 'PPPoE' || prtcl == 'PPPoA' )
    //loc = 'wizppp.html';
    //else if ( auto == 1 )
    //loc = 'wizprtcl.html';
    //else
    //loc = 'wizbackdsl.cgi';
    loc = 'wizwan.html';
	var code = 'location="' + loc + '"';
	eval(code);
}

// done hiding -->
</script>
   </head>
<body OnLoad="frmLoad()">
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Wizard";
HelpItem="wizwl";
</script>
<script type='text/javascript'>
	mainTableStart();
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
<form>
	<table id=box_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				1 > 2 > 3 > Step 4: Configure Wireless Network > 5 > 6
			</td>
		</tr>
		<tr>
			<td class=content>
            Your wireless network is enabled by default. You can simply uncheck to disable it and click "Next"
             to skip configuration of wireless network.
            <TABLE class=formarea cellSpacing=0 cellPadding=0 summary=""  border=0>
             <TR>
             <TD class=form_label_50>Enable Your Wireless Network&nbsp;:</TD>
                <TD><INPUT type="checkbox" id=wlEnbl name='wlEnbl' onClick='wlClick(this)'></TD>
	    </TR>
	    	<TR>
				<TD colspan=2><P>Your wireless network needs a name so it can be easily recognized by wireless clients.For security purposes,it is highly
                            recommended to change the pre-configured network name.</P>
				</TD>
			  </TR>
              <TR>
                <TD class=form_label_50><div>Wireless Network Name (SSID)&nbsp;:</div></TD>
                <TD><INPUT type="text" id=SSID maxLength=32></TD>
	    </TR>
	    	<TR>
				<TD colspan=3><P>Select "Visible" to publish your wireless network and SSID can be found by wireless clients,
                            or select "Invisible" to hide your wireless network so that users need to manually enter SSID in order
                            to connect to your wireless network.</P>
				</TD>
		 </TR>
             <TR>

                <TD class=form_label_50><div>Visibility Status:</div></TD>
                <TD><INPUT type="radio" name='wlHide'>Visible
                <INPUT type="radio"  name='wlHide'>Invisible</TD>
	    </TR>

	    	    	<TR>
				<TD colspan=3><P>In order to protect your network from hackers and unauthorized users,it is highly recommended
                            you choose one of the following wireless network security settings.</P>
				</TD>
			  </TR>
<!--
<style type="text/css">
<!--
.abc {filter:progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FF0000', endColorStr='#FFACAD', gradientType='1')}
.def {filter:progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFACAD', endColorStr='#FFFFff', gradientType='1')}
.hij {filter:progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFff', endColorStr='#FFFFff', gradientType='1')}
#kk {width:600px;filter:progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FF0000', endColorStr='#FFFFff', gradientType='1');height:20px;}
-->
<!--
</style>

        <TR height="15">
          <TD  width="40%"  class="abc">&nbsp;None</TD>
          <TD  width="50%"  class="def">Security Level</TD>
	 <TD  width="10%"  class="hij">Best</TD>
       </TR>
-->
       <TR><TD colspan=2>
<IMG alt="" src="images/img_wlsecurity.jpg"></TD></TR>

<TR>
<!--
                <TD ><INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >None
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >WEP</TD>
                <TD><INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >WPA-PSK
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >WPA2-PSK</TD>
-->
   <TD colspan=2><INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >None
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

    <INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >WEP
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >WPA-PSK
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <INPUT type="radio" id='encryptType' name='encryptType' onClick='doLabelChange();' >WPA2-PSK</TD>
</TR>
  
			</table>

			<div id=keySecInfo>
			<TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 width=100%>
      <TR>
     <TD colspan=3><STRONG>Security Mode&nbsp;:&nbsp;</STRONG><Label id=lbMode name=lbMode></label></TD></TR>
     <TR>
      <TD colspan=3>Select this option if your wireless adapters support <Label id=lbsupportMode name=lbsuppportMode></label></TD><br>
     </TR>
  <!--
              <TR>
                <TD class=form_label>Encryption&nbsp;:</TD>
                <TD><SELECT onChange='doLabelChange();' id=encryptType>
					<OPTION value=0 selected>none</OPTION>
					<OPTION value=1>WEP 64 bit</OPTION>
					<OPTION value=2>WPA-PSK</OPTION>
					</SELECT>
				</TD>
		  </TR>
			
 	    	<TR>
				<TD colspan=2><BR>Now,please enter your wireless adapters support <Label id=lbnowMode name=lbnowtMode></label>
				</TD>
			  </TR>
-->				  
              <TR>
                <TD class=form_label><Label id=lblkey name=lblkey>WEP</label> Key&nbsp;:</TD>
                <TD><INPUT type=text id=encryptkey><Label id=lbllength name=lbllength></label>
				</TD>
			  </TR>
			</table>
            <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
			  <tr>
				<td colspan=2><p>Note: You will need to enter the same key on your wireless clients in order to enable a proper wireless connection.</p>
				</td>
			  </tr>
			</table>
			</div>
      		</td>
		</tr>
	</table>
<p align=center>
<input type='button' value="Back" onClick='btnBack()'>
<input type='button' value="Next" onClick='btnApply()'>
<input type='button' value="Cancel" onClick="btnReset()">
</p>
</form>
<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
</blockquote>
   </body>
</html>
