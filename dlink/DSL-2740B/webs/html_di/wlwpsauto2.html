<HTML><HEAD><TITLE>D-Link ADSL Router</TITLE>
<META http-equiv=Content-Type content="text/html">
<META http-equiv=Pragma content=no-cache><LINK 
href="stylemain.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript src="util.js"></SCRIPT>

<SCRIPT language=JavaScript src="menu.js"></SCRIPT>
<SCRIPT language=javascript>
<!-- hide

var WscStaPin = '<%ejGetWl(wlWscStaPin)%>';
var WscAvail  = '<%ejGetWl(wlWscAvail)%>';


var wlRefresh = '<%ejGetWl(wlRefresh)%>';
if ( wlRefresh == '1' ) {
   var code = 'location="wlwpscfgrefresh.wl?wlRefresh=0"';
   eval(code);   
}

var wizardssid = '<%ejGetWl(Wizardssid)%>';
var wizardmode = '<%ejGetWl(Wizardmode)%>';
var wizardkey = '<%ejGetWl(WizardKEY)%>';
var sessionKey='<%ejGetOther(sessionKey)%>';
function validateChecksum()
{
	var accum = 0;
	var temp;
	var pin =  document.forms[0].paWscStaPin.value
	
	if(isInvalidNumber(document.forms[0].paWscStaPin.value)||document.forms[0].paWscStaPin.value.length !=8)
		return false;
	
	for(i=0;i<8;i++)
	{
		temp = 1*pin.charAt(i);
		if(i%2 == 0)
			accum += 3*(temp%10);
		else 
			accum += 1*(temp%10);			
	}
	return (0 == (accum%10));	
	
}


function stPIN(){
	if (validateChecksum() == false)
	{
	alert("Invalid PIN number.");
	}
}
function frmLoad() {
   with ( document.forms[0] ) {
      paWscStaPin.value = WscStaPin;
	  raClientMethod[0].checked = true;
   }
}
function btnPrev(){
  var code = 'location="wlwps.html"';
  eval(code);
}

function btnConnect()
{
    var loc = 'wlwpscfg.wl?';
    loc += 'sessionKey=' + sessionKey;
    loc += '&wl_wsc_mode=enabled';
    loc += '&wsc_force_restart=y';
    loc += '&wsc_config_state=1';
    loc += '&wsc_proc_status=1';

    loc += '&wlSsid=' + encodeUrl(wizardssid);
    loc += '&wlAuthMode=psk2&wlWep=disabled&wlWpa=tkip+aes&wlPreauth=0&wlAuth=0';	
    loc += '&wlWpaPsk=' + encodeUrl(wizardkey);
    loc += '&wsc_apLockCap=1';

    if (document.forms[0].raClientMethod[0].checked == false)
    {
        loc += '&wlWscConfig=client-pbc&wl_wsc_reg=enabled';
        loc += '&wlWscStaPin=&wsc_event=a';
        loc += '&wsc_addER=0';
	}
    else
	{
        if (validateChecksum() == false)
        {
            alert("Invalid PIN number.");
            return;
		}
        loc += '&wlWscStaPin=' + encodeUrl(document.forms[0].paWscStaPin.value);	
		loc += '&wsc_addER=0&wsc_proc_status=0';
        loc += '&wsc_method=1';
        loc += '&wlWscConfig=client-pin';
        loc += '&wsc_config_command=1&wl_wsc_reg=enabled';	
    }
    var code = 'location="' + loc + '"';
    //send to server
    eval(code);		 
}

// done hiding -->
</SCRIPT>
</HEAD>
<BODY onload=frmLoad()>
<BLOCKQUOTE>
  <SCRIPT language=JavaScript>
TabHeader="Setup";
SideItem="Wireless Settings";
HelpItem="diwireless";
</SCRIPT>

  <SCRIPT type=text/javascript>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</SCRIPT>

 <FORM>
  <TABLE id=box_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>ADD WIRELESS DEVICE WITH WPS(WI-FI PROTECTED SETUP) WIZARD </TD></TR>
    <TR>
      <TD class=content>
        <P>This wizard is designed to assist you in connecting your wireless device
		to your router.It will guide you through step-by-step instructions on how to 
		get your wireless device connected.Click the button below to begin.</P></TD></TR></TBODY></TABLE>
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>Add Wireless Device with WPS(Wi-Fi Protected Setup) </TD></TR>
    <TR>
      <TD class=content>
        <P>There are two ways to add wireless device to your wireless network:</P>
		<P>- PIN (Personal Identification Number)</P>
		<P>- PBC (Push Button Configuration)</P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
		    <TD><INPUT id=wps_enable type="radio"  name='raClientMethod'></TD>
            <TD>PIN :<INPUT type="text"name="paWscStaPin"  ></TD>
			<TD>Please enter the PIN from your wireless device and click
			the below "Connect" button</TD>
			</TR>
			<TR>
		    <TD><INPUT id=wps_enable type="radio"  name='raClientMethod'></TD>
            <TD>PBC</TD>
			<TD>Please press the push button on your wireless device and
			press the "Connect" button below within 120 seconds</TD>
        </TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
  <P align=center><INPUT type=button value="Prev" onclick=btnPrev()>
  <INPUT onclick=btnConnect() type=button value="Connect"></P>
 </FORM>
  <SCRIPT type=text/javascript>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</SCRIPT>
</BLOCKQUOTE></BODY></HTML>
