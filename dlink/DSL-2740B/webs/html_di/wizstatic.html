<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
 <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide
var auto = '<%ejGet(enblAutoScan)%>';
var prtcl = 'IPoA';
var eMode = '<%ejGet(encapMode)%>';
var atmvpi = '<%ejGet(atmVpi)%>';
var atmvci = '<%ejGet(atmVci)%>';

//var dhcpClnt = '0';
//var addr = '<%ejGet(wanIpAddress)%>';
//var mask = '<%ejGet(wanSubnetMask)%>';
var addr = window.parent.frames[0].wizWanIp;
var mask = window.parent.frames[0].wizWanSubnetMask;
//var enblAuto = '1';
var gtwyIfc = '<%ejGet(wanIntfGateway)%>';
if ( gtwyIfc == '&nbsp' ) gtwyIfc = '';
//var gtwy = '<%ejGet(wanIntfGateway)%>';
var gtwy = window.parent.frames[0].wizWanGateway;
if ( gtwy == '&nbsp' ) gtwy = '';
//var dnsAuto = '1';
//var dns1 = '<%ejGetOther(sysInfo, dns)%>';
var dns1 = window.parent.frames[0].wizDns1;
if ( dns1 == '&nbsp' )
   dns1 = '';
//var dns2 = '<%ejGetOther(sysInfo, dns2)%>';
var dns2 = window.parent.frames[0].wizDns2;
if ( dns2 == '&nbsp' )
   dns2 = '';

function btnCancel(){

  //var code = 'location="wizcanceldsl.cgi"';
  var code = 'location="internet.html"';
  eval(code);

}

function btnNext(){
    //var loc = 'wizwl.cgi?';
    var loc = 'wizwl.html';

	with ( document.forms[0] ) 
	{
		//loc += 'atmVpi=' + atmvpi;
		//loc += '&atmVci=' + atmvci;
		//loc += '&atmServiceCategory=UBR';
		//loc += 'quickSetup=1';

		//loc += '&ntwkPrtcl=5';
		//loc += '&encapMode=' + eMode;

		//loc += '&enblAuto=0';
		//loc += '&enblDhcpClnt=0';   // static WAN address
		if ( isValidIpAddress(statip.value) == false ) 
		{
		   alert('WAN Ip address "' + statgw.value + '" is invalid.');
		   return;
		}

		if ( isValidSubnetMask(statmask.value) == false &&  statmask.value != '255.255.255.255') 
		{
			alert('WAN subnet mask "' + statmask.value + '" is invalid.');
			return;
		}
		  
		if ( isValidIpAddress(statgw.value) == false ) 
		{
		   alert('WAN default gateway "' + statgw.value + '" is invalid.');
		   return;
		}		
		
		var reIP, reSubnetMask;
		reIP = reencodeIP(statip.value);
		reSubnetMask = reencodeIP(statmask.value);
		if (statip.value != "" && statmask.value != "")
		{
			if (!DoValidateNetworkIP(reIP, reSubnetMask)) 
				return;
			if (!DoValidateIpRange(reIP,reSubnetMask)) 
				return;
		}	  
		//loc += '&wanIpAddress=' + reIP;
		//loc += '&wanSubnetMask=' + reSubnetMask;
		//loc += '&wanIntfGateway=' + statgw.value;
        window.parent.frames[0].wizWanIp = reIP;
        window.parent.frames[0].wizWanSubnetMask = reSubnetMask;
        window.parent.frames[0].wizWanGateway = statgw.value;
		
    if ( isValidIpAddress(dnsPrimary.value) == false ) {
          alert('Primary DNS "' + dnsPrimary.value + '" is invalid IP address.');
          return;
       }
    //loc += '&dnsPrimary=' + dnsPrimary.value;
    window.parent.frames[0].wizDns1 = dnsPrimary.value;
    if (dnsSecondary.value != '') {
      if ( isValidIpAddress(dnsSecondary.value) == false ) {
         alert('Secondary DNS "' + dnsSecondary.value + '" is invalid IP address.');
         return;
      }
      //loc += '&dnsSecondary=' + dnsSecondary.value;
      window.parent.frames[0].wizDns2 = dnsSecondary.value;
    }
    else
    {
      //loc +=  '&dnsSecondary=' + '0.0.0.0';	  	
      window.parent.frames[0].wizDns2 = '0.0.0.0';
    }
    //loc += '&dnsIfc=' + '';
    window.parent.frames[0].wizDnsIfc = '';
	}

	var code = 'location="'+ loc + '"';
	eval(code);
}

function btnPrev(){

  //var code = 'location="wizbackdsl.cgi"';
  var code = 'location="wizwan.html"';
  //if(auto == 1)
  	//code = 'location="wizprtcl.html"';
  eval(code);

}

function frmLoad(){

   	with ( document.forms[0] ) {

		statip.value = addr;
		statmask.value = mask;
		statgw.value = gtwy;
		dnsPrimary.value = dns1;
		dnsSecondary.value = dns2

	}

}
// done hiding -->
    </script>

<script language="JavaScript" src="menu.js"></script>
   </head>
<body onLoad='frmLoad()'>
<blockquote>
<script language="JavaScript">
TabHeader="Setup";
SideItem="Wizard";
HelpItem="setupInternet";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
<form>
	<table id=box_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				1 > 2 > Step 3: Setup Internet Connection > 4 > 5 > 6
			</td>										
		</tr>
		<tr>
			<td class=content>
            <P>You have selected Static IP Internet connection.  Please enter the appropriate information below as provided by your ISP.</P>
			<p>The Auto PVC Scan feature will not work in all cases so please enter the VPI/VCI numbers if provided by the ISP.</p>
			<p>Click Next to continue.</p>
			<p>
           	<TABLE class=formarea align=center width=100%>
				<tr>
					<td class=form_label align=right>IP Address&nbsp;:&nbsp;</>
					</td>
					<td><INPUT type=text id=statip name=statip>
				    </td>
				</tr>
				<tr>
					<td class=form_label align=right>Subnet Mask&nbsp;:&nbsp;</>
					</td>
					<td><INPUT type=text id=statmask name=statmask>
				    </td>
				</tr>
				<tr>
					<td class=form_label align=right>Default Gateway&nbsp;:&nbsp;</>
					</td>
					<td><INPUT type=text id=statgw name=statgw>
				    </td>
				</tr>
						</table>
				</br>
				   	<TABLE class=formarea align=center width=100%>
					<tr>
					<td class=form_label align=right>Preferred DNS server&nbsp;:&nbsp;</>
					</td>
					<td><INPUT type=text id=dnsPrimary  name="dnsPrimary">
				    </td>
				</tr>
				<tr>
					<td class=form_label align=right>Alternate DNS server:&nbsp;:&nbsp;</>
					</td>
					<td><INPUT type=text id=dnsSecondary name="dnsSecondary">
				    </td>
				</tr>
						</table>
			</p>
      		</td>
		</tr>
	</table>
			<p align=center><input type=button value='Back' onclick='btnPrev()'><input type=button value='Next' onclick='btnNext()'><input type=button value='Cancel' onclick='btnCancel()'></p>
<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
</form>
</blockquote>
   </body>
</html>
