<HTML><HEAD><TITLE>D-Link ADSL Router</TITLE>
<META http-equiv=Content-Type content="text/html">
<META http-equiv=Pragma content=no-cache><LINK 
href="stylemain.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript src="util.js"></SCRIPT>
<SCRIPT language=JavaScript src="menu.js"></SCRIPT>
<SCRIPT language=javascript>
<!-- hide

var tcpudpListenCnt = new Array(2);
var tcpudpListen = new Array(2);
tcpudpListenCnt[0] = 16;
tcpudpListen[0] = new Array(16);
tcpudpListen[0][0] = 80;
tcpudpListen[0][1] = 22;
tcpudpListen[0][2] = 23;
tcpudpListen[0][3] = 25;
tcpudpListen[0][4] = 161;
tcpudpListen[0][5] = 80;
tcpudpListen[0][6] = 8080;
tcpudpListen[0][7] = 80;
tcpudpListen[0][8] = 80;
tcpudpListen[0][9] = 80;
tcpudpListen[0][10] = 80;
tcpudpListen[0][11] = 5060;
tcpudpListen[0][12] = 4626;
tcpudpListen[0][13] = 139;
tcpudpListen[0][14] = 80;
tcpudpListen[0][15] = 80;
var tcpListenStr = '80, 22, 23, 25, 161, 80, 8080, 80, 80, 80, 80, 5060, 4626, 139, 80, 80';
tcpudpListenCnt[1] = 9;
tcpudpListen[1] = new Array(9);
tcpudpListen[1][0] = 33201;
tcpudpListen[1][1] = 5060;
tcpudpListen[1][2] = 1900;
tcpudpListen[1][3] = 138;
tcpudpListen[1][4] = 137;
tcpudpListen[1][5] = 520;
tcpudpListen[1][6] = 32768;
tcpudpListen[1][7] = 53;
tcpudpListen[1][8] = 8080;
var udpListenStr = '33201, 5060, 1900, 138, 137, 520, 32768, 53, 8080';
var forwardport = new Array();
var forwardport_cnt =0 ;
var errPort='Invalid port number input. Valid number should be 1~65535.';
var errVolume='Invalid volume selection.';


  
function stZrk(){
	top.frames[2].location.href = "usb_wftp_server.html";
}

var shareMaxNum = 0;
var volMaxNum = 0;
var mountMaxNum = 0;
var diskMaxNum = 0;
var prMaxNum = 0;

var ftpUerNum = '<%ej_get_ftp_number(usernum)%>';
var diskNum = '<%ejGet(disknum)%>';
var part_num = '<%ejGet(partitions)%>';
var disk_type =  '<%ejGet(disk_type)%>';
if (disk_type > '1')
	part_num -=1;
var drive_Info = '<%ejGet(vendor)%>' + '(<%ejGet(model)%>)';
var usb_ms_vendor = '<%ejGet(vendor)%>';
var usb_ms_model = '<%ejGet(model)%>';
var usb_ms_type = '<%ej_get_fs_type(type)%>';
var	volType = new Array();
var array = usb_ms_type.split('|');
var length = array.length - 1;
for (i=0;i<length; i++)
{
	volType[i]=array[i];
}

var wftpFunc='<%ejGet(wftpEnable)%>';
var http_browse_port = '<%ejGet(wftpPort)%>';
var wftp_index = '<%ejGet(wftp_index)%>';
if (http_browse_port == '0')
	http_browse_port = 8000;
var http_browse_remote = '<%ejGet(wftp_remote)%>';
var wftp_pathValue = '<%ejGet(wftp_path)%>';
var wftp_partition_value=1;
var wftp_disk_value=0;
var wftp_defaultPath='/iinet_usb';
var cpName = '';
var gpName = '';
cpName = 'IINET';
gpName = 'IINETGROUP';

tcpListenStr="80,";
for(i=0;i<tcpudpListen[0].length;i++)
{
if((tcpudpListen[0][i]!=http_browse_port)&& (tcpudpListen[0][i]!="80")&&(tcpListenStr.indexOf(tcpudpListen[0][i])<0))
tcpListenStr=tcpListenStr+tcpudpListen[0][i]+",";
}
var ForwardStr="";
for(i=0;i<forwardport_cnt;i++)
{
if(ForwardStr.indexOf(forwardport[i])<0)
ForwardStr=ForwardStr+forwardport[i]+",";
}

function getNum() {
	document.tF0.curPath.value = '/';
	if (document.tF0.wftp_partition.value != 99) {
		document.tF0.curPath.disabled = false;
	}
	else {
		document.tF0.curPath.disabled = true;
	}
}

var stri;
function getDISK() {
	var tmpSt, k4;
	var partNum;
	//var volType_name = "volType" + k4;
	k4 = document.tF0.disk_value.value;
	if (k4 == 99) partNum = -1;
	else partNum = part_num ;
	
	stri = '<select size="1" name="wftp_partition" onChange="getNum();">';
	stri += '<option value=99>-- Select Volume --</option>';
	if (partNum != -1) {
		for (j = 1 ; j <= partNum ; j++) {
			//if (wftpFunc == 0)
				//tmpSt = '';
		    if (j == wftp_index) 
				tmpSt = ' selected';
			else 
				tmpSt = '';
				stri += '<option value='+j+tmpSt+'>'+j+'. '+volType[j-1]+'</option>';
			//}
		}
	}	
    stri += '</select>';
    
	document.getElementById('keylen').innerHTML = stri;
}

function openBrowse() {
	var volIdx = document.tF0.wftp_partition.value;
	var dskIdx = document.tF0.disk_value.value;
	//var arg = volIdx * 1000 + '/' + dskIdx;
	var theURL
	if (part_num == '1')
		theURL = '/usb_wftp_tree.html';
	else
	 	theURL = '/usb_wftp_tree.cmd?index=' + document.tF0.wftp_partition.value;

	if ((dskIdx == 99) || (volIdx == 99)) {
		alert(errVolume);
		return false;
	}

	if (window.win && (window.win.closed == false)) {
		window.win.close();
	}

	browseIdx = 0;
	dev_Idx = document.tF0.wftp_partition.value;
	win = window.open(theURL,'tree','scrollbars=yes,resizable=no,width=600,height=508');
	return true;
}

function setFirstLoad() {
	document.tF0.curPath.value = wftp_pathValue;
	document.tF0.wftp_port.value = http_browse_port;
	if (http_browse_remote == 1) {
		document.tF0.remoteEnable.defaultChecked = true;
		document.tF0.remoteEnable.checked = true;
	}
	else {
		document.tF0.remoteEnable.defaultChecked = false;
		document.tF0.remoteEnable.checked = false;
	}
	if (document.tF0.wftp_partition.value != 99) {
		document.tF0.curPath.disabled = false;
	}
	else {
		document.tF0.curPath.disabled = true;
	}
}

function btnCancel(){
	var loc= 'usb_wftp_server.html';
    var code = 'location=\"' + loc + '\"';
    eval(code);
}

function evaltF() {
	var tport;
	var loc= 'websrv_cfg.cmd?action=save';
	
	if (document.tF0.wftpEnb.checked == false){
		loc += '&wftp_enable=0';
	}
	else {
		loc += '&wftp_enable=1';
	}

	if (document.tF0.remoteEnable.checked == false){
		loc += '&wftp_remote=0';
	}
	else {
		loc += '&wftp_remote=1';
	}
	// make sure volume index is valid
	if (document.tF0.wftp_partition.value == 99) {
		alert(errVolume);
		if (diskNum > 0) document.tF0.wftp_partition.focus();
		return false;
	}

	// check control port
	tport = document.tF0.wftp_port.value;
	if (isNValidPort(tport)) {
		alert(errPort);
		return false;
	}
	
	
	// check port duplicate
	//if ((tport != http_browse_port) || (wftpFunc == 0)) {
	if ((tport != http_browse_port)) {
		errStr = 'Following ports have been reserved for other system services:\n';
		if (tcpudpListenCnt[0] > 0) errStr = errStr + 'TCP: '+tcpListenStr+'\n';
		errStr = errStr + 'Please modify your port settings in the "Port Number" field.';
		for (j = 0 ; j < tcpudpListenCnt[0] ; j++) {
			if (tport == tcpudpListen[0][j]) {
				alert(errStr);
				return false;
			}
		}
		errStr = 'Following ports have been reserved for forwarding ports:\n';
		if (forwardport_cnt > 0) errStr = errStr +ForwardStr+'\n';
		errStr = errStr + 'Please modify your port settings in the "Port Number" field.';
		for (j = 0 ; j < forwardport_cnt ; j++) {
			if (tport == forwardport[j]) {
				alert(errStr);
				return false;
			}
		}
	}
	loc += '&port=' + document.tF0.wftp_port.value;
	
	if (document.tF0.curPath.value == '/'){
		loc += '&path=*';
	}
	else
		loc += '&path=' + document.tF0.curPath.value;
    //var code = 'location=\"' + loc + '\"';
	loc += '&index=' + document.tF0.wftp_partition.value;
	var code = 'location="' + loc + '"';
	//alert(code);
	eval(code);
}

function unloadHandler() {
	if (window.win && (window.win.closed == false)) window.win.close();
}

function focusHandler() {
	if (window.win && (window.win.closed == false)) window.win.focus();
}

 //done hiding -->
</SCRIPT>
<link rel="stylesheet" type="text/css" media="screen" href="wftp.css">
</HEAD>
<BODY onload="setFirstLoad()">
<BLOCKQUOTE>

<SCRIPT language=JavaScript>
TabHeader="Setup";
SideItem="USB Setup";
HelpItem="usb";
</SCRIPT>

<SCRIPT type=text/javascript>
mainTableStart();	
logo();
TopNav();
ThirdRowStart();
Write_Item_Images();
mainBodyStart();
</SCRIPT>

  <FORM name="tF0">
  <TABLE id=box_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>Web Server</TD></TR>
    <TR>
      <TD class=content>
        <P>
You could share your USB mass storage via HTTP protocol. After you enable this function 
		and configure all the necessary parameters, you could access your USB storage from the LAN
		side by typing the following URL into your web browser:
		<br><br>
		</P>
		</TD></TR></TBODY></TABLE>
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>USB Interface</TD></TR>
    <TR>
     <TD class=content>
        <P>
			
			</p>
			<table border="0" cellspacing="0" cellpadding="0">
		<tr>
			<td>
				<p class=normalText>http://(IP address):(port number).&nbsp;&nbsp;&nbsp;</p>
				<p class=normalText>http://(host name):(port number).</p>
				<p class=normalText>http://(IP address).</p>
				<p class=normalText>http://(host name).</p>
			</td>
			<td>
				<p class=normalText>ex: http://10.1.1.1:8000</p>
				<p class=normalText>ex: http://iinet.iad:8000</p>
				<script LANGUAGE="JavaScript">
					document.write('<p class=normalText>ex: http://10.1.1.1', wftp_defaultPath, '</p>');
					document.write('<p class=normalText>ex: http://iinet.iad', wftp_defaultPath, '</p>');
				</script>
			</td>
		</tr>
		</table>
		<br>If you would like to access the USB storage from the WAN side, you need to enable the "Remote Access" parameter and use WAN IP address to access the modems Web server.
		</p>
	</td>
</tr>
<tr>
	<td>
		<p class=normalText><input type="checkbox" name="wftpEnb" value=1>&nbsp;&nbsp;Enable Web Server function</p>
		<script LANGUAGE="JavaScript">
			if (wftpFunc == 1)
				document.forms[0].wftpEnb.checked = true;
			else
				document.forms[0].wftpEnb.checked = false;
		</script>
		<table border="0" cellspacing="1" cellpadding="5" width=80%>
		<tr>
			<td class=tdTitler>Volume</td>
			<td class=tdText>
				<SCRIPT language="javascript">
				if (diskNum > 0) {
					if (diskNum > 1) {
						document.write('<select size="1" name="disk_value" onChange="getDISK();">');
						document.write('<option value=99>-- Select Disk --</option>');
						for (k = 0 ; k < part_num ; k++) {
							if (k == 0) tmpS = ' selected';
							else tmpS = '';
							if (isBlank(usb_ms_type) == false)
								document.write('<option value='+k+tmpS+'>'+volType[k]+'</option>');
							else
								document.write('<option value='+k+tmpS+'>Mass storage '+(k+1)+'</option>');
						}
						document.write('</select>&nbsp;&nbsp;');
					}
					else {
						document.write(drive_Info+', ');
						document.write('<input type="hidden" name="disk_value" value=0>&nbsp;&nbsp;');
					}
					document.write('<span id="keylen"></span>');
					getDISK();
				}
				else {
					document.write('<font color=red>No USB Mass Storage device detected!</font>');
					document.write('<input type="hidden" name="disk_value" value=99>');
					document.write('<input type="hidden" name="wftp_partition" value=99>');
				}
				</SCRIPT>
			</td>
		</tr>
		<tr>
			<td class=tdTitler>Path</td>
			<td class=tdText>
				<input type="text" class="textbox_350vt_nb" name="curPath" maxlength=40 disabled>&nbsp;<input type="button" class="formsbutton" name="browseb" value="Browse" onclick="openBrowse()">
			</td>
		</tr>
		<tr>
			<td class=tdTitler>Port Number</td>
			<td class=tdText>
				<input type="text" class="textbox_100_nb" name="wftp_port" maxlength=5>
			</td>
		</tr>
		<tr>
			<td class=tdTitler>Remote Access</td>
			<td class=tdText>
				<input type="checkbox" name="remoteEnable" value=1>
			</td>
		</tr>
		</table>
	</td>
</tr>
<tr><td>
				<!--<P align=center><a href="javascript:document.forms[0].submit()" onClick="return evaltF();" class="button87b"><input type="button" class="formsbutton" name="savesetting" value="SAVE SETTINGS"></a>-->
				<!---<td><a href=''><input type="button" class="formsbutton" name="cancelb" value="CANCEL" onClick='btnCancel()'></P>-->
    <!--    <P align=center><INPUT onclick=atmcfg() type=button value="ATM Interface"></P>-->
		</TD></TR></TBODY></TABLE>
  <!--<TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>ETH interface</TD></TR>
    <TR>
      <TD class=content>
        <P>use ETH to configure you wan interface.</P>

          <P align=center><INPUT onclick=ethcfg() type=button value="ETH Interface"></P>
		  
         </TD></TR></TBODY></TABLE>-->
				<P align=center><INPUT onclick='evaltF()' type=button class="formsbutton"  name="savesetting" value="SAVE SETTINGS">
				<INPUT onclick='btnCancel()' type=button class="formsbutton"  name="cancelb" value="CANCEL"></P>		 
</FORM>
 <SCRIPT type=text/javascript>
mainBodyEnd();
ThirdRowEnd();
Footer()
mainTableEnd()
</SCRIPT>
</BLOCKQUOTE></BODY></HTML>
