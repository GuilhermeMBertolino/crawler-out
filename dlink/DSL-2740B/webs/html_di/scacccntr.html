<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
			<script language="JavaScript" src="menu.js"></script>
            <script language="javascript">
<!-- hide
var doEdit = false;
var editId;
var acccntrs = '<%ejGetAccCntr(acccntrs)%>';
var entrys = acccntrs.split(',');
var entryNum = entrys.length - 1;
var ethIp = '<%ejGet(ethIpAddress)%>';

function frmLoad()
{
    var mode = '<%ejGetAccCntr(mode)%>';
    with (document.forms[0])
	{
	    if(mode == '1')	
		    secAccCntrMode[1].checked = true;
	    else	
		    secAccCntrMode[0].checked = true;
    }
}

function applyClick() 
{
    if(doEdit == false)
	{
        var loc = 'scacccntr.cmd?action=add';
    }
    else
    {
        var loc = 'scacccntr.cmd?action=edit&editId=' + editId;
    }

    with ( document.forms[0] ) 
    {
        if ( isValidIpAddress(addr.value, "IP address") == false ) return;

        if (addr.value == ethIp)
        {
            var msg;
            msg ='IP address "'+ addr.value +'" should not be the same with the router IP address.';
            alert(msg);
			return;
		}

		for(i = 0; i < entryNum; i++)
		{
	  	    if(entrys[i] == addr.value)
            {
                var msg;
          	    msg ='IP address "'+ addr.value +'" already exists';
          	    alert(msg);
                return;
     	    }
        }
        loc += '&addr=' + addr.value;
    }
	
    var response = confirm("Only the IP addresses in the list will be able to access the Web GUI with enabled mode.");

    if(!response) return;   
    var code = 'location="' + loc + '"';
    eval(code);
}

function enable_checkbox(is_enable,is_edit)
{
	with ( document.forms[0] ) 
	{
		if (1 ==entryNum)
			{
				if (0 == is_enable)
					rml.disabled =true;
				else
					rml.disabled = false;
				if (0 == is_edit)
					rml.checked = false;
			}
		else
		{
			for (i = 0; i < entryNum; i++)
			{
				if (0 == is_enable)
					rml[i].disabled = true;
				else 
				    rml[i].disabled = false;
				if (0 == is_edit)
					rml[i].checked = false;

			}
		}
	}
}

function btnCancel(){
    with ( document.forms[0] ) {
		ipAddInfo.style.display = 'none';
		removeAccessIP.disabled = 0;
		addAccessIP.disabled = 0;
		editAccessIP.disabled = 0;
		enable_checkbox(1,1);
	}
}

function btnAdd(){
    with ( document.forms[0] ) {
		ipAddInfo.style.display = 'block';
		removeAccessIP.disabled = 1;
		addAccessIP.disabled = 1;
		editAccessIP.disabled = 1;
		addr.value = '';doEdit = false;
		enable_checkbox(0,0);
	}
}

function btnEdit(rml) {
  var checkedCount = 0 ;
	editId ='';
	var hasChecked = false;
with ( document.forms[0] ) {	
	if (rml){
		if (rml.length > 0){
			for (i = 0; i < rml.length; i++)
    	{
      		if(rml[i].checked == true)
      		{
				hasChecked = true;
        		checkedCount++;
        		addr.value = entrys[i];
				editId = entrys[i];
      		}
		}
		} else if ( rml.checked == true ){
			editId = entrys[0];
			hasChecked = true;
			addr.value = entrys[0];
		}
		    if (checkedCount > 1){
      alert ("Please select only one item to edit!");
      hasChecked = false;
      editId ='';
      return;
    }
	}

	if (!hasChecked) {
		alert ("Please select an item to edit!");
		return;
	}

    with ( document.forms[0] ) {
		ipAddInfo.style.display = 'block';
		removeAccessIP.disabled = 1;
		addAccessIP.disabled = 1;
		editAccessIP.disabled = 1;
		enable_checkbox(0,1);
	}
	doEdit = true; 
}
}

function btnRemove(rml) {
var lst = '';
var has_selected_items = false;
     with ( document.forms[0] ) {
     if (rml)
  {
	if (rml.length > 0)
    	for (i = 0; i < rml.length; i++) {
        	if ( rml[i].checked == true ){
				has_selected_items=true;
            	lst += rml[i].value + ', ';
			}
      	}
   	else if ( rml.checked == true ){
		has_selected_items=true;
      	lst = rml.value;
	}
	}
	}
	if (has_selected_items){
   		var loc = 'scacccntr.cmd?action=remove&rmLst=' + lst;
		var code = 'location="' + loc + '"';
   		eval(code);
	} else
		alert("There are no items to remove")
}

// done hiding -->
</script>
<!--<script language="JavaScript" src="menu.html"></script> -->
   </head>
<body  onLoad='frmLoad()'>

<blockquote>
         <form onsubmit="return false;">
<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Access Controls";
HelpItem="acip";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
	<table id=box_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Access Control -- IP Address
			</td>										
		</tr>
		<tr>
			<td class=content>
				<p>The IP Address Access Control mode, if enabled, permits access to local management services from IP addresses contained in the Access Control List. If the Access Control mode is disabled, the system will not validate IP addresses for incoming packets. The services are the system applications listed in the Service Control List.</p>
				<p>
				Enter the IP address of the management station permitted to access the local 
            management services, and click 'Apply.'</p>
				
			</td>
		</tr>
	</table>
<script language='javascript'>
<!-- hide

// done hiding -->
</script>
	<table id=body_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>Access Control -- IP Address
			</td>
		</tr>
		<tr>
			<td class=content>
<center>
<table border='0' cellpadding='4' cellspacing='0'>
   <tr>
      <td>Access Control Mode&nbsp;&nbsp;&nbsp;</td>
      <td><input type='radio' name='secAccCntrMode' onClick='modeClick()' checked>Disabled&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
      <td><input type='radio' name='secAccCntrMode' onClick='modeClick()'>Enabled</td>
   </tr>
</table>
<table class=formlisting>
   <tr class=form_label_row>
      <td class='form_label_col'>IP Address</td>
      <td class='form_label_col'>Select</td>
   </tr>
     <script language="javascript">   
  	 
   for(i = 0; i < entryNum; i++){
		document.writeln('<tr>');
		document.writeln('<td><div align=center>'+entrys[i]+'</div></td>');    
		document.writeln('<td><div align=center><input type=checkbox name=rml value='+entrys[i]+'></div></td>');
		document.writeln('</tr>');
   }
   
function modeClick()
{
    if(entryNum < 1)
    {
        with ( document.forms[0] )
        {
            if ( secAccCntrMode[1].checked == true )
            {
                alert('Cannot enable access control when its list is empty.');
                secAccCntrMode[0].checked = true;
            }
        }
    }
    else
    {
        var loc = 'scacccntr.cmd?action=save';
        with ( document.forms[0] )
        {
            if ( secAccCntrMode[0].checked == true )
            loc += '&secAccCntrMode=0';
            else
            loc += '&secAccCntrMode=1';
        }
        var code = 'location=\"' + loc + '\"';
        eval(code);
    }
}
      </script>    
</table><br>
</center>
</td>
	</tr>
</table>
<p align=center>
<input type='button' id='addAccessIP' name='addAccessIP' onClick='btnAdd()' value='Add'>&nbsp;
<input type='button' id='editAccessIP' name='editAccessIP' onClick='btnEdit(this.form.rml)' value='Edit' >&nbsp;
<input type='button' id='removeAccessIP' name='removeAccessIP' onClick='btnRemove(this.form.rml)' value='Delete'></p>

<div id=ipAddInfo style="display:none;">
	<table id=body_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				IP Address
			</td>										
		</tr>
		<tr>
			<td class=content>
  
            <br>            
            <table border="0" cellpadding="0" cellspacing="0">
               <tr>
                  <td width="80">IP Address:</td>
                  <td><input type='text' name="addr" size='15' maxlength='15'></td>
               </tr>
            </table>
      		</td>
		</tr>
	</table>
<p align=center><input type='button' onClick='applyClick()' value='Apply'>
<input type='button' onClick='btnCancel()' value='Cancel'></p>
</div>
<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
         </form>
      </blockquote>
   </body>
</html>
