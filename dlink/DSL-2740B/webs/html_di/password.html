<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
	     <script language="JavaScript" src="menu.js"></script>
            <script language="javascript">
<!-- hide

var pwdAdmin = '<%ejGet(adminPassword)%>';
var pwdSupport = '<%ejGet(sptPassword)%>';
var pwdUser = '<%ejGet(usrPassword)%>';
var ethIp = '<%ejGet(ethIpAddress)%>';
var captchaEnbl='<%ejGet(captchaEnbl)%>';

function btnApply() {
   var loc = 'password.cgi?';

   with ( document.forms[0] ) {
      var idx = userName.selectedIndex;
      switch ( idx ) {
         case 0:
            alert("No username is selected.");
            return;
         case 1:
            if ( pwdOld.value == pwdAdmin )
               break;
            else {
               alert("Old admin password is wrong.");
               return;
            }
         case 2:
            if ( pwdOld.value == pwdSupport )
               break;
            else {
               alert("Old support password is wrong.");
               return;
            }
         case 3:
            if ( pwdOld.value == pwdUser )
               break;
            else {
               alert("Old user password is wrong.");
               return;
            }
      }

      if ( pwdNew.value != pwdCfm.value ) {
         alert("The passwords do not match.");
         return;
      }

      var str = new String();
      str = pwdNew.value;
	  /* Password can set special symbol
	  if (!isValidPassword(str)){
         alert('Password should not be the special characters.');
		 return;
	  }*/
//       /*20090209, Rob, Change it from 16 to 12*/
//         if (str.length > 16)
//         {
//             alert('Password should not be longer than 16 characters.');
//             return ;
//         }
	/*20110420, yocheng, data model define admin account's password length to 16 and maintance->Access Control->admin can set 16 length password, so here modified the limitation from 12 to 16.*/
        if (str.length > 16)
        {
            alert('Password should not be longer than 16 characters.');
            return ;
        }
	/*20090209, Rob, Should not be shoter than 4*/
	 if (str.length < 4)
        {
            alert('Password should not be shorter than 4 characters.');
            return ;
        }
	  if ( str.length == 0 ) {
         alert('Password should not be empty.');
         return;
      }
      if ( str.indexOf(' ') != -1 ) {
         alert('Password cannot contain a space.');
         return;
      }

      switch ( idx ) {
         case 2:
            loc += 'sptPassword=' + encodeUrl(pwdNew.value);
            break;
         case 3:
            loc += 'usrPassword=' + encodeUrl(pwdNew.value);
            break;
         default:
            loc += 'adminPassword=' + encodeUrl(pwdNew.value);
            break;
      }
      var code = 'location="' + loc + '"';
      eval(code);
   }
}

function frmLoad(){
    with ( document.forms[0] ) 
    {
		if(captchaEnbl == '1')
			captchaEnable.checked = true;
		else
			captchaEnable.checked = false;
    }
}

function CapApply()
{
    var loc="captcha.cgi?";
    
    with ( document.forms[0] ) 
    {
    	if(captchaEnable.checked == true)
            loc += 'captchaEnbl=1';
		else
            loc += 'captchaEnbl=0';
    }
    var code = 'location.assign("'+ loc + '")';
    eval(code);
}

function btnCancel(){
   var loc = 'password.html';
   var code = 'location="' + loc + '"';
   eval(code);
}
// done hiding -->
</script>
<!--<script language="JavaScript" src="menu.html"></script> -->
   </head>
<body onload=frmLoad()>

<blockquote>
<script language="JavaScript">
TabHeader="Maintenance";
SideItem="Access Controls";
HelpItem="acadmin";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
	<table id=box_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Access Control -- Passwords
			</td>										
		</tr>
		<tr>
			<td class=content>
				<p>
				Access to your DSL Router is controlled through three user accounts: admin,
            support, and user.</p>
				<p>The user name "support" is used to allow an ISP technician to access your
            DSL Router for maintenance and to run diagnostics.</p>
				<p>The user name "user" can access the DSL Router, view configuration settings
            and statistics, as well as, update the router's firmware.</p>
				<p>Use the fields below to enter up to 16 characters
            and click "Apply" to change or create passwords. Note: Password cannot contain a space.</p>
				
			</td>
		</tr>
	</table>
	<table id=body_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Administrator Settings
			</td>										
		</tr>
		<tr>
			<td class=content>

<form id="form1" name="form1" method="post" action=password.cgi>
            <table border="0" cellpadding="0" cellspacing="0">
               <tr>
                  <td width="120">Username:</td>
                  <td><select name='userName' size="1">
                        <option value="0">(Click to Select)</option>
                        <option value="1">admin</option>
                        <option value="2">support</option>
                        <option value="3">user</option>
<!--
                        <option value="4">
                        <option value="5">
-->                        
                     </select></td>
               </tr>
               <tr>
                  <td>Old Password:</td>
                  <td><input name='pwdOld' type="password" size="20" maxlength="17"></td>
               </tr>
               <tr>
                  <td>New Password:</td>
                  <td><input name='pwdNew' type="password" size="20" maxlength="17"></td>
               </tr>
               <tr>
                  <td>Confirm Password:</td>
                  <td><input name='pwdCfm' type='password' size="20" maxlength="17"></td>
               </tr>
            </table>
      		</td>
		</tr>
	</table>
<p align=center><input type='button' onClick='btnApply()' value='Apply'><input type='button' onClick='btnCancel()' value='Cancel'></p>

  <TABLE id=body_header cellSpacing=0 width=690 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>GRAPHIC LOG-IN AUTHENTICATION (CAPTCHA)</TD></TR>
    <TR>
      <TD class=content>
        <P>To enhance your router login security.</P>
        <table border="0" cellpadding="0" cellspacing="0">
          <TBODY>
           <TR>
            <TD width="120" class=form_label>Enable CAPTCHA:</TD>
            <TD><INPUT type=checkbox name='captchaEnable' id='captchaEnable'></TD></TR>
         </TBODY></TABLE></TD></TR></TBODY></TABLE>
        <TABLE cellSpacing=0 cellPadding=0 border=0>
          <TBODY>
          <br>
          </TBODY>  
         </TABLE>
  <P align=center><INPUT onclick="CapApply()" type=button value="Apply"><INPUT onclick="btnCancel()" type=button value=Cancel></P>
         </form>
<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
</blockquote>
   </body>
</html>
