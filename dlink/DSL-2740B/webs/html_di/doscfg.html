<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide

function hideDOSInfo(hide) {
   var status = false;

   if ( hide == 1 )
      status = true;
   changeBlockState('dosInfo',status);
}

var rate_default = 8;
var burst_default = 10;

function dosClick(cb) {
   with ( document.forms[0] ) {

   if (cb.checked == true){
      hideDOSInfo(0);
	  tcprate.value = rate_default;
	  tcpburst.value = burst_default;
	  icmprate.value = rate_default;
	  icmpburst.value = burst_default;
	  pscanrate.value = rate_default;
	  pscanburst.value = burst_default;
	  
   } else {
      hideDOSInfo(1);
	  tcprate.value = '';
	  tcpburst.value = '';
	  icmprate.value = '';
	  icmpburst.value = '';
	  pscanrate.value = '';
	  pscanburst.value = '';
	}
   }
}


function btnApply() {
   var loc = 'scfwcfg.cmd?dos_enabled=';

   with ( document.forms[0] ) {
      if (dosEnabled.checked ) {
         loc += '1';
		 if(tcprate.value == '' && icmprate.value == '' && pscanrate.value == '')
		 {
		   alert('At least one of TCP DoS, Ping DoS and Port Scan must be specified.');
           return;	
		 }
		 
		 if(tcprate.value != '')
		 {
	         if ( isNaN(tcprate.value) == true || tcprate.value < 1 || tcprate.value > 999) {
	           alert('TCP Rate value "' + tcprate.value + '"is out of range. [1-999].');
	           return;
	         }
	         
	         if ( isNaN(tcpburst.value) == true || tcpburst.value < 1 || tcpburst.value > 999) {
	           alert('TCP Burst value "' + tcpburst.value + '"is out of range. [1-999].');
	           return;
	         }
	         
		 }
		 else
		 {
		 	tcprate.value = 0;
	  		tcpburst.value = 0;
		 }
		 if(icmprate.value != '')
		 {
			 if ( isNaN(icmprate.value) == true || icmprate.value < 1 || icmprate.value > 999) {
	           alert('ICMP Rate value "' + icmprate.value + '"is out of range. [1-999].');
	           return;
	         }
	         
	         if ( isNaN(icmpburst.value) == true || icmpburst.value < 1 || icmpburst.value > 999) {
	           alert('ICMP Burst value "' + icmpburst.value + '"is out of range. [1-999].');
	           return;
	         }
	         
		 }
		 else
		 {
		 	icmprate.value = 0;
	  		icmpburst.value = 0;
		 }
		 if(pscanrate.value != '')
		 {
	         if ( isNaN(pscanrate.value) == true || pscanrate.value < 1 || pscanrate.value > 999) {
	           alert('Port Scan Rate value "' + pscanrate.value + '"is out of range. [1-999].');
	           return;
	         }
	         
	         if ( isNaN(pscanburst.value) == true || pscanburst.value < 1 || pscanburst.value > 999) {
	           alert('Port Scan Burst value "' + pscanburst.value + '"is out of range. [1-999].');
	           return;
	         }
	         
		 }
		 else
		 {
		 	pscanrate.value = 0;
	  		pscanburst.value = 0;
		 }
		 loc += '&tcpburst='+tcpburst.value;
		 loc += '&tcprate='+tcprate.value;
		 loc += '&icmprate='+icmprate.value;
		 loc += '&icmpburst='+icmpburst.value;
		 loc += '&pscanrate='+pscanrate.value;
		 loc += '&pscanburst='+pscanburst.value;
         loc += '&ipspoofing=';
         if (ipspoofing.checked )
           loc += '1';
         else
           loc += '0';	  
      }
      else {
         loc += '0';
      }
   }
   var code = 'location.assign("' + loc + '")';
   eval(code);
}



function frmLoad() {
   with ( document.forms[0] ) {
   	var fwDos = '<%ejGetFw(fwDos)%>';
	//var fwDos = '1|1|11|11|11|11|11|11|';
   	var dos = fwDos.split('|');
      var dosEnable = dos[0];
      var ipspoof = dos[1];

      if ( dosEnable == '1' ) {
         dosEnabled.checked = true;         
         hideDOSInfo(0);
      } else {
         dosEnabled.checked = false;
         hideDOSInfo(1);
      }
	
      tcprate.value = dos[2];
      tcpburst.value = dos[3];
      icmprate.value = dos[4];
      icmpburst.value = dos[5];
      pscanrate.value = dos[6];
      pscanburst.value = dos[7];
      if(tcprate.value=='0') tcprate.value='';
	if(tcpburst.value=='0') tcpburst.value='';
	if(icmpburst.value=='0') icmpburst.value='';
	if(icmprate.value=='0') icmprate.value='';
	if(pscanburst.value=='0') pscanburst.value='';
	if(pscanrate.value=='0') pscanrate.value='';
      if ( ipspoof == '1' )
         ipspoofing.checked = true;
      else
         ipspoofing.checked = false;
   }
}

function btnCancel(){
   var loc = 'doscfg.html';

   var code = 'location="' + loc + '"';

   eval(code);

}

// done hiding -->
</script>
      <script language="JavaScript" src="menu.js"></script>
   </head>
<body onLoad='frmLoad()'>
<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Firewall Settings";
HelpItem="dos";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
<form>
	<table id=box_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Firewall Settings
			</td>										
		</tr>
		<tr>
			<td class=content>				
        <p>    Click "Apply" button to make the changes effective immediately.</p>				
			</td>
		</tr>
	</table>
	<table id=body_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Firewall Configuration
			</td>										
		</tr>
		<tr>
			<td class=content>

            <table border="0" cellpadding="0" cellspacing="5" class=formarea>
               <tr>
                  <td class=form_label><input class=INPUT_rightMinus1 type='checkbox' name='dosEnabled' id='dosEnabled' onclick='dosClick(this)'></td>
                  <td colspan="2"><label for=dosEnabled><b>Enable Attack Prevention</b></label></td>
               </tr>
            </table>
            <div id='dosInfo'>
               <table border="0" cellpadding="0" cellspacing="0" class=formarea>
                  <tr>
                     <td class=form_label>Type</td>
                     <td align=center>Rate(pkt/sec)</td>
                     <td align=center>Burst</td>
                  </tr>
                  <tr>
                  	<td class=form_label>TCP DoS&nbsp;:</td>
                  	<td ><input type='text' name='tcprate' size='8' maxlen='4'></td>
                  	<td ><input type='text' name='tcpburst' size='8' maxlen='4'></td>
                  </tr>	
                  <tr>
                  	<td class=form_label>Ping DoS&nbsp;:</td>
                  	<td ><input type='text' name='icmprate' size='8' maxlen='4'></td>
                  	<td ><input type='text' name='icmpburst' size='8' maxlen='4'></td>
                  </tr>	
                  <tr>
                  	<td class=form_label>Port Scan&nbsp;:</td>
                  	<td ><input type='text' name='pscanrate' size='8' maxlen='4'></td>
                  	<td ><input type='text' name='pscanburst' size='8' maxlen='4'></td>
                  </tr>
				  <tr>
					<td></td>
					<td></td>
					<td></td>
				  </tr>	
                  <tr>
					 <td class=form_label><label for=ipspoofing>Prevent IP Spoofing&nbsp;:</label></td>
                     <td align=left><input type='checkbox' name='ipspoofing' id='ipspoofing' class=INPUT_lefMinus4></td>
                     <td></td>
                  </tr>	
               </table>
               <br>
               <table>

               </table>
            </div>
            <br>
			</td>										
		</tr>
	</table>
<p align=center><input type='button' onClick='btnApply()' value='Apply'><input type='button' onClick='btnCancel()' value='Cancel'></p>
         </form>

<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
</blockquote>
   </body>
</html>
