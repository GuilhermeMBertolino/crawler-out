<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
			<script language="JavaScript" src="menu.js"></script>
            <script language="javascript">

<!-- hide

var ssidIdx = '<%ejGetWl(wlSsidIdx)%>';
var ssid_2 = '<%ejGetWl(wlSsid_wl0v1)%>';
var enbl_2 = '<%ejGetWl(wlEnbl_wl0v1)%>';
var hide_2 = '<%ejGetWl(wlHide_wl0v1)%>';
var apisolation_2 = '<%ejGetWl(wlAPIsolation_wl0v1)%>';
var wl11Mode = '<%ejGetWl(wl11Mode)%>';
var enbl = '<%ejGetWl(wlEnbl_wl0v0)%>';
var country = '<%ejGetWl(wlCountry)%>';
var channel = '<%ejGetWl(wlChannel)%>';
var rate = '<%ejGetWl(wlRate)%>';
var frg = '<%ejGetWl(wlFrgThrshld)%>';
var rts = '<%ejGetWl(wlRtsThrshld)%>';
var dtm = '<%ejGetWl(wlDtmIntvl)%>';
var bcn = '<%ejGetWl(wlBcnIntvl)%>';
var phy = '<%ejGetWl(wlPhyType)%>';
var brate = '<%ejGetWl(wlBasicRate)%>';
//var fburst = '<%ejGetWl(wlFrameBurst)%>';
var gmode = '<%ejGetWl(wlgMode)%>';
var pro = '<%ejGetWl(wlProtection)%>';
var pre = '<%ejGetWl(wlPreambleType)%>';
var band= '<%ejGetWl(wlBand)%>';
var mcastrate = '<%ejGetWl(wlMCastRate)%>';
var hasafterburner = '<%ejGetWl(wlHasAfterburner)%>';
var afterburneren = '<%ejGetWl(wlAfterBurnerEn)%>';
var bands = '<%ejGetWl(wlBands)%>';
var mode = '<%ejGetWl(wlMode)%>';
var wlRefresh = '<%ejGetWl(wlRefresh)%>';
var TxPwrPcnt = '<%ejGetWl(wlTxPwrPcnt)%>';
var reg_mode = '<%ejGetWl(wlRegMode)%>';
var dfs_preism = '<%ejGetWl(wlDfsPreIsm)%>';
var dfs_postism = '<%ejGetWl(wlDfsPostIsm)%>';
var tpcDb = '<%ejGetWl(wlTpcDb)%>';
var wme = '<%ejGetWl(wlWme)%>';
var wlCurrentChannel = '<%ejGetWl(wlCurrentChannel)%>';
var csscantimer = '<%ejGetWl(wlCsScanTimer)%>';
var nctrlsb = '<%ejGetWl(wlNCtrlsb)%>';
var corerev = '<%ejGetWl(wlCoreRev)%>';
var npro = '<%ejGetWl(wlNProtection)%>';
var nmcsidx = '<%ejGetWl(wlNMcsidx)%>';
var chanspec = '<%ejGetWl(wlCurrentChSpec)%>';
var nmode = '<%ejGetWl(wlNmode)%>'; 
var nreqd = '<%ejGetWl(wlNReqd)%>'; 
var wmenoack= '<%ejGetWl(wlWmeNoAck)%>';
var wmeapsd= '<%ejGetWl(wlWmeApsd)%>';
var nbwcap= '<%ejGetWl(wlNBwCap)%>'; 
var haswme= '<%ejGetWl(wlHasWme)%>';

var curr_bw_str = "";


var curr_bw_str = "";


var wlmode = '<%ejGetWl(wlAuthMode_wl0v1)%>';
var wlwep = '<%ejGetWl(wlWep_wl0v1)%>';
var bit = '<%ejGetWl(wlKeyBit_wl0v1)%>';
var keys = new Array( "<%ejGetWl(wlKey1_wl0v1)%>", "<%ejGetWl(wlKey2_wl0v1)%>",
                      "<%ejGetWl(wlKey3_wl0v1)%>", "<%ejGetWl(wlKey4_wl0v1)%>" );
var keyIdx = '<%ejGetWl(wlKeyIndex_wl0v1)%>';

var wpaGTKRekey = '<%ejGetWl(wlWpaGTKRekey_wl0v1)%>';
var wpaPskKey = '<%ejGetWl(wlWpaPsk_wl0v1)%>';
var varNetReauth = '<%ejGetWl(wlNetReauth_wl0v1)%>';
var radiusServerIP = '<%ejGetWl(wlRadiusServerIP_wl0v1)%>';
var radiusPort = '<%ejGetWl(wlRadiusPort_wl0v1)%>';
var radiusKey = '<%ejGetWl(wlRadiusKey_wl0v1)%>';

var wpa = '<%ejGetWl(wlWpa_wl0v1)%>';
var auth = '<%ejGetWl(wlAuth_wl0v1)%>';
var obsscoex = '<%ejGetWl(wlObssCoex)%>';

var wl_switch = '<%ejGetWl(wireless_switch)%>';
var sessionKey='<%ejGetOther(sessionKey)%>';
var atheDriverWireless='<%ejGet(atheDriverWireless)%>';

if ( wlRefresh == '1' ) {
   var code = 'location="wlcfgadvrefresh.wl?wlRefresh=0"';
   eval(code);   
}
  

function issupport11n(country)
{
	var support11ncountrys='AR.AU.AT.BD.BE.BR.BG.CA.CL.CN.CO.CR.HR.CY.CZ.DK.EC.EG.EE.FI.FR.GF.DE.GR.HK.';
	support11ncountrys += 'HU.IS.IN.ID.IE.IT.JM.JP.JP1.JO.LV.LI.LT.LU.MY.MT.MX.MA.NL.NZ.NO.PK.PA.PE.PH.';
	support11ncountrys += 'PL.PT.PR.RO.SA.SG.SK.SI.ZA.ES.LK.SE.CH.TW.TR.AE.GB.US.US2.US3.US4.Q1.UY.VE.VN.X0.';
	var idx = support11ncountrys.indexOf(country);
	//alert(idx);
	if (phy !="n")  return;
  
	if ( idx == -1 ){
		document.forms[0].wlNBwCap.disabled = 1;
                document.forms[0].wlBand.disabled = 1;
		setSelect(document.forms[0].wlNBwCap, 0);
		return 1;
		
	}else{
		document.forms[0].wlNBwCap.disabled = 0;
                document.forms[0].wlBand.disabled = 0; 
                return 0; 
        }

}

 
function getGmodeIndex(mode) {
   var ret = 0;
   switch(mode) {
   case '0':
      ret = 3;
      break;
   case '4':
      ret = 1;
      break;
   case '5':
      ret = 2;
      break;
   default:
      ret = 0;
      break;
   }
   return ret;
}

function getNmodeIndex(mode) {
   var ret = 0;
   switch(mode) {
   case "off":
      ret = 1;
      break;
   case "auto":
   default:
      ret = 0;
      break;
   }
   return ret;
}

function genericChange(OnPageLoad) {

   with ( document.forms[0] ) {    
      if(OnPageLoad) { 
         wlRate.selectedIndex = getRateIndex(rate);
         wlMCastRate.selectedIndex = getRateIndex(mcastrate);
         wlBasicRate.selectedIndex = getBasicRateIndex(brate);
         //wlFrameBurst.selectedIndex = getFrameBurstIndex(fburst);
         wlFrgThrshld.value = frg;
         wlRtsThrshld.value = rts;
         wlDtmIntvl.value = dtm;
         wlBcnIntvl.value = bcn;
         wlObssCoex.value = obsscoex;
        // wlGlobalMaxAssoc.value = globalmaxassoc;
         //wlCsScanTimer.value = csscantimer;         
         wlTxPower.selectedIndex = ((TxPwrPcnt/20) -1);
         wlRegMode.selectedIndex = reg_mode;
         wlDfsPreIsm.value = dfs_preism;
         wlDfsPostIsm.value = dfs_postism;
         wlTpcDb.selectedIndex = getTpcDbIndex(tpcDb);
         /* preamble */
         if ( pre == 'short' )
            wlPreambleType.selectedIndex = 1;
         else
            wlPreambleType.selectedIndex = 0;                                           
      }      
   }
}

function gModeChange(OnPageLoad) {

   var sel_band;
   var sel_gmode;
   var sel_pro;
   var sel_pre;
   var sel_nmode;
           
   /* save selected */   
   if(OnPageLoad) {      
      sel_band = band;
      sel_gmode = gmode;
      sel_pro = pro;
      sel_nmode = nmode;
   } else {
      sel_band = document.forms[0].wlBand.value;
      sel_gmode = document.forms[0].wlgMode.value; 
      sel_pro = document.forms[0].wlProtection.value;
      sel_nmode = document.forms[0].wlNmode.value;      
   }

   with ( document.forms[0] ) {
      showhide("preambleType", 0);
      wlProtection.selectedIndex = getGModeProtection(sel_pro);                                      
      
      if (phy == "n" && sel_nmode != "off") {
         showhide("div_gMode", 0);
      } else {
         switch(sel_gmode) {
            case '0':
               showhide("preambleType", 1);         
               wlgMode.selectedIndex = 3;
               break;
            case '4':
               wlgMode.selectedIndex = 1;
               break;
            case '5':
               wlgMode.selectedIndex = 2;
               break;
            case '2':
               wlgMode.selectedIndex = 4;
               break;
            default:
               wlgMode.selectedIndex = 0;
               showhide("preambleType", 1);            
               break;
         }        
         if (sel_band == "2") {
           if (phy == "b") { //11b
             showhide("div_gMode", 0);
           }
           else { //11g
             showhide("div_gMode", 1);            
           }
         }
         else { //11a
           showhide("div_gMode", 0);
           showhide("preambleType", 0);    
         }        
      }           
   }
}

function wlLoadCountryList(OnPageLoad)
{
   var sel = 0;
   var idx;
   
   /* save selected */           
   if(OnPageLoad) {         
      sel = country;      
   } else {
      sel = document.forms[0].wlCountry.options[document.forms[0].wlCountry.selectedIndex].value;            
   }
   
   /* load list */
   if (band == "1") { // 5G
      <%ejGetWl(wlCountryList, a)%>
   } else {
      <%ejGetWl(wlCountryList, b)%>
   }

   /* mark selected */         
   for (idx=0; idx < document.forms[0].wlCountry.options.length; idx++) {
      if (document.forms[0].wlCountry.options[idx].value == sel) {
         document.forms[0].wlCountry.options[idx].selected = true;
         break;
      }
   }
   
   /* set to all(the last one) if not found */
   if( idx == document.forms[0].wlCountry.options.length)   
      document.forms[0].wlCountry.options[idx-1].selected = true;
}

function loadChannelList(OnPageLoad)
{
   var sel_ch;
   var sel_band;
   var sel_nbw_cap;
   var sel_sb;
   var idx;
      
   /* save selected */   
   if(OnPageLoad) {      
      sel_ch = channel;
      sel_band = band;
      sel_nbw_cap = nbwcap;
      sel_sb = nctrlsb;
   } else {
      sel_ch = document.forms[0].wlChannel.value;
      sel_band = document.forms[0].wlBand.value;
      sel_nbw_cap = document.forms[0].wlNBwCap.value;
      //sel_sb = document.forms[0].wlNCtrlsb.value;
	  sel_sb = nctrlsb;
   }
   
   /* load list */
   document.forms[0].wlChannel.length = 0;
	      
   if ((sel_band == "2") && (phy != "n") ) {
      <%ejGetWl(wlChannelList, b)%>
   }
   else  if ((sel_band == "1") && (phy != "n")) {
      <%ejGetWl(wlChannelList, a)%>
   }
   else  if ((sel_band == "2") && (phy == "n") ) { 
      if(sel_nbw_cap == "1") {
         if(sel_sb == 1) {
            <%ejGetWl(wlChannelList, n, b, 40, "upper")%>
         } else {
            <%ejGetWl(wlChannelList, n, b, 40, "lower")%>         
         }

         var Length11='AS.OB.CA.KY.GU.PR.TW.US.Q2.UM.VI.X0.XW';		 
		 var idx11 = Length11.indexOf(country);
		 var currlength = 13;
		 if ( idx11 != -1 ){
		   currlength = 11;
		 }
		 if (currlength <  document.forms[0].wlChannel.length - 1){
		    document.forms[0].wlChannel.length = currlength + 1;
         }
		 else if (currlength > document.forms[0].wlChannel.length - 1){

		  	document.forms[0].wlChannel[5] = new Option("5", "5");
		  	document.forms[0].wlChannel[6] = new Option("6", "6");
            		document.forms[0].wlChannel[7] = new Option("7", "7");
		  	document.forms[0].wlChannel[8] = new Option("8", "8");
            		document.forms[0].wlChannel[9] = new Option("9", "9");
		  	document.forms[0].wlChannel[10] = new Option("10", "10");
            		document.forms[0].wlChannel[11] = new Option("11", "11");
		  	document.forms[0].wlChannel[12] = new Option("12", "12");
            		document.forms[0].wlChannel[13] = new Option("13", "13");
		 }
            
      } else if(sel_nbw_cap == "0" || sel_nbw_cap == "2"){      
         <%ejGetWl(wlChannelList, n, b, 20 )%>
      }         
   }
   else  if ((sel_band == "1") && (phy == "n") ) {    
      if(sel_nbw_cap == "1" || sel_nbw_cap == "2") {
         if(sel_sb == 1) {
            <%ejGetWl(wlChannelList, n, a, 40, "upper")%>
         } else {
            <%ejGetWl(wlChannelList, n, a, 40, "lower")%>         
         }  
      } else if (sel_nbw_cap == "0") {
         <%ejGetWl(wlChannelList, n, a, 20 )%>
      }         
   }      
   else {
      document.forms[0].wlChannel[0] = new Option("Auto", "0")
   }
         
   /* mark selected */
   for (idx=0; idx<document.forms[0].wlChannel.options.length; idx++) {
      if (document.forms[0].wlChannel.options[idx].value == sel_ch) {
         document.forms[0].wlChannel.options[idx].selected = true;
         break;
      }
   }
   
   /* set to first channel none-auto if not found */   
   if (idx == document.forms[0].wlChannel.options.length) {
      document.forms[0].wlChannel.options[1].selected = true;
   }
   
   with ( document.forms[0] ) {
      if( wlChannel.selectedIndex != 0 ) {
         //wlCsScanTimer.disabled=true;         
      } else {
         //wlCsScanTimer.disabled=false;         
      }
   }   
}

function loadRateList(OnPageLoad) {
   var sel_band;
   var sel_rate;
   var idx;
   var sel_nmode;
   var sel_gmode;
         
   /* save selected */
   if(OnPageLoad) {
      sel_band = band;
      sel_rate = rate;
      sel_nmode = nmode;
      sel_gmode = gmode;
   }
   else {
      sel_band = document.forms[0].wlBand.value;
      sel_rate = document.forms[0].wlRate.value;
      sel_nmode = document.forms[0].wlNmode.value;
      sel_gmode = document.forms[0].wlgMode.value;
   }

   if(phy != "n") sel_nmode = "off";

   document.forms[0].wlRate.length = 0;
               
   if (sel_band == "2") { // 2.4G
      if (phy == "b" || 
          (country == "JP" && document.forms[0].wlChannel.value == 14) ||
          (sel_nmode == "off" && sel_gmode == "0")) {
document.forms[0].wlRate[0] = new Option("Auto", "0");
document.forms[0].wlRate[1] = new Option("1 Mbps", "1000000");
document.forms[0].wlRate[2] = new Option("2 Mbps", "2000000");
document.forms[0].wlRate[3] = new Option("5.5 Mbps", "5500000");
document.forms[0].wlRate[4] = new Option("11 Mbps", "11000000");
      }
      else {
document.forms[0].wlRate[0] = new Option("Auto", "0");
document.forms[0].wlRate[1] = new Option("1 Mbps", "1000000");
document.forms[0].wlRate[2] = new Option("2 Mbps", "2000000");
document.forms[0].wlRate[3] = new Option("5.5 Mbps", "5500000");
document.forms[0].wlRate[4] = new Option("6 Mbps", "6000000");
document.forms[0].wlRate[5] = new Option("9 Mbps", "9000000");
document.forms[0].wlRate[6] = new Option("11 Mbps", "11000000");
document.forms[0].wlRate[7] = new Option("12 Mbps", "12000000");
document.forms[0].wlRate[8] = new Option("18 Mbps", "18000000");
document.forms[0].wlRate[9] = new Option("24 Mbps", "24000000");
document.forms[0].wlRate[10] = new Option("36 Mbps", "36000000");
document.forms[0].wlRate[11] = new Option("48 Mbps", "48000000");
document.forms[0].wlRate[12] = new Option("54 Mbps", "54000000");
     }
   }
   else if (sel_band == "1") { // 5G
document.forms[0].wlRate[0] = new Option("Auto", "0");
document.forms[0].wlRate[1] = new Option("6 Mbps", "6000000");
document.forms[0].wlRate[2] = new Option("9 Mbps", "9000000");
document.forms[0].wlRate[3] = new Option("12 Mbps", "12000000");
document.forms[0].wlRate[4] = new Option("18 Mbps", "18000000");
document.forms[0].wlRate[5] = new Option("24 Mbps", "24000000");
document.forms[0].wlRate[6] = new Option("36 Mbps", "36000000");
document.forms[0].wlRate[7] = new Option("48 Mbps", "48000000");
document.forms[0].wlRate[8] = new Option("54 Mbps", "54000000");
   }
   else {
document.forms[0].wlRate[0] = new Option("Auto", "0");
   }

   if(sel_nmode != "off") {
      /* exclude auto for 802.11a/b/g (Legacy) rates if 11n is enabled */
      document.forms[0].wlRate[0]=null;
   }
      
   /* mark selected */         
   for (idx = 0; idx < document.forms[0].wlRate.options.length; idx++) {
      if (document.forms[0].wlRate.options[idx].value == sel_rate) {
         document.forms[0].wlRate.options[idx].selected = true;
         break;
      }
   } 
      
   /* set to first(Auto) if not found */
   if( idx == document.forms[0].wlRate.options.length)   
      document.forms[0].wlRate.options[0].selected = true;       
}


function loadMCastRateList(OnPageLoad) {

   var sel_band;
   var sel_rate;
   var idx;
   var sel_nmode;
   var sel_gmode;
   
   /* save selected */
   if(OnPageLoad) {
      sel_band = band;
      sel_rate = mcastrate;
      sel_nmode = nmode;
      sel_gmode = gmode;      
   }
   else {
      sel_band = document.forms[0].wlBand.value;
      sel_rate = document.forms[0].wlMCastRate.value;
      sel_nmode = document.forms[0].wlNmode.value;
      sel_gmode = document.forms[0].wlgMode.value;      
   }

   if(phy != "n") sel_nmode = "off";
   
   document.forms[0].wlMCastRate.length = 0;
   if (sel_band == "2") { // 2.4G
      if (phy == "b" ||      
          (country == "JP" && document.forms[0].wlChannel.value == 14) ||
          (sel_nmode == "off" && sel_gmode == "0")) {
document.forms[0].wlMCastRate[0] = new Option("Auto", "0");
document.forms[0].wlMCastRate[1] = new Option("1 Mbps", "1000000");
document.forms[0].wlMCastRate[2] = new Option("2 Mbps", "2000000");
document.forms[0].wlMCastRate[3] = new Option("5.5 Mbps", "5500000");
document.forms[0].wlMCastRate[4] = new Option("11 Mbps", "11000000");
      }
      else {
document.forms[0].wlMCastRate[0] = new Option("Auto", "0");
document.forms[0].wlMCastRate[1] = new Option("1 Mbps", "1000000");
document.forms[0].wlMCastRate[2] = new Option("2 Mbps", "2000000");
document.forms[0].wlMCastRate[3] = new Option("5.5 Mbps", "5500000");
document.forms[0].wlMCastRate[4] = new Option("6 Mbps", "6000000");
document.forms[0].wlMCastRate[5] = new Option("9 Mbps", "9000000");
document.forms[0].wlMCastRate[6] = new Option("11 Mbps", "11000000");
document.forms[0].wlMCastRate[7] = new Option("12 Mbps", "12000000");
document.forms[0].wlMCastRate[8] = new Option("18 Mbps", "18000000");
document.forms[0].wlMCastRate[9] = new Option("24 Mbps", "24000000");
document.forms[0].wlMCastRate[10] = new Option("36 Mbps", "36000000");
document.forms[0].wlMCastRate[11] = new Option("48 Mbps", "48000000");
document.forms[0].wlMCastRate[12] = new Option("54 Mbps", "54000000");
     }
   }
   else if (sel_band == "1") { // 5G
document.forms[0].wlMCastRate[0] = new Option("Auto", "0");
document.forms[0].wlMCastRate[1] = new Option("6 Mbps", "6000000");
document.forms[0].wlMCastRate[2] = new Option("9 Mbps", "9000000");
document.forms[0].wlMCastRate[3] = new Option("12 Mbps", "12000000");
document.forms[0].wlMCastRate[4] = new Option("18 Mbps", "18000000");
document.forms[0].wlMCastRate[5] = new Option("24 Mbps", "24000000");
document.forms[0].wlMCastRate[6] = new Option("36 Mbps", "36000000");
document.forms[0].wlMCastRate[7] = new Option("48 Mbps", "48000000");
document.forms[0].wlMCastRate[8] = new Option("54 Mbps", "54000000");
   }
   else {
document.forms[0].wlMCastRate[0] = new Option("Auto", "0");
   }
   
   /* mark selected */         
   for (idx=0; idx < document.forms[0].wlMCastRate.options.length; idx++) {
      if (document.forms[0].wlMCastRate.options[idx].value == sel_rate) {
         document.forms[0].wlMCastRate.options[idx].selected = true;
         break;
      }
   }
   
   /* set to first(Auto) if not found */
   if( idx == document.forms[0].wlMCastRate.options.length)   
      document.forms[0].wlMCastRate.options[0].selected = true;
      
}

function loadBasicRateList(OnPageLoad) {

   var sel_band;
   var sel_rate;
   var idx;

   /* save selected */
   if(OnPageLoad) {
      sel_band = band;
      sel_rate = brate;
   }
   else {
      sel_band = document.forms[0].wlBand.value;
      sel_rate = document.forms[0].wlBasicRate.value;
   }
   
  document.forms[0].wlBasicRate.length = 0;
  
   if (sel_band == "2") { // 2.4G
document.forms[0].wlBasicRate[0] = new Option("Default", "default");
document.forms[0].wlBasicRate[1] = new Option("All", "all");
document.forms[0].wlBasicRate[2] = new Option("1 & 2 Mbps", "12");
      if (phy != "b") {
         document.forms[0].wlBasicRate[3] = new Option("1 & 2 & 5.5 & 6 & 11 & 12 & 24 Mbps", "wifi2");
      }
      
   }
   else if (sel_band == "1") { // 5G
document.forms[0].wlBasicRate[0] = new Option("Default", "default");
document.forms[0].wlBasicRate[1] = new Option("All", "all");
document.forms[0].wlBasicRate[2] = new Option("6 & 12 Mbps", "12");
document.forms[0].wlBasicRate[3] = new Option("6 & 12 & 24 Mbps", "wifi2");
   }
   else {
document.forms[0].wlBasicRate[0] = new Option("Default", "0");
   }

   /* mark selected */         
   for (idx=0; idx < document.forms[0].wlBasicRate.options.length; idx++) {
      if (document.forms[0].wlBasicRate.options[idx].value == sel_rate) {
         document.forms[0].wlBasicRate.options[idx].selected = true;
         break;
      }
   }
   
   /* set to first(Auto) if not found */
   if( idx == document.forms[0].wlBasicRate.options.length)   
      document.forms[0].wlBasicRate.options[0].selected = true;   
      
}

function onBandChange(OnPageLoad) {

   with ( document.forms[0] ) {
      var sel_band;
         
      /* save selected */      
      if(OnPageLoad) {
         sel_band = band;
         wlBand.selectedIndex = getBandIndex(sel_band);
      }      
      else {
         sel_band = document.forms[0].wlBand.value;
      }
                
      loadChannelList(OnPageLoad);
      loadRateList(OnPageLoad);
      loadMCastRateList(OnPageLoad);
      loadBasicRateList(OnPageLoad);
   }
}

function getBasicRateIndex(br) {
   var ret = 0;
   if ( br == "12" ) {
      ret = 2;
   }
   else if ( br == "all" ) {
      ret = 1;
   } else if ( br == "wifi2" ) {
      ret = 3;
   } else
      ret = 0;
   return ret;
}

function getRateIndex(r) {
   var rateNum = parseInt(r);
   var ret = 0;

   if ( band == '2') {
      if ( phy == "b" ) { //11b
         switch ( rateNum ) {
         case 1000000:
            ret = 1;
            break;
         case 2000000:
            ret = 2;
            break;
         case 5500000:
            ret = 3;
            break;
         case 11000000:
            ret = 4;
            break;
         default:
            ret = 0;
            break;
         }
      }
      // physical type is 802.11g
      else {
         switch ( rateNum ) {
         case 1000000:
            ret = 1;
            break;
         case 2000000:
            ret = 2;
            break;
         case 5500000:
            ret = 3;
            break;
         case 6000000:
            ret = 4;
            break;
         case 9000000:
            ret = 5;
            break;
         case 11000000:
            ret = 6;
            break;
         case 12000000:
            ret = 7;
            break;
         case 18000000:
            ret = 8;
            break;
         case 24000000:
            ret = 9;
            break;
         case 36000000:
            ret = 10;
            break;
         case 48000000:
            ret = 11;
            break;
         case 54000000:
            ret = 12;
            break;
         default:
            ret = 0;
            break;
         }
      }
   }
   // physical type is 802.11a
   else if ( band == '1' ) { // 11a
      switch ( rateNum ) {
      case 6000000:
         ret = 1;
         break;
      case 9000000:
         ret = 2;
         break;
      case 12000000:
         ret = 3;
         break;
      case 18000000:
         ret = 4;
         break;
      case 24000000:
         ret = 5;
         break;
      case 36000000:
         ret = 6;
         break;
      case 48000000:
         ret = 7;
         break;
      case 54000000:
         ret = 8;
         break;
      default:
         ret = 0;
         break;
      }
   }
   return ret;
}

function getFrameBurstIndex(frameburst) {
   var ret;
   
   if ( frameburst == "off" )
      ret = 0;
   else
      ret = 1;
   return ret;
}

function getAfterBurnerIndex(afterburner) {
   var ret;
   
   if ( afterburner == "auto" )
      ret = 1;
   else
      ret = 0;
   return ret;
}

function getGModeProtection(pro) {
   var ret;
   
   if ( pro == "auto" )
      ret = 1;
   else
      ret = 0;
   return ret;
}

function getTpcDbIndex(val) {
   var ret;
   
   if ( val == "0" )
      ret = 0;
   else if ( val == "2" )
      ret = 1;
   else if ( val == "3" )
      ret = 2;
   else if ( val == "4" )
      ret = 3;
   else ret = 0;
   return ret;
}

function phyChange() {
   with ( document.forms[0] )
      if (phy == "n") {
         showhide("div_nMode", 1);
         showhide("div_nMode_sel", 0);//wind went to remove it         
         showhide("div_gMode", 0);         
      } else {
         showhide("div_nMode", 0);
         showhide("div_nMode_sel", 0);         
         showhide("div_gMode", 1);         
      }         
}

function RegModeChange(OnPageLoad) {
   with ( document.forms[0] ) {
      var sel_band;
      
      /* save selected */      
      if(OnPageLoad) {
         sel_band = band;
      }      
      else {
         sel_band = document.forms[0].wlBand.value;
      }          
                
      if( wlRegMode.selectedIndex != 1 )
         wlDfsPreIsm.disabled=wlDfsPostIsm.disabled=wlTpcDb.disabled=true;
      else 
         wlDfsPreIsm.disabled=wlDfsPostIsm.disabled=wlTpcDb.disabled=false;
         
      if (sel_band == "2") {
        showhide("div_regMode", 0);   
      }
      else {
        showhide("div_regMode", 1);     
      }         
   }         
}

function getBandIndex(b) {
   var ret;
   
   if ( b == '1' )
      ret = 1;
   else
      ret = 0;
   return ret;
}

function wl_afterburner_options(OnPageLoad) {

    var hideAB = false;
    var enableABSel = true; 
    var hideWarning = true;  
              
    with ( document.forms[0] ) {      
        var sel_nmode = wlNmode.options[wlNmode.selectedIndex].value;
        if(OnPageLoad) {
           sel_nmode = nmode;
           wlAfterBurnerEn.selectedIndex = getAfterBurnerIndex(afterburneren);
        } else {
           sel_nmode = wlNmode.options[wlNmode.selectedIndex].value;        
        }
                 
	if ( (hasafterburner != 1) ){
	   hideAB = true;
	}

        if(phy == "n" && sel_nmode == "auto") {
	   hideAB = true;        
        }
            
	if (parseInt(wlFrgThrshld.value) != 2346 ){
	   //alert('wlFrgThrshld.value "' + parseInt(wlFrgThrshld.value) +'"');
           enableABSel = false; 
           hideWarning = false;        	
	}
	
	if(getSelect(wlWme)!= 0) {
	   enableABSel = false; 
	}
	   
        if (hideAB ||!enableABSel) {
           wlAfterBurnerEn.value ="off";
        }    	
	showhide("AFB", !hideAB);
	wlAfterBurnerEn.disabled =!enableABSel;
    }
 }

function wl_ewc_options(OnPageLoad)
{
   var sel_nbw;
   var sel_nmcsidx;
   var idx;   
   var sel_ch;
   var sel_nmode;
   var sel_nreqd;
   var sel_nbw_cap;
   var sel_band;
   var bw;
        
   if(phy != "n")
      return;
  
   //issupport11n(country);   
 
   if(OnPageLoad) {
     sel_ch = channel;
     sel_nmode = nmode;
     sel_nreqd = nreqd; 
     sel_band = band;
     sel_nbw_cap = nbwcap;
     
     document.forms[0].wlNProtection.value = npro;     
     sel_nmcsidx = nmcsidx;
	 /*
     if(nctrlsb == 0) {
        document.forms[0].wlNCtrlsb.selectedIndex = 0;     
        document.forms[0].wlNCtrlsb.disabled = 1;
     } else         
        document.forms[0].wlNCtrlsb.value = nctrlsb;   
     */   
     document.forms[0].wlNReqd.value = nreqd;
     if(sel_nmode == "off") {
        document.forms[0].wlNmode.selectedIndex = 1;
     }
     
     document.forms[0].wlNBwCap.selectedIndex = sel_nbw_cap;
     
   } else {
     sel_ch = document.forms[0].wlChannel.value;   
     sel_nmcsidx = document.forms[0].wlNMmcsidx.value;
     sel_nmode = document.forms[0].wlNmode.value;
     sel_nreqd = document.forms[0].wlNReqd.value;
     sel_band = document.forms[0].wlBand.value;
     sel_nbw_cap = document.forms[0].wlNBwCap.value;
   }

   if(sel_nmode == "off") {
      document.forms[0].wlNMmcsidx.disabled = 1;      
      document.forms[0].wlNProtection.disabled = 1;
      document.forms[0].wlNReqd.disabled = 1;
      document.forms[0].wlNBwCap.disabled = 1;      
      showhide("div_nMode", 0);      
      bw = "20";
   } else {
      document.forms[0].wlNMmcsidx.disabled = 0;
      document.forms[0].wlNProtection.disabled = 0;      
      document.forms[0].wlNReqd.disabled = 0;      
      //document.forms[0].wlNBwCap.disabled = 0; 
      issupport11n(country);               
      showhide("div_nMode", 1); 
      if (((sel_band == "1") && ((sel_nbw_cap == "1") || (sel_nbw_cap == "2"))) || 
         ((sel_band == "2") && (sel_nbw_cap == "1"))) 
         bw = "40";
      else
         bw = "20";      
   }  
           
   if (document.forms[0].wlNMmcsidx != null)
      document.forms[0].wlNMmcsidx.disabled = 0;        
   /*   
   // load n phy rates 
   if(sel_ch == 0) {
      //document.forms[0].wlNCtrlsb.disabled = 1;
      <%ejGetWl(wlNPhyRates, "0");%>   
   } else if (bw == "40") {
      // Control sb is allowed only for 40MHz BW Channels 
      //document.forms[0].wlNCtrlsb.disabled = 0;
      <%ejGetWl(wlNPhyRates, "40");%>
   } else if (bw == "20") {
      //document.forms[0].wlNCtrlsb.selectedIndex = 0;
      //document.forms[0].wlNCtrlsb.disabled = 1;
      <%ejGetWl(wlNPhyRates, "20");%>
   }
  */
  if (bw == "20") {
      //document.forms[0].wlNCtrlsb.selectedIndex = 0;
      //document.forms[0].wlNCtrlsb.disabled = 1;
      <%ejGetWl(wlNPhyRates, "20");%>
   } else if (bw == "40") {
      //document.forms[0].wlNCtrlsb.disabled = 1;
      <%ejGetWl(wlNPhyRates, "0");%>   
   }
   
   /* mark selected */         
   for (idx=0; idx< document.forms[0].wlNMmcsidx.options.length; idx++) {
      if (document.forms[0].wlNMmcsidx[idx].value == sel_nmcsidx) {
         document.forms[0].wlNMmcsidx[idx].selected = true;
         break;
      }
   }     
   
   /* set to first (Auto) if not found */
   if( idx == document.forms[0].wlNMmcsidx.options.length)   
      document.forms[0].wlNMmcsidx.options[0].selected = true;   

   /* mark selected */ 
   document.forms[0].wlNmode.selectedIndex = getNmodeIndex(sel_nmode);
               
}

function wl_mcs_onchange(OnPageLoad)
{
   var sel_nmcsidx;
   var sel_nmode;
   
   if(phy != "n")
      return;

   if(OnPageLoad) {
     sel_nmcsidx = nmcsidx;
     sel_nmode = nmode;
   } else {
     sel_nmcsidx = document.forms[0].wlNMmcsidx.value;
     sel_nmode = document.forms[0].wlNmode.value;     
   }      
   
   /* If using 'legacy rate' then enable */
   if (sel_nmcsidx == "-2" || sel_nmode == "off")
      document.forms[0].wlRate.disabled = 0;
   else
      document.forms[0].wlRate.disabled = 1;
}


function wl_recalc(OnPageLoad) {
   with ( document.forms[0] ) {            

      phyChange(OnPageLoad);
      genericChange(OnPageLoad);
      updateCurChannel(OnPageLoad);      
      onBandChange(OnPageLoad);       
      gModeChange(OnPageLoad);
      wl_ewc_options(OnPageLoad);    
      RegModeChange(OnPageLoad);
      wl_mcs_onchange(OnPageLoad);
      wmeChange(OnPageLoad);      
      wl_afterburner_options(OnPageLoad);        
   }
}

function updateCurChannel(OnPageLoad) {
   
   if(OnPageLoad) { 

      var curr_chanspec = parseInt(chanspec);
      var curr_sb = (curr_chanspec & 0x300 ) >> 8;
      var curr_bw = (curr_chanspec & 0xc00 ) >> 10;
      var curr_sb_str = "N/A";
            
      if(curr_bw == 2)
         curr_bw_str = "20";
      else if (curr_bw == 3)
         curr_bw_str = "40";
      else if (curr_bw == 1)
         curr_bw_str = "10";               
         
      if(curr_sb == 1)
         curr_sb_str = "Lower";
      else if (curr_sb == 2)
         curr_sb_str = "Upper";
      else if (curr_sb == 3)
         curr_sb_str = "None";   
               
/*            
      if (document.getElementById)  // DOM3 = IE5, NS6
         document.getElementById("CurChannel").innerHTML = " Current: " + wlCurrentChannel;
      else {
         if (document.layers == false) // IE4
            document.all.CurChannel.innerHTML = " Current: " + wlCurrentChannel;
      }
      
      if (document.getElementById)  // DOM3 = IE5, NS6
         document.getElementById("CurNbw").innerHTML = " Current: " + curr_bw_str + "MHz";
      else {
         if (document.layers == false) // IE4
            document.all.CurNbw.innerHTML = " Current: " + curr_bw_str + "MHz";
      }         

      if (document.getElementById)  // DOM3 = IE5, NS6
         document.getElementById("CurNCtrlsb").innerHTML = " Current: " + curr_sb_str;
      else {
         if (document.layers == false) // IE4
            document.all.CurNCtrlsb.innerHTML = " Current: " + curr_sb_str;
      }     
	  */
   }
}


function wmeChange(OnPageLoad) {     
   with ( document.forms[0] ) {
      //if(afterburneren != "off")
      //   setSelect(wlWme, 0);
	  
 /* 20081218, Lily,modify for hide WLWMM,WLWMMNOACK,WLWMMAPSD option , mark: 12180845*/
  //     if(OnPageLoad) {      
//         showhide("WLWMM", haswme);
//         showhide("WLWMMNOACK", haswme);
//         showhide("WLWMMAPSD", haswme);
         
//         setSelect(wlWme, wme);
//         setSelect(wlWmeNoAck, wmenoack);
 //        setSelect(wlWmeApsd, wmeapsd);
//      }
                                 
 //     setDisable(wlWmeNoAck, getSelect(wlWme) == 0);
  //    setDisable(wlWmeApsd, getSelect(wlWme) == 0);       
         setSelect(wlWme, wme);
         showhide("WLWMM", 0); 
 /* 20081218, Lily, end---------------------------------- mark: 12180845*/
   }
}

	
function onNmodeChange(OnPageLoad)
{   
   wl_recalc(OnPageLoad);
   document.forms[0].wlRate.selectedIndex = 0;
}

function frmLoad() {
   wl_recalc(true);

      with ( document.forms[0] ) {
save_button.disabled = 0;
   	setCheck(wlEnbl_2, enbl_2);
   	wlSsid_2.value = ssid_2;
	issupport11n(country);	
	 // showhide("wlSecInfo", (!hidden));
      //showhide("wlLegacyGuestInfo", ((!parseInt(hidden))&&(parseInt(supportMbss)==0)));
      //showhide("wlMBSSInfo", ((!parseInt(hidden))&&(parseInt(supportMbss)!=0)));
	  
   	setCheck(wlEnbl_2, enbl_2);
   	wlSsid_2.value = ssid_2;
    if (enbl_2 == '1')
    {
       wlSsid_2.disabled = 0;
       wlHide_2.disabled = 0;
       wlAPIsolation_wl0v1.disabled = 0;
       wlAuthMode.disabled = 0;
    } else {
       wlSsid_2.disabled = 1;
       wlHide_2.disabled = 1;
       wlAPIsolation_wl0v1.disabled = 1;
       wlAuthMode.disabled = 1;
    }
	setCheck(wlHide_2, hide_2);
	
    wlAPIsolation_wl0v1.selectedIndex = parseInt(apisolation_2);
	
	wlKeyBit.selectedIndex = parseInt(bit);
	for ( i = 0; i < 4; i++ ) {
			wlKeys[i].value = keys[i];
		}
	
	wlKeyIndex.selectedIndex = parseInt(keyIdx) - 1;

	//wlWpaGtkRekey.value = wpaGTKRekey;
	wlWpaGtkRekeywpa.value = wpaGTKRekey; // by jack 11.15
	wlWpaGtkRekeywpa2.value = wpaGTKRekey;
	wlWpaGtkRekeywpa2mix.value = wpaGTKRekey;

	wlWpaPsk.value = wpaPskKey;
	//wlNetReauth.value = varNetReauth;
	wlNetReauth.value = varNetReauth;
	wlRadiusIPAddr.value = radiusServerIP;
	wlRadiusPort.value = radiusPort;
	wlRadiusKey.value = radiusKey;

	if(wlmode=='open' &&  wlwep=='disabled' )
		setSelect(wlAuthMode, 0);
	else if(( wlmode=='shared'  || wlmode=='open' ) &&  wlwep=='enabled' ){
		setSelect(wlAuthMode, 1);
	//	window.confirm(wlmode);
		if(wlmode == 'open')
			setSelect(WepAuth,1);
		else
			setSelect(WepAuth,2);
	}
	else if(wlmode == 'psk' || wlmode == 'wpa' ){
		setSelect(wlAuthMode, 2);
		if(wlmode == 'psk')
			setSelect(wpa,1);
		else if(wlmode == 'wpa')
			setSelect(wpa,2);
	}
	else if(wlmode == 'psk2' || wlmode == 'wpa2' ){
		setSelect(wlAuthMode, 3);
		if(wlmode == 'psk2')
			setSelect(wpa2,1);
		else if(wlmode == 'wpa2')
			setSelect(wpa2,2);
	}
	else if(wlmode == 'psk psk2' || wlmode == 'wpa wpa2' ){
		setSelect(wlAuthMode, 4);
		if(wlmode == 'psk psk2')
			setSelect(wpauto,1);
		else if(wlmode == 'wpa wpa2')
			setSelect(wpauto,2);
	}

	//if(opmode != '101')	// added by rome
	displayMode(wlAuthMode,0);
	 // if((wlmode == 'psk' || wlmode == 'psk2'  || wlmode =='psk2mix'  ||wlmode == 'wpa' || wlmode == 'wpa2'  || wlmode =='wpa2mix')
	if(wlmode != 'open' && wlmode != 'shared' ) {
	//	displayWPAMode(wpamode);
		 if(wlmode == 'psk'  || wlmode == 'wpa' )
			displayWPAMode(wpa);
		 else  if(wlmode == 'psk2'  || wlmode == 'wpa2' )
			displayWPAMode(wpa2);
		 else  if(wlmode == 'psk psk2'  || wlmode == 'wpa wpa2' )
			displayWPAMode(wpauto);

	}

	/* 20100406, Linus Shi, begin mod to fix bug #7482, mark: 04061555 */
	if ('0' == wl_switch)
	{
		wlBand.disabled = 1;
		wlChannel.disabled = 1;
		//wlCsScanTimer.disabled = 1;
		wlNmode.disabled = 1;
		wlNBwCap.disabled = 1;
		wlNMmcsidx.disabled = 1;
		wlNProtection.disabled = 1;
		wlNReqd.disabled = 1;
		wlObssCoex.disabled = 1;
		wlRate.disabled = 1;
		wlMCastRate.disabled = 1;
		wlBasicRate.disabled = 1;
		wlFrgThrshld.disabled = 1;
		wlRtsThrshld.disabled = 1;
		wlDtmIntvl.disabled = 1;
		wlBcnIntvl.disabled = 1;
		//wlFrameBurst.disabled = 1;
		wlTxPower.disabled = 1;
		wlEnbl_2.disabled = 1;
		wlHide_2.disabled = 1;
		wlAPIsolation_wl0v1.disabled = 1;
		wlAuthMode.disabled = 1;
	}
	/* 20100406, Linus Shi, end ----------------------- mark: 04061555 */

		if((wl11Mode==0)||(wl11Mode==1)||(wl11Mode==2)||(wl11Mode==3)){
			//alert('the wireless 1 mode='+mode+',mode='+nmode+''+wl11Mode);
			wlBasicRate.disabled = 1;
		}else{
			//alert('the wireless 2 mode='+mode+',mode='+nmode+''+wl11Mode);
			wlBasicRate.disabled = 0;
		}
	//if (atheDriverWireless == "Gemini")
		//guestInfo.style.display = "block";
   }

}

function btnApply() {
   var loc = 'wlcfgadv.wl?';
   var idx, frgNum, rtsNum, dtmNum, bcnNum, frmburstNum, globalMaxAssocNum;

   if ( enbl == '0' ) {
      alert('Cannot apply the change since wireless is currently disabled.');
      return;
   }
           
   wl_recalc(false); 
      
   with ( document.forms[0] ) {
      var sel_nmode = wlNmode.options[wlNmode.selectedIndex].value;
      var sel_nmcsidx = wlNMmcsidx.value;

      /* 20101109, Linus Shi, begin mod to fix bug#10216 and #10459, mark: 11091355 */
      //if ((wlCsScanTimer.disabled == false) && isnum(wlCsScanTimer.value) == false)
      //{
          //alert('Auto Channel Timer "' + wlCsScanTimer.value + '" should be a number!');
          //return;
      //}
	  
      if (isnum(wlFrgThrshld.value) == false)
      {
          alert('Fragmentation Threshold "' + wlFrgThrshld.value + '" should be a number!');
          return;
      }
	  frgNum = parseInt(wlFrgThrshld.value);
      if ( isNaN(frgNum) == true || frgNum < 256 || frgNum > 2346 ) 
      {
          alert('Fragmentation Threshold "' + wlFrgThrshld.value + '" should be between 256 and 2346.');
          return;
      }

      if (isnum(wlRtsThrshld.value) == false)
      {
          alert('RTS Threshold "' + wlRtsThrshld.value + '" should be a number!');
          return;
      }
      rtsNum = parseInt(wlRtsThrshld.value);
      if ( isNaN(rtsNum) == true || rtsNum < 0 || rtsNum > 2347 ) 
      {
          alert('RTS Threshold "' + wlRtsThrshld.value + '" should be between 0 and 2347.');
          return;
      }
	  
      if (isnum(wlDtmIntvl.value) == false)
      {
          alert('DTIM Interval "' + wlDtmIntvl.value + '" should be a number!');
          return;
      }
      dtmNum = parseInt(wlDtmIntvl.value);
      if ( isNaN(dtmNum) == true || dtmNum < 1 || dtmNum > 255 ) 
      {
          alert('DTIM Interval "' + wlDtmIntvl.value + '" should be between 1 and 255.');
          return;
      }

      if (isnum(wlBcnIntvl.value) == false)
      {
          alert('Beacon Interval "' + wlBcnIntvl.value + '" should be a number!');
          return;
      }
      bcnNum = parseInt(wlBcnIntvl.value);
      if ( isNaN(bcnNum) == true || bcnNum < 1 || bcnNum > 65535 ) 
      {
          alert('Beacon Interval "' + wlBcnIntvl.value + '" should be between 1 and 65535.');
          return;
      }
      /* 20101109, Linus Shi, end ----------------------- mark: 11091355 */

      loc += 'sessionKey=' + sessionKey;                 
      loc += '&wlChannel=' + wlChannel.options[wlChannel.selectedIndex].value;
      loc += '&wlNmode=' + sel_nmode;
      loc += '&wlNReqd=' + wlNReqd.value;      
      loc += '&wlBasicRate=' + wlBasicRate.options[wlBasicRate.selectedIndex].value;
      loc += '&wlFrgThrshld=' + wlFrgThrshld.value;
      loc += '&wlRtsThrshld=' + wlRtsThrshld.value;
      loc += '&wlDtmIntvl=' + wlDtmIntvl.value;
      loc += '&wlBcnIntvl=' + wlBcnIntvl.value;
      //loc += '&wlCsScanTimer=' + wlCsScanTimer.value;      
      //loc += '&wlFrameBurst=' + wlFrameBurst.value;
      loc += '&wlBand=' + wlBand.value;
      loc += '&wlObssCoex=' + wlObssCoex.value;
      loc += '&wlMCastRate=' + wlMCastRate.options[wlMCastRate.selectedIndex].value;
      if (hasafterburner == '1') {
         loc += '&wlAfterBurnerEn=' + wlAfterBurnerEn.value;
      }
      else {
         loc += '&wlAfterBurnerEn=off';
      }

      /* rate */
      if ( phy != "n" || (phy == "n" && (sel_nmode == "off" || sel_nmcsidx == -2)))
         loc += '&wlRate=' + wlRate.options[wlRate.selectedIndex].value;
                  
      /* b/g mode */
      if ( band == '2') { // 2.4G
         if (phy == "b") { // 802.11b
            loc += '&wlPreambleType=' + wlPreambleType.options[wlPreambleType.selectedIndex].value;
         } else if ((phy == "n" && sel_nmode == "off") || phy == "g" || phy == "a") { // 802.11g
            loc += '&wlgMode=' + wlgMode.options[wlgMode.selectedIndex].value;
            loc += '&wlProtection=' + wlProtection.options[wlProtection.selectedIndex].value;
            if (wlgMode.selectedIndex == 0 || wlgMode.selectedIndex == 3) {
               loc += '&wlPreambleType=' + wlPreambleType.options[wlPreambleType.selectedIndex].value;
            }
         }         
      }

      if ( wlgMode.options[wlgMode.selectedIndex].value == 0 && sel_nmode=="off") {        
           loc += '&wl11Mode=-3';
           loc += '&wlnrate=' +0;
      } else if ( wlgMode.options[wlgMode.selectedIndex].value == 2) {   
           loc += '&wl11Mode=3';
      } else {

        if ( sel_nmode=="auto" && wlNReqd.value==1) {
             loc += '&wl11Mode=0';
             loc += '&wlnrate=' +1;
        } else if ( sel_nmode=="auto" && wlNReqd.value==0) {
             loc += '&wl11Mode=1';
             loc += '&wlnrate=' +1;
        } else if (phy=="g") {
             loc += '&wl11Mode=-1';
             loc += '&wlnrate=' +0;
        } else {
             loc += '&wl11Mode=-2';
             loc += '&wlnrate=' +0;
        }

      }

      if (wlBand[wlBand.selectedIndex].value==1) {
             loc += '&wl11Mode=2'; 
      }


     loc += '&wlTxPwrPcnt=' + wlTxPower.options[wlTxPower.selectedIndex].value;
     loc += '&wlRegMode=' + wlRegMode.options[wlRegMode.selectedIndex].value;
      
     if(phy == "n") {
        loc += '&wlNBwCap=' + wlNBwCap.options[wlNBwCap.selectedIndex].value;
        
        if((wlBand.value=="1" && wlNBwCap.options[wlNBwCap.selectedIndex].value == "0") ||
           (wlBand.value=="2" && ((wlNBwCap.options[wlNBwCap.selectedIndex].value == "0") ||
                                   (wlNBwCap.options[wlNBwCap.selectedIndex].value == "2"))))
           loc += '&wlNCtrlsb=' + 0;
        else   
           //loc += '&wlNCtrlsb=' + wlNCtrlsb.options[wlNCtrlsb.selectedIndex].value;
           {
				var k=0;
				k = wlChannel.options[wlChannel.selectedIndex].value;

				if(k >= 0 && k <= 9){
					loc += '&wlNCtrlsb=' + -1; //leo_debug
				}else{
					loc += '&wlNCtrlsb=' + 1; //leo_debug
				}
		   }
        loc += '&wlNProtection=' + wlNProtection.options[wlNProtection.selectedIndex].value;
        loc += '&wlNMcsidx=' + wlNMmcsidx.options[wlNMmcsidx.selectedIndex].value;

        if (wlNMmcsidx.options[wlNMmcsidx.selectedIndex].value == "-1")
            loc += '&wlnrate=' + -1; 
     }

     if(wlRegMode.selectedIndex == 1) {
        DfsPreIsmNum = parseInt(wlDfsPreIsm.value);
        if ( isNaN(DfsPreIsmNum) == true || DfsPreIsmNum < 0 || DfsPreIsmNum > 99 ) {
           alert('Pre-Network Radar Check "' + wlDfsPreIsm.value + '" should be between 0 and 99.');
           return;
        }
      
        DfsPostNum = parseInt(wlDfsPostIsm.value);
        if ( isNaN(DfsPostNum) == true || DfsPostNum < 10 || DfsPostNum > 99 ) {
           alert('In-Network Radar Check: "' + wlDfsPostIsm.value + '" should be between 10 and 99.');
           return;
        } 
      
        loc += '&wlDfsPreIsm=' + wlDfsPreIsm.value;
        loc += '&wlDfsPostIsm=' + wlDfsPostIsm.value;       
        loc += '&wlTpcDb=' + wlTpcDb.options[wlTpcDb.selectedIndex].value;
     }    
             
     /* 20081218, Lily,modify for delete wme parameter , mark: 12180848*/
	 
      //loc += '&wlWme=' + parseInt(wlWme.value);
     //loc += '&wlWmeNoAck=' + parseInt(wlWmeNoAck.value);
     //loc += '&wlWmeApsd=' + parseInt(wlWmeApsd.value);     
	 
      /* 20081218, Lily, end---------------------------------- mark: 12180848*/     
/*
   	 if(supportMbss==0) {	 
	    //LegacyGuest
            loc += submitCheck(wlEnbl_2);
            loc += '&wlSsid_2=' + encodeUrl(wlSsid_2.value);
         } else {
            //MBSS           
            for (var i=0; i < document.forms[0].elements.length; i++){
               if(document.forms[0].elements[i].name.search('_wl'+unitNum+'v') != -1) {
                  if (document.forms[0].elements[i].type == 'checkbox') {
                     loc += submitCheck(document.forms[0].elements[i]);
                     //alert(submitCheck(document.forms[0].elements[i]));
                  }
                  if (document.forms[0].elements[i].type == 'text') {
                     loc += '&'+document.forms[0].elements[i].name + '=' + encodeUrl(document.forms[0].elements[i].value);
                     //alert('&'+document.forms[0].elements[i].name + '=' + encodeUrl(document.forms[0].elements[i].value));
                  }
               }            
            }
         }
   */
	if ( wlEnbl_2.checked == false ) {
			loc += '&wlSsid_2=' + encodeUrl(ssid_2);
			loc += '&wlEnbl_2=0';
		} else {
			if ( wlSsid_2.value == '' ) {
				alert('SSID should not be empty.');
				return;
			}
			var str = new String();
			str = wlSsid_2.value;
			if ( str.length > 32 ) {
				alert('GUESS SSID "' + wlSsid_2.value + '" should not be longer than 32 characters.');
				return;
			}
			loc += '&wlSsid_2=' + encodeUrl(wlSsid_2.value);
			if ( wlEnbl_2.checked == true )
				loc += '&wlEnbl_2=1';
			else
				loc += '&wlEnbl_2=0';

			//loc += submitCheck(wlHide);	
			if ( wlHide_2.checked == true )
				loc += '&wlHide_wl0v1=1';
			else
				loc += '&wlHide_wl0v1=0';
		}
		loc += '&wlAPIsolation_wl0v1=' + wlAPIsolation_wl0v1.value;		
		wlauth=getSelect(wlAuthMode);
		if(wlauth ==0){
			loc += '&wlAuthMode_wl0v1=open';
			loc += '&wlAuth_wl0v1=0';
			loc += '&wlWep_wl0v1=disabled';
		} else if(wlauth == 1){
			var wepauth=getSelect(WepAuth);
		//	window.confirm(wepauth);
			if(wepauth == 1){
				loc += '&wlAuthMode_wl0v1=open';
				loc += '&wlAuth_wl0v1=0';
			}else{
				loc += '&wlAuthMode_wl0v1=shared';
				loc += '&wlAuth_wl0v1=1';
			}
			loc += '&wlWep_wl0v1=enabled';
			//loc += submitSelect(wlKeyBit);
			loc += '&wlKeyBit_wl0v1=' + wlKeyBit.options[wlKeyBit.selectedIndex].value;
			var i, val;
			
			var cbit = getSelect(wlKeyBit);
			var num = parseInt(getSelect(wlKeyIndex))-1;
			for ( i = 0; i < 4; i++ ) {
      		    val = wlKeys[i].value;
				if ( i == num && val == '') {
					alert('Cannot choose key that has empty value.');
					return;
				}
				if ( val != '' ) {
					if ( cbit == '0' ) {
						if ( isValidKey(val, 13) == false ) {
							alert('Key '+(i+1)+' "' + val + '" is invalid. Please enter 13 ASCII characters or 26 hexadecimal digits for a 128-bit WEP encryption key.');
							return;
						}
					} else {
						if ( isValidKey(val, 5) == false ) {
							alert('Key '+(i+1)+' "'+ val + '" is invalid. Please enter 5 ASCII characters or 10 hexadecimal digits for a 64-bit WEP encryption key.');
							return;
						}
					}
				}
			}				
			//loc += submitSelect(wlKeyIndex);
			loc += '&wlKeyIndex_wl0v1=' + wlKeyIndex.options[wlKeyIndex.selectedIndex].value;
			loc += '&wlKey1_wl0v1=' + encodeUrl(wlKeys[0].value);
			loc += '&wlKey2_wl0v1=' + encodeUrl(wlKeys[1].value);
			loc += '&wlKey3_wl0v1=' + encodeUrl(wlKeys[2].value);
			loc += '&wlKey4_wl0v1=' + encodeUrl(wlKeys[3].value);
      					
		} else if(wlauth == 2){
			var wpaMode=getSelect(wpa);
			var cipher='aes';
			//alert('wlauth='+wlauth+'  wapMode='+wpaMode);

			if(wpaMode =='1')
				loc += '&wlAuthMode_wl0v1=psk';
			else if(wpaMode == '2')
				loc += '&wlAuthMode_wl0v1=wpa';
			cipher = 'tkip+aes';
		} else if(wlauth == 3){
			var wpaMode=getSelect(wpa2);
			//alert('wlauth='+wlauth+'  wapMode='+wpaMode); 
			if(wpaMode =='1')
				loc += '&wlAuthMode_wl0v1=psk2';
			else if(wpaMode == '2')
				loc += '&wlAuthMode_wl0v1=wpa2';
			cipher='aes';
}
	else if(wlauth == 4){
			var wpaMode=getSelect(wpauto);
			if(wpaMode =='1')
				loc += '&wlAuthMode_wl0v1=psk psk2';
			else if(wpaMode == '2')
				loc += '&wlAuthMode_wl0v1=wpa wpa2';
			cipher = 'tkip+aes';
		}

	if ( wlauth >= 2){
			var wpaMode,objvalue;
			if (wlauth == 2){
			 	wpaMode=getSelect(wpa);
				objvalue=parseInt(wlWpaGtkRekeywpa.value);
				loc += '&wlWpaGtkRekey_wl0v1=' + wlWpaGtkRekeywpa.value;
			}
			if (wlauth == 3){
			 	wpaMode=getSelect(wpa2);
				objvalue=parseInt(wlWpaGtkRekeywpa2.value);
				loc += '&wlWpaGtkRekey_wl0v1=' + wlWpaGtkRekeywpa2.value;
			}
			if (wlauth == 4){
			 	wpaMode=getSelect(wpauto);
				objvalue=parseInt(wlWpaGtkRekeywpa2mix.value);
				loc += '&wlWpaGtkRekey_wl0v1=' + wlWpaGtkRekeywpa2mix.value;
			}

			//alert('wpaMode='+wpaMode);
			
			if(wpaMode == 0){
				alert('please select WPA mode!');
				return;
			}

			if ( wlauth == 2 && (isNaN(wlWpaGtkRekeywpa.value) == true || isNaN(objvalue) == true || objvalue < 0 || objvalue > 0xffffffff )) {
				alert('WPA Group Rekey Interval "' + objvalue + '" should be between 0 and 4294967295.');
				return;
			}

			if ( wlauth == 3 && (isNaN(wlWpaGtkRekeywpa2.value) == true || isNaN(objvalue) == true || objvalue < 0 || objvalue > 0xffffffff )) {
				alert('WPA Group Rekey Interval "' + objvalue + '" should be between 0 and 4294967295.');
				return;
			}	
			if ( wlauth == 4 && (isNaN(wlWpaGtkRekeywpa2mix.value) == true || isNaN(objvalue) == true || objvalue < 0 || objvalue > 0xffffffff )) {
				alert('WPA Group Rekey Interval "' + objvalue + '" should be between 0 and 4294967295.');
				return;
			}	
			if (wpaMode == 1){

				loc += '&wlWep_wl0v1=disabled';
				loc += '&wlWpa_wl0v1=' + cipher;	// changed to aes by Rome.Huang@Ayecom.com
				loc += '&wlPreauth_wl0v1=0';
				loc += '&wlAuth_wl0v1=0';

				var value = wlWpaPsk.value;
				if ( isValidWPAPskKey(value) == false ) {
					alert('WPA Pre-Shared Key should be between 8 and 63 ASCII characters or 64 hexadecimal digits.');
					return;
				} 
				loc += '&wlWpaPsk_wl0v1=' + encodeUrl(wlWpaPsk.value);
			}
			else if(wpaMode ==2){
				loc += '&wlWep_wl0v1=disabled';
				loc += '&wlWpa_wl0v1=' + cipher;
				loc += '&wlPreauth_wl0v1=0';
				loc += '&wlAuth_wl0v1=0';
				//	check Reauth interval
      				value = parseInt(wlNetReauth.value);
				if (  isNaN(wlNetReauth.value) == true || value < 0 || value > 0xffffffff ) {
					alert('WPA Network Reauthentication Interval "' + wlNetReauth.value + '" should be between 0 and 4294967295.');
         				return;
				}
				loc += '&wlNetReauth_wl0v1=' + wlNetReauth.value;    
			
				if ( isValidIpAddress(wlRadiusIPAddr.value) == false ) {
					alert('RADIUS Server IP Address "' + wlRadiusIPAddr.value + '" is invalid IP address.');
					return;
				}
				if (isValidPort(wlRadiusPort.value) == false ) {
					alert('RADIUS Server Port "' + wlRadiusPort.value + '" is invalid Port.');
         			return;
         		}
         		value = wlRadiusKey.value;
         		if ( isValidWPAPskKey(value) == false ) {
            		alert('RADIUS server Shared Secret should be between 8 and 63 ASCII characters or 64 hexadecimal digits.');
            		return;
         		}
				loc += '&wlRadiusServerIP_wl0v1=' + wlRadiusIPAddr.value;
					
				loc += '&wlRadiusPort_wl0v1=' + wlRadiusPort.value;
				loc += '&wlRadiusKey_wl0v1=' + encodeUrl(wlRadiusKey.value);
			}
		
	    }      
   }
   loc += '&wlWscConfig=ap-pbc';
   loc += '&wsc_apLockCap=1'; 
   var code = 'location="' + loc + '"';


   eval(code);

document.forms[0].save_button.disabled = 1;
}

function wlgClick(obj){
	   var variable = obj.checked;
	   if ( variable == true ){
      		document.forms[0].wlSsid_2.disabled = 0;
       		document.forms[0].wlHide_2.disabled = 0;
       		document.forms[0].wlAPIsolation_wl0v1.disabled = 0;
       		document.forms[0].wlAuthMode.disabled = 0;
			document.forms[0].wlKeyBit.disabled=0;
			document.forms[0].wlKeys[0].disabled=0;
			document.forms[0].wlKeys[1].disabled=0;
			document.forms[0].wlKeys[2].disabled=0;
			document.forms[0].wlKeys[3].disabled=0;
			document.forms[0].wlKeyIndex.disabled=0;
			document.forms[0].WepAuth.disabled=0;
			document.forms[0].wpa.disabled=0;
			document.forms[0].wlWpaGtkRekeywpa.disabled=0;
			document.forms[0].wpa2.disabled=0;
			document.forms[0].wlWpaGtkRekeywpa2.disabled=0;	
			document.forms[0].wpauto.disabled=0;
			document.forms[0].wlWpaGtkRekeywpa2mix.disabled=0;
			document.forms[0].wlWpaPsk.disabled=0;
			document.forms[0].wlNetReauth.disabled=0;
			document.forms[0].wlRadiusIPAddr.disabled=0;
			document.forms[0].wlRadiusPort.disabled=0;
			document.forms[0].wlRadiusKey.disabled=0;						
	}
	   else{
		document.forms[0].wlSsid_2.disabled = 1;
       		document.forms[0].wlHide_2.disabled = 1;
       		document.forms[0].wlAPIsolation_wl0v1.disabled = 1;
       		document.forms[0].wlAuthMode.disabled = 1;
			document.forms[0].wlKeyBit.disabled=1;
			document.forms[0].wlKeys[0].disabled=1;
			document.forms[0].wlKeys[1].disabled=1;
			document.forms[0].wlKeys[2].disabled=1;
			document.forms[0].wlKeys[3].disabled=1;
			document.forms[0].wlKeyIndex.disabled=1;
			document.forms[0].WepAuth.disabled=1;
			document.forms[0].wpa.disabled=1;
			document.forms[0].wlWpaGtkRekeywpa.disabled=1;
			document.forms[0].wpa2.disabled=1;
			document.forms[0].wlWpaGtkRekeywpa2.disabled=1;	
			document.forms[0].wpauto.disabled=1;
			document.forms[0].wlWpaGtkRekeywpa2mix.disabled=1;	
			document.forms[0].wlWpaPsk.disabled=1;			
			document.forms[0].wlNetReauth.disabled=1;
			document.forms[0].wlRadiusIPAddr.disabled=1;
			document.forms[0].wlRadiusPort.disabled=1;
			document.forms[0].wlRadiusKey.disabled=1;			
   	}	
}
function displayMode(cb,i)
{
var value = cb.selectedIndex;
//alert('enter displayMode:value= '+value);

with (document.forms[0]) {
	wep.style.display = "none";
	wpa1mode.style.display = "none";
	wpa2mode.style.display = "none";
	wpautomode.style.display = "none";
	shared.style.display = "none";
	eap.style.display = "none";
	//eapadv.style.display = "none";
	eapvalue = 0;
  switch (value){		
  	case 0:
		lbwpamode.innerHTML="";
		break;
	case 1:
		wep.style.display = "block";
		lbwpamode.innerHTML="";
		break;
	case 2:
		wpa1mode.style.display = "block";
		wlWpaGtkRekeywpa.value = wpaGTKRekey;
		lbwpamode.innerHTML="&nbsp;(TKIP or AES)";
		if(i == 1)
  			setSelect(wpa,0);
	//	shared.style.display = "block";
		break;
	case 3:
		wpa2mode.style.display = "block";
		wlWpaGtkRekeywpa2.value = wpaGTKRekey;
		lbwpamode.innerHTML="&nbsp;(AES)";
		if(i == 1)
  			setSelect(wpa2,0);
	//	shared.style.display = "block";
		break;	
	case 4:
		wpautomode.style.display = "block";
		wlWpaGtkRekeywpa2mix.value = wpaGTKRekey;
		lbwpamode.innerHTML="&nbsp;(TKIP or AES)";
		if(i == 1)
  			setSelect(wpauto,0);
	//	eap.style.display = "block";
		break;
  }
  }
}
function displayWPAMode(cb)// add by jack 11.15
{
var value = cb.selectedIndex;

with (document.forms[0]) {
//	wep.style.display = "none";
//	wpa.style.display = "none";
	shared.style.display = "none";
	eap.style.display = "none";
	//eapadv.style.display = "none";
	eapvalue = 0;
  switch (value){		
	case 0:
	//	wep.style.display = "block";
		break;
	case 1:
	//	wpa.style.display = "block";
		shared.style.display = "block";
		break;
	case 2:
	//	wpa.style.display = "block";
		eap.style.display = "block";
		break;	
  }
}
}

function isValidWPAPskKey(val) {
   var ret = false;
   var len = val.length;
   var maxSize = 64;
   var minSize = 8;

   if ( len >= minSize && len < maxSize )
      ret = true;
   else if ( len == maxSize ) {
      for ( i = 0; i < maxSize; i++ )
         if ( isHexaDigit(val.charAt(i)) == false )
            break;
      if ( i == maxSize )
         ret = true;
   } else
      ret = false;

   return ret;
}
// done hiding -->

        </script>
  <!--    <script language="JavaScript" src="menu.html"></script> -->
   </head>
<body onLoad='frmLoad()'>

<blockquote>
<script language="JavaScript">
TabHeader="Advanced";
SideItem="Advanced Wireless";
HelpItem="wirelessadv";
</script> 
<script type='text/javascript'>
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
</script>
	<table id=box_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Wireless -- Advanced Settings
			</td>										
		</tr>
		<tr>
			<td class=content>
				<p>
				This page allows you to configure advanced features of the wireless LAN 
            interface. You can select a particular channel on which to operate, force the 
            transmission rate to a particular speed, set the fragmentation threshold, set 
            the RTS threshold, set the wake up interval for clients in power-save mode, set 
            the beacon interval for the access point, set XPress mode and set whether short 
            or long preambles are used.</p><p>
            Click "Save/Apply" to configure the advanced wireless options.</p>
			
			</td>
		</tr>
	</table>
	<table id=body_header width="690" border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Advanced Settings 
			</td>										
		</tr>
		<tr>
			<td class=content>

         <form>
            <br>
          

           <table border="0" cellpadding="0" cellspacing="0">
               <tr>
                  <td width="180">Band:</td>
                  <script language="javascript">
		<!-- hide
		if ( bands == '3' ) { // dual band
     		    document.writeln(' <td><select name="wlBand" size="1" onChange="wl_recalc(false);">');
         		document.writeln('      <option value=2>2.4GHz');
         		document.writeln('      <option value=1>5GHz');         
			}
		else if (bands == '1') {
         		document.writeln(' <td><select name="wlBand" size="1" onChange="wl_recalc(false);">');
         		document.writeln('      <option value=1>5GHz');         
		}
		else {
         		document.writeln(' <td><select name="wlBand" size="1" onChange="wl_recalc(false);">');
         		document.writeln('      <option value=2>2.4GHz');
		}
		// done hiding -->
		</script>
                  </select></td>
               </tr>
               <tr>
                  <td width="180">Channel:</td>
                  <td td width="200"><select name='wlChannel' size="1" onChange="wl_recalc(false)">
                     </select>
                  </td>
         <!--
                  <td>
                     <div id="CurChannel">
                         Current Channel:
                     </div>
                  </td>     
           -->
               </tr>
               <!--<tr>
                  <td width="180">Auto Channel Timer(min)</td>
                  <td><input type='text' name='wlCsScanTimer' size='10'></td>
               </tr>-->               
            </table>
            <div id="div_nMode_sel">    
               <table border="0" cellpadding="0" cellspacing="0">
	          <tr style="DISPLAY: none"> 
                     <td width="180">802.11n/EWC:</td>
                     <td width="200"><select name='wlNmode' size="1" onChange="onNmodeChange(false)">
                        <option value="auto">
                        Auto
                        <option value="off">
                        Disabled
                     </select></td>
                  </tr>
               </table>
            </div>            
            <div id="div_nMode">    
               <table border="0" cellpadding="0" cellspacing="0">               
	          <tr> 
                     <td width="180">Bandwidth:</td>
                     <td width="200"><select name='wlNBwCap' size="1" onChange="wl_recalc(false)">
                        <option value="0">
                        20MHz
                        <option value="1">
                        Auto 20/40MHz
                  	<script language="javascript">
			<!-- hide
			if ( bands == '3' ) { // dual band
         		document.writeln('<option value=2>20MHz in 2.4G Band and 40MHz in 5G Band');
        	        }
			// done hiding -->
			</script>
                     </select></td>
                     <!--
                  <td>
                     <div id="CurNbw">
                         Current Bandwidth:
                     </div>
                  </td>  
                  -->
                  </tr>                   
	          <!--<tr> 
                     <td width="180">Control Sideband:</td>
                     <td width="200"><select name='wlNCtrlsb' size="1" onChange="wl_recalc(false)">
                        <option value="-1">
                        Lower
                        <option value="1">
                        Upper
                     </select></td>
                     <!--
                  <td>
                     <div id="CurNCtrlsb">
                         Current Control Sideband:
                     </div>
                  </td>
                  </tr>-->
                  <tr style="DISPLAY: none">   
                     <td width="180">802.11n Rate:</td>
                     <td><select name='wlNMmcsidx' size="1"  onChange="wl_mcs_onchange()";>
                     </select>
                     </td>
                  </tr>
                  <tr style="DISPLAY: none">
                     <td width="180">802.11n Protection:</td>
                     <td><select name="wlNProtection" size="1">
                           <option value="off">
                           Off
                           <option value="auto">
                           Auto
                        </select></td>
                  </tr>
                  <tr>
                     <td width="180"> Support 802.11n Client Only:</td>
                     <td><select name="wlNReqd" size="1">
                           <option value="0">
                           Off
                           <option value="1">
                           On
                        </select></td>
                  </tr>
                  <tr style="DISPLAY: none">
                     <td width="180"> OBSS Co-Existance:</td>
                     <td><select name="wlObssCoex" size="1">
                           <option value="0">
                           Disable
                           <option value="1">
                           Enable
                         </select></td>
                  </tr>                  
            	</table>
            </div> 
            <table border="0" cellpadding="0" cellspacing="0">
               <tr style="DISPLAY: none">
                  <td width="180"> 54g&#8482; Rate: </td>
                  <td><select name='wlRate' size="1">
                     </select></td>
               </tr>
               <tr style="DISPLAY: none">
                  <td width="180">Multicast Rate:</td>
                  <td><select name='wlMCastRate' size="1">
                     </select></td>
               </tr>
               <tr>
                  <td width="180">Basic Rate:</td>
                  <td><select name='wlBasicRate' size="1">
                     </select></td>
               </tr>               
               <tr>
                  <td width="180">Fragmentation Threshold(byte):</td>
                  <td><input type='text' name='wlFrgThrshld' size='10'></td>
               </tr>
               <tr>
                  <td width="180">RTS Threshold(byte):</td>
                  <td><input type='text' name='wlRtsThrshld' size='10'></td>
               </tr>
               <tr>
                  <td width="180">DTIM Interval(ms):</td>
                  <td><input type='text' name='wlDtmIntvl' size='10'></td>
               </tr>
               <tr>
                  <td width="180">Beacon Interval(ms):</td>
                  <td><input type='text' name='wlBcnIntvl' size='10'></td>
               </tr>
<!--
               <tr>
                  <td width="180">Global Max Clients:</td>
                  <td><input type='text' name='wlGlobalMaxAssoc' size='10'></td>
               </tr>                
               <tr>

                  <td width="180">XPress&#8482; Technology:</td>
                  <td><select name='wlFrameBurst' size="1">
                        <option value="off">
                        Disabled
                        <option value="on">
                        Enabled
                     </select></td>
 -->                    
               </tr> 
            </table>  
            <div id="div_gMode">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr style="DISPLAY: none">
                     <td width="180">54g&#8482; Mode:</td>
                     <td><select name="wlgMode" size="1" onChange="wl_recalc(false)">
                           <option value="1">
                           54g Auto
                           <option value="4">
                           54g Performance
                           <option value="5">
                           54g LRS
                           <option value="0">
                           802.11b Only
                           <option value="2">
                           54g Only
                        </select></td>
                  </tr>
                  <tr style="DISPLAY: none">
                     <td width="180">54g&#8482; Protection:</td>
                     <td><select name="wlProtection" size="1">
                           <option value="off">
                           Off
                           <option value="auto">
                           Auto
                        </select></td>
                  </tr>
               </table>
            </div>
            <div id="div_regMode">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
                     <td width="180">Regulatory Mode:</td>
                     <td><select name="wlRegMode" size="1" onChange='RegModeChange(false)'>
                           <option value="0">
                           Disabled
                           <option value="1">
                           802.11h
                           <option value="2">
                           802.11d
                        </select></td>
                  </tr>
                  <tr>
                     <td width="180">Pre-Network Radar Check:</td>
                     <td><input type='text' name='wlDfsPreIsm' size='2'></td>
                  </tr>
                  <tr>
                     <td width="180">In-Network Radar Check:</td>
                     <td><input type='text' name='wlDfsPostIsm' size='2'></td>
                  </tr>
                  <tr>
                     <td width="180">TPC Mitigation(db):</td>
                     <td><select name="wlTpcDb" size="1">
                           <option value="0">
                           0(off)
                           <option value="2">
                           2
                           <option value="3">
                           3
                           <option value="4">
                           4                           
                        </select></td>
                  </tr>
               </table>
            </div>
            <div id="AFB">    
               <table border="0" cellpadding="0" cellspacing="0">  
	           <tr> 
                        <td width="180">Afterburner Technology:</td>
                        <td><select name='wlAfterBurnerEn' size="1" onChange='wl_afterburner_options(false)'>
                                <option value="off">
                                Disabled
                                <option value="auto">
                                Enabled
                                </select></td>
                        <td width="180">(Disable WMM for Selection)</td>        				
                   </tr> 
            	</table>
            </div>     	   
            <div id="preambleType">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
                     <td width="180">Preamble Type:</td>
                     <td><select name="wlPreambleType" size="1">
                           <option value="long">
                           long
                           <option value="short">
                           short
                        </select></td>
                  </tr>
               </table>
            </div>
            <div id="WLTXPOWER">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
                     <td width="180"> Transmit Power:</td>
                     <td><select name="wlTxPower" size="1">
                           <option value="20">
                           20%
                           <option value="40">
                           40%
                           <option value="60">
                           60%
                           <option value="80">
                           80%
                           <option value="100">
                           100%
                        </select></td>
                  </tr>
               </table>
            </div>   
       
            <div id="WLWMM">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
                     <td width="180">WMM(Wi-Fi Multimedia):</td>
          			 <td><select name='wlWme' size="1" onchange="wmeChange(false)">
          			     <option value="-1">Auto</option>
          		  	     <option value="0">Disabled</option>
          		  	     <option value="1">Enabled</option>          		  	     
          		  	     </select>
		             </td>
		             <td>
			             <div id="WMMWarning">
			             </div>
		             </td>
                  </tr>
               </table>
            </div>
            
            <!--
            <div id="WLWMMNOACK">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
                     <td width="180">WMM No Acknowledgement:</td>
		             <td><select name='wlWmeNoAck' size="1">
			         <option value="0">Disabled</option>
			         <option value="1">Enabled</option>
			         </select></td> 
                  </tr>
               </table>
            </div>
            <div id="WLWMMAPSD">
               <table border="0" cellpadding="0" cellspacing="0">
                  <tr>
                     <td width="180">WMM APSD:</td>
		             <td><select name='wlWmeApsd' size="1">
			         <option value="0">Disabled</option>
			         <option value="1">Enabled</option>
			         </select></td> 
                  </tr>
               </table>
            </div>         
      -->
  <!--          <br>  

			               <div id="wlLegacyGuestInfo">
               <table border="0" cellpadding="4" cellspacing="0">
                  <tr>
                     <td valign="middle" align="center" width="30" height="30">
                        <input type='checkbox' name='wlEnbl_2' value="ON"></td>
                     <td>Enable Wireless Guest Network</td>
                  </tr>
               </table>
               <table border="0" cellpadding="4" cellspacing="0">
                  <tr>
                     <td width="100">Guest SSID:</td>
                     <td>
                        <input type='text' name='wlSsid_2' maxlength="32" size="32"></td>
                  </tr>
               </table>
			       </div>   
			 <div id="wlMBSSInfo">
              <br><b>Wireless - Guest/Virtual Access Points:</b><br>
              <table border="0" cellpadding="4" cellspacing="0">
                 <tr> <td>
                 <table border='1' cellpadding='2' cellspacing='0' align="left" >
                    <tr>
                       <td class='hd' valign="middle" align="center" width="30" height="30" >Enabled</td>                    
                       <td class='hd' valign="middle" align="center" width="30" height="30" >SSID</td>
                       <td class='hd' valign="middle" align="center" width="30" height="30" >Hidden</td>                       
                       <td class='hd' valign="middle" align="center" width="30" height="30" >Isolate Clients</td>
                       <td class='hd' valign="middle" align="center" width="30" height="30" >Disable WMM Advertise</td>
                       <td class='hd' valign="middle" align="center" width="30" height="30" >Max Clients</td>                                            
                       <td class='hd' valign="middle" align="center" width="30" height="30" >BSSID</td>
                    </tr>
                       <%ejGetWl(wlMbssTbl)%>
                 </table>
                 </td></tr>
              </table>
           <br>
           <br>            
           </div>-->
            
      		</td>
		</tr>
	</table>
<!--<div id="guestInfo" style="DISPLAY: none">	-->
<TABLE id=body_header cellSpacing=0 width=690 border=0>
    
    <TR>
      <TD class=topheader>GUEST Wireless Settings </TD></TR>
    <TR>
      <TD class=content>

        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label><LABEL for=radio_control>Enable Wireless Guest Network&nbsp;:</LABEL></TD>
            <TD><INPUT type='checkbox' id=radio_control name='wlEnbl_2' onClick='wlgClick(this)'> </TD></TR>
          <TR>
            <TD class=form_label>
              <DIV>Wireless Network Name (SSID)&nbsp;:</DIV></TD>
            <TD><INPUT type='text' id=SSID  name='wlSsid_2' maxLength=32></TD></TR>
   
          <TR>
            <TD class=form_label><LABEL>Hide Wireless Network :</LABEL></TD>
            <TD><INPUT id=hideacces type=checkbox name='wlHide_2'></TD>
		  </TR>
		   <tr>
            <td class=form_label width="180">AP Isolation&nbsp;:</td>
            <td><select name='wlAPIsolation_wl0v1' size="1" class="changefont">
                        <option value="0">
                        Off
                        <option value="1">
                        On
                     </select></td>
               </tr>
            </TBODY></TABLE>
		  
        </TD></TR></TABLE>  

  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>GUEST Wireless Security Mode </TD></TR>
    <TR>
      <TD class=content>
        <P>To protect your privacy you can configure wireless security features. 
        This device supports three wireless security modes including: WEP, 
        WPA, WPA2 and Auto.<br><p>The <STRONG>WEP</STRONG> mode is the original wireless encryption standard.WPA provides
        a higher level of security.</p>
        For maximum compatibility,use <STRONG>WPA</STRONG>.This mode uses TKIP cipher.Some gaming and legacy devices work
        only in this mode.For best security,use <STRONG>WPA2</STRONG> mode.This mode uses AES(CCMP) cipher and legacy stations
        are not allowed access with WPA security.Use <STRONG>Auto(WPA or WPA2)</STRONG> mode to achieve a balance of strong
        security and best compatibility.This mode uses WPA for legacy clients while maintaining higher security with
        stations that are WPA2 capable.Also the strongest cipher that the client supports will be used<br>
        <p>To achieve better wireless performance use <STRONG>WPA2</STRONG> security mode (or in other words AES cipher).</p></P><!--@ENDOPTIONAL@-->
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label>Security Mode&nbsp;:</TD>
            <TD><SELECT id=authmode  name='wlAuthMode' onchange=displayMode(this,1)>
            <OPTION value=0 selected>None</OPTION> 
            <OPTION value=1>WEP</OPTION>
          	<OPTION value=2>WPA</OPTION>
            <OPTION value=3>WPA2</OPTION>
            <OPTION value=4>Auto (WPA or WPA2)</OPTION>
           </SELECT></TD><TD><LABEL id=lbwpamode name="lbwpamode"></LABEL></TD>
        </TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
  <DIV id=wep style="DISPLAY: none">
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>WEP </TD></TR>
    <TR>
      <TD class=content>
        <DIV class="box box_alert">
        <P>If you choose the WEP security option this device will 
        <STRONG>ONLY</STRONG> operate in <STRONG>Legacy Wireless mode 
        (802.11B/G)</STRONG>. This means you will <STRONG>NOT</STRONG> get 11N 
        performance due to the fact that WEP is not supported by the Draft 11N 
        specification.</P></DIV>
        <P>WEP is the wireless encryption standard. To use it you must enter the 
        same key(s) into the router and the wireless stations. For 64 bit keys 
        you must enter 10 hex digits into each key box. For 128 bit keys you 
        must enter 26 hex digits into each key box. A hex digit is either a 
        number from 0 to 9 or a letter from A to F. For the most secure use of 
        WEP set the authentication type to "Shared Key" when WEP is enabled.</P>
        <P>You may also enter any text string into a WEP key box, in which case 
        it will be converted into a hexadecimal key using the ASCII values of 
        the characters. A maximum of 5 text characters can be entered for 64 bit 
        keys, and a maximum of 13 characters for 128 bit keys.</P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label>WEP Key Length&nbsp;:</TD>
            <TD><SELECT _VALUE="data.wireless.keylen" name='wlKeyBit'>
		<OPTION value="0" selected>128 bit (13 characters or 26 hex digits)</OPTION>
		<OPTION value="1" >64 bit (5 characters or 10 hex digits)</OPTION>
		</SELECT>
          </TD><TD class=form_label> (length applies to all keys) </TD></TR>

          <TR>
            <TD class=form_label><LABEL for=wep_key0>WEP Key 
            1&nbsp;:</LABEL></TD>
            <TD><INPUT id=wep_key0 type="text" maxLength=26 size=30 
              name="wlKeys" _VALUE="data.wireless.wep_key[0]"> </TD></TR>
          <TR>
                    
            <TD class=form_label><LABEL for=wep_key1>WEP Key 
            2&nbsp;:</LABEL></TD>
            <TD><INPUT id=wep_key1 type="text"  maxLength=26 size=30 
              name="wlKeys" _VALUE="data.wireless.wep_key[1]"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=wep_key2>WEP Key 
            3&nbsp;:</LABEL></TD>
            <TD><INPUT id=wep_key2 type="text"  maxLength=26 size=30 
              name="wlKeys" _VALUE="data.wireless.wep_key[2]"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=wep_key3>WEP Key 
            4&nbsp;:</LABEL></TD>
            <TD><INPUT id=wep_key3 type="text"  maxLength=26 size=30
              name="wlKeys" _VALUE="data.wireless.wep_key[3]"> </TD></TR>
          <TR>
          
            <TD class=form_label>Default WEP Key&nbsp;:</TD>
            <TD><SELECT _VALUE="data.wireless.use_key" name='wlKeyIndex'> 
            <OPTION value=1 selected>WEP Key 1</OPTION> 
            <OPTION value=2>WEP Key 2</OPTION> 
            <OPTION value=3>WEP Key 3</OPTION> 
            <OPTION value=4>WEP Key 4</OPTION>
            </SELECT> </TD></TR>      
          <TR>
            <TD class=form_label>Authentication&nbsp;:</TD>
            <TD><SELECT _VALUE="data.wireless.auth" name="WepAuth"> 
            <OPTION value=1 selected>Open</OPTION> 
            <OPTION value=2>Shared Key</OPTION>
            </SELECT> 
  </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
  <DIV id=wpa1mode style="DISPLAY: none">
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>WPA </TD></TR>
    <TR>
      <TD class=content>
        <P>WPA-Personal does not require an autherntication server.The WPA-Enterprise option requires
         an external RADIUS server</P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label>WPA Mode&nbsp;:</TD>
            <TD><SELECT id=wpamode name="wpa" onchange=displayWPAMode(this)> 
             <OPTION value=0 selected>(Click to Select)</OPTION> 
             <OPTION value=1>WPA-PSK (Personal)</OPTION> 
             <OPTION value=2>WPA (Enterprise)</OPTION>
           		</SELECT> </TD></TR>		
          
          <TR>
            <TD class=form_label><LABEL for=wpa_rekey_time>Group Key Update 
              Interval&nbsp;:</LABEL></TD>
            <TD><INPUT id=wpa_rekey_time size=10 name="wlWpaGtkRekeywpa"> (seconds) 
        </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>

   <DIV id=wpa2mode style="DISPLAY: none">
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>WPA2 </TD></TR>
    <TR>
      <TD class=content>
        <P>WPA-Personal does not require an autherntication server.The WPA-Enterprise option requires
         an external RADIUS server</P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label>WPA Mode&nbsp;:</TD>
            <TD><SELECT id=wpamode name="wpa2" onchange=displayWPAMode(this)> 
             <OPTION value=0 selected>(Click to Select)</OPTION> 
             <OPTION value=1>WPA2-PSK (Personal)</OPTION> 
             <OPTION value=2>WPA2 (Enterprise)</OPTION>
           </SELECT> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=wpa_rekey_time>Group Key Update 
              Interval&nbsp;:</LABEL></TD>
            <TD><INPUT id=wpa_rekey_time size=10 name="wlWpaGtkRekeywpa2"> (seconds) 
        </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>

  <DIV id=wpautomode style="DISPLAY: none">
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>AUTO (WPA OR WPA2) </TD></TR>
    <TR>
      <TD class=content>
        <P>WPA-Personal does not require an autherntication server.The WPA-Enterprise option requires
         an external RADIUS server</P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label>WPA Mode&nbsp;:</TD>
            <TD><SELECT id=wpamode name="wpauto" onchange=displayWPAMode(this)> 
             <OPTION value=0 selected>(Click to Select)</OPTION> 
             <OPTION value=1>WPA/WPA2-PSK (Personal)</OPTION> 
             <OPTION value=2>WPA/WPA2 (Enterprise)</OPTION>
           </SELECT> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=wpa_rekey_time>Group Key Update 
              Interval&nbsp;:</LABEL></TD>
            <TD><INPUT id=wpa_rekey_time size=10 name="wlWpaGtkRekeywpa2mix"> (seconds)
        </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>

        <DIV id=shared style="DISPLAY: none">
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>Pre-Shared Key </TD></TR>
    <TR>
      <TD class=content>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label><LABEL for=wpa_psk>Pre-Shared 
              Key&nbsp;:</LABEL></TD>
            <TD><INPUT id=wpa_psk type="text"  maxLength=64 
              _VALUE="data.wireless.wpa_psk" name="wlWpaPsk"> 
  </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>

  <DIV id=eap style="DISPLAY: none">
  <TABLE id=body_header cellSpacing=0 border=0>
    <TBODY>
    <TR>
      <TD class=topheader>EAP (802.1x) </TD></TR>
    <TR>
      <TD class=content>
        <P>When WPA enterprise is enabled, the router uses EAP (802.1x) to 
        authenticate clients via a remote RADIUS server. </P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0>
          <TBODY>
          <TR>
            <TD class=form_label><LABEL for=reauth_time>Authentication 
              Timeout&nbsp;:</LABEL></TD>
            <TD><INPUT id=reauth_time size=10 
              _VALUE="data.wireless.ieee8021x_reauth_time" name="wlNetReauth"> (seconds) </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=radius_server_address>RADIUS 
              server IP Address&nbsp;:</LABEL></TD>
            <TD><INPUT id=radius_server_address 
              _VALUE="data.wireless.radius_server_address" name="wlRadiusIPAddr"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=radius_server_port>RADIUS server 
              Port&nbsp;:</LABEL></TD>
            <TD><INPUT id=radius_server_port size=10 
              _VALUE="data.wireless.radius_server_port" name="wlRadiusPort"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=radius_shared_secret>RADIUS server 
              Shared Secret&nbsp;:</LABEL></TD>
            <TD><INPUT id=radius_shared_secret maxLength=64 
              _VALUE="data.wireless.radius_shared_secret" name="wlRadiusKey"> </TD></TR>
          <TR>
       </TBODY></TABLE>
    	<DIV id=eapadv style="DISPLAY: none">
        <P class=box_msg>Optional backup RADIUS server: </P>
        <TABLE class=formarea cellSpacing=0 cellPadding=0 summary="" border=0 
        _DISPLAYED="show_advanced">
          <TBODY>
          <TR>
            <TD class=form_label><LABEL 
              for=second_radius_server_address>Second RADIUS server IP 
              Address&nbsp;:</LABEL></TD>
            <TD><INPUT id=second_radius_server_address 
              _VALUE="data.wireless.second_radius_server_address"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=second_radius_server_port>Second 
              RADIUS server Port&nbsp;:</LABEL></TD>
            <TD><INPUT id=second_radius_server_port size=10 
              _VALUE="data.wireless.second_radius_server_port"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=second_radius_shared_secret>Second 
              RADIUS server Shared Secret&nbsp;:</LABEL></TD>
            <TD><INPUT id=second_radius_shared_secret maxLength=64 
              _VALUE="data.wireless.second_radius_shared_secret"> </TD></TR>
          <TR>
            <TD class=form_label><LABEL for=second_radius_auth_mac>Second MAC 
              Address Authentication&nbsp;:</LABEL></TD>
            <TD><INPUT id=second_radius_auth_mac type=checkbox 
              _VALUE="data.wireless.second_radius_auth_mac"> 
        </TD></TR></TBODY></TABLE></DIV> </TD></TR></TBODY></TABLE></DIV>			
<!--</div>	-->
<P align=center><input type='button' onClick='btnApply()' value='Save/Apply' name='save_button'></p>
         </form>

<script type='text/javascript'>
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
</script>
      </blockquote>
   </body>
</html>
