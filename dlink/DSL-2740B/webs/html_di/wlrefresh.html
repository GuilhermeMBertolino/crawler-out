<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
<style>
HTML {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
BODY {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
DIV {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
P {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
TD {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
INPUT {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
SELECT {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
TEXTAREA {
	FONT-SIZE: 12px; FONT-FAMILY: Tahoma, Helvetica, Geneva, Arial, sans-serif
}
BODY {
	MARGIN: 1px 0px auto; BACKGROUND-COLOR: #757575
}
#header_container {
	BORDER-RIGHT: #ffffff 1px solid; PADDING-RIGHT: 0px; BORDER-TOP: #ffffff 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 5px; BORDER-LEFT: #ffffff 1px solid; WIDTH: 100%; COLOR: white; PADDING-TOP: 5px; BORDER-BOTTOM: #ffffff 0px; HEIGHT: 20px; BACKGROUND-COLOR: #404343
}
#header_container TD {
	PADDING-RIGHT: 5px; PADDING-LEFT: 5px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; WHITE-SPACE: nowrap
}
#header_container A:link {
	FONT-SIZE: 10px; COLOR: #ffffff; TEXT-DECORATION: none
}
#header_container A:visited {
	FONT-SIZE: 10px; COLOR: #ffffff; TEXT-DECORATION: none
}
#copyright {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; FONT-SIZE: 11px; PADDING-BOTTOM: 10px; MARGIN: 0px auto; COLOR: #ffffff; PADDING-TOP: 10px; TEXT-ALIGN: center
}
#header_container A:active {
	FONT-SIZE: 10px; COLOR: #ffffff; TEXT-DECORATION: none
}
#header_container A:hover {
	FONT-SIZE: 10px; COLOR: #ffffff; TEXT-DECORATION: underline
}
#masthead_container {
	BORDER-RIGHT: #ffffff 1px solid; PADDING-RIGHT: 0px; BORDER-TOP: #ffffff 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; BORDER-LEFT: #ffffff 1px solid; WIDTH: 100%; PADDING-TOP: 0px; BORDER-BOTTOM: #ffffff 0px; BACKGROUND-COLOR: #404343
}
#masthead_container TD {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; BACKGROUND-IMAGE: url(img_bg_masthead.gif); PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px; BACKGROUND-REPEAT: repeat; TEXT-ALIGN: right
}
#topnav_container {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; WIDTH: 100%; PADDING-TOP: 0px; BACKGROUND-COLOR: #ffffff
}
#topnav_container TD {
	PADDING-RIGHT: 1px; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; PADDING-TOP: 1px; BACKGROUND-COLOR: #404343
}
#topnav_container #modnum {
	WIDTH: 125px
}
.topnavon {
	FONT-WEIGHT: normal; FONT-SIZE: 12px; BORDER-LEFT-COLOR: #ffffff; BORDER-BOTTOM-COLOR: #ffffff;  BORDER-TOP-COLOR: #ffffff; LETTER-SPACING: 1px; BORDER-RIGHT-COLOR: #ffffff
}
.topnavon A:link {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-ALIGN: center; TEXT-DECORATION: none
}
.topnavon A:visited {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-ALIGN: center; TEXT-DECORATION: none
}
.topnavon A:active {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-ALIGN: center; TEXT-DECORATION: none
}
.topnavon A:hover {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-ALIGN: center; TEXT-DECORATION: none
}
.topnavoff A:link {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BORDER-LEFT-COLOR: #ffffff; BORDER-BOTTOM-COLOR: #ffffff; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #ffffff; BORDER-TOP-COLOR: #ffffff; PADDING-TOP: 5px; LETTER-SPACING: 1px; BACKGROUND-COLOR: transparent; TEXT-ALIGN: center; TEXT-DECORATION: none; BORDER-RIGHT-COLOR: #ffffff
}
.topnavoff A:visited {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BORDER-LEFT-COLOR: #ffffff; BORDER-BOTTOM-COLOR: #ffffff; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #ffffff; BORDER-TOP-COLOR: #ffffff; PADDING-TOP: 5px; LETTER-SPACING: 1px; BACKGROUND-COLOR: transparent; TEXT-ALIGN: center; TEXT-DECORATION: none; BORDER-RIGHT-COLOR: #ffffff
}
.topnavoff A:active {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BORDER-LEFT-COLOR: #ffffff; BORDER-BOTTOM-COLOR: #ffffff; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #ffffff; BORDER-TOP-COLOR: #ffffff; PADDING-TOP: 5px; LETTER-SPACING: 1px; BACKGROUND-COLOR: transparent; TEXT-ALIGN: center; TEXT-DECORATION: none; BORDER-RIGHT-COLOR: #ffffff
}
.topnavoff A:hover {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: bold; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; TEXT-TRANSFORM: uppercase; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-ALIGN: center; TEXT-DECORATION: underline
}
#content_container {
	BORDER-RIGHT: #ffffff 1px solid; PADDING-RIGHT: 0px; BORDER-TOP: #404343 1px solid; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; BORDER-LEFT: #ffffff 1px solid; WIDTH: 100%; PADDING-TOP: 0px; BACKGROUND-COLOR: #ffffff; BORDER-BOTTOM-STYLE: none; border-spacing: 0; HEIGHT:450
}
#content_container TD {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px
}
#sidenav_container {
	BORDER-RIGHT: #ffffff 1px solid; BORDER-TOP: #404343 0px solid; VERTICAL-ALIGN: top; WIDTH: 130px; BORDER-BOTTOM: #404343 1px solid; BACKGROUND-COLOR: #404343
}
#sidenav {
	FONT-SIZE: 11px; WIDTH: WIDTH: 130px;
}
#sidenav UL {
	PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px; BORDER-BOTTOM: #404343 1px solid; BACKGROUND-COLOR: #f1f1f1
}
#sidenav LI {
	BORDER-RIGHT: #404343 1px solid; BORDER-TOP: #404343 1px solid; MARGIN-BOTTOM: 1px; TEXT-TRANSFORM: uppercase; BORDER-LEFT: #404343 1px solid; BORDER-BOTTOM: #404343 1px solid; LIST-STYLE-TYPE: none; BACKGROUND-COLOR: #404343
}
#sidenav LI A:link {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #ffffff; PADDING-TOP: 5px; BACKGROUND-COLOR: transparent; TEXT-DECORATION: none
}
#sidenav LI A:visited {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #ffffff; PADDING-TOP: 5px; BACKGROUND-COLOR: transparent; TEXT-DECORATION: none
}
#sidenav LI A:active {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #ffffff; PADDING-TOP: 5px; BACKGROUND-COLOR: transparent; TEXT-DECORATION: none
}
#sidenav LI A:hover {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-DECORATION: underline
}
#sidenav .sidenavoff {
	FONT-SIZE: 11px; WIDTH: 128px
}
#sidenav .sidenavoff {
	FONT-SIZE: 11px; COLOR: #404343; BACKGROUND-COLOR: #f1f1f1
}
#sidenav .sidenavoff A:link {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-DECORATION: none
}
#sidenav .sidenavoff A:visited {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-DECORATION: none
}
#sidenav .sidenavoff A:active {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-DECORATION: none
}
#sidenav .sidenavoff A:hover {
	PADDING-RIGHT: 5px; DISPLAY: block; PADDING-LEFT: 5px; FONT-WEIGHT: normal; FONT-SIZE: 11px; PADDING-BOTTOM: 5px; COLOR: #404343; PADDING-TOP: 5px; BACKGROUND-COLOR: #f1f1f1; TEXT-DECORATION: none
}

#maincontent_container {
	VERTICAL-ALIGN: top; COLOR: #000000; BACKGROUND-COLOR: #ffffff
}
#maincontent {
	PADDING-RIGHT: 5px; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; COLOR: #000000; PADDING-TOP: 5px; BACKGROUND-COLOR: #ffffff;
width:50% ;TEXT-ALIGN: center
}
#box_header {
	BORDER-RIGHT: #0a89a1 1px solid; BORDER-TOP: #0a89a1 1px solid; BORDER-LEFT: #0a89a1 1px solid; BORDER-BOTTOM: #0a89a1 1px solid; BACKGROUND-COLOR: #dfdfdf; width:100%
}
#box_header .topheader {
	PADDING-RIGHT: 5px; PADDING-LEFT: 10px; FONT-WEIGHT: bold; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; MARGIN: 0px -10px 5px; TEXT-TRANSFORM: uppercase; COLOR: #000000; PADDING-TOP: 5px; LETTER-SPACING: 1px; BACKGROUND-COLOR: #0a89a1
}
#box_header .content {
	PADDING-LEFT: 10px; PADDING-TOP: 10px; PADDING-RIGHT: 10px; PADDING-BOTTOM: 10px;
}

#body_header {
	BORDER-RIGHT: #333333 1px solid; BORDER-TOP: #333333 1px solid; BORDER-LEFT: #333333 1px solid; BORDER-BOTTOM: #333333 1px solid; BACKGROUND-COLOR: #ffffff;MARGIN: 5px 0px 0px; width: 100%
}
#body_header .topheader{
	PADDING-RIGHT: 5px; PADDING-LEFT: 10px; FONT-WEIGHT: bold; FONT-SIZE: 12px; PADDING-BOTTOM: 5px; MARGIN: 0px -10px 5px; TEXT-TRANSFORM: uppercase; COLOR: #ffffff; PADDING-TOP: 5px; LETTER-SPACING: 1px; BACKGROUND-COLOR: #404343
}
#body_header .content {
	PADDING-LEFT: 10px; PADDING-TOP: 10px; PADDING-RIGHT: 10px; PADDING-BOTTOM: 10px;
}
#footer_container {
	BORDER-RIGHT: #ffffff 1px solid; BORDER-TOP: #ffffff 1px solid; BORDER-LEFT: #ffffff 1px solid; WIDTH: 100%; COLOR: #ffffff; BORDER-BOTTOM: #ffffff 0px; HEIGHT: 40px; BACKGROUND-COLOR: #404343
}
#footer_container TD {
	VERTICAL-ALIGN: bottom; TEXT-ALIGN: center
}
#footer_container #leftimage {
	WIDTH: 127px
}

div.overflow
{
	overflow: auto;
	width: 660px;
}
INPUT {

	PADDING-RIGHT: 4px; PADDING-LEFT: 4px; PADDING-BOTTOM: 2px; MARGIN: 0px 10px 0px 0px; PADDING-TOP: 2px; WHITE-SPACE: nowrap
}
</style>

            <script language="javascript">
<!-- hide
var wltempPage = '<%ejGetWirelessRefresh()%>';
var wltargetPage = '<%ejGetWirelessPage()%>';
var wlRefresh = '<%ejGetWl(wlRefresh)%>';

var widthNum=0;
var needReset = 1; 
var count = 0;

// shared function to refresh a page
function refreshPage(page) {
      var code = 'location="' + page + '"'; 
      window.defaultStatus = '';        
        
      eval(code); 
}
// shared wrapper function to refresh a page
function autoRefresh(val, refresh, page) {
   
var code = 'location="' + page + '"';
//alert(code+", refresh(),wltempPage=refresh="+refresh+",page=wltargetPage="+page);
//alert(refresh.match('wlcfgadv'));   
   //if ( val == '1' && refresh.match('wlcfgadv')) {
   if ( val == '1' ) {       

     if(count < 20)
   	{
//aids, 060803 added progress bar
   	count ++;
	//status = " Progress: " + count*5 + '%';	  
	status="";
	if (document.getElementById)  // DOM3 = IE5, NS6
		document.getElementById('status').style.display = "inline";
	else 
	{
		if (document.layers == false) // IE4
			document.all.status.style.display = "inline";
	}
    widthNum = widthNum+24;
	if  (document.getElementById('uiStatus').innerHTML.length < 140)
	{
		document.getElementById('uiStatus').style.width=widthNum;
        document.getElementById('uiStatus').style.background="#DFDFDF";
        document.getElementById('uiStatus').style.maxWidth=540;
        document.getElementById('uiStatus').value="|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||";
		document.getElementById('uiPercent').innerHTML = parseInt(((count / 20) * 100), 10) + '%';
        }
		
	//setTimeout('reboot()', interval);
//setTimeout('refreshPage("'+ refresh + '")' ,5000);
setTimeout('autoRefresh("'+ val +'","' + refresh +'","' + page+'")' ,500);
   	  }
     else
		{
//	alert("DSL Router has been rebooted and is up running now");
	
//	 var loc = 'index.html';
//   	var code = 'window.top.location="' + loc + '"';
	//eval(code);
        setTimeout('refreshPage("'+ refresh + '")' ,1000);                                 
		}





       
        //setTimeout('refreshPage("'+ refresh + '")' ,5000);                                 
        window.defaultStatus = 'Restarting Wireless... Click menu in the left panel for manual refresh';       
   } else {
setTimeout('refreshPage("'+ refresh + '")' ,500);
        //refreshPage(page);
        window.defaultStatus = '';
   }
}

function frmLoad() {
//document.getElementById('uiStatus').innerHTML = document.getElementById('uiStatus').innerHTML + "|||||";
//alert('at frmLoad()');

//alert(wltempPage.match('wlcfgadv'));
//if(wltempPage.match('wlcfgadv')==null )
//{
//setTimeout('refreshPage("'+ wltempPage + '")' ,1000);
//refreshPage(wltempPage);
//}
//else
//{
//autoRefresh(wlRefresh, wltempPage, wltargetPage);
//}
var status;
//var code = 'location="' + 'uploadinfo2.cgi' + '"'; //Fred, not needed anymroe


   if (needReset== 1)
   {
//	   	if(getMsgIndex() == 3 && <%ejGet(glbUploadMode)%> == 1){}
			//alert("The version of the firmware you are uploading is older than the current version or is an invalid Firmware Version");		
//	   	if (getMsgIndex() != 0  || 0 == 2)
//	  		total=70;//rick, change to 70
//	  	interval = total*55;
//	  	if (getMsgIndex() == 0)
//		  reboot();
   }
   else
   {
   	//eval(code);
   }

   if (needReset == 0)
	status="visible";
   //else
   	//status="hidden";

   if (document.getElementById)  // DOM3 = IE5, NS6
   {
    //document.getElementById('back').style.visibility = status;
   }
   else 
   {
   	if (document.layers == false) // IE4
    	    document.all.back.style.visibility = status;
   }

autoRefresh(wlRefresh, wltempPage, wltargetPage);
}

//autoRefresh(wlRefresh, wltempPage, wltargetPage);

function btnBack() {
   var code = 'location="' + 'upload.cgi' + '"';

   if (<%ejGet(glbUploadMode)%> == 2)
      code = 'location="' + 'updatesettings.cgi' + '"';
   eval(code);
}

// done hiding -->
</script>
<script language="JavaScript">
<!-- hide
if (needReset != 1)
{
	document.write("<script language=\"JavaScript\" src=\"menu.js\"></script>");
}
// done hiding -->
</script>
<script language="JavaScript">
<!-- hide
if ('0' == '2')
{
TabHeader="Maintenance";
SideItem="System";
}
else
{
TabHeader="Maintenance";
SideItem="Firmware Update";
}
// done hiding -->
</script>
<script language="javascript">
<!-- hide

if (needReset == 0)
{
	mainTableStart();	
	logo();
	TopNav();
	ThirdRowStart();
	Write_Item_Images();
	mainBodyStart();
}

// done hiding -->
</script>
</head>
<DIV align="center" style="display: default" id="tblmain">
<body onLoad='frmLoad()'>

<script language="javascript">
//<!-- hide
	   //if (needReset == 0){
		//document.writeln("<DIV id=maincontent>");
	   //}else
		//document.writeln("<br><br><DIV id=maincontent style=\"width:500\">");

// done hiding -->
</script>
<br><br><DIV id=maincontent style="width:560; valign=center">
	<table id=box_header border=0 cellSpacing=0>
		<tr>
			<td class=topheader>
				Waiting for setting parameters...
			</td>										
		</tr>

		<tr>
			<td class=content><p>
<font color=#000000>
<script language="javascript">
//<!-- hide
//if(<%ejGet(glbUploadMode)%> == 1)
//	document.write(msg_image[getMsgIndex()]);
//else if(<%ejGet(glbUploadMode)%> == 2)
//	document.write(msg_setting[getMsgIndex()]);

//if(getMsgIndex() != 0)
	//document.writeln("<p align=center><input type='button' onClick='btnBack()' value='Back'></p>");
	
// done hiding -->
</script>
</font>
</p>
         <div id='status' style="display: default">
		<table class="Status" border="0">
			<tr>
				<td width="555"style="display:inline">
				<table class="Status" border="1">
				<tr>
					<td width="540" style="background:#DFDFDF">
						<input id="uiStatus" type="text"  name="uiStatus" style="width:1">
					</td>
				</tr>
				</table>
				</td>
				<td style="BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px">

					<label name="uiPercent" id="uiPercent" class="Status"></label>
				</td>
			</tr>
		</table>
         </div>
      		</td>
		</tr>
	</table>

        <div id='back'>
         <script language="javascript">
         //<!-- hide
           //<input type='button' onClick='btnBack()' value='Back'>
   		if (needReset == 0){
		document.writeln("<p align=center><input type='button' onClick='btnBack()' value='Back'></p>");
   		}
         // done hiding -->
         </script>
         </div>
</DIV>
</div>
      </blockquote>
<script language="javascript">
<!-- hide

if (needReset == 0)
{
	mainBodyEnd();
	ThirdRowEnd();
	Footer()
	mainTableEnd()
}

// done hiding -->
</script>

</body>
</html>
