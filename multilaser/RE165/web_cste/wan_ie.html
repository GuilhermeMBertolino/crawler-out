<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title></title><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="shortcut icon" href="/favicon.ico"><style>body{margin:0;font-size:12px;background:#2ea8dc;color:#fff;font-family:sans-serif}input{width:160px}.table-responsive{width:80%}.btn{width:100px;height:30px;font-size:14px;color:#fff;border:0;cursor:pointer;outline:0;border-radius:0;background:#72b4e6}.btn:hover{background:#1c8ebe}.btn[disabled]{background:#abcddb}.text-ie{width:20%;padding-left:30%;float:left}.footer-box{height:34px;width:100%;background:#aaa;color:#000;position:fixed;bottom:0;line-height:34px;z-index:500}select::-ms-expand{display:none}select{width:162px;height:26px}.footer-box{height:34px;background:#aaa;color:#000;position:absolute;left:0;right:0;bottom:0;line-height:34px;z-index:500}.ie-width{width:100%}</style></head><script src="/plugin/json2.js"></script><script src="/static/js/kr.js"></script><script src="/static/js/config_ie.js"></script><body id="myui"><div id="app"><div class="ie-width"><div style="padding:13px 0 0 20px"><div style="float:right"><span id="lang_select"></span> <button onclick="logout()">{{ w('menu.logout') }}</button></div></div></div><br><br><br><div class="table-responsive" id="homePage"><div style="margin-left:20%;margin-top:30px;margin-bottom:50px"><strong>{{w('wan.help')}}</strong></div><div class="text-ie">{{w('wan.wan_status')}}</div><div id="linkState"></div><br><br><div class="text-ie">{{w('wan.proto')}}</div><div><select id="modeType" onchange="modeChange()" data-style="btn-default"><option value="0">{{w('wan.static_ip')}}</option><option value="1">DHCP</option><option value="3">PPPoE</option></select></div><div id="wanMode1" style="display:none"><br><div class="text-ie">{{w('wan.ip')}}</div><div><input type="text" id="staticIp"></div><br><div class="text-ie">{{w('wan.mask')}}</div><div><input type="text_wan" id="staticMask"></div><br><div class="text-ie">{{w('wan.gateway')}}</div><div><input type="text_wan" id="staticGw"></div><br><div class="text-ie">{{w('wan.pri_dns')}}</div><div><input type="text_wan" id="priDns"></div><br><div class="text-ie">{{w('wan.sec_dns')}}</div><div><input type="text_wan" id="secDns"></div><br><div class="text-ie">MTU</div><div><input type="text" oninput="4<value.length&&(value=value.slice(0,4))" id="staticMtu"></div></div><div id="wanMode2" style="display:none"><br><div class="text-ie">MTU</div><div><input type="text_wan" oninput="4<value.length&&(value=value.slice(0,4))" id="dhcpMtu"></div></div><div id="wanMode3" style="display:none"><br><div class="text-ie">{{w('wan.user')}}</div><div><input type="text_wan" id="pppoeUser"></div><br><div class="text-ie">{{w('wan.pass')}}</div><div><input type="password" id="pppoePass"></div><br><div class="text-ie">MTU</div><div><input type="text_wan" oninput="4<value.length&&(value=value.slice(0,4))" id="pppoeMtu"></div></div><br><div class="text-ie">&nbsp;</div><div><button name="save" onclick="saveBut()" type="button" class="btn btn-primary all-but">{{w('common.apply')}}</button></div><br></div><div id="show_sec" style="display:none;margin-top:20%;text-align:center"><img src="static/images/load.gif"> <span>{{w('wan.msg26')}}</span> [{{w('wan.msg27')}}<span id="sec"></span>{{w('wan.sec')}}]</div><div class="footer-box" style="text-align:center;padding-left:32%"><div style="float:left"><span id="copyRight"></span></div><div style="float:left;padding-left:100px"><span>{{w('index.version')}}: </span><span id="version"></span> <span id="support" style="display:none"><span>&nbsp;&nbsp;|&nbsp;&nbsp;</span> <span style="text-decoration:underline;cursor:pointer" onclick="gotoUrl()">{{w("index.support")}}</span></span></div></div></div><script>var lanIP,lanNetmask,linkState=!1,wtime=60;function modeChange(){var t=kr.get("modeType");"0"==t?(kr.show("wanMode1"),kr.hide("wanMode2"),kr.hide("wanMode3")):"3"==t?(kr.show("wanMode3"),kr.hide("wanMode2"),kr.hide("wanMode1")):(kr.show("wanMode2"),kr.hide("wanMode1"),kr.hide("wanMode3"))}function saveBut(){var t=document.getElementById("modeType").value,e={};if("0"==t){var n=document.getElementById("staticIp").value,a=document.getElementById("staticMask").value,r=document.getElementById("staticGw").value,l=document.getElementById("priDns").value,i=document.getElementById("secDns").value||"",s=document.getElementById("staticMtu").value;if(!n)return alert(lang_t("wan.ip")+lang_t("wan.msg1")),!1;if(99!=(c=myCheckIp(n)))return alert(lang_t("wan.ip")+lang_t("wan.msg20")),!1;if(!a)return alert(lang_t("wan.mask")+lang_t("wan.msg1")),!1;if(!checkMask(a))return alert(lang_t("wan.mask")+lang_t("wan.msg20")),!1;if("0.0.0.0"==a)return alert(lang_t("wan.mask")+lang_t("wan.msg20")),!1;if(!r)return alert(lang_t("wan.gateway")+lang_t("wan.msg1")),!1;if(!checkIp(r))return alert(lang_t("wan.gateway")+lang_t("wan.msg20")),!1;if(99!=(c=myCheckIp(r)))return alert(lang_t("wan.gateway")+lang_t("wan.msg20")),!1;if(1!=checkIpSubnet(n,a,r))return alert(lang_t("wan.msg6")),!1;if(!l)return alert(lang_t("wan.pri_dns")+lang_t("wan.msg1")),!1;if(!(c=checkIp(l)))return alert(lang_t("wan.pri_dns")+lang_t("wan.msg20")),!1;if("0.0.0.0"==l||"255.255.255.255"==l)return alert(lang_t("wan.pri_dns")+lang_t("wan.msg20")),!1;if(i){if(!(c=checkIp(i)))return alert(lang_t("vpn.sec_dns")+lang_t("vpn.msg6")),!1;if("0.0.0.0"==c||"255.255.255.255"==c)return alert(lang_t("vpn.sec_dns")+lang_t("vpn.msg6")),!1}if(!s)return alert(lang_t("wan.msg8")),!1;if(!Number(s))return alert(lang_t("wan.msg9")),!1;if(s<576||1500<s)return alert(lang_t("wan.msg28")),!1;e={topicurl:"setWanIeCfg",token:token,ieFlag:"ie8",wanMode:t,dnsMode:"1",priDns:l,secDns:i,staticIp:n,staticMask:a,staticGw:r,staticMtu:s}}else if("1"==t){var o=kr.get("dhcpMtu");if(!o)return alert(lang_t("wan.msg8")),!1;if(!Number(o))return alert(lang_t("wan.msg9")),!1;if(o<576||1500<o)return alert(lang_t("wan.msg28")),!1;e={topicurl:"setWanIeCfg",token:token,ieFlag:"ie8",wanMode:t,dnsMode:"0",dhcpMtu:o}}else{var g=kr.get("pppoeUser"),u=kr.get("pppoePass"),c=stringFun(g);if(0==c)return alert(lang_t("wan.msg12")),!1;if(1==c)return alert(lang_t("wan.msg13")),!1;if(0==(c=stringFun(u)))return alert(lang_t("wan.msg14")),!1;if(1==c)return alert(lang_t("wan.msg15")),!1;var p=kr.get("pppoeMtu");if(!p)return alert(lang_t("wan.msg8")),!1;if(!Number(p))return alert(lang_t("wan.msg9")),!1;if(p<576||1492<p)return alert(lang_t("wan.msg29")),!1;e={topicurl:"setWanIeCfg",token:token,ieFlag:"ie8",wanMode:t,dnsMode:"0",pppoeUser:g,pppoePass:u,pppoeMtu:p}}kr.request({type:"post",data:e,success:function(t){t.wtime&&(wtime=Number(t.wtime)),kr.hide("homePage"),kr.show("show_sec"),do_count_down(),linkState=!0===t.success,linkType()}})}function checkIpSubnet(t,e,n){for(var a=t.split("."),r=n.split("."),l=e.split("."),i=0;i<=3;i++)if((a[i]&l[i])!=(r[i]&l[i]))return 0;return 1}function linkType(t){linkState?(kr.html("linkState",lang_t("wan.connected")),kr.elm("linkState").style.color="#A2CD52"):(kr.html("linkState",lang_t("wan.onlink")),kr.elm("linkState").style.color="#f00")}function myCheckIp(t,e){var n=99;if(null==t||""==t)return n=0;/^(?:(?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/.test(t)||(n=1);var a=t.split(".");return(a[0]<1||223<a[0])&&(n=2),(255<a[1]||255<a[2])&&(n=3),(a[3]<1||254<a[3])&&(n=4),n}function checkIp(t){return null!=t.match(/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/)}function checkMask(t){return null!=t.match(/^(254|252|248|240|224|192|128|0)\.0\.0\.0|255\.(254|252|248|240|224|192|128|0)\.0\.0|255\.255\.(254|252|248|240|224|192|128|0)\.0|255\.255\.255\.(254|252|248|240|224|192|128|0)$/)}function do_count_down(){kr.html("sec",wtime),0==wtime&&(alert(lang_t("wan.msg30")),kr.show("homePage"),kr.hide("show_sec")),0<wtime&&(wtime--,setTimeout("do_count_down()",1e3))}function logout(){return!!window.confirm(lang_t("login.msg7"))&&(window.location.href="/login_ie.html",!0)}function stringFun(t){var e=99;if(null==t||""==t)return e=0;/[\xB7]/.test(t)&&(e=1),/[^\x00-\xff]/.test(t)&&(e=1);return(/[^\x20-\x7D]/.test(t)||/[\x20\x22\x24\x25\x27\x2C\x2F\x3B\x3C\x3E\x5C\x60]/.test(t))&&(e=1),e}function ip_subnet(t,e,n){for(var a=t.split("."),r=n.split("."),l=e.split("."),i=0;i<=3;i++)if((a[i]&l[i])!=(r[i]&l[i]))return 0;return 1}function gotoUrl(){window.open(initData.helpUrl)}!function(){document.title=initData.webTitle,token=initData.token,kr.html("lang_select",lang_select),kr.html("version",initData.fmVersion);var t=(new Date).getFullYear();kr.html("copyRight",initData.copyRight.replace("[date]",t));var e={action:"getWanIeCfg",idx:"1",topicurl:"getWanIeCfg",token:token};new kr$1({}),kr.html("linkState",lang_t("wan.onlink")),"1"!=initData.hideLogo?(kr.show("logo-img"),initData.helpUrl&&"http://"!=initData.helpUrl?document.getElementById("support").style.display="":document.getElementById("support").style.display="none"):document.getElementById("support").style.display="none",kr.request({type:"POST",url:"/cgi-bin/cstecgi.cgi",data:e,success:function(t){"1"==t.linkState&&(linkState=!0),linkType(),kr.set("modeType",t.wanMode),kr.set("staticIp",t.staticIp),kr.set("staticMask",t.staticMask),kr.set("staticGw",t.staticGw),kr.set("priDns",t.priDns),kr.set("secDns",t.secDns),kr.set("staticMtu",t.staticMtu),kr.set("dhcpMtu",t.dhcpMtu),kr.set("pppoeUser",t.pppoeUser),kr.set("pppoePass",t.pppoePass),kr.set("pppoeMtu",t.pppoeMtu),modeChange()}}),kr.request({type:"POST",url:"/cgi-bin/cstecgi.cgi",data:{topicurl:"getLanCfg",token:token},success:function(t){lanIp=t.lanIp,lanNetmask=t.lanNetmask}})}(window)</script></body></html>