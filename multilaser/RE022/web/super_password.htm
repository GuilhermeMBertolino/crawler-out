<html>
<! Copyright (c) Realtek Semiconductor Corp., 2003. All Rights Reserved. ->
<head>
<meta http-equiv="Content-Type" content="text/html">
<% getIndex("no-cache"); %>
<title>Password configuration</title>
<% getInfo("reinit_warning") %>
<% getInfo("include_css"); %>
<% language=javascript %>
<script src="/md5.min.js"></script>
<script src="/macro.js"></script>
<SCRIPT language=Javascript src="<% getInfo("lang");%>"></SCRIPT>
<style>
	h3{
		font-size: 14px;
	}
</style>
<SCRIPT>
parent.hideWaitDiv()

function includeSpace(str)
{
  for (var i=0; i<str.length; i++) {
  	if ( str.charAt(i) == ' ' ) {
	  return true;
	}
  }
  return false;
}

function checkInvalid(field)
{
	if(!field)
		return true;

	if(field.value.length==0)
	{
		alert(field.name+super_password_empty);
		field.focus();
		return false;
	}
	if(includeSpace(field.value))
	{
		alert(super_password_space+field.name+super_password_try);
		field.focus();
		return false;
	}
	return true;
}

function checkUserName(field) {
	if (!/(?=^[!-~]{1,15}$)/.test(field.value)) {
		alert(password_user_err);
		field.focus();
		return false;
	}
	return true;
}

function checkPassword(field) {
	var regexp = /(?=^[!-~]{8,31}$)/;
	if (!regexp.test(field.value)) {
		alert(password_pass_err);
		field.focus();
		return false;
	}
	return true;
}

function saveChanges()
{
	if(!checkInvalid(document.password.superName)) return false;
	if(!checkUserName(document.password.superName)) return false;
	if(!checkInvalid(document.password.newSuperPass)) return false;
	if(!checkPassword(document.password.newSuperPass)) return false;
	if(!checkInvalid(document.password.confSuperPass)) return false;

   if ( document.password.newSuperPass.value != document.password.confSuperPass.value) {
		alert(super_password_superpasswd_unmatched);
		document.password.newSuperPass.focus();
		return false;
   }

   if (!document.password.oldSuperPass.value) {
		alert(password_passwd_empty);
		document.password.oldSuperPass.focus();
		return false;
   }

   var newSuperPass = document.password.newSuperPass.value
   document.password.newSuperPass.value = md5(newSuperPass).slice(11, 19);
   document.password.confSuperPass.value = md5(newSuperPass).slice(11, 19);
   document.password.oldSuperPass.value = md5(document.password.oldSuperPass.value).slice(11, 19);
   parent.showWaitDiv()
   return true;

}

function nomalSaveChanges() {
	if(!checkInvalid(document.nomalpassword.userName)) return false;
	if(!checkUserName(document.nomalpassword.userName)) return false;
	if(!checkInvalid(document.nomalpassword.newPass)) return false;
	if(!checkPassword(document.nomalpassword.newPass)) return false;
	if(!checkInvalid(document.nomalpassword.confPass)) return false;

	if ( document.nomalpassword.newPass.value != document.nomalpassword.confPass.value) {
		alert(super_password_passwd_unmatched);
		document.nomalpassword.newPass.focus();
		return false;
    }
	var newpassword = document.nomalpassword.newPass.value
    document.nomalpassword.newPass.value = md5(newpassword).slice(11, 19);
    document.nomalpassword.confPass.value = md5(newpassword).slice(11, 19);
	parent.showWaitDiv()
    return true;
}

function webAccessSave() {
  parent.showWaitDiv();
  return true;
}

function init() {
	document.password.superName.value = '<% getInfo("superName"); %>'
	document.nomalpassword.userName.value = '<% getInfo("userName"); %>'
	if (MACRO && MACRO.support && MACRO.support.FEATURE_MULT_USER_SUPPORT) {
		var webAllowStatus = <% getIndex("web_access_function");%>
		for (var index = 0; index < webAllowStatus.length; index++) {
			var radios = document.getElementsByName("web_access_function" + index)
			if (radios && radios.length == 2) {
				var redioValue = webAllowStatus[index]
				if (radios.length == 2) {
					if (redioValue) {
						radios[0].checked = "checked"
					} else {
						radios[1].checked = "checked"
					}
				}
			}
		}
		var enable = '<% getIndex("showGuideWhenFactory"); %>'
		var webGuideEnableId = document.getElementById("webGuideEnableId")
		if (enable == 1) {
			webGuideEnableId.checked = true
		} else {
			webGuideEnableId.checked = false
		}

	} else {
		var webAccessSetup = document.getElementById('webAccessSetup')
		webAccessSetup.style.display = "none"
	}
}

function guideEnableSave() {
  var flag = document.getElementById('webGuideEnableId').checked;
  if (flag) {
    document.bootstrapPage.enable.value = "ON"
  } else {
    document.bootstrapPage.enable.value = "OFF"
  }
  parent.showWaitDiv()
  return true;
}

</SCRIPT>
</head>

<BODY onload="init()">
<blockquote>
<h2><script>dw(super_password_header)</script></h2>

<form action=/boafrm/formSuperPasswordSetup method=POST name="password">
 	<table border="0" cellspacing="4" width="500">
		<tr><font size=2><script>dw(super_password_header_explain)</script></tr>
		<tr><hr size=1 noshade align=top></tr>
		<h3><font color="#0000FF">Super User</font></h3>
		<tr>
			<td width="20%"><font size=2><b><script>dw(super_password_superusername)</script></b></font></td>
			<td width="50%"><font size=2><input type="text" name="superName" size="20" maxlength="30"></font></td>
		</tr>
		<tr>
			<td width="20%"><font size=2><b><script>dw(super_old_password)</script></b></td>
			<td width="50%"><font size=2><input type="password" onfocus="inputOnFocus(this)" onblur="inputOnBlur(this)" name="oldSuperPass" size="20" maxlength="30"></td>
		</tr>
		<tr>
			<td width="20%"><font size=2><b><script>dw(super_password_user_passwd)</script></b></td>
			<td width="50%"><font size=2><input type="password" onfocus="inputOnFocus(this)" onblur="inputOnBlur(this)" name="newSuperPass" size="20" maxlength="30"></td>
		</tr>
		<tr>
			<td width="20%"><font size=2><b><script>dw(super_password_user_passwd_confm)</script></b></td>
			<td width="50%"><font size=2><input type="password" onfocus="inputOnFocus(this)" onblur="inputOnBlur(this)" name="confSuperPass" size="20" maxlength="30"></td>
		</tr>
	</table>

	<input type="hidden" value="/super_password.htm" name="submit-url">
	<input type="submit" value="Save & Apply" name="save_apply" onClick="return saveChanges()">&nbsp;&nbsp;
	<script>document.password.save_apply.value = super_password_apply;</script>
	<input type="reset" value="  Reset  " name="reset"></p>
	<script>document.password.reset.value = super_password_reset;</script>
</form>

<form action="/boafrm/formPasswordSetup" method="post"  name="nomalpassword">
	<table border="0" cellspacing="4" width="500">
		<h3><font color="#0000FF"><script>dw(super_password_admin_user)</script></font></h3>
		<tr>
			<td width="20%"><font size=2><b><script>dw(super_password_username)</script></b></font></td>
			<td width="50%"><font size=2><input type="text" name="userName" size="20" maxlength="30"></font></td>
		</tr>
		<tr>
      <td width="20%"><font size=2><b><script>dw(super_password_user_passwd)</script></b></td>
      <td width="50%"><font size=2><input type="password" onfocus="inputOnFocus(this)" onblur="inputOnBlur(this)" name="newPass" size="20" maxlength="30"></td>
		</tr>
		<tr>
      <td width="20%"><font size=2><b><script>dw(super_password_user_passwd_confm)</script></b></td>
      <td width="50%"><font size=2><input type="password" onfocus="inputOnFocus(this)" onblur="inputOnBlur(this)" name="confPass" size="20" maxlength="30"></td>
		</tr>
  </table>
  <input type="hidden" value="/super_password.htm" name="submit-url">
  <p><input type="submit" value="Save & Apply" name="save_apply" onClick="return nomalSaveChanges()">&nbsp;&nbsp;
  <script>document.nomalpassword.save_apply.value = super_password_apply;</script>
  <input type="reset" value="  Reset  " name="reset"></p>
  <script>document.password.reset.value = super_password_reset;</script>
</form>

<form action=/boafrm/formWebAccessSetup method=POST name="webAccess" id="webAccessSetup">
	<h3><font color="#0000FF"><script>dw(web_access)</script></font></h3>
	<table border="0" cellspacing="4" width="100%">
		<tr>
			<td width="30%"><b><script>dw(WIFI_setting)</script></b></td>
			<td width="60%">
				<input type="radio" name="web_access_function0" value="1" id="menu_setup-allow">
        <label for="menu_setup-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function0" value="0" id="menu_setup-deny">
        <label for="menu_setup-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b><script>dw(wlguest_wlan_guest)</script></b></td>
			<td width="60%">
				<input type="radio" name="web_access_function1" value="1" id="menu_wlan2-allow">
        <label for="menu_wlan2-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function1" value="0" id="menu_wlan2-deny">
        <label for="menu_wlan2-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b>easyMesh</b></td>
			<td width="60%">
				<input type="radio" name="web_access_function2" value="1" id="easyMesh-allow">
        <label for="easyMesh-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function2" value="0" id="easyMesh-deny">
        <label for="easyMesh-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b><script>dw(menu_tcpip)</script></b></td>
			<td width="60%">
				<input type="radio" name="web_access_function3" value="1" id="menu_menu_tcpip-allow">
        <label for="menu_menu_tcpip-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function3" value="0" id="menu_menu_tcpip-deny">
        <label for="menu_menu_tcpip-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b>IPV6</b></td>
			<td width="60%">
				<input type="radio" name="web_access_function4" value="1" id="menu_IPV6-allow">
        <label for="menu_IPV6-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function4" value="0" id="menu_IPV6-deny">
        <label for="menu_IPV6-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b><script>dw(menu_fireWall)</script></b></td>
			<td width="60%">
				<input type="radio" name="web_access_function5" value="1" id="menu_fireWall-allow">
        <label for="menu_fireWall-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function5" value="0" id="menu_fireWall-deny"> 
        <label for="menu_fireWall-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b><script>dw(menu_management)</script></b></td>
			<td width="60%">
				<input type="radio" name="web_access_function6" value="1" id="menu_management-allow">
        <label for="menu_management-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function6" value="0" id="menu_management-deny">
        <label for="menu_management-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
		<tr>
			<td width="30%"><b><script>dw(quickSetup_menu)</script></b></td>
			<td width="60%">
				<input type="radio" name="web_access_function7" value="1" id="menu_quickSetup-allow">
        <label for="menu_quickSetup-allow"><script>dw(wlmeshACL_mode_allow)</script></label>
				<input type="radio" name="web_access_function7" value="0" id="menu_quickSetup-deny">
        <label for="menu_quickSetup-deny"><script>dw(wlmeshACL_mode_deny)</script></label>
			</td>
		</tr>
	</table>
	<input type="hidden" value="/super_password.htm" name="submit-url">
	<p><input type="submit" value="Apply Changes" name="save" onClick="return webAccessSave()">&nbsp;&nbsp;
	<script>document.webAccess.save.value = super_password_apply;</script>
	<input type="reset" value="  Reset  " name="reset"></p>
	<script>document.webAccess.reset.value = super_password_reset;</script>
</form>

<form action=/boafrm/formGuideConfig method=POST name="bootstrapPage" id="bootstrapPageId">
    <h3><font color="#0000FF"><script>dw(enable_wizard)</script></font></h3>
    <table border="0" cellspacing="4" width="100%">
        <tr>
        <td width="50%"><font size="2"><b><script>dw(enable_wizard_title)</script></b></font></td>
        <td width="50%">
            <input type="hidden" name="enable" value="OFF"/>
            <input type="checkbox" id="webGuideEnableId" name="_enable"/>
        </td>
        </tr>
    </table>
    <input type="hidden" value="/super_password.htm" name="submit-url">
    <p><input type="submit" value="Apply Changes" name="save"  onClick="return guideEnableSave()">&nbsp;&nbsp;
    <script>document.bootstrapPage.save.value = super_password_apply;</script>
    <input type="reset" value="  Reset  " name="reset"></p>
    <script>document.bootstrapPage.reset.value = super_password_reset;</script>
</form>

<blockquote>
</body>
</html>


