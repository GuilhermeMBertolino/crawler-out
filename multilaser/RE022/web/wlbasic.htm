<html>
<! Copyright (c) Realtek Semiconductor Corp., 2003. All Rights Reserved. ->
<head>
<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
<% getIndex("no-cache"); %>
<title>WLAN Basic Settings</title>
<script type="text/javascript" src="util_gw.js"> </script>
<SCRIPT language=Javascript src="<% getInfo("lang");%>"></SCRIPT>
<% getInfo("include_css"); %>
<link rel="stylesheet" rev="stylesheet" href="customer.css" type="text/css">
<style>
.on {display:on}
.off {display:none}
.hide-class{
	display:none
}
h3{
	font-size: 14px;
    color: #0000FF;
}
</style>
<SCRIPT>
parent.hideWaitDiv()
var wlan_channel=new Array();
var wlan_txrate=new Array();
var wlan_channelbound=new Array();
var wlan_controlsideband=new Array();
var regDomain=new Array();
var defaultChan=new Array();
var lastBand=new Array();
var lastRegDomain=new Array();
var RFType=new Array();
var APMode=new Array();
var bandIdx=new Array();
var bandIdxAP=new Array();
var bandIdxClient=new Array();
var startChanIdx=new Array();
var disableSSID=new Array();
var networkType=new Array();
var repeater_enable_val=<% getIndex("repeaterEnabled"); %>
//var multi_AP_Repeater_Str=<% getIndex("multiAPRepeaterStr"); %>
var countrystr= "<% getInfo("country_str"); %>";
var wlan_idx= <% getIndex("wlan_idx"); %>;
var opmode=<% getIndex("opMode"); %>;
var wispWanId=<% getIndex("wispWanId"); %>;
var WiFiTest=<% getIndex("WiFiTest"); %>;
var ssid_2g="<% getIndex("2G_ssid"); %>";
var ssid_5g="<% getIndex("5G_ssid"); %>";
var info_country=<% getInfo("info_country");%>;
var array_country=new Array();
var info_2g=<% getInfo("info_2g");%>;
var array_2g=new Array();
var info_5g=<% getInfo("info_5g");%>;
var array_5g=new Array();

// 高级设置
var band2G5GSupport=<% getIndex("Band2G5GSupport"); %> ;
var mode2x2=<% getIndex("wlan_mode_2x2");%>;
var enabled1X=<% getIndex("enable1X");%>;
var wlan_mode = <% getIndex("wlanMode");%>;
var wlan_encmode = <% getIndex("encrypt");%>;
var ft_enable = <% getIndex("80211r_enable");%>;

var is_ulinker="<% getInfo("is_ulinker"); %>"*1;
var ulinker_opMode="<% getInfo("ulinker_opMode"); %>"*1; //0:AP; 1:Client; 2:Router; 3:RPT
var wlProfileSupport="<% getInfo("wlProfileSupport"); %>"*1;

lastBand[wlan_idx] = 0;
lastRegDomain[wlan_idx]= 0;
bandIdxAP[wlan_idx] = -1;
bandIdxClient[wlan_idx] = -1;
startChanIdx[wlan_idx] = 0;
disableSSID[wlan_idx] = 0;
networkType[wlan_idx] = <% getIndex("networkType");%>;
var enc_method=new Array();
enc_method[wlan_idx] = <%getIndex("encrypt");%>;

// for WPS ---------------------------------------->>
var wps_disabled=<% getIndex("wscDisable");%>;
var wps_ssid_old='<% getInfo("ssid"); %>';
var wps_mode_old=<% getIndex("wlanMode"); %>;
var wps_config_by_registrar=<% getIndex("wps_by_reg"); %>;
var wps_encrypt_old=<% getIndex("encrypt");%>;
var wps_enable1x=<% getIndex("enable1X");%>;
var wps_wpa_auth=<% getIndex("wpaAuth");%>;
// <<-------------------------------------- for WPS
function Data_country(country_code,abb,idx_5g,idx_2g,fullname) 
{
        this.country_code= country_code;
        this.abb = abb;
        this.idx_5g = idx_5g;
        this.idx_2g = idx_2g;
        this.fullname = fullname;
}

function Data_regdomain(regdomain,channelsetnumber,regdomainarea) 
{
        this.regdoemain = regdomain;
        this.channelsetnumber = channelsetnumber;
        this.regdomainarea = regdomainarea;
}

function includeSpace(str){
	for (var i=0; i<str.length; i++)
	{
		if ( str.charAt(i) == ' ' )
		{
			return true;
		}
	}
	return false;
}

function initData()
{
	var i=0;
	for(i=0;i<info_country.length;i++)
		array_country[array_country.length++] = new Data_country(info_country[i][0],
		info_country[i][1],info_country[i][2],info_country[i][3],info_country[i][4]);	
	for(i=0;i<info_2g.length;i++)
		array_2g[array_2g.length++] = new Data_regdomain(info_2g[i][0],
		info_2g[i][1],info_2g[i][2]);	
	for(i=0;i<info_5g.length;i++)
		array_5g[array_5g.length++] = new Data_regdomain(info_5g[i][0],
		info_5g[i][1],info_5g[i][2]);	
        showCountry(document.wlanSetup, wlan_idx);
		
}

function showCountry(form,wlan_id)
{
	var i;
	var index;
	for(i=0;i<array_country.length;i++)
	{
		form.elements["country"+wlan_id].options[i]= new Option(array_country[i].fullname,i,false,false);
		if(countrystr == array_country[i].abb)
			index=i;
			
	}
	form.elements["country"+wlan_id].selectedIndex=index;
}

function updateCountry(form,wlan_id)
{	
	var regidx;
	var bandidx;
	var idx=form.elements["country"+wlan_idx].selectedIndex;
	if(idx >= 0 && idx <array_country.length)
	{
		bandidx=form.elements["band"+wlan_id].selectedIndex;
		var selectText=form.elements["band"+wlan_id].options[bandidx].text.substr(0,1);
		if(selectText == '5')
		{
			regidx=array_country[idx].idx_5g;
			if( regidx >0 && regidx < array_5g.length)
				regDomain[wlan_id]= regidx;
		}
		else if(selectText == '2')
		{
			regidx=array_country[idx].idx_2g;
			if( regidx >0 && regidx < array_2g.length)
				regDomain[wlan_id]= regidx;
		}
		form.elements["countrystr"+wlan_id].value=array_country[idx].abb;
	}
	form.elements["regdomain"+wlan_id].value=regDomain[wlan_id];
}

function showMacClick(form, url)
{
var mode_idx = form.elements["mode"+wlan_idx].selectedIndex;
var mode_value = form.elements["mode"+wlan_idx].options[mode_idx].value; 
  if (!form.elements["wlanDisabled"+wlan_idx].checked 
  // && (mode_value==0 || mode_value==3))
  && (mode_value==0 || mode_value==3|| mode_value==4|| mode_value==6))
	openWindow(url, 'showWirelessClient', 800, 500 );
}

function showMultipleAP(form, url)
{	
var mode_idx = form.elements["mode"+wlan_idx].selectedIndex;
var mode_value = form.elements["mode"+wlan_idx].options[mode_idx].value; 
  if (!form.elements["wlanDisabled"+wlan_idx].checked 
  // 802.11s Mesh NOTICE: If Mesh work with Multiple AP, Add mode_value == 4 (AP+MPP) and mode_value == 6 (MAP)
  && (mode_value==0 || mode_value==3 || mode_value==4 || mode_value==6 ))
	//openWindow(url, 'MultipleAP', 800, 380 );
	document.location.href = url;
}

function updateState(form, wlan_id)
{
  updateIputState(form, wlan_id);
  updateRepeaterState(form, wlan_id);
}

function updateRepeaterState(form, wlan_id)
{   
	disableCheckBox(form.elements["repeaterEnabled"+wlan_id]);
	disableTextField(form.elements["repeaterSSID"+wlan_id]);
	get_by_id("wlProfileDiv").style.display = "none"; //disable wlProfileDiv first

	if(!form.elements["wlanDisabled"+wlan_id].checked)
	{  	
		if( (form.elements["mode"+wlan_id].selectedIndex!=1)
			&& (form.elements["mode"+wlan_id].selectedIndex!=2) 
		)
		{     	
			enableCheckBox(form.elements["repeaterEnabled"+wlan_id]);

			if (form.elements["repeaterEnabled"+wlan_id].checked)
			{
				enableTextField(form.elements["repeaterSSID"+wlan_id]);
				enableButton(document.wlanSetup.elements["addRptProfile"]);

				if(wlProfileSupport == 1)
				{
					// get_by_id("wlProfileDiv").style.display = "";
				}
			}
			else
			{
				disableTextField(form.elements["repeaterSSID"+wlan_id]);
				disableButton(document.wlanSetup.elements["addRptProfile"]);
			}
		}

		if(is_ulinker == 1)
		{
			disableCheckBox(form.elements["repeaterEnabled"+wlan_id]);
			if(ulinker_opMode == 3)
			{
				form.elements["repeaterEnabled"+wlan_id].checked = true;
				enableTextField(form.elements["repeaterSSID"+wlan_id]);
			}
		}
  	
  	
  }

}

function updateMode_basic(form, wlan_id)
{
	var mode_selected=0;
	var Type_selected=0;
	var mode_selected_idx=document.wlanSetup.elements["mode"+wlan_id].selectedIndex;
	mode_selected = document.wlanSetup.elements["mode"+wlan_id].options[mode_selected_idx].value;
	
	if(mode_selected==0)
	    ;
		//form.elements["repeaterEnabled"+wlan_id].checked = true;
	else if(mode_selected == 4 || mode_selected == 5) {/*default disable repeater in AP+MESH mode and MESH mode*/
		form.elements["repeaterEnabled"+wlan_id].checked = false;
		if(opmode == 2 && wispWanId == wlan_id) {/*WISP*/		
			form.elements["repeaterEnabled"+wlan_id].checked = true;
		}
	}
	
	updateRepeaterState(form, wlan_id);
	updateMode(form, wlan_id);
	Type_selected = document.wlanSetup.elements["type"+wlan_id].selectedIndex;
  	
  	var chan_number_idx=form.elements["chan"+wlan_id].selectedIndex;
	var chan_number= form.elements["chan"+wlan_id].options[chan_number_idx].value;	
	
		
		get_by_id("wlProfileDiv").style.display = "none"; //disable wlProfileDiv first
  	//if client and infrastructure mode
  	if(mode_selected ==1){
		if(Type_selected == 0){
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
			disableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
		}else{
			enableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
			index_channelbound=document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex;
		if(index_channelbound ==0 || index_channelbound ==2)
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		else{
			if(chan_number != 0)
				enableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
			else
				disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
		}
		}
		
		if(wlProfileSupport == 1)
		{
			// get_by_id("wlProfileDiv").style.display = "";
			enableButton(document.wlanSetup.elements["addWlProfile"]);
				disableButton(document.wlanSetup.elements["addRptProfile"]);
		}
	}
	else if(mode_selected ==8){
		if(Type_selected == 0){
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
			disableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
		}else{
			enableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
			index_channelbound=document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex;
		if(index_channelbound ==0 || index_channelbound ==2)
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		else{
			if(chan_number != 0)
				enableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
			else
				disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
		}
		}	
	}else{
		enableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
			index_channelbound=document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex;
		if(index_channelbound ==0 || index_channelbound ==2)
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		else{
			if(chan_number != 0)
				enableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
	 		else
				disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
		}
		
		if(mode_selected != 2) //2:WDS
		{
		disableButton(document.wlanSetup.elements["addWlProfile"]);
		if (form.elements["repeaterEnabled"+wlan_id].checked)
		{
			// get_by_id("wlProfileDiv").style.display = ""; 
			enableButton(document.wlanSetup.elements["addRptProfile"]);
		}
		else
		{
			get_by_id("wlProfileDiv").style.display = "none";
			disableButton(document.wlanSetup.elements["addRptProfile"]);
		}
}
}
	
	if( mode_selected == 5 )	//6 should be MESH mode
		disableTextField(document.wlanSetup.elements["ssid"+<% getIndex("wlan_idx"); %>]);

	var wlan_support_8812e=<% getIndex("wlan_support_8812e"); %>;
	var index = form.elements["band"+wlan_id].selectedIndex;
	var selectText=form.elements["band"+wlan_id].options[index].text.substr(0,1);
	var bandOption = form.elements["band"+wlan_id].options.value;
	
	if(wlan_support_8812e==1 && (bandOption == 3 || (bandOption == 7 && selectText=='5') || bandOption == 11 || bandOption == 63 || bandOption == 71 || bandOption == 75 || bandOption == 74))
		disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	

}

function updateType_basic(form, wlan_id)
{
	updateRepeaterState(form, wlan_id);
	updateType(form, wlan_id);
	
}
function checkTurboState()
{
}
function Set_SSIDbyBand(form, wlan_id, band, index)
{
	var selectText=form.elements["band"+wlan_id].options[index].text.substr(0,1);
	var bandOption = form.elements["band"+wlan_id].options.value;
		
	if(bandOption == 0 || bandOption == 1 || (bandOption == 7 && selectText=='2') || bandOption == 2 || bandOption == 9 || bandOption == 10)
	{
		//form.elements["ssid"+wlan_idx].value = ssid_2g;
		var tmpstr=ssid_2g;
		if(ssid_2g.match("&quot;")!=null)
			tmpstr=ssid_2g.replace(/&quot;/g, "\"");

		if(ssid_2g.match("&#37;")!=null)
			tmpstr=tmpstr.replace(/&#37;/g, "%");

		if(ssid_2g.match("&#38;")!=null)
			tmpstr=tmpstr.replace(/&#38;/g, "&");

		if(ssid_2g.match("&#39;")!=null)
			tmpstr=tmpstr.replace(/&#39;/g, "'");
		
		if(ssid_2g.match("&#92;")!=null)
			tmpstr=tmpstr.replace(/&#92;/g, "\\");

		if(ssid_2g.match("&#62;")!=null)
			tmpstr=tmpstr.replace(/&#62;/g, ">");

		if(ssid_2g.match("&#60;")!=null)
			tmpstr=tmpstr.replace(/&#60;/g, "<");
		
		form.elements["ssid"+wlan_idx].value = tmpstr;
	}
	else if(bandOption == 3 || (bandOption == 7 && selectText=='5') || bandOption == 11 || bandOption == 63 || bandOption == 71 || bandOption == 75)
	{
		//form.elements["ssid"+wlan_idx].value = ssid_5g;
		var tmpstr=ssid_5g;
		if(ssid_5g.match("&quot;")!=null)
			tmpstr=ssid_5g.replace(/&quot;/g, "\"");

		if(ssid_2g.match("&#37;")!=null)
			tmpstr=tmpstr.replace(/&#37;/g, "%");

		if(ssid_2g.match("&#38;")!=null)
			tmpstr=tmpstr.replace(/&#38;/g, "&");
			
		if(ssid_5g.match("&#39;")!=null)
			tmpstr=tmpstr.replace(/&#39;/g, "'");
		
		if(ssid_5g.match("&#92;")!=null)
			tmpstr=tmpstr.replace(/&#92;/g, "\\");

		if(ssid_5g.match("&#62;")!=null)
			tmpstr=tmpstr.replace(/&#62;/g, ">");

		if(ssid_5g.match("&#60;")!=null)
			tmpstr=tmpstr.replace(/&#60;/g, "<");
		
		form.elements["ssid"+wlan_idx].value = tmpstr;
	}
}
function Set_onChangeBand(form, wlan_id, band, index){
	    var band;
	    var auto;
 	    var txrate;
	var value;
	
	//var checkid_wmm1 = document.getElementById("wlan_wmm");
	var checkid_wmm2 = document.wlanSetup.wlanwmm<% getIndex("wlan_idx"); %>;
	 var checkid_bound=document.getElementById("channel_bounding");
	 var checkid_sideband = document.getElementById("control_sideband");
	 var wmm_value = <% getIndex("wmmEnabled"); %>;
	 var mode_selected=0;
	var Type_selected=0;
	var index_channelbound=0;
	var wlan_support_8812e=<% getIndex("wlan_support_8812e"); %>;
	
	if(wmm_value==0)
		document.wlanSetup.elements["wlanwmm"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
	else
		document.wlanSetup.elements["wlanwmm"+<% getIndex("wlan_idx"); %>].selectedIndex=1;	
	value =band.options[index].value;
	if(value ==9 || value ==10 || value ==7 || value ==11 || value ==14 || value ==63 || value ==71 || value ==75 ||value==74){
		checkid_bound.style.display = "";
		// checkid_sideband.style.display = "";
		document.wlanSetup.elements["wlanwmm"+<% getIndex("wlan_idx"); %>].selectedIndex = 1;
	 	//checkid_wmm1.disabled = true;
	 	checkid_wmm2.disabled = true;

		var controlsideband_idx=form.elements["controlsideband"+wlan_idx].selectedIndex;
		var wlan_controlsideband_value= form.elements["controlsideband"+wlan_idx].options[controlsideband_idx].value;
		wlan_controlsideband[wlan_idx] = wlan_controlsideband_value;
		document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>].length=0;
		showcontrolsideband_updated(document.wlanSetup, value, wlan_idx, <% getIndex("rf_used"); %>, index);	
	}else{
		checkid_bound.style.display = "none";
		checkid_sideband.style.display = "none";
		//checkid_wmm1.disabled = false;
		checkid_wmm2.disabled = false;
	}
	
	
	var txrate_idx=form.elements["txRate"+wlan_idx].selectedIndex;
	var wlan_txrate_value= form.elements["txRate"+wlan_idx].options[txrate_idx].value;
	wlan_txrate[wlan_idx] = wlan_txrate_value;
	document.wlanSetup.elements["txRate"+<% getIndex("wlan_idx"); %>].length=0;
	showtxrate_updated(document.wlanSetup, value, wlan_idx, <% getIndex("rf_used"); %>);	
	
	var channelbound_idx=form.elements["channelbound"+wlan_idx].selectedIndex;
	var wlan_channelbound_value= form.elements["channelbound"+wlan_idx].options[channelbound_idx].value;
	wlan_channelbound[wlan_idx] = wlan_channelbound_value;
	document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].length=0;
	showchannelbound_updated(document.wlanSetup, value, wlan_idx, <% getIndex("rf_used"); %>);	
	
	updateChan_channebound(form, wlan_id);
	Type_selected = document.wlanSetup.elements["type"+wlan_id].selectedIndex;
	var mode_selected_idx=document.wlanSetup.elements["mode"+wlan_id].selectedIndex;
	mode_selected = document.wlanSetup.elements["mode"+wlan_id].options[mode_selected_idx].value;
  	//if client and infrastructure mode
  	if(mode_selected ==1){
		if(Type_selected == 0){
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
			disableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
		}else{
			enableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
			index_channelbound=document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex;
		if(index_channelbound ==0 || index_channelbound ==2)
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		else
			enableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
		}
	}else{
		enableTextField(document.wlanSetup.elements["channelbound"+wlan_id]);
			index_channelbound=document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex;
		if(index_channelbound ==0 || index_channelbound ==2)
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		else
			enableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
	}	
/*	
	if( value ==9 || value ==10){
		if(enc_method[wlan_idx]==1){
			alert(encrypt_basic);
		}else if(enc_method[wlan_idx]==2){
			var wpaCipher = <% getIndex("wpaCipher");%>;
			if(wpaCipher ==1)
				alert(encrypt_basic);
		}else if(enc_method[wlan_idx]==4){
			var wpa2Cipher = <% getIndex("wpa2Cipher");%>;
				if(wpa2Cipher ==1)
					alert(encrypt_basic);
		}else if(enc_method[wlan_idx]==6){
			var wpaCipher = <% getIndex("wpaCipher");%>;
			var wpa2Cipher = <% getIndex("wpa2Cipher");%>;
			if(wpa2Cipher ==1 || wpaCipher ==1)
				alert(encrypt_basic);
		}
	}	
*/	
	var chan_number_idx=form.elements["chan"+wlan_id].selectedIndex;
	var chan_number= form.elements["chan"+wlan_id].options[chan_number_idx].value;	
	if(chan_number == 0)
		disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
	else{
		if(document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex == "0")
		disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		else if(document.wlanSetup.elements["channelbound"+wlan_id].selectedIndex == "2")
			disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);
 		else
			enableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);		
	}

	if(wlan_support_8812e==1 && ((value==11 || value ==63|| value ==71|| value==75 ||value==74) || (value==7 && index==1)))
		disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
}

function updateDataRate()
{
	var band   = <% getIndex("band"); %>;
	var auto   = <% getIndex("rateAdaptiveEnabled"); %>;
	var txrate = <% getIndex("fixTxRate"); %>;
	var rf_num = <% getIndex("rf_used"); %>;

	var rate_mask = [31,1,1,1,1,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,8,8,8,8,8,8,8,8,16,16,16,16,16,16,16,16];
	var rate_name=[wlbasic_data_rate_auto,"1M","2M","5.5M","11M","6M","9M","12M","18M","24M","36M","48M","54M", 
		"MCS0", "MCS1", "MCS2", "MCS3", "MCS4", "MCS5", "MCS6", "MCS7", 
		"MCS8", "MCS9", "MCS10", "MCS11", "MCS12", "MCS13", "MCS14", "MCS15", 
		"MCS16", "MCS17", "MCS18", "MCS19", "MCS20", "MCS21", "MCS22", "MCS23"];
	var vht_rate_name=["NSS1-MCS0","NSS1-MCS1","NSS1-MCS2","NSS1-MCS3","NSS1-MCS4",
		"NSS1-MCS5","NSS1-MCS6","NSS1-MCS7","NSS1-MCS8","NSS1-MCS9",
		"NSS2-MCS0","NSS2-MCS1","NSS2-MCS2","NSS2-MCS3","NSS2-MCS4",
		"NSS2-MCS5","NSS2-MCS6","NSS2-MCS7","NSS2-MCS8","NSS2-MCS9",
		"NSS3-MCS0","NSS3-MCS1","NSS3-MCS2","NSS3-MCS3","NSS3-MCS4",
		"NSS3-MCS5","NSS3-MCS6","NSS3-MCS7","NSS3-MCS8","NSS3-MCS9"];
	var mask=0;
	var defidx=0;
	var idx, i, rate;
	var vht_num;
	var option_num = 0;
	
	if (auto)
		txrate=0;
	if (band & 1)
		mask |= 1;
	if ((band&2) || (band&4))
		mask |= 2;
	if (band & 8) 
	{
		if (rf_num == 3)
			mask |= 28;
		else if (rf_num == 2)
			mask |= 12;	
		else
			mask |= 4;
	}
	
	document.write('<option value="' + 0 + '">' + rate_name[0] + '\n');
	option_num++;
	for (idx=1, i=1; i<=36; i++)
	{
		if (rate_mask[i] & mask)
		{
			//rate = (1 << (i-1));
		 	if(txrate == 0)
            	defidx = 0;
			else if (i<29 && txrate == (1 << (i-1)))
				defidx = idx;
			else if (i>=29 && (txrate == ((1<<28)+(i-29))))
				defidx = idx;
			document.write('<option value="' + i + '">' + rate_name[i] + '\n');
			idx++;
			option_num++;
		}
	}
	
	if(band & 64)
	{
		vht_num = rf_num*10-1;
		
		for(idx=37, i=0; i<=vht_num; i++)
		{
			rate = ((1 << 31) + i);
			if (txrate == rate)
			{
				defidx = option_num;
			}
			//if((i == 9) || (i == 19) || (i==29))
			if((i == 9) || (i == 19))
			{
				if(document.wlanSetup.elements["channelbound" + <% getIndex("wlan_idx"); %>].selectedIndex == 0)//channel width = 20M
				{
					idx++;
					continue;
				}
			}
			if( (document.wlanSetup.elements["channelbound" + <% getIndex("wlan_idx"); %>].selectedIndex == 2) && (i == 26) )//channel width = 80M,don't add NSS3-MCS6
			{
				idx++;
				continue;
			}
			document.write('<option value="' + idx + '">' + vht_rate_name[i] + '\n');
			idx++;
			option_num++;
		}
	}
	document.wlanSetup.elements["txRate"+ <% getIndex("wlan_idx"); %>].selectedIndex = defidx;
}

function ShowChannelInVxdMode()
{
	var channel_drv = <%getInfo("channel_drv")%>;
	var repeaterState = "<%getInfo("repeaterState");%>";
	var isRepeaterDisplay =  <% getIndex("isRepeaterDisplay"); %> ;
	var sideband="<% getIndex("ControlSideBand"); %>";
	
	var i;
	if(channel_drv){
		if(repeaterState == "Connected"){
			if(isRepeaterDisplay || (document.wlanSetup.elements["mode"+ wlan_idx].selectedIndex == 1)){
				//if(document.wlanSetup.elements["chan"+wlan_idx].selectedIndex != 0){
					if(channel_drv != defaultChan[wlan_idx]){
						for(i=0; i<document.wlanSetup.elements["chan"+wlan_idx].length; i++){
							if(document.wlanSetup.elements["chan"+wlan_idx].options[i].value == channel_drv){
								document.wlanSetup.elements["chan"+wlan_idx].selectedIndex = i;
								break;
							}
						}
						if(i>= document.wlanSetup.elements["chan"+wlan_idx].length)
						{//change the side band
							if(sideband=="0")
								document.wlanSetup.elements["controlsideband"+ wlan_idx].selectedIndex=1;
							else
								document.wlanSetup.elements["controlsideband"+ wlan_idx].selectedIndex=0;
							updateChan_channebound(document.wlanSetup, wlan_idx);
							for(i=0; i<document.wlanSetup.elements["chan"+wlan_idx].length; i++){
								if(document.wlanSetup.elements["chan"+wlan_idx].options[i].value == channel_drv){
									document.wlanSetup.elements["chan"+wlan_idx].selectedIndex = i;
									break;
								}
							}
							
						}
					}			
				//}
			}
		}
	}
}

SecurityTypePage = new Array("wlsecurity_all.htm");
var defPskLen=new Array();
var defPskFormat=new Array();
var autoconf=new Array();
var wlan_idx=<% getIndex("wlan_idx"); %>;
autoconf[wlan_idx]= 0;
var SSIDnum = 1;
var wlProfileSupport="<% getInfo("wlProfileSupport"); %>"*1;

function ValidateForm(passForm, reset)
{
	var question;

	if (reset) {
		passForm.reset();				
		var auth = get_by_id("SSIDAuthMode");
		auth.src = SecurityTypePage[0];
	}
	else {
		if (self.SSIDAuthMode.ValidateForm(passForm) == true) {
			 if ((passForm.method<% getIndex("wlan_idx"); %>.value == 7) && (passForm.wapiAuth<% getIndex("wlan_idx"); %>[0].checked)){
			 	// For wapi-cert only
				 question = confirm(wlsec_validate_note);
			        if(!question)
			        {
			                return;
			        }
			 }
			parent.showWaitDiv()
			passForm.submit();
		}
	}
}

function SetSSIDSettingOption()
{	
	var mode = <% getIndex("wlanMode");%>;
	var mssid_num=<%getIndex("wlan_mssid_num");%>;
	var rp_enable = <% getIndex("repeaterEnabled"); %>;
	var wlEnableProfile="<%getInfo("wlEnableProfile");%>"*1;
	var wlProfile_num="<%getInfo("wlan_profile_num");%>"*1;
	
	if (mode != 1) {	
		var ssid="<% getInfo("ssid"); %>";
		var val="Root AP - " + ssid;
		if(mode != 5) {/*MESH mode do not have ROOT AP option*/
			var disable=new Array()
			disable[0] = 0;		
			disable[1] = <% getVirtualIndex("wlanDisabled", "1"); %>;
			disable[2] = <% getVirtualIndex("wlanDisabled", "2"); %>;
			disable[3] = <% getVirtualIndex("wlanDisabled", "3"); %>;
			disable[4] = <% getVirtualIndex("wlanDisabled", "4"); %>;
			
			for (i=0; i<=mssid_num; i++) {	
				if (!disable[i]) {
					document.write("<option value=\"" + i + "\"><font face=\"Arial\" style=\"font-size: 8pt\">");
					document.write(val);
					document.write("</font></option>");
				}
				if (i != 4 && !disable[i+1]) {
					id =  i+1;
					if (id == 1)	
						ssid =  " - <% getVirtualInfo("ssid", "1"); %>";
					else if (id == 2)	
						ssid =  " - <% getVirtualInfo("ssid", "2"); %>";
					else if (id == 3)	
						ssid =  " - <% getVirtualInfo("ssid", "3"); %>";
					else
					ssid =  " - <% getVirtualInfo("ssid", "4"); %>";	
					val = "AP" + id + ssid;
				}		
			}
		}
		
		var is_adhoc = <% getIndex("networkType"); %>;
		if (rp_enable==1 && ((mode == 0 || mode == 3 || mode == 4 || mode == 5) || (mode == 1 && !is_adhoc)) 
			&& (wlEnableProfile == 0 || wlProfile_num == 0)
		) 
		{
			ssid =  " - <% getInfo("repeaterSSID"); %>";
			if (mode == 1)
				val = "Repeater AP" + ssid;
			else
				val = "Repeater Client" + ssid;
			document.write("<option value=5><font face=\"Arial\" style=\"font-size: 8pt\">");
			document.write(val);
			document.write("</font></option>");			
		}	
	}
	else { // client mode has no vxd interface 
		if(wlEnableProfile == 0 || wlProfile_num == 0)
		{

			var ssid="Root Client - " + "<% getInfo("ssid"); %>";
			document.write("<option value=0><font face=\"Arial\" style=\"font-size: 8pt\">");
			document.write(ssid);
			document.write("</font></option>");		
		}
		
			
	}	
	
	
	var wlProfileEnable=new Array();
	var wlProfileSSID=new Array();
	
	wlProfileEnable[0]="<% getWlProfileInfo("wlProfileTblEnable", "1"); %>"*1;
	wlProfileEnable[1]="<% getWlProfileInfo("wlProfileTblEnable", "2"); %>"*1;
	wlProfileEnable[2]="<% getWlProfileInfo("wlProfileTblEnable", "3"); %>"*1;
	wlProfileEnable[3]="<% getWlProfileInfo("wlProfileTblEnable", "4"); %>"*1;
	wlProfileEnable[4]="<% getWlProfileInfo("wlProfileTblEnable", "5"); %>"*1;
	
	wlProfileSSID[0]="<% getWlProfileInfo("wlProfileSSID", "1"); %>"
	wlProfileSSID[1]="<% getWlProfileInfo("wlProfileSSID", "2"); %>"
	wlProfileSSID[2]="<% getWlProfileInfo("wlProfileSSID", "3"); %>"
	wlProfileSSID[3]="<% getWlProfileInfo("wlProfileSSID", "4"); %>"
	wlProfileSSID[4]="<% getWlProfileInfo("wlProfileSSID", "5"); %>"
	
	if(wlProfileSupport == 1)
	{
		if((rp_enable == 1 && (mode == 0 || mode == 3)) //0:AP 3:AP+WDS
			|| (mode == 1) //1:Client
		) 
		{
			var wlProfile_start = "<%getIndex("wlan_root_mssid_rpt_num");%>"*1;
		

		
			for (i=0; i<=wlProfile_num; i++, wlProfile_start++) 
			{				
				if (wlProfileEnable[i]) {
					if(mode == 1) {//client
						var ssid="AP Profile - " + wlProfileSSID[i];
						document.write("<option value=\"" + 0 + "\"><font face=\"Arial\" style=\"font-size: 8pt\">");

					}
					else
					{
						var ssid="Repeater Profile - " + wlProfileSSID[i];
						document.write("<option value=\"" + wlProfile_start + "\"><font face=\"Arial\" style=\"font-size: 8pt\">");
					}
					document.write(ssid);
					document.write("</font></option>");
				}

			}
		}
	}
	
	

	var select=<% getIndex("mssid_idx"); %>;
	document.formEncrypt.SSID_Setting.selectedIndex = select;	
}
//add for mesh 
function apModeCheck()
{
	var disable = 0;
	if(wlan_mode==7)
		disable = 1;
	else if(wlan_mode == 5) {/*MESH mode*/
		var rp_enable = <% getIndex("repeaterEnabled"); %>;
		if(rp_enable == 0) /*if repeater is disable*/
			disable = 1;
	}

	if(disable)
	{
		disableRadioGroup(document.formEncrypt.SSID_Setting);
		disableButton(document.formEncrypt.save);
		disableButton(document.formEncrypt.reset1);
	}
}

function SSIDSelected(index)
{
	var enable = 1;
	if(wlan_mode == 7) {
		enable = 0;
	}
	else if(wlan_mode == 5) { /*MESH mode*/
		var rp_enable = <% getIndex("repeaterEnabled"); %>;
		if(rp_enable == 0) /*if repeater is disable*/
			enable = 0;	
	}


	if(enable) {
		var auth = get_by_id("SSIDAuthMode");
		auth.src = SecurityTypePage[0];
	}
}

function LoadSetting()
 {
 	var form = document.wlanSetup;
	var wlanband=<% getIndex("band"); %>; 


	var channelbound_idx=form.elements["channelbound"+wlan_idx].selectedIndex;
	var wlan_channelbound_value= form.elements["channelbound"+wlan_idx].options[channelbound_idx].value;
	wlan_channelbound[wlan_idx] = wlan_channelbound_value;
	document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].length=0;
	showchannelbound_updated(document.wlanSetup, (wlanband-1), wlan_idx, <% getIndex("rf_used"); %>);	

	
	if (wlanband < 7)
		wlanband = "0";
	else
		wlanband = "";

 	var checkid_bound;
 	var checkid_sideband;
 	//var checkid_wmm1 = document.getElementById("wlan_wmm");
 	var checkid_wmm2 = document.wlanSetup.wlanwmm<% getIndex("wlan_idx"); %>;
 	var mode_index = document.wlanSetup.elements["mode"+<% getIndex("wlan_idx"); %>].selectedIndex;
	var mode_selected = document.wlanSetup.elements["mode"+<% getIndex("wlan_idx"); %>].options[mode_index].value;
 	var nettype_index = document.wlanSetup.elements["type"+<% getIndex("wlan_idx"); %>].selectedIndex;
 	checkid_bound=document.getElementById("channel_bounding");
 	checkid_sideband=document.getElementById("control_sideband");
 	var wmm_value = <% getIndex("wmmEnabled"); %>;
	if(wmm_value==0)
		document.wlanSetup.elements["wlanwmm"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
	else
		document.wlanSetup.elements["wlanwmm"+<% getIndex("wlan_idx"); %>].selectedIndex=1;	
 	if(wlanband == "0"){
 		checkid_bound.style.display = "none";
 		checkid_sideband.style.display = "none";
 		//checkid_wmm1.disabled = false;
	 	checkid_wmm2.disabled = false;
 	}else{
 		checkid_bound.style.display = "";
 		// checkid_sideband.style.display = "";
 		document.wlanSetup.elements["wlanwmm"+<% getIndex("wlan_idx"); %>].selectedIndex = 1;
	 	//checkid_wmm1.disabled = true;
	 	checkid_wmm2.disabled = true;
 	}
 
	var init_bound = "<% getIndex("ChannelBonding"); %>";

	if (init_bound != "0")
		init_bound = "";

	var init_sideband="<% getIndex("ControlSideBand"); %>";
	if (init_sideband != "0")
		init_sideband = "";
 
 	if(init_bound=="0")
 		document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
 	else if(init_bound=="1")
 		document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].selectedIndex=1;
	else if(init_bound=="2")
		document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].selectedIndex=2;
 		
 	if(init_sideband=="0")
 		document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
 	else
 		document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>].selectedIndex=1;	
 	if(init_bound == "0" || init_bound == "2")
 		disableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);	
 	else
 	{
 		if(!document.wlanSetup.elements["wlanDisabled"+<% getIndex("wlan_idx"); %>].checked)
			enableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);		
	}
		
		//if client and infrastructure mode
	if(mode_selected==1){
	 	if(nettype_index ==0){
	 		disableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);
			disableTextField(document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>]);
	 	}
	}

	if( mode_selected == 5 )
		disableTextField(document.wlanSetup.elements["ssid"+<% getIndex("wlan_idx"); %>]);
		
	var hiddenSSID_value = <% getIndex("hiddenSSID"); %>;
	if(hiddenSSID_value==0)
		document.wlanSetup.elements["hiddenSSID"+<% getIndex("wlan_idx"); %>].selectedIndex=1;
	else
		document.wlanSetup.elements["hiddenSSID"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
	updateChan_channebound(document.wlanSetup, wlan_idx);	
/*		
	if( wlanband != "0"){
		if(enc_method[wlan_idx]==1){
			alert(encrypt_basic);
		}else if(enc_method[wlan_idx]==2){
			var wpaCipher = <% getIndex("wpaCipher");%>;
			if(wpaCipher ==1)
				alert(encrypt_basic);
		}else if(enc_method[wlan_idx]==4){
			var wpa2Cipher = <% getIndex("wpa2Cipher");%>;
				if(wpa2Cipher ==1)
					alert(encrypt_basic);
		}else if(enc_method[wlan_idx]==6){
			var wpaCipher = <% getIndex("wpaCipher");%>;
			var wpa2Cipher = <% getIndex("wpa2Cipher");%>;
			if(wpa2Cipher ==1 || wpaCipher ==1)
				alert(encrypt_basic);
		}
	}
*/		
	var chan_number_idx=form.elements["chan"+wlan_idx].selectedIndex;
	var chan_number= form.elements["chan"+wlan_idx].options[chan_number_idx].value;
	
	wlan_channel[wlan_idx] = chan_number;
	
	var txrate_idx=form.elements["txRate"+wlan_idx].selectedIndex;
	var wlan_txrate_value= form.elements["txRate"+wlan_idx].options[txrate_idx].value;
	wlan_txrate[wlan_idx] = wlan_txrate_value;
	if(chan_number == 0)
		disableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);	

	var isRepeaterDisplay =  <% getIndex("isRepeaterDisplay"); %> ;
	if(isRepeaterDisplay == 0)
		disableCheckBox(document.wlanSetup.elements["repeaterEnabled"+wlan_idx]);			
		
	var isPocketRouter="<% getInfo("isPocketRouter"); %>"*1;
	var pocketRouter_Mode="<% getInfo("pocketRouter_Mode"); %>"*1;
	if(pocketRouter_Mode == 1) //1:bridge and client mode
		disableTextField(document.wlanSetup.elements["mode"+wlan_idx]);					
	
	if(is_ulinker == 1)
		disableTextField(document.wlanSetup.elements["mode"+wlan_idx]);					

 	if ( <% getIndex("wlanMacClone"); %> )
		document.wlanSetup.elements["wlanMacClone"+wlan_idx].checked=true;	

 	if (repeater_enable_val==1) {
		document.wlanSetup.elements["repeaterEnabled"+wlan_idx].checked=true;
		updateRepeaterState(document.wlanSetup, wlan_idx);	
	}else if (repeater_enable_val==2) {
		document.wlanSetup.elements["repeaterEnabled"+wlan_idx].disabled=true;			
	}
	
	if(<% getInfo("wlProfile_value");%>)
		document.wlanSetup.elements["wlProfileEnabled"].checked=true;

 	if ( <% getIndex("wlanDisabled"); %> ) {
		document.wlanSetup.elements["wlanDisabled"+wlan_idx].checked=true;	
		updateState(document.wlanSetup, wlan_idx);
	}

	var index_bound = form.elements["channelbound"+wlan_idx].selectedIndex;

	if(index_bound == 0)
		disableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);
	if(index_bound == 2)
		disableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);

	var wlan_support_8812e=<% getIndex("wlan_support_8812e"); %>;
	var phyband   = <% getIndex("Band2G5GSupport"); %>;
	
	if(wlan_support_8812e==1 && phyband==2)
		disableTextField(document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>]);	

	if(mode_index==1)//client
	{
		// get_by_id("wlProfileDiv").style.display = "";
		enableButton(document.wlanSetup.elements["addWlProfile"]);
	}
	else
		disableButton(document.wlanSetup.elements["addWlProfile"]);
		
	disableButton(document.wlanSetup.elements["addRptProfile"]);
	if(mode_index != 1 && mode_index != 2)//1:client 2:wds
	{
		if(document.wlanSetup.elements["repeaterEnabled"+wlan_idx].checked == 1)//enable rpt
		{
			if(mode_index != 4 && mode_index != 5) {//4:ap+mesh 5:mesh
				ShowChannelInVxdMode();	
			}
			enableButton(document.wlanSetup.elements["addRptProfile"]);
		}
	}
	if (<% getIndex("multi_ap_controller"); %>  == 2) { //mesh agent can not change
		var inputs = document.getElementsByTagName("input");
		for (var i=0; i<inputs.length; i++) {
			inputs[i].disabled = true;
		}
		var selects = document.getElementsByTagName("select");
		for (var i=0; i<selects.length; i++) {
			selects[i].disabled = true;
		}
	}
}

function validateNum(str)
{
  for (var i=0; i<str.length; i++) {
   	if ( !(str.charAt(i) >='0' && str.charAt(i) <= '9')) {
		alert(wladv_vallid_num_alert);
		return false;
  	}
  }
  return true;
}

function saveChanges()
{

  var band   = <% getIndex("band"); %>;
  	
  if ( validateNum(document.advanceSetup.fragThreshold.value) == 0 ) {
  	document.advanceSetup.fragThreshold.focus();
	return false;
  }
  num = parseInt(document.advanceSetup.fragThreshold.value);
  if (document.advanceSetup.fragThreshold.value == "" || num < 256 || num > 2346) {
  	alert(wladv_fragment_thre_alert);
  	document.advanceSetup.fragThreshold.focus();
	return false;
  }
  
 if(document.advanceSetup.aggregation.value == "enable" &&  ( (band!=1)&&(band!=2)&&(band!=3)&&(band!=4)) && (num != 2346) ){
	alert(wladv_fragment_aggr_alert);
  	return false;
  }

  if ( validateNum(document.advanceSetup.rtsThreshold.value) == 0 ) {
  	document.advanceSetup.rtsThreshold.focus();
	return false;
  }
  num = parseInt(document.advanceSetup.rtsThreshold.value);
  if (document.advanceSetup.rtsThreshold.value=="" || num > 2347) {
  	alert(wladv_rts_thre_alert);
  	document.advanceSetup.rtsThreshold.focus();
	return false;
  }

  if ( validateNum(document.advanceSetup.beaconInterval.value) == 0 ) {
  	document.advanceSetup.beaconInterval.focus();
	return false;
  }
  num = parseInt(document.advanceSetup.beaconInterval.value);
  if (document.advanceSetup.beaconInterval.value=="" || num < 20 || num > 1024) {
  	alert(wladv_beacon_alert);
  	document.advanceSetup.beaconInterval.focus();
	return false;

  }

  if (enabled1X != 1 && document.advanceSetup.elements["hs2"][0].checked == true) {
  	alert(wladv_8021x_hs2);
	resetForm();
	return false;
  }
  parent.parent.showWaitDiv()
  return true;
}

/*
function checkTurboState()
{
	var txRate= <% getIndex("rateAdaptiveEnabled"); %>;

	if (txRate == 1) 
		enableRadioGroup(document.advanceSetup.turbo);
	else		
		disableRadioGroup(document.advanceSetup.turbo);
}
*/

function wlan_adv_switch()
{
	var wlanband = <% getIndex("band"); %>;  
	if (wlanband < 9)
		wlanband = "0";
	else
		wlanband = "";

	var checkid_aggregation;
 	var checkid_shortgi;
 	var wlan_xTxR="<% getInfo("wlan_xTxR"); %>";
 	
	var wlan_support_8822be=<% getIndex("wlan_support_8822be"); %>;
	var wlan_support_8812fe=<% getIndex("wlan_support_8812fe"); %>;
	var band   = <% getIndex("band"); %>;
 	
 	checkid_aggregation=document.getElementById("Aggregation");
 	checkid_shortgi=document.getElementById("ShortGi");
	
 	if(wlan_xTxR == "1*1")
 	{
 		document.advanceSetup.tx_stbc[0].checked= false;
 		document.advanceSetup.tx_stbc[1].checked= true;
 		document.advanceSetup.tx_stbc[0].disabled =true;
		document.advanceSetup.tx_stbc[1].disabled =true;
 	}
 	else if(wlan_xTxR == "0*0")
 	{
 		document.getElementById("stbctransmit").style.display = "none";
 		document.getElementById("coexist").style.display = "none"; 		
 	}
 	
	if(band2G5GSupport == 2) //2:5g
 	{
 		document.getElementById("preambleType").style.display = "none"; 		
 		document.getElementById("coexist").style.display = "none"; 		
 	}
 	else
 	{
 		document.getElementById("preambleType").style.display = ""; 		
 		document.getElementById("coexist").style.display = ""; 		
 	}
	//### add by sen_liu 2011.3.29 TX Beamforming added to mib in 92D 
	if(mode2x2)
	{				
 		document.getElementById("tx_beamforming").style.display = ""; 
	}
	else
	{
		document.getElementById("tx_beamforming").style.display = "none";
	}
	//### end
	

	if (<% getIndex("preamble"); %> == 0)
		document.advanceSetup.elements["preamble"][0].checked = true;
	else
		document.advanceSetup.elements["preamble"][1].checked = true;
	if(<% getIndex("iappDisabled"); %> == -2) 
		document.getElementById("showIAPP").style.display = "none";
	else
		document.getElementById("showIAPP").style.display = "";

	if (<% getIndex("iappDisabled"); %> == 0)
		document.advanceSetup.elements["iapp"][0].checked = true;
	else
		document.advanceSetup.elements["iapp"][1].checked = true;

	
	if(<% getIndex("hs2Enabled"); %> == -2) 
		document.getElementById("showHS2").style.display = "none";
	else
		document.getElementById("showHS2").style.display = "";
	
	if (<% getIndex("hs2Enabled"); %> == 1)
		document.advanceSetup.elements["hs2"][0].checked = true;
	else
		document.advanceSetup.elements["hs2"][1].checked = true;
	
	
	if (<% getIndex("protectionDisabled"); %> == 0)
		document.advanceSetup.elements["11g_protection"][0].checked = true;
	else
		document.advanceSetup.elements["11g_protection"][1].checked = true;

	if (<% getIndex("aggregation"); %> != 0)
		document.advanceSetup.elements["aggregation"][0].checked = true;
	else
		document.advanceSetup.elements["aggregation"][1].checked = true;

	if (<% getIndex("shortGIEnabled"); %> == 1)
		document.advanceSetup.elements["shortGI0"][0].checked = true;
	else
		document.advanceSetup.elements["shortGI0"][1].checked = true;

	if (<% getIndex("block_relay"); %> == 1)
		document.advanceSetup.elements["block_relay"][0].checked = true;
	else
		document.advanceSetup.elements["block_relay"][1].checked = true;

	if (<% getIndex("tx_stbc"); %> == 1)
		document.advanceSetup.elements["tx_stbc"][0].checked = true;
	else
		document.advanceSetup.elements["tx_stbc"][1].checked = true;

	//if(ldpc_support == 1)
	//{
		if (<% getIndex("tx_ldpc"); %> == 1)
			document.advanceSetup.elements["tx_ldpc"][0].checked = true;
		else
			document.advanceSetup.elements["tx_ldpc"][1].checked = true;
	//}
		
	if (<% getIndex("coexist"); %> == 1)
		document.advanceSetup.elements["coexist_"][0].checked = true;
	else
		document.advanceSetup.elements["coexist_"][1].checked = true;

	if (<% getIndex("tx_beamforming"); %> == 1){
		document.advanceSetup.elements["beamforming_"][0].checked = true;

		if((wlan_support_8822be==1 || wlan_support_8812fe==1) && (band & 64)) {
			document.advanceSetup.elements["txbf_mu_"][0].disabled = false;
			document.advanceSetup.elements["txbf_mu_"][1].disabled = false;

			if (<% getIndex("txbf_mu"); %> == 1)			
				document.advanceSetup.elements["txbf_mu_"][0].checked = true;
	else
				document.advanceSetup.elements["txbf_mu_"][1].checked = true;
		}else{

			document.advanceSetup.elements["txbf_mu_"][0].checked = false;
			document.advanceSetup.elements["txbf_mu_"][1].checked = true;
		
			document.advanceSetup.elements["txbf_mu_"][0].disabled = true;
			document.advanceSetup.elements["txbf_mu_"][1].disabled = true;

		}

	}
	else{
		document.advanceSetup.elements["beamforming_"][1].checked = true;

		document.advanceSetup.elements["txbf_mu_"][0].checked = false;
		document.advanceSetup.elements["txbf_mu_"][1].checked = true;
		
		document.advanceSetup.elements["txbf_mu_"][0].disabled = true;
		document.advanceSetup.elements["txbf_mu_"][1].disabled = true;
	}
	
	if (<% getIndex("mc2u_disable"); %> == 0)
		document.advanceSetup.elements["mc2u_"][0].checked = true;
	else
		document.advanceSetup.elements["mc2u_"][1].checked = true;
	onclick_mc2u();
	document.advanceSetup.elements["RFPower"][<% getIndex("RFPower"); %>].checked = true;

	if(<% getIndex("isCrossbandDefined"); %> == 1 && wlan_idx_ == 1) {
		if( (wlan_mode==0 || wlan_mode==3 || wlan_mode==4)) {
			enableRadioGroup(document.advanceSetup.elements["crossband_"]);
		}
		else {
			disableRadioGroup(document.advanceSetup.elements["crossband_"]);
		}
		
		document.getElementById("crossband").style.display = ""; 
		if (<% getIndex("crossband_enable"); %> == 1)
			document.advanceSetup.elements["crossband_"][0].checked = true;
		else
			document.advanceSetup.elements["crossband_"][1].checked = true;			
	}
	else {
		document.getElementById("crossband").style.display = "none"; 
	}

	if(<% getIndex("is_tdls_support"); %> == 1 && (wlan_mode == 0) ) {
		enableRadioGroup(document.advanceSetup.elements["tdls_prohibited_"]);
		document.getElementById("tdls_prohibited").style.display = ""; 
		enableRadioGroup(document.advanceSetup.elements["tdls_cs_prohibited_"]);
		document.getElementById("tdls_cs_prohibited").style.display = ""; 
		
		if (<% getIndex("tdls_cs_prohibited"); %> == 1)
			document.advanceSetup.elements["tdls_cs_prohibited_"][0].checked = true;
		else 
			document.advanceSetup.elements["tdls_cs_prohibited_"][1].checked = true;
		
		if (<% getIndex("tdls_prohibited"); %> == 1){
			document.advanceSetup.elements["tdls_prohibited_"][0].checked = true;

			document.advanceSetup.elements["tdls_cs_prohibited_"][0].checked = false;
			document.advanceSetup.elements["tdls_cs_prohibited_"][1].checked = true;
			document.advanceSetup.elements["tdls_cs_prohibited_"][0].disabled = true;
			document.advanceSetup.elements["tdls_cs_prohibited_"][1].disabled = true;
		}
		else
			document.advanceSetup.elements["tdls_prohibited_"][1].checked = true;
			
	}else {
		document.getElementById("tdls_prohibited").style.display = "none"; 
		document.getElementById("tdls_cs_prohibited").style.display = "none"; 
	}

	if(<% getIndex("is_80211k_support"); %> == 1) {
		if(wlan_mode==0 || wlan_mode==3 || wlan_mode==4) {
			enableRadioGroup(document.advanceSetup.elements["dot11k_"]);
		}
		else {
			disableRadioGroup(document.advanceSetup.elements["dot11k_"]);
		}
		
		document.getElementById("dot11k").style.display = ""; 
		if (<% getIndex("dot11k_enable"); %> == 1)
			document.advanceSetup.elements["dot11k_"][0].checked = true;
		else
			document.advanceSetup.elements["dot11k_"][1].checked = true;			
	}
	else {
		document.getElementById("dot11k").style.display = "none"; 
	}

	if(<% getIndex("is_80211r_support"); %> == 1 && (wlan_mode==0 || wlan_mode==3 || wlan_mode==4) ) {
		enableRadioGroup(document.advanceSetup.elements["80211r_enable_"]);
		document.getElementById("80211r_enable").style.display = ""; 
		
		if((enabled1X != 1)&&(wlan_encmode == 4 || wlan_encmode == 6)){ // wpa2 or wpa-mixed
			if (<% getIndex("80211r_enable"); %> == 1)
				document.advanceSetup.elements["80211r_enable_"][0].checked = true;
			else 
				document.advanceSetup.elements["80211r_enable_"][1].checked = true;
		}else{
			document.advanceSetup.elements["80211r_enable_"][0].checked = false;
			document.advanceSetup.elements["80211r_enable_"][1].checked = true;
			document.advanceSetup.elements["80211r_enable_"][0].disabled = true;
			document.advanceSetup.elements["80211r_enable_"][1].disabled = true;
		}
	}else {
		document.getElementById("80211r_enable").style.display = "none"; 
	}

	if (<% getIndex("is_80211v_support"); %> == 1 && (wlan_mode == 0 || wlan_mode==3 || wlan_mode==4)) {
		enableRadioGroup(document.advanceSetup.elements["80211v_enable_"]);
		document.getElementById("80211v_enable").style.display = ""; 

		if (<% getIndex("80211v_enable"); %> == 1)
			document.advanceSetup.elements["80211v_enable_"][0].checked = true;
		else
			document.advanceSetup.elements["80211v_enable_"][1].checked = true;
	}else {
		document.getElementById("80211v_enable").style.display = "none"; 
	}

	if(<% getIndex("is_smart_roaming_support"); %> == 1) {
		if(wlan_mode==0 || wlan_mode==3 || wlan_mode==4) {
			enableRadioGroup(document.advanceSetup.elements["smart_roaming_"]);
		}
		else {
			disableRadioGroup(document.advanceSetup.elements["smart_roaming_"]);
		}
		
		document.getElementById("smart_roaming").style.display = ""; 
		if (<% getIndex("smart_roaming_enable"); %> == 1)
			document.advanceSetup.elements["smart_roaming_"][0].checked = true;
		else
			document.advanceSetup.elements["smart_roaming_"][1].checked = true;			
	}
	else {
		document.getElementById("smart_roaming").style.display = "none"; 
	}


	if(<% getIndex("isStaControlDefined"); %> == 1 && wlan_idx_ == 1) {	
		document.getElementById("stactrl").style.display = "";
		if (<% getIndex("staControlEnabled"); %> == 1)
			document.advanceSetup.elements["staControlEnabled"].checked=true;			
		else 
			document.advanceSetup.elements["staControlEnabled"].checked=false;
		document.advanceSetup.elements["staControlPrefer"].selectedIndex=(<% getIndex("staControlPrefer"); %>==1?0:1);		
		updateStaControlState(document.advanceSetup, wlan_mode);
	}
	else {
		document.getElementById("stactrl").style.display = "none";
	}
	
}

function updateStaControlState(form, wlan_mode)
{   
	disableCheckBox(form.elements["staControlEnabled"]);
	form.elements["staControlPrefer"].disabled = true;

 	
	if(wlan_mode==0 ||
	   wlan_mode==3 ||
	   wlan_mode==4
	  )
	{     	
		enableCheckBox(form.elements["staControlEnabled"]);
		if (form.elements["staControlEnabled"].checked)
		{
			form.elements["staControlPrefer"].disabled = false;
		}	
	}  	
}

function onClick_func(enable)
{
	if(enable)
		enableRadioGroup(document.advanceSetup.sideBand0);
	else
		disableRadioGroup(document.advanceSetup.sideBand0);
	
}
function onclick_txbf()
{

	var wlan_support_8822be=<% getIndex("wlan_support_8822be"); %>;
	var wlan_support_8812fe=<% getIndex("wlan_support_8812fe"); %>;
	var band   = <% getIndex("band"); %>;

	if (document.advanceSetup.elements["beamforming_"][0].checked == true){

		if((wlan_support_8822be==1 || wlan_support_8812fe==1) && (band & 64)){
			document.advanceSetup.elements["txbf_mu_"][0].disabled = false;
			document.advanceSetup.elements["txbf_mu_"][1].disabled = false;
		}

	}
	else{

		document.advanceSetup.elements["txbf_mu_"][0].disabled = true;
		document.advanceSetup.elements["txbf_mu_"][1].disabled = true;

		document.advanceSetup.elements["txbf_mu_"][0].checked = false;
		document.advanceSetup.elements["txbf_mu_"][1].checked = true;

	}
}
function onclick_mc2u()
{
	if(document.advanceSetup.elements["mc2u_"][0].checked == true)
		get_by_id("mlcsttxrate").style.display = "none";
	else
		get_by_id("mlcsttxrate").style.display = "";
}
function resetForm()
{
	location=location; 
}
</SCRIPT>
</head>

<!--showtxrate_updated(document.wlanSetup,document.wlanSetup.band<% getIndex("wlan_idx"); %>.options[document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex].value, wlan_idx, <% getIndex("rf_used"); %>) -->
<body onload="LoadSetting();initData();SSIDSelected();wlan_adv_switch()">
<blockquote>
<h2>
<script type="text/javascript">
var wlan_num =  <% getIndex("wlan_num"); %>;
if (wlan_num > 1) {
	var wlan_idx_ = <% getIndex("wlan_idx"); %> + 1;
	var wifiname = "2.4G"
	if (wlan_idx_ == 1) {
		wifiname = "5G"
	}
	document.write(wlbasic_header_for_double + wifiname + "</p>");
}
else
	document.write(wlbasic_header+ "</p>");
</script>
</h2>

<form action=/boafrm/formWlanSetup method=POST name="wlanSetup">
<!-- for WPS -->
<INPUT type=hidden name=wps_clear_configure_by_reg<% getIndex("wlan_idx"); %> value=0>
<INPUT type=hidden name=Band2G5GSupport value=<% getIndex("Band2G5GSupport"); %>>
<INPUT type=hidden name=dsf_enable value=<% getIndex("dsf_enable"); %>>
<INPUT type=hidden name=wlBandMode value=<% getIndex("wlanBand2G5GSelect"); %>>
<INPUT type=hidden name="regdomain<% getIndex("wlan_idx");%>" value=<% getIndex("regDomain"); %>>
<INPUT type=hidden name="countrystr<% getIndex("wlan_idx");%>" value=<% getInfo("country_str"); %>>
<INPUT type=hidden name=wlan_support_8812e value=<% getIndex("wlan_support_8812e"); %>>
<INPUT type=hidden name=wlan_support_8192f value=<% getIndex("wlan_support_8192f"); %>>
<INPUT type=hidden name=wlan_support_ac2g value=<% getIndex("wlan_support_ac2g"); %>>

<table border=0 width="100%" cellspacing=4>
  <tr><hr size=1 noshade align=top></tr>
  <tr><font size=2><h3><script>dw(wizard_wire_basic)</script></h3></tr>
  <tr>
      <td width="100%" colspan=2><font size=2><b>
   	<input type="checkbox" name="wlanDisabled<% getIndex("wlan_idx"); %>" value="ON" ONCLICK="updateState(document.wlanSetup, wlan_idx)">&nbsp;&nbsp;<script>dw(wlbasic_disabled)</script></b>
      </td>
  </tr>

  <tr style="display:none">
      <td width="26%"><font size=2><b>Country:</b></td>
      <td width="74%"><font size=2><select size="1" name="country<% getIndex("wlan_idx"); %>" onChange="updateCountry(document.wlanSetup,wlan_idx);updateBand(document.wlanSetup, wlan_idx);updateChan_channebound(document.wlanSetup, wlan_idx);update_controlsideband(document.wlanSetup, wlan_idx);">
      </select>
      </td>
  </tr>
  <tr>
      <td width="26%"><font size=2>
      	<b><script>dw(wlbasic_band)</script></b>
      </td>
      <td width="74%"><font size=2>
      	<select size="1" name="band<% getIndex("wlan_idx"); %>" onChange="updateBand(document.wlanSetup, wlan_idx);Set_onChangeBand(document.wlanSetup, wlan_idx, document.wlanSetup.band<% getIndex("wlan_idx"); %>, document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex);Set_SSIDbyBand(document.wlanSetup, wlan_idx,document.wlanSetup.band<% getIndex("wlan_idx"); %>, document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex)">
	     	<SCRIPT>
				RFType[wlan_idx]= <% getIndex("RFType"); %>;
				APMode[wlan_idx]= <% getIndex("wlanMode"); %>;
				var val = <% getIndex("band"); %>;
				if (val > 0)
	    			bandIdx[wlan_idx]= val - 1;
				else
					bandIdx[wlan_idx]= val;

//	if (APMode[wlan_idx]!=1)
				bandIdxAP[wlan_idx]=bandIdx[wlan_idx];
//	else
				bandIdxClient[wlan_idx]=bandIdx[wlan_idx];
				showBand(document.wlanSetup, wlan_idx);
	     	</SCRIPT>
	 	</select>
      </td>
  </tr>
  <tr class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wlbasic_mode)</script></b></td>
      <td width="74%"><font size=2>
		<select size="1" name="mode<% getIndex("wlan_idx"); %>"	onChange="updateMode_basic(document.wlanSetup, wlan_idx)">
			<%  getModeCombobox(); %>   
		</select>	  
      </td>
	  <td>
		<input type="button" value=<% getIndex("multiAPRepeaterStr"); %> name="multipleAP<% getIndex("wlan_idx"); %>" 	onClick="showMultipleAP(document.wlanSetup, '/wlmultipleap.htm')">
		<script>document.wlanSetup.multipleAP<% getIndex("wlan_idx"); %>.value = wlbasic_multiple_ap;</script>
	  </td>
  </tr>
  <tr class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wlbasic_network_type)</script></b></td>
      <td width="74%"><font size=2><select size="1" name="type<% getIndex("wlan_idx"); %>"	onChange="updateType_basic(document.wlanSetup, wlan_idx)">
		<script type="text/javascript">
			var val = <% getIndex("networkType"); %>;
			if ( val == 0 ) {
				document.write('<option selected value=\"0\">'+wlbasic_infrastructure+'</option>');
				document.write('<option value=\"1\">'+wlbasic_adhoc+'</option>');
			}
			if ( val == 1 ) {
				document.write('<option value=\"0\">'+wlbasic_infrastructure+'</option>');
				document.write('<option selected value=\"1\">'+wlbasic_adhoc+'</option>');
			} 
		</script>
	 </select>
      </td>
  </tr>
  <tr>
      <td width="26%"><font size=2><b><script>dw(wlbasic_ssid)</script>
      </b></td>
      <td width="74%"><font size=2><input type="text" name="ssid<% getIndex("wlan_idx"); %>" size="33" maxlength="32" value="<% getInfo("ssid"); %>">
      </td>
      <td class="hide-class"><input type="submit" value="Add to Profile" id="addWlProfile" name="addWlProfile" onClick="return addWlProfileClick()">      	
      <script>document.wlanSetup.addWlProfile.value = wlbasic_addprofile;</script>
      </td>
  </tr>
      <tr id="channel_bounding" style="display:none">
      <td width="26%"><font size=2><b><script>dw(wlbasic_channelwidth)</script></b></td>
      <td width="74%"><font size=2>
      
      	<select size="1" name="channelbound<% getIndex("wlan_idx"); %>" onChange="update_controlsideband(document.wlanSetup, wlan_idx); showtxrate_updated(document.wlanSetup,document.wlanSetup.band<% getIndex("wlan_idx"); %>.options[document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex].value, wlan_idx, <% getIndex("rf_used"); %>)">
     		<option value="0">20MHz</option>
			<option value="1">40MHz</option>
			<SCRIPT>
			 	use_40m = <% getIndex("ChannelBonding"); %>;
		  		wlan_support_8812e=<% getIndex("wlan_support_8812e"); %>;
		  		wlan_support_8192f=<% getIndex("wlan_support_8192f"); %>;

				if( (wlan_support_8812e==1) && (wlan_support_8192f==0) )
				document.write('<option value="' + 2 + '">' + "80MHz" + '\n');
				
				phyband   = <% getIndex("Band2G5GSupport"); %>;
				if( phyband == 1 )
					document.write('<option value="' + 3 + '">' + "20/40MHz" + '\n');
					
				document.wlanSetup.elements["channelbound" + <% getIndex("wlan_idx"); %>].selectedIndex=use_40m;
			</SCRIPT>
	 	</select>
	 	
      </td>
  </tr>
  <tr id="control_sideband" style="display:none">
      <td width="26%"><font size=2><b><script>dw(wlbasic_ctlsideband)</script></b></td>
      <td width="74%"><font size=2>
      	<select size="1" name="controlsideband<% getIndex("wlan_idx"); %>" onChange="updateChan_channebound(document.wlanSetup, wlan_idx);">
			<SCRIPT>
		  		wlan_support_8812e=<% getIndex("wlan_support_8812e"); %>;
				phyband   = <% getIndex("Band2G5GSupport"); %>;

				if((wlan_support_8812e==1) && (phyband==2))
				{
					document.write('<option value="' + 0 + '">' + wlbasic_ctlsideautomode + '\n');
					document.write('<option value="' + 0 + '">' + wlbasic_ctlsideautomode + '\n');
				}
				else
				{
					document.write('<option value="' + 0 + '">' + wlbasic_ctlsideuppermode + '\n');
					document.write('<option value="' + 1 + '">' + wlbasic_ctlsidelowermode + '\n');

				}
			</SCRIPT>
	 	</select>
      </td>
  </tr>
  <tr>
      <td width="26%"><font size=2><b><script>dw(wlbasic_chnnelnum)</script></b></td>
      <td width="74%"><font size=2><select size="1" name="chan<% getIndex("wlan_idx"); %>" onChange="updateChan_selectedIndex(document.wlanSetup, wlan_idx);"> </select></td>
    <SCRIPT>
	regDomain[wlan_idx] = <% getIndex("regDomain"); %>;
	defaultChan[wlan_idx] = <% getIndex("channel"); %>;

	wlan_channel[wlan_idx] = defaultChan[wlan_idx];
	updateChan(document.wlanSetup, wlan_idx);
    </SCRIPT>
  </tr>
<tr>
      <td width="26%"><font size=2><b><script>dw(wlbasic_broadcastssid)</script></b></td>
      <td width="74%"><font size=2><select size="1" name="hiddenSSID<% getIndex("wlan_idx"); %>"	onChange="">
      	  	<option value="1"><script>dw(wlbasic_brossid_disabled)</script></option>
   	  	<option value="0"><script>dw(wlbasic_brossid_enabled)</script></option>
	 </select>
      </td>
  </tr>
  
  <tr id="wlan_wmm"  class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wlbasic_wmm)</script></b></td>
      <td width="74%"><font size=2><select size="1" name="wlanwmm<% getIndex("wlan_idx"); %>"	onChange="">
      	  	<option value="0"><script>dw(wlbasic_wmm_disabled)</script></option>
   	  	<option value="1"><script>dw(wlbasic_wmm_enabled)</script></option>
	 </select>
      </td>
  </tr>
  
  
  <tr class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wlbasic_data_rate)</script></b></td>
      <td width="74%"><font size=2>
      <select size="1" name="txRate<% getIndex("wlan_idx"); %>" onChange="checkTurboState()"> 
	 	<SCRIPT>
	 		updateDataRate();
		</SCRIPT>
	</select>
	</td>
  </tr>
  
  <tr class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wlbasic_tx_restrict)</script>
      </b></td>
      <td width="74%"><font size=2><input type="text" name="tx_restrict<% getIndex("wlan_idx"); %>" size="5" maxlength="4" value="<% getInfo("tx_restrict"); %>">&nbsp;Mbps&nbsp;<script>dw(wlbasic_no_restrict)</script>
      </td>      
  </tr>
  
  <tr class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wlbasic_rx_restrict)</script>
      </b></td>
      <td width="74%"><font size=2><input type="text" name="rx_restrict<% getIndex("wlan_idx"); %>" size="5" maxlength="4" value="<% getInfo("rx_restrict"); %>">&nbsp;Mbps&nbsp;<script>dw(wlbasic_no_restrict)</script>
      </td>      
  </tr>
  
   <tr class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wlbasic_associated_clients)</script></b></td>
      <td width="70%"><font size=2><input type="button" value="Show Active Clients" name="showMac<% getIndex("wlan_idx"); %>" onClick="showMacClick(document.wlanSetup, '/wlstatbl.htm')">
      <script>document.wlanSetup.showMac<% getIndex("wlan_idx"); %>.value = wlbasic_show_associated_clients;</script>
      </td>
  </tr>
  <tr class="hide-class">
      <td width="100%" colspan=2><font size=2><b>
   	<input type="checkbox" name="wlanMacClone<% getIndex("wlan_idx"); %>" value="ON">&nbsp;&nbsp;<script>dw(wlbasic_enable_mac_clone)</script></b>
      </td>
  </tr>  
  <tr class="hide-class">
      <td width="100%" colspan=2><font size=2><b>
   	<input type="checkbox" name="repeaterEnabled<% getIndex("wlan_idx"); %>" value="ON" 
		ONCLICK="updateRepeaterState(document.wlanSetup, wlan_idx)">&nbsp;&nbsp; <script>dw(wlbasic_enable_repeater_mode)</script></b>
      </td>
  </tr>
  <tr class="hide-class">
      <td width="100%" colspan=2><font size=2><b><script>dw(wlbasic_extended_ssid)</script>&nbsp;&nbsp;
      <input type="text" name="repeaterSSID<% getIndex("wlan_idx"); %>" size="33" maxlength="32" value="<% getInfo("repeaterSSID"); %>">
      </td>
      <td><input type="submit" value="Add to Profile" id="addRptProfile" name="addRptProfile" onClick="return addRptProfileClick()">      	
      <script>document.wlanSetup.addRptProfile.value = wlbasic_addprofile;</script>
      </td>
  </tr> 
  <script>
  if (!disableSSID[wlan_idx]) {
	document.write("</table>\n");
	document.write("<span id = \"hide_div\" class = \"off\">\n");
	document.write("<table border=\"0\" width='100%'>\n");
  }
  </script>

  </tr>
  <tr><td colspan="2" width="100%" height="55"><font size=2>
  <em>Note: If you want to change the setting for Mode and SSID, you must go to EasyConfig page to disable EasyConfig first.</em></font></td>
  </tr>
  <script>
  if (!disableSSID[wlan_idx]) {
	document.write("</table>\n");
	document.write("</span>\n");
	document.write("<table border=\"0\" width='100%'>\n");
  }
  </script>

  </table>
  </span>
  <br>
  
  
<p id="wlProfileDiv" style="display:none">
  <table border=0 width="100%">
  <tr><input type="checkbox" id="wlProfileEnabled" name="wlProfileEnabled" value=<% getInfo("wlProfile_value"); %> <% getInfo("wlProfile_checkbox"); %> onclick="onclick_wlProfile()"><b>&nbsp;&nbsp;&nbsp;<script>dw(wlbasic_enable_wl_profile)</script></b></tr>
  <br>
  <tr><font size=2><b><script>dw(wlbasic_wl_profile_list)</script></b></font></tr>
  <% wlProfileTblList(); %>
  </table>
  <br>
  <input type="submit" value="Delete Selected" name="delSelWlProfile" onClick="return deleteClick()">&nbsp;&nbsp;
  <script>document.wlanSetup.delSelWlProfile.value = wlbasic_delete_select;</script>
  <input type="submit" value="DeleteAll" name="delAllWlProfile" onClick="return deleteAllClick()">&nbsp;&nbsp;&nbsp;
  <script>document.wlanSetup.delAllWlProfile.value = wlbasic_delete_all;</script>

</tr>
</p>

  
  <script>

  function addWlProfileClick()
 	{
  	if ( get_by_id("wlProfileEnabled").checked == false
  	&& confirm(wlbasic_enable_wire) )
  	{
  		get_by_id("wlProfileEnabled").checked = true;
  		get_by_id("wlProfileEnabled").value = 1;
		if (saveChanges_basic(document.wlanSetup, wlan_idx)) {
			parent.showWaitDiv();
  			return true;
		}
  	}
  	return false;
 	}

 	function addRptProfileClick() {
 		if ( get_by_id("wlProfileEnabled").checked == false&& confirm(wlbasic_asloenable_wire) ){
			get_by_id("wlProfileEnabled").checked = true;
			get_by_id("wlProfileEnabled").value = 1;
			if (saveChanges_basic(document.wlanSetup, wlan_idx)) {
				parent.showWaitDiv();
				return true;
			}
  		}
		return false;
 	}
 	
  function onclick_wlProfile()
  {
  	if(get_by_id("wlProfileEnabled").checked == true)
  		get_by_id("wlProfileEnabled").value = 1;  		
  	else
  		get_by_id("wlProfileEnabled").value = 0;
  }
  
	function deleteClick()
	{
		parent.showWaitDiv();
		return true;
	}

	function deleteAllClick()
	{
		parent.showWaitDiv();
		return true;
	}

	function saveApply() {
		if (!saveChanges_basic(document.wlanSetup, wlan_idx)) {
			return false
		}
		parent.hideWaitDiv()
		var guest_2g = '<% getInfo("guestssid2g"); %>'
		var guest_5g = '<% getInfo("guestssid5g"); %>'
		var main_ssid = document.wlanSetup.elements["ssid"+wlan_idx].value
		if (main_ssid == guest_2g || main_ssid == guest_5g) {
			alert(wlguest_ssid_same_as_root_2g)
			document.wlanSetup.elements["ssid"+wlan_idx].focus();
			return false;
		}
		parent.showWaitDiv()
		return true
	}
	  	
  
  </script>
  <table border="0" width="100%">
  </table>
  <table border=0 width="100%" cellspacing=0 cellpadding=0>
  <tr>
    <input type="hidden" value="/wlbasic.htm" name="wlan-url">
<% getInfo("apply_prompt_comment_start");%>
     <input type="submit" value="Apply Changes" name="save" onClick="return saveChanges_basic(document.wlanSetup, wlan_idx)">&nbsp;&nbsp;
     <script>document.wlanSetup.save.value = wlbasic_save;</script>
     <input type="button" value="Reset" name="reset" onclick="resetForm();">
     <script>document.wlanSetup.reset.value = wlbasic_reset;</script>
<% getInfo("apply_prompt_comment_end");%>
<% getInfo("apply_direct_comment_start");%>
     <input type="submit" class="save_button_class" value="Save" name="save" onClick="return saveChanges_basic(document.wlanSetup, wlan_idx)">&nbsp;&nbsp;
     <script>document.wlanSetup.save.value = wlbasic_save;</script>
     <input type="submit" value="Save & Apply" name="save_apply" onClick="return saveApply()">&nbsp;&nbsp;
     <script>document.wlanSetup.save_apply.value = wlbasic_save_apply;</script>
     <input type="button" value="Reset" name="reset" onclick="resetForm();">
     <script>document.wlanSetup.reset.value = wlbasic_reset;</script>
<% getInfo("apply_direct_comment_end");%>
     <input type="hidden" name="basicrates<% getIndex("wlan_idx"); %>" value=0>
     <input type="hidden" name="operrates<% getIndex("wlan_idx"); %>" value=0>
     <input type="hidden" id="action" name="Action" value="">
  </tr>
  <script>
  	var usedBand=new Array();
	usedBand[wlan_idx] = <% getIndex("band"); %>;
   	updateState(document.wlanSetup, wlan_idx);
	var mssid_num=<%getIndex("wlan_mssid_num");%>;
	if(mssid_num == 0)
		   disableButton(document.wlanSetup.elements["multipleAP"+<% getIndex("wlan_idx"); %>]);
  </script>
</form>
</table>
</blockquote>

<blockquote style="margin-top: 30px;">
<form action=/boafrm/formWlEncrypt method=POST name="formEncrypt">
<div><font size=2><h3><script>dw(wlwds_set_secu)</script></h3></div>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr> 
<td  rowspan="12" width="540">
<iframe width="100%" height="100" id="SSIDAuthMode" name="SSIDAuthMode" frameborder="0" marginheight="0" scrolling="no"> 
</iframe> </td>
</tr>
</table>
<table width="100%" height="25" border="0" cellpadding="0" cellspacing="0">
<tr> 
<td  height="20" class="MainTD" ><font size="2"><b class="hide-class"><script>dw(wlsec_select_ssid)</script>&nbsp;&nbsp;</b>
<select name="SSID_Setting" onChange="SSIDSelected( this.selectedIndex )" class="hide-class">
<script>SetSSIDSettingOption()</script>
</select>
<% getInfo("apply_prompt_comment_start");%>
	 <input type="button" value="Apply Changes" name="save" onClick="ValidateForm(document.formEncrypt, 0);">&nbsp;&nbsp;
	 <script>document.formEncrypt.save.value = wlsec_save;</script>
	 <input type="button" value="Reset" name="reset1" onClick="ValidateForm(document.formEncrypt, 1);">
	 <script>document.formEncrypt.reset1.value = wlsec_reset;</script>
<% getInfo("apply_prompt_comment_end");%>
<% getInfo("apply_direct_comment_start");%>
     <input type="hidden" id="save_apply_flag" name="save_apply_flag" value="1">
     <input type="button" class="save_button_class" value="Save" name="save" onClick="document.getElementById('save_apply_flag').name='save';ValidateForm(document.formEncrypt, 0);">&nbsp;&nbsp;
     <script>document.formEncrypt.save.value = wlsec_save;</script>
	 <input type="button" value="Save & Apply" name="save_apply" onClick="document.getElementById('save_apply_flag').name='save_apply';ValidateForm(document.formEncrypt, 0);">&nbsp;&nbsp;
	 <script>document.formEncrypt.save_apply.value = wlsec_save_apply;</script>
	 <input type="button" value="Reset" name="reset1" onClick="ValidateForm(document.formEncrypt, 1);">
	 <script>document.formEncrypt.reset1.value = wlsec_reset;</script>
<% getInfo("apply_direct_comment_end");%>
 <script> apModeCheck();	 
</script> 
</td>
</tr>
</table>

<span id = "wpa_auth" class = "off" >
<table>
<input name="wpaAuth<% getIndex("wlan_idx"); %>" type="radio" value="eap" >PSK
<input name="wpaAuth<% getIndex("wlan_idx"); %>" type="radio" value="psk">Pre-Shared&nbsp;Key
<input type="checkbox" name="ciphersuite<% getIndex("wlan_idx"); %>" value="tkip">TKIP
<input type="checkbox" name="ciphersuite<% getIndex("wlan_idx"); %>" value="aes" >AES
<input type="checkbox" name="wpa2ciphersuite<% getIndex("wlan_idx"); %>" value="tkip">TKIP
<input type="checkbox" name="wpa2ciphersuite<% getIndex("wlan_idx"); %>" value="aes" >AES
<input type="radio" name="wpa11w<% getIndex("wlan_idx"); %>" value="none">none
<input type="radio" name="wpa11w<% getIndex("wlan_idx"); %>" value="capable">capable
<input type="radio" name="wpa11w<% getIndex("wlan_idx"); %>" value="required">required
<input type="radio" name="wpa2EnableSHA256<% getIndex("wlan_idx"); %>" value="disable">disable
<input type="radio" name="wpa2EnableSHA256<% getIndex("wlan_idx"); %>" value="enable">enable
</table>
</span>
<span id= "wapi_auth" class= "off" >
<table>
<input name="wapiAuth<% getIndex("wlan_idx"); %>" type="radio" value="eap" >PSK
<input name="wapiAuth<% getIndex("wlan_idx"); %>" type="radio" value="psk">Pre-Shared&nbsp;Key
</table>
</span>
<input type=hidden name=wps_clear_configure_by_reg<% getIndex("wlan_idx"); %> value=0>
<input type="hidden" id="wlan_ssid" name="wlan_ssid" value="">
<input type="hidden" id="wlan_ssid_id" name="wlan_ssid_id" value="">        
<input type="hidden" id="wlan_security_mode" name="method<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_authtype" name="authType" value="">
<input type="hidden" id="wlan_wepkeylength" name="wepKeyLen<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wepkeyfmt" name="wlan_wepkeyfmt" value="">
<input type="hidden" id="wlan_wepdefaultkey" name="wlan_wepdefaultkey" value="">
<input type="hidden" id="wlan_wepkey" name="wlan_wepkey" value="">

<input type="hidden" id="wepEnabled" name="wepEnabled<% getIndex("wlan_idx"); %>" value="ON">
<input type="hidden" id="length" name="length<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="format" name="format<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="key" name="key<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wpa_psk_fmt" name="pskFormat<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wpa_psk" name="pskValue<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wpa_preAuth" name="preAuth<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_radius_server_ip" name="radiusIP<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_radius_server_port" name="radiusPort<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_radius_server_psk" name="radiusPass<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_ieee8021x" name="use1x<% getIndex("wlan_idx"); %>" value="">

<input type="hidden" id="eap_type" name="eapType<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="eap_inside_type" name="eapInsideType<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="eap_user_id" name="eapUserId<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="radius_user_name" name="radiusUserName<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="radius_user_pass" name="radiusUserPass<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="radius_user_cert_pass" name="radiusUserCertPass<% getIndex("wlan_idx"); %>" value="">

<input type="hidden" id="wlan_wapi_psk_fmt" name="wapiPskFormat<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wapi_psk" name="wapiPskValue<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_as_server_ip" name="wapiASIP<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_wapi_cert_sel" name="wapiCertSel<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" value="/wlbasic.htm" name="submit-url">
</form>
</blockquote>

<blockquote style="margin-top: 30px;">
<form action=/boafrm/formAdvanceSetup method=POST name="advanceSetup">
<div><h3><script>dw(menu_advance)</script></h3></div>
<table border=0 width="100%" cellspacing=4 cellpadding=0>
    <tr class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_frg_thre)</script></b></td>
      <td width="70%"><font size=2><input type="text" name="fragThreshold" size="10" maxlength="4" value=<% getInfo("fragThreshold"); %>>(256-2346)</td>
    </tr>
    <tr class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_rts_thre)</script></b></td>
      <td width="70%"><font size=2><input type="text" name="rtsThreshold" size="10" maxlength="4" value=<% getInfo("rtsThreshold"); %>>(0-2347)</td>
    </tr>
    <tr class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_beacon_interval)</script></b></td>
      <td width="70%"><font size=2><input type="text" name="beaconInterval" size="10" maxlength="4" value=<% getInfo("beaconInterval"); %>> (20-1024 ms)</td>
    </tr>
    <tr id="preambleType" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_preamble_type)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="preamble" value="long"><script>dw(wladv_preamble_long)</script>&nbsp;&nbsp;
      <input type="radio" name="preamble" value="short"><script>dw(wladv_preamble_short)</script></td>
    </tr>
    
    <tr id="showIAPP" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_iapp)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="iapp" value="yes"><script>dw(wladv_iapp_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="iapp" value="no"><script>dw(wladv_iapp_disabled)</script></td>
    </tr>
    <tr id="showHS2" style="display:" class="hide-class">
      <td width="30%"><font size=2><b>HS2:</b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="hs2" value="yes">Enabled&nbsp;&nbsp;
      <input type="radio" name="hs2" value="no">Disabled</td>
    </tr>
    <tr class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_protection)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="11g_protection" value="yes"><script>dw(wladv_protection_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="11g_protection" value="no"><script>dw(wladv_protection_disabled)</script></td>
    </tr> 

   <tr id="Aggregation" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_aggregation)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="aggregation" value="enable"><script>dw(wladv_aggregation_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="aggregation" value="disable"><script>dw(wladv_aggregation_disabled)</script></td>
   </tr>

    <tr id="ShortGi" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_short_gi)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="shortGI0" value="on"><script>dw(wladv_short_gi_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="shortGI0" value="off"><script>dw(wladv_short_gi_disabled)</script></td>
    </tr> 
    <tr id="blockrelay" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_wlan_partition)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="block_relay" value="enable"><script>dw(wladv_wlan_partition_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="block_relay" value="disable"><script>dw(wladv_wlan_partition_disabled)</script></td>
    </tr> 

     <tr id="stbctransmit" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_stbc)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="tx_stbc" value="enable"><script>dw(wladv_stbc_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="tx_stbc" value="disable"><script>dw(wladv_stbc_disabled)</script></td>
    </tr>

	<tr id="ldpctransmit" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_ldpc)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="tx_ldpc" value="enable"><script>dw(wladv_ldpc_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="tx_ldpc" value="disable"><script>dw(wladv_ldpc_disabled)</script></td>
    </tr>
	
     <tr id="coexist" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_coexist)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="coexist_" value="enable"><script>dw(wladv_coexist_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="coexist_" value="disable"><script>dw(wladv_coexist_disabled)</script></td>
    </tr> 
    <tr id="tx_beamforming" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_tx_beamform)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="beamforming_" value="enable"><script>dw(wladv_tx_beamform_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="beamforming_" value="disable"><script>dw(wladv_tx_beamform_disabled)</script></td>
    </tr>
     <tr id="txbf_mu" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_mu_mimo)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="txbf_mu_" value="enable"><script>dw(wladv_mu_mimo_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="txbf_mu_" value="disable"><script>dw(wladv_mu_mimo_disabled)</script></td>
    </tr>
     <tr id="mc2u_disable" style="display:" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_m2u)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="mc2u_" value="enable" onclick="onclick_mc2u()" ><script>dw(wladv_m2u_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="mc2u_" value="disable" onclick="onclick_mc2u()" ><script>dw(wladv_m2u_disabled)</script></td>
    </tr>
   <tr id="tdls_prohibited" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_tdls_prohibited)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="tdls_prohibited_" value="enable" ><script>dw(wladv_tdls_prohibited_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="tdls_prohibited_" value="disable" ><script>dw(wladv_tdls_prohibited_disabled)</script></td>
    </tr>
       <tr id="tdls_cs_prohibited" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_tdls_channel_switch)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="tdls_cs_prohibited_" value="enable" ><script>dw(wladv_tdls_channel_switch_enabled)</script>&nbsp;&nbsp;
      <input type="radio" name="tdls_cs_prohibited_" value="disable" ><script>dw(wladv_tdls_channel_switch_disabled)</script></td>
    </tr>
    <tr id="mlcsttxrate" style="display:" class="hide-class">
      <td width="26%"><font size=2><b><script>dw(wladv_multicast_rate)</script></b></td>
      <td width="74%"><font size=2><select size="1" name="mlcstrate" onChange=""> 
	 <SCRIPT>
	var band   = <% getIndex("band"); %>;
	var auto   = <% getIndex("rateAdaptiveEnabled"); %>;
	var txrate = <% getIndex("lowestMlcstRate"); %>;
	var rf_num = <% getIndex("rf_used"); %>;

	var rate_mask = [15,1,1,1,1,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,8,8,8,8,8,8,8,8];
	var rate_name=[wladv_multicast_rate,"1M","2M","5.5M","11M","6M","9M","12M","18M","24M","36M","48M","54M", "MCS0", "MCS1",
		"MCS2", "MCS3", "MCS4", "MCS5", "MCS6", "MCS7", "MCS8", "MCS9", "MCS10", "MCS11", "MCS12", "MCS13", "MCS14", "MCS15"];
	var vht_rate_name=["NSS1-MCS0","NSS1-MCS1","NSS1-MCS2","NSS1-MCS3","NSS1-MCS4",
		"NSS1-MCS5","NSS1-MCS6","NSS1-MCS7","NSS1-MCS8","NSS1-MCS9",
		"NSS2-MCS0","NSS2-MCS1","NSS2-MCS2","NSS2-MCS3","NSS2-MCS4",
		"NSS2-MCS5","NSS2-MCS6","NSS2-MCS7","NSS2-MCS8","NSS2-MCS9"];
	var mask=0;
	var defidx=0;
	var idx, i, rate;
	var vht_num;
	
	if (band & 1)
		mask |= 1;
	if ((band&2) || (band&4))
		mask |= 2;
	if (band & 8) {
		if (rf_num == 2)
			mask |= 12;	
		else
			mask |= 4;
	}	
document.write('<option value="' + 0 + '">' + rate_name[0] + '\n');
	for (idx=1, i=1; i<=28; i++) {
		if (rate_mask[i] & mask) {
				rate = (1 << (i-1));
		 if(txrate == 0)
            defidx = 0;
		 else if (txrate == rate)
				defidx = idx;
			document.write('<option value="' + i + '">' + rate_name[i] + '\n');
			idx++;
		}
	}
	if(band & 64){
		if(rf_num==1)
			vht_num=9;
		else
			vht_num=19; 
		for (idx=30, i=0; i<=vht_num; i++) {
		
				rate = ((1 << 31) + i);
				
				if (txrate == rate)
				{
					if(vht_num == 19)
					defidx = idx-5;
					else
						defidx = idx-5-8;
				}
				document.write('<option value="' + (i+30) + '">' + vht_rate_name[i] + '\n');
				idx++;
		}
	}
	document.advanceSetup.elements["mlcstrate"].selectedIndex=defidx;
	</SCRIPT>
	</select>
	</td>
  </tr>
    <tr>
      <td width="30%"><font size=2><b><script>dw(wladv_rf_power)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="RFPower" value="0"><script>dw(wladv_wall)</script>&nbsp;&nbsp;
      <input type="radio" name="RFPower" value="1"><script>dw(wladv_standard)</script>&nbsp;&nbsp;
      <input type="radio" name="RFPower" value="2"><script>dw(wladv_green)</script>&nbsp;&nbsp;
    </tr>

  <tr id="crossband" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_crossband_support)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="crossband_" value="enable"><script>dw(wladv_enable)</script>&nbsp;&nbsp;
      <input type="radio" name="crossband_" value="disable"><script>dw(wladv_disable)</script></td>
  </tr>
  
    <tr id="dot11k" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_80211k_support)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="dot11k_" value="enable"><script>dw(wladv_enable)</script>&nbsp;&nbsp;
      <input type="radio" name="dot11k_" value="disable"><script>dw(wladv_disable)</script></td>
    </tr>

   <tr id="80211r_enable" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_fast_bss_tran)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="80211r_enable_" value="enable"><script>dw(wladv_enable)</script>&nbsp;&nbsp;
      <input type="radio" name="80211r_enable_" value="disable"><script>dw(wladv_disable)</script></td>
    </tr> 
   <tr id="ft_over_ds" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_support_overds)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="ft_over_ds_" value="enable"><script>dw(wladv_enable)</script>&nbsp;&nbsp;
      <input type="radio" name="ft_over_ds_" value="disable"><script>dw(wladv_disable)</script></td>
    </tr>
    <tr id="80211v_enable" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b><script>dw(wladv_80211v_bss_tran)</script></b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="80211v_enable_" value="enable"><script>dw(wladv_enable)</script>&nbsp;&nbsp;
      <input type="radio" name="80211v_enable_" value="disable"><script>dw(wladv_disable)</script></td>
    </tr> 
    <tr id="smart_roaming" style="display:none" class="hide-class">
      <td width="30%"><font size=2><b>Smart Roaming Support:</b></td>
      <td width="70%"><font size=2>
      <input type="radio" name="smart_roaming_" value="enable">Enabled&nbsp;&nbsp;
      <input type="radio" name="smart_roaming_" value="disable">Disabled</td>
    </tr>
  <tr id="stactrl" style="display:none" class="hide-class">
    <td width="35%"><font size=2><b>
   	<input type="checkbox" name="staControlEnabled" value="ON" 
		ONCLICK="updateStaControlState(document.advanceSetup, wlan_mode)">&nbsp;&nbsp; Enable STA Control</b>
      </td>
     <td width="60%"><font size=2>
		<select size="1" name="staControlPrefer">
    		<option value="0">Prefer 5GHz</option>
   			<option value="1">Prefer 2GHz</option>
    	</select>
	</td>	      
  </tr>   
  </table>
<p>
<% getInfo("apply_prompt_comment_start");%>  
  <input type="submit" value="Apply Changes" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
   <script>document.advanceSetup.save.value = wladv_save;</script>
  <input type="reset" value="  Reset  " name="reset" onClick="resetForm();">&nbsp;&nbsp;&nbsp;
  <script>document.advanceSetup.reset.value = wladv_reset;</script>
<% getInfo("apply_prompt_comment_end");%>
<% getInfo("apply_direct_comment_start");%>
  <input type="submit" class="save_button_class" value="Save" name="save" onClick="return saveChanges()">&nbsp;&nbsp;
  <script>document.advanceSetup.save.value = wladv_save;</script>
  <input type="submit" value="Save & Apply" name="save_apply" onClick="return saveChanges()">&nbsp;&nbsp;
  <script>document.advanceSetup.save_apply.value = wladv_save_apply;</script>
  <input type="reset" value="  Reset  " name="reset" onClick="resetForm();">&nbsp;&nbsp;&nbsp;
  <script>document.advanceSetup.reset.value = wladv_reset;</script>
<% getInfo("apply_direct_comment_end");%>
  <input type="hidden" value="/wlbasic.htm" name="submit-url">
  </p>
</form>
</blockquote>
</body>

</html>
