<html>
<! Copyright (c) Realtek Semiconductor Corp., 2003. All Rights Reserved. ->
<head>
<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
<% getIndex("no-cache"); %>
<title>MAC Filtering</title>
<script type="text/javascript" src="util_gw.js"> </script>
<SCRIPT language=Javascript src="<% getInfo("lang");%>"></SCRIPT>
<% getInfo("include_css"); %>
<script>
parent.hideWaitDiv()

var macFilterPolicy = '<% getIndex("macFilterPolicy"); %>'

function addClick()
{
  if (!document.formFilterAdd.enabled.checked){
    parent.showWaitDiv()
    return true;
  }
  // 当开启mac过滤且选择白名单时，
  var macFilterPolicys = document.getElementsByName("policy")
  if ( ('<% getIndex("macFilterNum"); %>' == 0 || macFilterPolicy != document.formFilterAdd.policy.value) 
        && macFilterPolicys[1].checked) {
    if (document.formFilterAdd.mac.value == "") {
      alert(white_macfilter_alert)
      document.formFilterAdd.mac.focus();
      return false
    }
  }

  if (document.formFilterAdd.mac.value=="" && document.formFilterAdd.comment.value=="" ){
    parent.showWaitDiv()
    return true;
  }

  var str = document.formFilterAdd.mac.value;
  if ( str.length < 12) {
    alert(macfilter_macaddr_nocomplete);
    document.formFilterAdd.mac.focus();
    return false;
  }

  // add for "All MAC Address field can't reject 00:00:00:00:00:00/ff:ff:ff:ff:ff:ff MAC Address" issue
  with(document.formFilterAdd)
  {
    if(!checkMacAddr(mac,macfilter_macaddr_invalid))
      return false;
  }
  document.formFilterAdd.mac.value = document.formFilterAdd.mac.value.replace(/:/g, "").replace(/-/g, "");
  parent.showWaitDiv()
  return true;
}


function deleteClick()
{
  
  var macFilterNum = Number('<% getIndex("macFilterNum"); %>')
  var selectNum = 0
  for (var i = 1; i <= macFilterNum; i++) {
    var element = document.getElementsByName("select" + i)[0]
    if (element.checked) {
      selectNum ++
    }
  }
  if (selectNum == 0) {
    alert(least_select_one)
    return false
  }
  if (document.formFilterAdd.enabled.checked && macFilterPolicy == 1 && selectNum == macFilterNum) {
    alert(firewall_delete_alert_message)
    return false;
  }
  if ( !confirm(macfilter_delete_confirm) ) {
	  return false;
  }
  else{
    parent.showWaitDiv()
	  return true;
  }
  
}

function deleteAllClick()
{
  if (document.formFilterAdd.enabled.checked && macFilterPolicy == 1) {
    alert(firewall_delete_alert_message)
    return false;
  }
  if ( !confirm(macfilter_delete_all_confirm) ) {
	  return false;
  }
  else {
    parent.showWaitDiv()
    return true;
  }
  
}

function disableDelButton()
{
	disableButton(document.formFilterDel.deleteSelFilterMac);
	disableButton(document.formFilterDel.deleteAllFilterMac);
}

function updateState()
{
  if (document.formFilterAdd.enabled.checked) {
 	enableTextField(document.formFilterAdd.mac);
	enableTextField(document.formFilterAdd.comment);
  }
  else {
 	disableTextField(document.formFilterAdd.mac);
	disableTextField(document.formFilterAdd.comment);
  }
}

function policyChange(value) {
  var formFilterDelId = document.getElementById("formFilterDelId")
  if (value != macFilterPolicy) {
    formFilterDelId.style.display = "none"
  } else {
    formFilterDelId.style.display = ""
  }
}

function Load_Setting()
{
	if ( <% getIndex("macFilterEnabled"); %> ){
    document.formFilterAdd.enabled.checked = true;
  }
	
  var policydom = document.getElementsByName("policy")
  if ( macFilterPolicy == 1) {
    policydom[1].checked = true
  } else {
    policydom[0].checked = true
  }
	updateState();
}
</script>
</head>

<body onload="Load_Setting();">
<blockquote>
<h2><script>dw(macfilter_header)</script></h2>

<table border=0 width="100%" cellspacing=4 cellpadding=0>
<tr><td><font size=2>
<script>dw(macfilter_header_explain)</script>
</font></td></tr>

<tr><td><hr size=1 noshade align=top></td></tr>

<form action=/boafrm/formFilter method=POST name="formFilterAdd">
<tr style="height: 30px;"><td><font size=2><b>
	<input type="checkbox" name="enabled" value="ON" ONCLICK=updateState()>&nbsp;&nbsp;<script>dw(macfilter_enable)</script></b><br>
    </td>
</tr>

<tr style="height: 30px;">
  <td>
    <b>
      <font size=2><script>dw(filtering_policy)</script>:</font>
      <input type="radio" name="policy" value="0" id="deny" onclick="policyChange(0)"><label for="deny"><script>dw(wlmeshACL_mode_deny)</script></label>
      <input type="radio" name="policy" value="1" id="allow" onclick="policyChange(1)"><label for="allow"><script>dw(wlmeshACL_mode_allow)</script></label>
    </b>
    <span>(<script>dw(filtering_policy_msg)</script>)</span>
  </td>
</tr>
<tr><td>
    <p>
      <b>
        <font size=2><script>dw(macfilter_macaddr)</script></font>
        <input type="text" name="mac" size="15">
      </b>
      <b>
        <font size=2><script>dw(macfilter_comm)</script>&nbsp;&nbsp;&nbsp;&nbsp;</font>
        <input type="text" name="comment" size="16" maxlength="20">
      </b>
    </p>
<% getInfo("apply_prompt_comment_start");%>	 
     <p><input type="submit" value="Apply Changes" name="addFilterMac" onClick="return addClick()">&nbsp;&nbsp;
       <input type="reset" value="Reset" name="reset">
<% getInfo("apply_prompt_comment_end");%>
<% getInfo("apply_direct_comment_start");%>
     <p><input type="submit" class="save_button_class" value="Save" name="addFilterMac" onClick="return addClick()">
        <script>document.formFilterAdd.addFilterMac.value = macfilter_save;</script>&nbsp;&nbsp;
        <input type="submit" value="Save & Apply" name="save_apply" onClick="return addClick()">
        <script>document.formFilterAdd.save_apply.value = macfilter_apply;</script>&nbsp;&nbsp;	   
        <input type="reset" value="Reset" name="reset">
        <script>document.formFilterAdd.reset.value = macfilter_reset;</script>
        <input type="hidden" value="1" name="addFilterMacFlag">		
<% getInfo("apply_direct_comment_end");%>
        <input type="hidden" value="/macfilter.htm" name="submit-url">
     </p>
  </td><tr>
  <script> updateState(); </script>
</form>
</table>

<br>
<form action=/boafrm/formFilter method=POST name="formFilterDel" id="formFilterDelId">
  <table border="0" width="100%">
  <tr><font size=2><b><script>dw(macfilter_current_table)</script></b></font></tr>
  <% macFilterList(); %>
  </table>
  <br>
  <input type="submit" value="Delete Selected" name="deleteSelFilterMac" onClick="return deleteClick()">
  <script>document.formFilterDel.deleteSelFilterMac.value = macfilter_delete;</script>&nbsp;&nbsp;
  <input type="submit" value="Delete All" name="deleteAllFilterMac" onClick="return deleteAllClick()">
  <script>document.formFilterDel.deleteAllFilterMac.value = macfilter_delete_all;</script>&nbsp;&nbsp;&nbsp;
  <input type="reset" value="Reset" name="reset">
  <script>document.formFilterDel.reset.value = macfilter_reset;</script>
  <input type="hidden" value="/macfilter.htm" name="submit-url">
 <script>
	if ( <% getIndex("macFilterNum"); %> == 0 )
		disableDelButton();
 </script>
</form>

</blockquote>
</body>
</html>
