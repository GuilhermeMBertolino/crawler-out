function change_answer1(obj){"1"==security_enhance_flag&&0!=answer1_empty&&0==focus_trigger_flag1&&(focus_trigger_flag1=1,"Firefox"==get_browser()?(obj.value="",obj.type="text"):(obj.outerHTML='<input type="text" autocomplete="off" maxLength="64" size="30" name="answer1" id="answer1"  onFocus="this.select();change_answer1();" >',document.forms[0].answer1.select()))}function change_answer2(obj){"1"==security_enhance_flag&&0!=answer2_empty&&0==focus_trigger_flag2&&(focus_trigger_flag2=1,"Firefox"==get_browser()?(obj.value="",obj.type="text"):(obj.outerHTML='<input type="text" autocomplete="off" maxLength="64" size="30" name="answer2" id="answer2"  onFocus="this.select();change_answer2();" >',document.forms[0].answer2.select()))}var valid_pwd=0;function validatepassword(){var disabled="image/checkbox-selected-gry.svg",enabled="image/checkbox-selected.svg",meet_complex=0,meet_len=0,cf=document.forms[0],passwd=cf.sysNewPasswd.value;valid_pwd=0,cf.apply.disabled=!0,re=new RegExp("[A-Z]"),len=re.test(passwd),len?(cf.weak_password_rule1_1.src=enabled,meet_complex++):cf.weak_password_rule1_1.src=disabled,re=new RegExp("[a-z]"),len=re.test(passwd),len?(cf.weak_password_rule1_2.src=enabled,meet_complex++):cf.weak_password_rule1_2.src=disabled,(0==use_black_logo&&passwd.length>=10||1==use_black_logo&&passwd.length>=8)&&passwd.length<=32?(cf.weak_password_rule2.src=enabled,meet_len=1):cf.weak_password_rule2.src=disabled,meet_complex>=2&&meet_len?(document.getElementById("passwd_hint").style.display="none",cf.pwd_warn.src="image/check.png",document.forms[0].apply.disabled="",valid_pwd=1):(document.getElementById("passwd_hint").style.display="",cf.pwd_warn.src="image/warning_flag.jpg")}function change_display(){"1"==security_enhance_flag&&(document.getElementById("apply").className="apply_bt",document.forms[0].pwd_warn.style.display="",document.getElementById("passwd_hint").style.display="none")}function checkpasswd(cf){if("1"!=support_sso_login){for(i=0;i<cf.sysNewPasswd.value.length;i++)if(0==isValidChar_space(cf.sysNewPasswd.value.charCodeAt(i)))return alert("$password_error"),!1;if("1"==security_enhance_flag&&(0==use_black_logo&&cf.sysNewPasswd.value.length<10||1==use_black_logo&&cf.sysNewPasswd.value.length<8))return alert("$password_length_error_weak"),!1;if(cf.sysNewPasswd.value.length>=33||cf.sysConfirmPasswd.value.length>=33)return alert("$max_password_length"),!1;if("1"==security_enhance_flag&&"password"==cf.sysNewPasswd.value)return alert("$must_change_passwd"),!1;if(cf.sysNewPasswd.value!=cf.sysConfirmPasswd.value)return alert("$newpas_notmatch"),!1;if("1"==security_enhance_flag&&""==cf.sysNewPasswd.value)return alert("$must_enter_passwd"),cf.apply.disabled=!0,document.getElementById("apply").className="apply_gray_bt",!1;if(""!=cf.sysOldPasswd.value&&""==cf.sysNewPasswd.value)return alert("$password_null"),!1;if(validatepassword(),1!=valid_pwd)return alert("$password_error"),!1}if(1==cf.enable_recovery.checked){if(cf.hidden_enable_recovery.value="1","0"==cf.question1.value||"0"==cf.question2.value)return alert("$select_quest"),!1;if(""==cf.answer1.value||""==cf.answer2.value)return alert("$enter_answer"),!1;if(cf.answer1.value.length>64||cf.answer2.value.length>64)return alert("$invalid_answer"),!1;for(i=0;i<cf.answer1.value.length;i++)if(0==isValidChar_space(cf.answer1.value.charCodeAt(i)))return alert("$invalid_answer"),!1;for(i=0;i<cf.answer2.value.length;i++)if(0==isValidChar_space(cf.answer2.value.charCodeAt(i)))return alert("$invalid_answer"),!1}else{if(""!=cf.sysOldPasswd.value&&0==confirm("$pwd_recovery_to_default \n$are_you_sure_not_enable_recovery"))return!1;cf.hidden_enable_recovery.value="0"}return"1"!=support_sso_login&&(cf.sysOldPasswd.value=$$.base64.encode(cf.sysOldPasswd.value),cf.sysNewPasswd.value=$$.base64.encode(cf.sysNewPasswd.value),cf.sysConfirmPasswd.value=cf.sysNewPasswd.value),"1"==security_enhance_flag&&(cf.hid_answer1_change.value=focus_trigger_flag1,cf.hid_answer2_change.value=focus_trigger_flag2),cf.hid_answer1.value=$$.base64.encode(cf.answer1.value),cf.hid_answer2.value=$$.base64.encode(cf.answer2.value),cf.answer1.value="******",cf.answer2.value="******",cf.submit(),!0}