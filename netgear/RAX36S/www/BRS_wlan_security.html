<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head>
<% new_hijack_flow_head() %>
<% hijack_language() %>
</head>

<style>
#pwd_display,#pwd_an_display{width:21px;margin-left:-28px;cursor:pointer;position:relative;top:6px}
</style>
<body onload="loadvalue()">
<script>
<% hijack_support_flag() %>
<% onboarding_ra_trigger("installState","6") %>
if(hijack_use_orbi_style_flag)
var get_smart_connect = "<% cfg_get("lbd_enable") %>";
else
var get_smart_connect = "<% cfg_get("enable_smart_connect") %>";
var hijack_process="<% cfg_get("hijack_process") %>";
var support_sso_login="<% support_sso_login() %>";
if(get_smart_connect.trim() === "")
	get_smart_connect = "1";
	var netgear_region="<% get_firmware_region() %>";
	var valid_region = "<% valid_firmware_region() %>";
	valid_region = parseInt(valid_region, 10);
	var an_router_flag = parent.an_router_flag;
	if(netgear_region == "NA")
		var wl_get_countryA = "10";
	else
		var wl_get_countryA = "<% cfg_get("wl_country") %>";
function loadvalue()
{
	var cf = document.forms[0];
	var wl_sectype="<% cfg_get("wl_sectype") %>";
	if(wl_sectype=="1")
	{
		if(support_sso_login == "1" && hijack_process!="3")
			location.href="check_sso_status.htm";
		else if ( support_sso_login == "1")
			location.href="BRS_security_sso.html";
		else
			location.href="BRS_orbi_complete.html";
	}
	else
		document.getElementById("container").style.display="";

	document.getElementById("samediv").style.display="";

	if(get_smart_connect == "1")
	{
		document.getElementById("check_same").checked = true;
		document.getElementById("5gssid").style.display="none";
		document.getElementById("5gpass").style.display="none";
	}
}

function isValidChar_space(each_char)
{
	if( each_char < 32 || each_char > 127)
		return false;
}
function isValidHex(each_char)
{
	var macVals = new Array("0", "1", "2", "3", "4", "5", "6", "7", "8", "9","A", "B", "C", "D", "E", "F", "a", "b", "c", "d", "e", "f");
	var len = macVals.length;
	var i = 0;
	var ret = false;
	for ( i = 0; i < len; i++ )
		if ( each_char == macVals[i] ) break;
	if ( i < len )
		ret = true;
	return ret;
}

function checkpsk(passphrase, passphrase_len)
{
	var len = passphrase.value.length;
	if ( len == 64 )
	{
		for(i=0;i<len;i++)
		{
			if(isValidHex(passphrase.value.charAt(i))==false)
			{
				alert(bh_notallowpassps);
				return false;
			}
		}
	}
	else
	{
		if(len < 8 )
		{
			alert(bh_passphrase_short8);
			return false;
		}
		if(len > 63)
		{
			alert(bh_passphrase_long63);
			return false;
		}
		for(i=0;i<passphrase.value.length;i++)
		{
			if(isValidChar_space(passphrase.value.charCodeAt(i))==false)
			{
				alert(bh_notallowpassps);
				return false;
			}
		}
	}
	passphrase_len.value=len;
	return true;
}

function check_ssid(ssid)
{
	var tmp_ssid=ssid;
	var ssid_len = tmp_ssid.length;
	for(i=0;i<tmp_ssid.length;i++)
	{
		if(tmp_ssid.charCodeAt(i)==32)
			ssid_len--;
	}
	if(tmp_ssid == "" || ssid_len == 0)
	{
		alert(bh_ssid_null);
		return false;
	}
	for(i=0;i<tmp_ssid.length;i++)
	{
		if(isValidChar_space(tmp_ssid.charCodeAt(i))==false)
		{
			alert(bh_ssid_not_allowed);
			return false;
		}
	}
	
	return true;
}

function checkwlan(cf)
{
			if(hijack_region_select_flag == 1 && netgear_region == "AP"){
			cf.wl_WRegion.value =cf.WRegion.value;
			}
	if(check_ssid(cf.wl_ssid.value) == false)
		return false;
	if( checkpsk(cf.wl_password, cf.wl_sec_wpaphrase_len)== false)
			return false;
	var d = new Date();
	cf.hid_apply_time.value = Math.floor(d.getTime()/1000);
	if(parent.smart_connect_flag == "1")
	{
		if(document.getElementById("check_same").checked == false) {
			if(check_ssid(cf.wla_ssid.value) == false)
				return false;
			if(checkpsk(cf.wla_password, cf.wla_sec_wpaphrase_len)== false)
				return false;
			if(top.security_enhance_flag !="1" && cf.wl_ssid.value == cf.wla_ssid.value)
			{
				alert(bh_ssid_not_allowed_same);
				return false;
			}
		}
		else {
			cf.hid_same_ssid.value = "1";
			cf.wla_ssid.value = cf.wl_ssid.value;
			cf.wla_password.value = cf.wl_password.value;
			cf.wla_sec_wpaphrase_len.value = cf.wl_sec_wpaphrase_len.value;
		}
	}
	return true;
}
function checksameid()
{
	if(document.getElementById("check_same").checked == false)
	{
		if(document.getElementById("wla_ssid").value==document.getElementById("wl_ssid").value)
		{
			if(document.getElementById("wla_ssid").value.length<30)
				document.getElementById("wla_ssid").value+="-5G";
		}
		document.getElementById("5gssid").style.display="";
		document.getElementById("5gpass").style.display="";
	}else
	{
		document.getElementById("5gssid").style.display="none";
		document.getElementById("5gpass").style.display="none";
	}
}
function change_password_display(flag)
{
	if(flag == 1){
		var e_value = document.getElementById("wl_password").value;
		var pwd_input = document.getElementById("wl_password");

		if(pwd_input.type == "password"){
			document.getElementById("2gpass").innerHTML='<input type="text" name="wl_password" autocomplete="off" placeholder="'+bh_ddns_passwd+'" id="wl_password" maxlength="64" value="'+e_value+'"/><label class="active" for="wl_password">2.4GHz '+bh_ddns_passwd+'</label><img id="pwd_display" src="image/pwd_display_eye.png" onclick="change_password_display(1)">';
		}
		else
			document.getElementById("2gpass").innerHTML='<input type="password" name="wl_password" autocomplete="off" placeholder="'+bh_ddns_passwd+'" id="wl_password" maxlength="64" value="'+e_value+'"/><label class="active" for="wl_password">2.4GHz '+bh_ddns_passwd+'</label><img id="pwd_display" src="image/pwd_close_eye.png" onclick="change_password_display(1)">';

	}

	if(flag == 2){
		var pwd_input_an = document.getElementById("wla_password");
		var e_value_an = document.getElementById("wla_password").value;

		if(pwd_input_an.type == "password"){
			document.getElementById("5gpass").innerHTML='<input type="text" autocomplete="off" name="wla_password" placeholder="'+bh_ddns_passwd+'" id="wla_password" maxlength="64" value="'+e_value_an+'"/><label class="active" for="wla_password">5GHz '+bh_ddns_passwd+'</label><img id="pwd_an_display" src="image/pwd_display_eye.png" onclick="change_password_display(2)">';
		}else
			document.getElementById("5gpass").innerHTML='<input type="password" autocomplete="off" name="wla_password" placeholder="'+bh_ddns_passwd+'" id="wla_password" maxlength="64" value="'+e_value_an+'"/><label class="active" for="wla_password">5GHz '+bh_ddns_passwd+'</label><img id="pwd_an_display" src="image/pwd_close_eye.png" onclick="change_password_display(2)">';

	}

	checksameid();
}
</script>
<% form_submit("apply", "BRS_wlan_plsWait.html", "hijack_wlan") %>
<input type="hidden" name="wl_sec_wpaphrase_len" />
<input type="hidden" name="wla_sec_wpaphrase_len" />
<input type="hidden" name="hid_apply_time" />
<input type="hidden" name="hid_same_ssid" value="0"/>
<input type="hidden" name="hid_save_time" value="6">
<input type="hidden" name="wl_WRegion">
<div id="container" style="display:none">
	<div class="dialog-content">
		<!-- Orbi Setup WiFi-->
		<div id="card-orbi-setup-wifi" class="install-card clearfix" style="height:auto;">
			<div class="logos">
				<img class="netgear-logo" src="images/svg/netgear.svg">
				<% hijack_logo_title() %>
			</div>
		     <div class="content">
			<div class="desc-title"><script>document.write(bh_orbi_wlan);</script></div>
			<div class="desc-text"><script>document.write(bh_orbi_wlan_msg);</script></div>
<script>
	if(hijack_region_select_flag == 1 && netgear_region == "AP")
		{
				if(valid_region != 1 && an_router_flag == 1)
				{
						document.write('<div class="row input-row" style="max-width: 80%;"><TR><TD nowrap colspan=2><A tabindex=-1 class="disabled" href="javascript:loadhelp(\'_wlan\',\'Region\')"><B>$wlg_region_select</B></A></TD></TR>');
						document.write('<TR> <TD nowrap width=35% class="label-td">$wlan_mark_reg:</TD><TD nowrap>');
						document.write('<select name="WRegion" id="wireless_region" size="1" style="width:240px"');
						document.write('</select></TD></TR></div>');
					}
				else if(an_router_flag == 1)
				{
						document.write('<div class="row input-row" style="max-width: 80%;"><TR><TD nowrap colspan=2><A tabindex=-1 class="disabled" href="javascript:loadhelp(\'_wlan\',\'Region\')"><B>$wlg_region_select</B></A></TD></TR>');
						document.write('<TR> <TD nowrap width=35% class="label-td">$wlan_mark_reg:</TD><TD nowrap>');
						if(netgear_region.toUpperCase() == "NA" || netgear_region.toUpperCase() == "CA" || netgear_region.toUpperCase() == "JP" || netgear_region.toUpperCase() == "US" || netgear_region.toUpperCase() == "PR" || netgear_region.toUpperCase() == "PA")
						{
								document.write('<select name="WRegion" id="wireless_region" size="1" disabled="disabled">');
								document.write('<option value=3>$coun_ca</option>');
								document.write('<option value=6>$coun_jp</option>');
								if(netgear_region.toUpperCase() == "PA" || ( hijack_region_select_flag == "1" && (netgear_region.toUpperCase() == "CA" || netgear_region.toUpperCase() == "NA")))
								{
										document.write('<option value=10>$coun_us</option>');
										document.write('<option value=21>$coun_ta</option>');
									}
								else
								document.write('<option value=10>$coun_na</option>');
								document.write('<option value=11>$coun_ch</option>');
							}
						else
						{
								document.write('<select name="WRegion" id="wireless_region" size="1">');
								document.write('<option value=2>$coun_au $and $coun_nz</option>');
								if(optimize_ww_ap_region != "1"){
								document.write('<option value=20>$coun_si</option>');
								document.write('<option value=22>$coun_hk</option>');
									}
							}
						document.write('</select></TD></TR></div>');
						if(netgear_region.toUpperCase() == "JP")
							document.getElementsByName("WRegion")[0].value = 6;
						else if(netgear_region.toUpperCase() == "CA" && hijack_region_select_flag != 1)
							document.getElementsByName("WRegion")[0].value = 3;
						else if(netgear_region.toUpperCase() == "PR")
							document.getElementsByName("WRegion")[0].value = 11;
						else if(netgear_region.toUpperCase() == "AP")
							document.getElementsByName("WRegion")[0].value = 2;
						else if(wl_get_countryA == "24")
							document.getElementsByName("WRegion")[0].value = 2;
						else
							document.getElementsByName("WRegion")[0].value = wl_get_countryA;
					}
			}
</script>

			<div class="input-field">			
				<script>document.write('<input type="text" placeholder="'+bh_orbi_ssid+'" name="wl_ssid" id="wl_ssid" maxlength="32" value="<% cfg_get_ssid_value("wl_ssid") %>"/><label for="wl_ssid">2.4GHz '+bh_orbi_ssid+'</label>');</script>
			</div>

			<div class="input-field" id="2gpass">
				<script>document.write('<input type="password" name="wl_password" placeholder="'+bh_ddns_passwd+'" id="wl_password" maxlength="64" value="<% get_wifi_pwd("2.4G") %>"/><label for="wl_password">2.4GHz '+bh_ddns_passwd+'</label><img id="pwd_display" src="image/pwd_close_eye.png" onclick="change_password_display(1)">');</script>
			</div>
			
			<div class="input-field" id="5gssid">							
				<script>document.write('<input type="text" placeholder="'+bh_orbi_ssid+'" name="wla_ssid" id="wla_ssid" maxlength="32" value="<% cfg_get_ssid_value("wla_ssid") %>"/><label for="wla_ssid">5GHz '+bh_orbi_ssid+'</label>');</script>
			</div>
			
			<div class="input-field" id="5gpass">			
				<script>document.write('<input type="password" placeholder="'+bh_ddns_passwd+'" name="wla_password" id="wla_password" maxlength="64" value="<% get_wifi_pwd("5G") %>"/><label for="wla_password">5GHz '+bh_ddns_passwd+'</label><img id="pwd_an_display" src="image/pwd_close_eye.png" onclick="change_password_display(2)">');</script>
			</div>
			
                     </div>
			<div style="margin-left:10%;margin-right:auto;max-width:85%;text-align:left;display:none;height:50px;margin-bottom: 60px;" id="samediv" >
			 <input type="checkbox" id="check_same" name="check_same" onclick="checksameid();">
			 <label for="check_same"><script>
			 if(hijack_use_orbi_style_flag == 1)
				 document.write(bh_enable_smart_conn_tip_new);
			 else
				 document.write(bh_use_same_ssid);
			 </script></label>
			</div>
		     <div class="buttons">
			<button name="setup_wifi_next" id="setup_wifi_next" class="waves-effect waves-light btn button-nav btn-icon icon-right" onclick="return checkwlan(document.forms[0]);">
				<span><script>document.write(bh_orbi_next_mark);</script></span>
			</button>
		     </div>
			<!--button class="waves-effect btn-flat button-nav-skip">
				<span>SKIP</span>
			</button-->
		</div>
	</div>
</div>
</form>
</body>

</html>
