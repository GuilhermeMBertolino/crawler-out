<!DOCTYPE HTML>
<!-- include lua to use webGetFunc functions -->
<%
      local commonCfg = require "webGetFunc.commonCfg"
%>
<html>
<head>
  <META charset="UTF-8">
  <META http-equiv="Pragma" content="no-cache">
  <META HTTP-equiv="Cache-Control" content="no-cache">
  <META HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">

  <title>NETGEAR Router <?= commonCfg.getModelNameStr()?></title>

  <link rel="stylesheet" href="css/table_noh.css">
  <link rel="stylesheet" href="css/scrollbar.css">
  <link rel="stylesheet" href="css/button.css">
  <link rel="stylesheet" href="css/form.css">
  <link rel="stylesheet" href="css/settings.css<? commonCfg.getVer(); ?>">
  <link rel="stylesheet" href="css/custom.css">

  <script src="js/jquery.min.js"></script>
  <script src="js/jquery.mousewheel.js"></script>
  <script src="js/jquery.jscrollpane.min.js"></script>
  <script src="js/jquery.inputmask.min.js"></script>
  <script src="js/ipInput.js"></script>
  <script src="js/utils.js<? commonCfg.getVer(); ?>"></script>
  <script src="js/validations.js<? commonCfg.getVer(); ?>"></script>
  <script src="js/embedProgressBar.js"></script>
  <script src="js/staticRoute.js"></script>

  <script language="javascript" type="text/javascript">
    CSRF_TOKEN = <?= commonCfg.genCsrfTokenFile('tokenNumber')?>;

    /* var for Edit button of route rule */
    var sel_vlan_index = "-1";
    var sel_vlan_name;
    var sel_vlan_id;
    var sel_vlan_priority;
    var sel_vlan_port1;
    var sel_vlan_port2;
    var sel_vlan_port3;
    var sel_vlan_port4;
    var sel_vlan_wifi2g;
    var sel_vlan_wifi5g;


    
    $(document).ready(function()
    {
        fetchData('target', 'vlan', 'pre_fillout_init', 'post_fillout_init');
    });
    
    function pre_fillout_init(json) 
    {
        var new_tr = '<tr class=\"vlanRule\" __displayStyle>\r\n\
        <td nowrap align=\"center\" rowspan=\"1\"> &nbsp;\r\n\
            <input type=\"radio\" name=\"vlanSelect\" id=\"vlan_select__index\" value=\"__index\" onClick=\"onClick_SelVlanRule(\'__index\',\'__name\',\'__vlandId\',\'__priority\',\'__enPort1\',\'__enPort2\',\'__enPort3\',\'__enPort4\',\'__enWifi2g\',\'__enWifi5g\');\">\r\n\
        </td>\r\n\
        <td nowrap align=\"center\" rowspan=\"1\">\r\n\
            <input type=\"checkbox\" id=\"srv__index\" __enableRule>\r\n\
        </td>\r\n\
        <td nowrap align=\"center\" rowspan=\"1\">\r\n\
            <span class=\"ttext\">__name</span>\r\n\
        </td>\r\n\
        <td nowrap align=\"center\" rowspan=\"1\">\r\n\
            <span class=\"ttext\">__vlandId</span>\r\n\
        </td>\r\n\
        <td nowrap align=\"center\" rowspan=\"1\">\r\n\
            <span class=\"ttext\">__priority</span>\r\n\
        </td>\r\n\
        <td nowrap align=\"center\" style=\"display:table; width:100%;\">\r\n\
            <div style=\"display:table-row;\">\r\n\
              <div style=\"display:table-cell;\">\r\n\
                <input type=\"checkbox\" class=\"table_tag_port\" disabled __enPort1>Port1\r\n\
              </div>\r\n\
              <div style=\"display:table-cell;\">\r\n\
                <input type=\"checkbox\" class=\"table_tag_port\" disabled __enPort3>Port3\r\n\
              </div>\r\n\
            </div>\r\n\
            <div style=\"display:table-row;\">\r\n\
              <div style=\"display:table-cell;\">\r\n\
                <input type=\"checkbox\" class=\"table_tag_port\" disabled __enPort2>Port2\r\n\
              </div>\r\n\
              <div style=\"display:table-cell;\">\r\n\
                <input type=\"checkbox\" class=\"table_tag_port\" disabled __enPort4>Port4\r\n\
              </div>\r\n\
            </div>\r\n\
        </td>\r\n\
        <td nowrap align=\"center\">\r\n\
            <input type=\"checkbox\" class=\"table_tag_port\" disabled __enWifi2g>WiFi-2.4G\r\n\
            <input type=\"checkbox\" class=\"table_tag_port\" disabled __enWifi5g>WiFi-5G\r\n\
        </td>\r\n\
        <td nowrap align=\"center\" rowspan=\"2\" style="display:none;" >__index</td>\r\n\
        <td nowrap align=\"center\" rowspan=\"2\" style="display:none;" >__displayVal</td>\r\n\
        </tr>\n';
        
        fetchTableData('vlan_rule_table', 'VlanRuleTable', new_tr, '', 'table_post_fillout_init');

    }

    function formSubmit() {
        var enableVlan = $('#target [name=enableVlan]').val();
        var groupType = $('#target [name=groupType]:checked').val();

        //sync port value to hidden input 
        var portMember = "";
        
        if(groupType == "port")
        {
        totalBridgePort = $(".bridge_port:checked").length;
        if(totalBridgePort < 1)
        {
            alert(window.top.mlang["genie_264"]);
            return;
        }
        
        $(".bridge_port:checked").each(function(i){
            portMember += $(this).attr("name");
            if(i !== totalBridgePort -1)
            {
                portMember += ",";
        }
        });
        }
        
        $('#target [name=portMember]').val(portMember);
        
        //sync enabled VLAN id list to hidden input

        
        if (enableVlan == "true" && groupType == "vid") {
        var Vids_enabled = get_Vids_enabledVlanRules();
        $('#target [name=enabledVid]').val(Vids_enabled);
        }
        
        if (validation()) {
            $.postForm('vlan', $('#target'), 'cgi-bin/netgear.plua', 'postForm_callback_vlan');
        }
    }

    function formSubmit_vlanRule() {
        var groupType = $('#target [name=groupType]:checked').val();
        var portMember = "";

        if(groupType == "vid")
        {
            totalTagPort = $(".tag_port:checked").length;
            isInternetPort = $(".tag_port:visible").length == 0 ? true: false;
            if(!isInternetPort && totalTagPort < 1)
            {
                alert(window.top.mlang["genie_264"]);
                return;
        }

            if(!isInternetPort && totalTagPort > 5)
            {
                alert(window.top.mlang["genie_265"]);
                return;
        }

            $(".tag_port:checked").each(function(i){
                portMember += $(this).attr("name");
                if(i !== totalTagPort -1)
                {
                    portMember += ",";
        }
            });
        }

        $('#target_VlanRule [name=portMember]').val(portMember);
        
        if (validation_vlanRule()) {
            $.postForm('vlanRule', $('#target_VlanRule'), 'cgi-bin/netgear.plua');
        }
    }
    
    function validation()
    {
        var enableVlan = $('#target [name=enableVlan]').val();
        var groupType = $('#target [name=groupType]:checked').val();
        var port1 = $('#target [name=port1]').val();
        var port2 = $('#target [name=port2]').val();
        var port3 = $('#target [name=port3]').val();
        var port4 = $('#target [name=port4]').val();
        var wifi2g = $('#target [name=wifi2g]').val();
        var wifi5g = $('#target [name=wifi5g]').val();
        
        if (enableVlan == "true" && groupType == "port") {
            if (port1 == "false" && port2 == "false" && port3 == "false" && port4 == "false" && 
                wifi2g == "false" && wifi5g == "false") 
            {
                //"Please select at least one port as WAN bridge"
                alert(window.top.mlang["genie_1070"]);
                return false;
            }
            
            if (port1 == "true" && port2 == "true" && port3 == "true" && port4 == "true" && 
                wifi2g == "true" && wifi5g == "true") 
            {
                //"At least one port MUST be unchecked."
                alert(window.top.mlang["genie_265"]);
                return false;
            }
        }
        else if(enableVlan == "true" && groupType == "vid")
        {
            if($("#vlan_rule_table tr:visible:not(:first)").eq(0).find(".table_tag_port:checked").length < 1)
            {
                alert(window.top.mlang["genie_1130"]);
                return false;
            }  
        }
        return true;
    }
    
    function validation_vlanRule()
    {
        var name = $('#target_VlanRule [name=name]').val();
        var vid = $('#target_VlanRule [name=vid]').val();
        var priority = $('#target_VlanRule [name=priority]').val();
        var action = $("#target_VlanRule [name='action']").val();
        
        if (name.match( /[^\x21-\x7E]/ ) || name == "") {
            //"Group name must consist of printable ASCII characters (ASCII 0x21 ~ 0x7E, space is not allowed) and is up to 10 characters."
            alert(window.top.mlang["genie_1014"]);
            return false;
        }
        
        if (isNumStr(vid) == false || parseInt(vid,10) > 4094 || parseInt(vid,10) < 1) {
            //"Incorrect VLAN ID value; correct values are from 1 to 4094."
            alert(window.top.mlang["genie_261"]);
            return false;
        }
        
        if (isNumStr(priority) == false || parseInt(priority,10) > 7 || parseInt(priority,10) < 0) {
            //"Incorrect 802.1p value"
            alert(window.top.mlang["genie_260"]);
            return false;
        }

        if ($('#target_VlanRule [name=portMember]').val() == "") {
            //"At least one port MUST be chosen."
            alert(window.top.mlang["genie_264"]);
            return false;
        }

        if (is_duplicateVlanRuleName(sel_vlan_index, action, name) == true) {
            //""Group Name xxx already exists."
            alert(window.top.mlang["genie_262"] + " " + name + " " + window.top.mlang["genie_263"]);
            return false;
        }
        
        return true;
    }
    
    function post_fillout_init()
    {   
        /* init function */
        init_enableVlan();

        // Init ID of ports
        configurePortsIds($('#target [name=groupType]:checked').val());
        
        /* register a onClick/onChange funtion */
        $('#target [name=enableVlan]').on('change', function() {
            $('#target [name=enableVlan]').val($('#target [name=enableVlan]').prop("checked"));
            onChange_enableVlan();
        });
        $('#target [name=groupType]').on('change', function() {
            onChange_groupType();
        });
        $('#target [name=port1]').on('change', function() {
            $('#target [name=port1]').val($('#target [name=port1]').prop("checked"));
        });
        $('#target [name=port2]').on('change', function() {
            $('#target [name=port2]').val($('#target [name=port2]').prop("checked"));
        });
        $('#target [name=port3]').on('change', function() {
            $('#target [name=port3]').val($('#target [name=port3]').prop("checked"));
        });
        $('#target [name=port4]').on('change', function() {
            $('#target [name=port4]').val($('#target [name=port4]').prop("checked"));
        });
        $('#target [name=wifi2g]').on('change', function() {
            $('#target [name=wifi2g]').val($('#target [name=wifi2g]').prop("checked"));
        });
        $('#target [name=wifi5g]').on('change', function() {
            $('#target [name=wifi5g]').val($('#target [name=wifi5g]').prop("checked"));
        });
        $('#target [name=add_vlan_rule]').on('click', function() {
            onClick_add_vlan_rule();
            //PEGA JYang, change the edit id to "main"
            $('div[name=main]').attr("id", "");
            $('div[name=mainEdit]').attr("id", "main");
        });
        $('#target [name=edit_vlan_rule]').on('click', function() {
            onClick_edit_vlan_rule();
            //PEGA JYang, change the edit id to "main"
            $('div[name=main]').attr("id", "");
            $('div[name=mainEdit]').attr("id", "main");
        });
        $('#target [name=del_vlan_rule]').on('click', function() {
            onClick_del_vlan_rule();
        });
        
        post_fillout_init_vlanRule();
    }
    
    function post_fillout_init_vlanRule()
    {
        /* sync checkbox value */
        $('#target_VlanRule [name=port1]').on('change', function() {
            $('#target_VlanRule [name=port1]').val($('#target_VlanRule [name=port1]').prop("checked"));
        });
        $('#target_VlanRule [name=port2]').on('change', function() {
            $('#target_VlanRule [name=port2]').val($('#target_VlanRule [name=port2]').prop("checked"));
        });
        $('#target_VlanRule [name=port3]').on('change', function() {
            $('#target_VlanRule [name=port3]').val($('#target_VlanRule [name=port3]').prop("checked"));
        });
        $('#target_VlanRule [name=port4]').on('change', function() {
            $('#target_VlanRule [name=port4]').val($('#target_VlanRule [name=port4]').prop("checked"));
        });
        $('#target_VlanRule [name=wifi2g]').on('change', function() {
            $('#target_VlanRule [name=wifi2g]').val($('#target_VlanRule [name=wifi2g]').prop("checked"));
        });
        $('#target_VlanRule [name=wifi5g]').on('change', function() {
            $('#target_VlanRule [name=wifi5g]').val($('#target_VlanRule [name=wifi5g]').prop("checked"));
        });
    }
    
    function table_post_fillout_init()
    {
        //The enable checkbox of the first vlan rule "Internet" should be always greyout
        $("#srv1").attr("disabled", true);

        $("#vlan_rule_table").find('tr').each(function(i) {
            if (i>0)
            {
                var cat = i%4;
                if (cat == 1 || cat == 2)
                {
                    $(this).find('td').each(function() {
                        $(this).css("background-color", "rgb(247,247,247)");
                    });
                }
                else
                {
                    $(this).find('td').each(function() {
                        $(this).css("background-color", "rgb(255,255,255)");
                    });
                }

                if (cat == 0 || cat == 2)
                {
                    $(this).find('td:first-child').addClass("blackBorderLeft");
                }
            }
        });
    }
    
    function reload_MainPage()
    {
        location.href='VLAN_IPTV.html';
    }
    
    function postForm_callback_vlan(json)
    {
        console.log(json);
        /* Show error page while port conflict check fail */
        if (json.message == "Port Conflict") {
            $('#target').hide();
            $('#target_VlanRule').hide();
            $('#portConflict_error_page').show();
            
            setTimeout('reload_MainPage()' ,5000);
        }
        else {
            /* system fter sending post, show progress bar */
	    show_EmbedProgressBar('SWP011', 26000, '/VLAN_IPTV.html');
        }
    }
    /* init function Section --------> Begin */
    function init_enableVlan()
    {
        onChange_enableVlan();
    }
    /* init function Section --------> End */
    
    /* Onclick Callback Section --------> Begin */
    function onChange_enableVlan()
    {
        var enableVlan = $('#target [name=enableVlan]').val();
        
        if (enableVlan == "true") {
            $('#vlan_iptv_div').show();
            // only when VLAN is enabled, the hide/show of the sub-enable-elements can be active. 
            onChange_groupType();
        }
        else if (enableVlan == "false") {
            $('#vlan_iptv_div').hide();
            // When VLAN is disabled, all element should be hide.
        }
    }

    function configurePortsIds(groupType)
    {
        var element = "";
        var Ports = [
            {
                'name': 'port1',
                'id': 'iptv_ports_0'
            },
            {
                'name': 'port2',
                'id': 'iptv_ports_1'
            },
            {
                'name': 'port3',
                'id': 'iptv_ports_2'
            },
            {
                'name': 'port4',
                'id': 'iptv_ports_3'
            },
            {
                'name': 'wifi2g',
                'id': 'iptv_ports_10'
            },
            {
                'name': 'wifi5g',
                'id': 'iptv_ports_11'
            }
        ];

        if (groupType == "port") {
            target = "target";
            hiddenTarget = "target_VlanRule";
        }
        else if (groupType == "vid") {
            target = "target_VlanRule";
            hiddenTarget = "target";
        }

        for (var i=0; i<Ports.length; i++)
        {
            element = "#" + target + " input[name='" + Ports[i].name + "']";
            $(element).attr("id", Ports[i].id);
            element = "#" + hiddenTarget + " input[name='" + Ports[i].name + "']";
            $(element).attr("id", "");
        }
    }

    function onChange_groupType()
    {
        var groupType = $('#target [name=groupType]:checked').val();

        configurePortsIds(groupType);

        if (groupType == "port") {
            $('#bridge_port_table').show();
            $('#vlan_rule_table').hide();
            $('#add').hide();
            $('#edit').hide();
            $('#delete').hide();
        }
        else if (groupType == "vid") {
            $('#bridge_port_table').hide();
            $('#vlan_rule_table').show();
            $('#add').show();
            $('#edit').show();
            $('#delete').show();
        }
    }
    
    function onClick_SelVlanRule(index, name, vlandId, priority, enPort1, enPort2, enPort3, enPort4, enWifi2g, enWifi5g)
    {
        sel_vlan_index = index;
        sel_vlan_name = name;
        sel_vlan_id = vlandId;
        sel_vlan_priority = priority;
        sel_vlan_port1 = (enPort1 == "checked");
        sel_vlan_port2 = (enPort2 == "checked");
        sel_vlan_port3 = (enPort3 == "checked");
        sel_vlan_port4 = (enPort4 == "checked");
        sel_vlan_wifi2g = (enWifi2g == "checked");
        sel_vlan_wifi5g = (enWifi5g == "checked");
    }
     
    function onClick_add_vlan_rule()
    {
        $("#target_VlanRule input[name='action']").val("add");
        
        /* fill auto test IDs of checkbox element */
        
        /* show form "target_VlanRule"*/
        $("#target").hide();
        $("#target_VlanRule").show();
        $("#add_page_header").show();
        $("#edit_page_header").hide();
    }
    

    
    function onClick_edit_vlan_rule()
    {
        /* no rule is selected */
        if (sel_vlan_index == "-1")
        {
            //"Please select an item to edit"
            alert(window.top.mlang["AAWE08"]);
            return;
        }
        
        /* Fillout selected rule data into form 'target_VlanRule' */
        $("#target_VlanRule input[name='action']").val("edit");
        $("#target_VlanRule input[name='iid']").val(sel_vlan_index);
        $("#target_VlanRule input[name='name']").val(sel_vlan_name);
        $("#target_VlanRule input[name='vid']").val(sel_vlan_id);
        $("#target_VlanRule input[name='priority']").val(sel_vlan_priority);
        $("#target_VlanRule input[name='port1']")[0].checked = sel_vlan_port1;
        $("#target_VlanRule input[name='port1']").val(sel_vlan_port1);
        $("#target_VlanRule input[name='port2']")[0].checked = sel_vlan_port2;
        $("#target_VlanRule input[name='port2']").val(sel_vlan_port2);
        $("#target_VlanRule input[name='port3']")[0].checked = sel_vlan_port3;
        $("#target_VlanRule input[name='port3']").val(sel_vlan_port3);
        $("#target_VlanRule input[name='port4']")[0].checked = sel_vlan_port4;
        $("#target_VlanRule input[name='port4']").val(sel_vlan_port4);
        $("#target_VlanRule input[name='wifi2g']")[0].checked = sel_vlan_wifi2g;
        $("#target_VlanRule input[name='wifi2g']").val(sel_vlan_wifi2g);
        $("#target_VlanRule input[name='wifi5g']")[0].checked = sel_vlan_wifi5g;
        $("#target_VlanRule input[name='wifi5g']").val(sel_vlan_wifi5g);
        
        /* show form "target_VlanRule"*/
        $("#target").hide();
        $("#target_VlanRule").show();
        $("#add_page_header").hide();
        $("#edit_page_header").show();
        
        if (sel_vlan_name == "Internet") {
            //Editing Internet rule show only the internet-fields in the form target_VlanRule
            $('.internet-fields').show();
            $('.non-internet-fields').hide();
            $("#target_VlanRule input[name='name']").attr('readonly', true);
        }
    }
    
    function onClick_del_vlan_rule()
    {
        /* no rule is selected */
        if (sel_vlan_index == "-1")
        {
            //"Please select an item to delete"
            alert(window.top.mlang["AAWE07"]);
            return;
        }
        
        //"Remove Group xxx"
        if (!confirm(window.top.mlang["genie_1069"] + " " + sel_vlan_name)) {
            return;
        }
        
        //"Internet rule should not be deleted"
        if (sel_vlan_name == "Internet") {
            alert(window.top.mlang["genie_1064"]);
            return;
        }
        
        $("#target_VlanRule input[name='action']").val("delete");
        $("#target_VlanRule input[name='iid']").val(sel_vlan_index);
        $("#target_VlanRule input[name='name']").val(sel_vlan_name);
        $("#target_VlanRule input[name='vid']").val(sel_vlan_id);
        $("#target_VlanRule input[name='priority']").val(sel_vlan_priority);
        $("#target_VlanRule input[name='port1']")[0].checked = sel_vlan_port1;
        $("#target_VlanRule input[name='port1']").val(sel_vlan_port1);
        $("#target_VlanRule input[name='port2']")[0].checked = sel_vlan_port2;
        $("#target_VlanRule input[name='port2']").val(sel_vlan_port2);
        $("#target_VlanRule input[name='port3']")[0].checked = sel_vlan_port3;
        $("#target_VlanRule input[name='port3']").val(sel_vlan_port3);
        $("#target_VlanRule input[name='port4']")[0].checked = sel_vlan_port4;
        $("#target_VlanRule input[name='port4']").val(sel_vlan_port4);
        $("#target_VlanRule input[name='wifi2g']")[0].checked = sel_vlan_wifi2g;
        $("#target_VlanRule input[name='wifi2g']").val(sel_vlan_wifi2g);
        $("#target_VlanRule input[name='wifi5g']")[0].checked = sel_vlan_wifi5g;
        $("#target_VlanRule input[name='wifi5g']").val(sel_vlan_wifi5g);
        
        /* Send post for deleting forward rule */
        $.postForm('vlanRule', $('#target_VlanRule'), 'cgi-bin/netgear.plua');
    }
    /* Onclick Callback Section --------> End */

    function isNumStr(str)
    {
        var i;
        if (str.length == 0) {
            return false;
        }
        
        for(i = 0; i < str.length; i++) {
            var c = str.substring(i, i+1);
            if("0" <= c && c <= "9") {
                continue;
            }
            return false;
        }
        
        return true;
    }
    
    function is_duplicateVlanRuleName(sel_vlan_index, action, vlanName)
    {
        var table = document.getElementById("vlan_rule_table");
        var rows = table.getElementsByClassName("vlanRule");
        var i;
        var tmpName;
        var duplicateIndex;
        var displayVal;
        var isDuplicate = false;
        
        for (i = 0; i < rows.length; i++)
        {
            //Not to check the rule with displayVal = 0
            displayVal = rows[i].getElementsByTagName("td")[8].innerHTML;
            if (displayVal == "0") {
                continue;    
            }
            
            tmpName = rows[i].getElementsByTagName("td")[2].getElementsByTagName("span")[0].innerHTML;
            if (tmpName == vlanName) {
                isDuplicate = true;
                duplicateIndex = rows[i].getElementsByTagName("td")[7].innerHTML;
                break;
            }
        }
        
        if (isDuplicate == true) {
            /* Editting a rule with not changging its name is not a duplicate case */
            if (action == "edit" && sel_vlan_index == duplicateIndex) {
                isDuplicate = false;
            }
        }
        
        return isDuplicate;
    }
    
    function get_Vids_enabledVlanRules()
    {
        var enabled_vids = [];
        var table = document.getElementById("vlan_rule_table");
        var rows = table.getElementsByClassName("vlanRule");
        var i;
        var tmpEnable;
        var tmpVid;
        
        for (i = 0; i < rows.length; i++)
        {
            //tmpEnable = rows[i].getElementsByTagName("td")[13].innerHTML;
            tmpEnable = rows[i].getElementsByTagName("td")[1].getElementsByTagName("input")[0].checked;
            tmpVid =    rows[i].getElementsByTagName("td")[3].getElementsByTagName("span")[0].innerHTML;
            
            /* add enabled VLAN id into array */
            if (tmpEnable == true) {
                enabled_vids.push(tmpVid);
            }
        }
        
        return enabled_vids;
    }
    
  </script>


</head>

<body onload="window.top.change_size($(this));loadhelp('VLAN_IPTV','');" class="page-body" onResize="window.top.change_size($(this));">
    <!-- main form -->
    <form id="target"  name="formname" method="POST" >
        <div class="page-header" style="position: relative;" mlang="genie_1075">VLAN / Bridge Settings</div>
        <div id="main" name="main" class="form-group" style=height:410px;overflow:auto;scrolling:auto">
        
        <div class="form-row">
            <label class="checkbox-container">
                <span mlang="genie_1076" >Enable VLAN / Bridge group</span>
                    <input type="checkbox" name="enableVlan" id="vlan_iptv_enable" value="true">
                <span class="checkbox-checkmark"></span>
            </label>
        </div>
        <!-- vlan_iptv_div start -->
        <div class="pl-30" id="vlan_iptv_div">
            <div class="form-row">
                <label class="checkbox-container" ><div mlang="genie_968">By bridge group</div>
                    <input type="radio" name="groupType" id="iptv_select" value="port">
                    <span class="radio-checkmark"></span>
                </label>
            </div>
            
            <div class="form-row" id="iptv_fields">
                <table class="tbWhite cmn-table-2" border="1" cellpadding="2" cellspacing="0" width="97%" id="bridge_port_table">
                    <tr>
                        <td nowrap align="center"><span class="thead" mlang="genie_1011">Wired Ports</span></td>
                        <td nowrap align="center"><span class="thead" mlang="genie_1061">Wireless"</span></td>
                    </tr>
                    
                    <tr>
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" class="bridge_port" name="port1" id="iptv_ports_0" value="true">Port1
                                <span class="checkbox-checkmark" style="top:3px"></span> 
                            </label>
                            <label class="checkbox-container">
                                <input type="checkbox" class="bridge_port" name="port2" id="iptv_ports_1" value="true">Port2
	                            <span class="checkbox-checkmark" style="top:3px"></span> 
                            </label>
                            <label class="checkbox-container">
                                <input type="checkbox" class="bridge_port" name="port3" id="iptv_ports_2" value="true">Port3
	                            <span class="checkbox-checkmark" style="top:3px"></span> 
                            </label>
                            <label class="checkbox-container">
                                <input type="checkbox" class="bridge_port" name="port4" id="iptv_ports_3" value="true">Port4
	                            <span class="checkbox-checkmark" style="top:3px"></span> 
                            </label>
                        </td>
                        
                        <td>
                            <label class="checkbox-container">
                                <input type="checkbox" class="bridge_port" name="wifi2g" id="iptv_ports_10" value="true">WiFi-2.4G
	                            <span class="checkbox-checkmark" style="top:3px"></span> 
                            </label>
                            <label class="checkbox-container">
                                <input type="checkbox" class="bridge_port" name="wifi5g" id="iptv_ports_11" value="true">WiFi-5G
                                <span class="checkbox-checkmark" style="top:3px"></span> 
                            </label>
                        </td>
                    </tr>
                    <input type="hidden" name="portMember">
                </table>
            </div>
            
            <div class="form-row">
                <label class="checkbox-container" ><div mlang="genie_969">By VLAN tag group</div>
                <input type="radio" name="groupType" id="vlan_select" value="vid">
                <span class="radio-checkmark"></span>
                </label>
            </div> 
            
            <div class="form-row" id="vlan_fields">
                <table class="tbWhite cmn-table-2" border="1" cellpadding="2" cellspacing="0" width="97%" id="vlan_rule_table">
                    <tr class="table_header">
                        <td width="6%" align="center"><span class="thead"></span></td>
                        <td width="6%" align="center"><span class="thead" mlang="SBS026">Enable</span></td>
                        <td align="center"><span class="thead" mlang="ALS015">Name</span></td>
                        <td align="center"><span class="thead" mlang="genie_271">VLAN ID</span></td>
                        <td align="center"><span class="thead" mlang="AQS040">Priority</span></td>
                        <td align="center"><span class="thead" mlang="genie_1011">Wired Ports</span></td>
                        <td align="center"><span class="thead" mlang="genie_1061">Wireless</span></td>
                    </tr>
                </table>
            </div>
        
            <div class="form-row">
                <td colspan="2" align="center">
                    <button type="button" value="add" id="add" name="add_vlan_rule" class="button-sty1" mlang="OTH012">Add</button>
                    <button type="button" value="edit" id="edit" name="edit_vlan_rule" class="button-sty1" mlang="UAS011">Edit</button>
                    <button type="button" value="delete" id="delete" name="del_vlan_rule" class="button-sty1"  mlang="UAS013">Delete</button>
                </td>
            </div>
        </div>
        <!-- vlan_iptv_div end -->
        </div> <!-- form-group end -->
        
        <div class="form-btn-row" id="form_btn_fwdrule">
            <button type="button" value="BUTTON"  onClick="location.href='VLAN_IPTV.html';" name="Cancel" id="cancel" class="button-cancel cancel_bt" mlang="UAS021">Cancel</button>
            <button type="button" value="apply"  onClick="formSubmit($(this))" name="apply" id="apply" class="button-apply apply_bt" mlang="LUP004" >Apply</button>
        </div>
        
        <input type="hidden" name="enabledVid">
    </form>
    <!-- main form end -->

    <!-- vlan rule form begin -->
    <form id="target_VlanRule"  name="formname_VlanRule" method="POST" style="display: none;">
        <div class="page-header" id="add_page_header" style="position: relative;" mlang="genie_1062">Add Vlan Rule</div>
        <div class="page-header" id="edit_page_header" style="position: relative; display: none;"  mlang="genie_1063">Edit Vlan Rule</div>
        <div id=mainEdit" name="mainEdit" class="form-group" style=height:365px;overflow:auto;scrolling:auto">
            <div class="form-row internet-fields">
                <span mlang="ALS015" >Name</span>
            </div>
            <div class="form-row internet-fields">
                <input class="input1" type="text" name="name" id="vlan_name" size="32" maxlength="10">
            </div>
            
            <div class="form-row internet-fields">
                <span mlang="genie_271" >VLAN ID</span>
            </div>
            <div class="form-row internet-fields">
                <input class="input1" type="text" name="vid" id="vlan_id" size="10" maxlength="4">    (1~4094)
            </div>
            
            <div class="form-row internet-fields">
                <span mlang="AQS040" >Priority</span>
            </div>
            <div class="form-row internet-fields">
                <input class="input1" type="text" name="priority" id="vlan_priority" size="10" maxlength="1" value="0">    (0~7)
            </div>
            
            <div class="form-row non-internet-fields">
                <label class="checkbox-container">
                    <span>Port1</span>
                    <input type="checkbox" class="tag_port" name="port1" id="iptv_ports_0">
                    <span class="checkbox-checkmark"></span>
                </label>
            </div>
            
            <div class="form-row non-internet-fields">
                <label class="checkbox-container">
                    <span>Port2</span>
                    <input type="checkbox" class="tag_port" name="port2" id="iptv_ports_1">
                    <span class="checkbox-checkmark"></span>
                </label>
            </div>
            
            <div class="form-row non-internet-fields">
                <label class="checkbox-container">
                    <span>Port3</span>
                    <input type="checkbox" class="tag_port" name="port3" id="iptv_ports_2">
                    <span class="checkbox-checkmark"></span>
                </label>
            </div>
            
            <div class="form-row non-internet-fields">
                <label class="checkbox-container">
                    <span>Port4</span>
                    <input type="checkbox" class="tag_port" name="port4" id="iptv_ports_3">
                    <span class="checkbox-checkmark"></span>
                </label>
            </div>
            
            <div class="form-row non-internet-fields">
                <label class="checkbox-container">
                    <span>WiFi-2.4G</span>
                    <input type="checkbox" class="tag_port" name="wifi2g" id="iptv_ports_10"">
                    <span class="checkbox-checkmark"></span>
                </label>
            </div>
            
            <div class="form-row non-internet-fields">
                <label class="checkbox-container">
                    <span>WiFi-5G</span>
                    <input type="checkbox" class="tag_port" name="wifi5g" id="iptv_ports_11">
                    <span class="checkbox-checkmark"></span>
                </label>
            </div>
            
            <input type="hidden" name="portMember">
        </div> <!-- form-group end -->
    
        <div class="form-btn-row" id="form_btn_fwdrule">
            <button type="button" value="BUTTON"  onClick="location.href='VLAN_IPTV.html';" name="Cancel" id="cancel" class="button-cancel cancel_bt" mlang="UAS021">Cancel</button>
            <button type="button" value="apply"  onClick="formSubmit_vlanRule($(this))" name="apply" id="apply" class="button-apply apply_bt" mlang="LUP004" >Apply</button>
        </div>
        
        <input type="hidden" name="action" value="">
        <input type="hidden" name="iid" value="">
    </form>
    <!-- vlan rule form end -->

  <? commonCfg.genHelpSection()?>
  <? commonCfg.generate_EmbedProgressBar()?>
  
    <div id="portConflict_error_page" style="display:none"> 
        <div class="page-header" style="position: relative;">
            <span mlang="AWC005">Failure</span>
        </div>
    
        <div class="form-group"  style=height:365px;overflow:auto;scrolling:auto">
            <form id="target_error"  name="formname" method="POST" >
                <div align="center" class="form-row">
                    <b mlang="genie_1012">A port can only belong to one enabled VLAN group.</b>
                </div>
            
                <div class="divider">&nbsp;</div>
           
                <div align="center" class="form-row">
                    <b mlang="CBS009">This screen will automatically return to the previous screen in a few seconds...</b>
                </div>
            </form>
        </div>
    </div><!-- password_error page end-->
    
</html>
