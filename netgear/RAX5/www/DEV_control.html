<!DOCTYPE HTML>
<% 
      local commonCfg = require "webGetFunc.commonCfg"
%>
<html>
<head>
  <META charset="UTF-8">
  <META http-equiv="Pragma" content="no-cache">
  <META HTTP-equiv="Cache-Control" content="no-cache">
  <META HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">
  
  <title>NETGEAR Router <?= commonCfg.getModelNameStr()?></title>



  <script src="js/jquery.min.js"></script>
  <script src="js/jquery.jscrollpane.min.js"></script>
  <script src="js/jquery.mousewheel.js"></script>
  <script src="js/ipInput.js"></script>
  <script src="js/utils.js<?= commonCfg.getVer() ?>"></script>
  <script src="js/validations.js<?= commonCfg.getVer() ?>"></script>
  <script src="js/jquery.inputmask.min.js"></script>

  <link rel="stylesheet" href="css/button.css">
  <link rel="stylesheet" href="css/settings.css<?= commonCfg.getVer() ?>">
  <link rel="stylesheet" href="css/scrollbar.css">
  <link rel="stylesheet" href="css/form.css">
  <link rel="stylesheet" href="css/custom.css" type="text/css">

  <script language="javascript" type="text/javascript">
    CSRF_TOKEN = <?= commonCfg.genCsrfTokenFile('tokenNumber')?>;

    var postFormId = "target";
    var functionName = "accessCtrl";
    $(document).ready(function()
    {
        fetchData('target', 'DEV_control', 'pre_fillout_init', 'post_fillout_init');
    });

    function post_fillout_white()
    {
        if($('tr[name=row_rules_white]').length > 0)
        {
            if($("input[name=enableAccessCtrl]").prop("checked"))
            {
                $("#delete_white").prop("disabled", false);
                $("#checkbox_index_white").prop("disabled", false);
            }
        }
        else
        {
            if(!$("input[name=enableAccessCtrl]").prop("checked"))
            {
                $("#delete_white").prop("disabled", true);
                $("#checkbox_index_white").prop("disabled", true);
            }
        }
    }

    function post_fillout_black()
    {
        if($('tr[name=row_rules_black]').length > 0)
        {
            if($("input[name=enableAccessCtrl]").prop("checked"))
            {
                $("#delete_black").prop("disabled", false);
                $("#checkbox_index_black").prop("disabled", false);
            }
        }
        else
        {
            if(!$("input[name=enableAccessCtrl]").prop("checked"))
            {
                $("#delete_black").prop("disabled", true);
                $("#checkbox_index_black").prop("disabled", true);
            }
        }
    }

    function pre_fillout_init()
    {
        refreshAccessControlTable();
    }
    
    function post_fillout_init()
    {
        if ($("input[name=circleActivationStatus]").val() == "provisioned")
        {
            $("div[name=main]").hide();
            $("div[name=cancelApplyButtons]").hide();
            $("div[name=circleMsg]").show();
            return;
        }

        var new_tr ='<tr name=\"row_rules_white\">\r\n\
          <td nowrap align=\"center\">\r\n\
            <label class=\"checkbox-container\">\r\n\
            <input __disabled name=\"checkbox_white\" id=\"checkbox_index_white__index\" type=\"checkbox\" value=\"\" onclick=\"handle_checkboxElements(\'checkbox_white\');\">\r\n\
            <input type=\"hidden\" name="iid" value=\"__iid\" disabled />\r\n\
            <span class=\"checkbox-checkmark\"></span>\r\n\
            </lable>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span name=\"rule_name_white\">__name</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span class=\"mac_column\" name=\"rule_mac_white\">__mac</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
          <span mlang="__conType"></span>\r\n\
          </td>\r\n\
          ';
        fetchTableData('white_control_table', 'access_control_white', new_tr, '', 'post_fillout_white');
        
        var new_tr ='<tr name=\"row_rules_black\">\r\n\
          <td nowrap align=\"center\">\r\n\
            <label class=\"checkbox-container\">\r\n\
            <input __disabled name=\"checkbox_black\" id=\"checkbox_index_black__index\" type=\"checkbox\" value=\"\" onclick=\"handle_checkboxElements(\'checkbox_black\');\">\r\n\
            <input type=\"hidden\" name="iid" value=\"__iid\" disabled />\r\n\
            <span class=\"checkbox-checkmark\"></span>\r\n\
            </lable>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span name=\"rule_name_black\">__name</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span class=\"mac_column\" name=\"rule_mac_black\">__mac</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
          <span mlang="__conType"></span>\r\n\
          </td>\r\n\
          ';
        fetchTableData('black_control_table', 'access_control_black', new_tr, '', 'post_fillout_black');

        $("input[name=enableAccessCtrl]").on("click", function() {
            this.value = this.checked ? "true" : "false";
            this.checked ? ungrayout_all_items() :grayout_all_items() ;
        });

        $("#allow").on("click", function() {
            if($("input[name='checkbox']:checked").length < 1)
            {
                    return false;
            }
            change_selected_rule("D-genie_417");
            postDevFromList("", "edit","allow");
        });
        $("#block").on("click", function() {
            var reject = false;

            if($("input[name='checkbox']:checked").length > 0)
            {
                if(!confirm(window.top.mlang["genie_189"]))
                    return false;
            }
            else
            {
                return false;  
            }
            
            $("input[name='checkbox']:checked").closest("tr").find("span[name='rule_mac']").each(function(){
                if($(this).html() == $("#client_mac").val().toUpperCase())
                {
                    alert(window.top.mlang["genie_190"]);
                    reject = true;
                    return false;
                }
            });

            if (reject == true)
            {
                return false;
            }

            change_selected_rule("D-genie_416");
            postDevFromList("", "edit","deny");

        });

        $("#edit_attached").on("click", function() {
            edit_selected("");
            $("#primaryDiv").hide();
            $("#editDiv").show();
            changeName();
            $("#action").val("edit");
        });
        
        $("#refresh").on("click", function() {
            removeAccessControlTable();
            refreshAccessControlTable();
        });

        $("#checkbox_index").on("click", function() {
            handle_checkboxes($(this).prop("checked"), "checkbox");
        });

        $("#delete_white").on("click", function() {
            if($("#white_control_table input[name='checkbox_white']:checked").length < 1)
            {
                return false;  
            }
            postDevFromList("_white", "delete", "deny");
        });

        $("#add_white").on("click", function() {
            add_rule("_white");
            $("#primaryDiv").hide();
            $("#editDiv").show();
            $("#mac_addr").prop("disabled",false);
            changeName();
        });

        $("#edit_white").on("click", function() {
            edit_selected("_white");
            $("#primaryDiv").hide();
            $("#editDiv").show();
            changeName();
            $("#action").val("edit");
        });

        $("#checkbox_index_white").on("click", function() {
            handle_checkboxes($(this).prop("checked"), "checkbox_white");
        });

        $("#delete_black").on("click", function() {
            if($("#black_control_table input[name='checkbox_black']:checked").length < 1)
            {
                return false;  
            }
            postDevFromList("_black", "delete", "deny");
        });

        $("#add_black").on("click", function() {
            add_rule("_black");
            $("#primaryDiv").hide();
            $("#editDiv").show();
            $("#mac_addr").prop("disabled",false);
            changeName();
        });

        $("#edit_black").on("click", function() {
            edit_selected("_black");
            $("#primaryDiv").hide();
            $("#editDiv").show();
            changeName();
            $("#action").val("edit");
        });

        $("#checkbox_index_black").on("click", function() {
            handle_checkboxes($(this).prop("checked"), "checkbox_black");
        });
        
        $("#cancel").on('click', function() {
            location.href='DEV_control.html';
        });

        $("#apply").on('click', function() {
            if(postFormId == "edit-form")
            {
                if( !validation())
                {
                    return false;
                }
                addOrEditDev();  
            }
            else
            {
                $.postForm(functionName, $('#'+postFormId),  'cgi-bin/netgear.plua');
            }
            
        });
        
        if($("input[name=enableAccessCtrl]").prop("checked"))
        {
            ungrayout_all_items();
        }

        //PEGA JYang, sync two select list for Netgear GUI automation id (dirty solution)
        $('select[name=allow_or_block_connect_device]')[0].selectedIndex = $('#allowOrBlockConnectDevice').prop('selectedIndex');
        $('select[name=allow_or_block_connect_device]').on('click', function() {
            $('#allowOrBlockConnectDevice')[0].selectedIndex = $('select[name=allow_or_block_connect_device]').prop('selectedIndex');
        });
        $('#allowOrBlockConnectDevice').change(function() {
            $('select[name=allow_or_block_connect_device]')[0].selectedIndex = $('#allowOrBlockConnectDevice').prop('selectedIndex');
        });

    }

    function addOrEditDev()
    {
        var a=[];
        var o={};
        o["action"] = $("#action").val();
        o["iid"] = $("#iid").val();
        o["rule"] = $("#allowOrBlockConnectDevice").val();
        o["macAddr"] = $("#mac_addr").val();
        o["devName"] = $("#dev_name").val();
        a.push(o);
 
        deviceListPost(a);
    }

    function postDevFromList(typeName, actionName, rule)
    {
        var a=[];
        $("input[name='checkbox" + typeName + "']:checked").closest("tr").each(function(){
          var o={};
          o["action"] = actionName;
          o["iid"] = $(this).find("input[name='iid']").val();
          o["rule"] = rule;
          o["macAddr"] = $(this).find("span[name='rule_mac" + typeName + "']").text();
          o["devName"] = $(this).find("span[name='rule_name" + typeName + "']").text();
          a.push(o);
        });
        deviceListPost(a);
    }

    function deviceListPost(listData)
    {   
        var wrapObj = {};
        wrapObj.function = "accessCtrlDev";
        wrapObj.data = listData;
        
        console.log(JSON.stringify(wrapObj));
        $.ajax({
            url: "/cgi-bin/netgear.plua?csrftoken=" + CSRF_TOKEN,
            type: "POST",
            data: JSON.stringify(wrapObj),
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            success: function(json) {
              console.log(json.status);
              document.location.reload();
            },
            error: function(json) {
              console.log(json.status);
            }
        });
    }

    function changeName()
    {
        postFormId = "edit-form";
        functionName = "accessCtrlDev";

        //PEGA JYang, change the edit id to "main"
        $('div[name=main]').attr("id", "");
        $('div[name=mainEdit]').attr("id", "main");
    }

    function validation()
    {
        var msg = "";
        if ($("input[name='dev_name']").val().match( /[^\x20-\x7E]/ ))
            msg+= window.top.mlang["AAWE04"] + "\n";
        
        if ($("#mac_addr").val().toUpperCase() == $("#client_mac").val().toUpperCase() && $("#allowOrBlockConnectDevice").val().match("deny"))
        {
            msg+= window.top.mlang["genie_190"] + "\n";
            $("#allowOrBlockConnectDevice").val("allow");
        }

        if(postFormId == "edit-form" && $("#action").val() == "add")
        {
            //Steven add for TT#1086, when device is blank, popup "Invalid Mac Address"
            var new_MAC = $("#mac_addr").val().toUpperCase();
            if ($("input[name='dev_name']").val() == "")
            {
                msg+= window.top.mlang["AAWE06"] + "\n";
                alert(msg);
                return false;
            }

            var obj_mac = $("input[name='macAddr']");
            if(!$("input[name='macAddr']").inputmask("isComplete") || checkMacStr(obj_mac.get(0)))
            {
                msg+= window.top.mlang["AAWE06"] + "\n";
                alert(msg);
                return false;
            }

            $(".mac_column").each(function(){
              if($(this).text().indexOf(new_MAC) != -1)
              {
                  msg+= window.top.mlang["AAWE11"] + "\n";
                  return false;
              }
            });
        }

        if (msg.length > 1)
        {
            alert(msg);
            return false;
        }
        
        return true;	
    }

    function change_selected_rule(rule)
    {
        $("input[name='checkbox']:checked").closest("tr").find("span[name='rule_status']").each(function(){
            $(this).html(window.top.mlang[rule]);
            if(rule == "D-genie_417")
              $(this).css("color","green");
            else if(rule == "D-genie_416")
              $(this).css("color","red");
        });

    }

    function getEditIdByCheckboxName(checkboxName)
    {
        if(checkboxName == "checkbox")
            return "edit_attached";
        else if(checkboxName == "checkbox_white")
            return "edit_white";
        else if(checkboxName == "checkbox_black")
            return "edit_black";
    }

    function handle_checkboxes(isChecked,eName)
    {
        var selected_count = 0;
        if(isChecked) 
        {
            $("input[name='" + eName + "']").each(function(){
                $(this).prop("checked", true);
                selected_count++;
            });
        } 
        else 
        {
            $("input[name='" + eName + "']").prop("checked", false);
        }  
        
        editId = getEditIdByCheckboxName(eName);
        
        if(selected_count == 1)
        {
            $("#" + editId).prop("disabled", false);
        }
        else
        {
            $("#" + editId).prop("disabled", true);
        }
    }

    function handle_checkboxElements(checkboxName)
    {
        editId = getEditIdByCheckboxName(checkboxName);
        if($("input[name='" + checkboxName + "']:checked").length == 1)
        {
          $("#" + editId).prop("disabled", false);
        }
        else
        {
          $("#" + editId).prop("disabled", true); 
        }
    }

    function handle_white_list_table()
    {
        $(".white_list_body").toggle();
        $("#allow_pic").attr("src", "images/arrow_" + ($(".white_list_body").css("display") == "none" ? "" : "down_" )+ "nobackground.gif");
    }

    function handle_black_list_table()
    {
        $(".black_list_body").toggle();
        $("#block_pic").attr("src", "images/arrow_" + ($(".black_list_body").css("display") == "none" ? "" : "down_" )+ "nobackground.gif");
    }
    
    function ungrayout_all_items()
    {
        $(".access_rule_all").css("pointer-events", "");
        $(".access_rule_all").css("opacity", "");
        $("#allow_all").attr("readonly", false);
        $("#block_all").attr("readonly", false);
        $("#allow").prop("disabled", false);
        $("#block").prop("disabled", false);
        $("#edit_attached").prop("disabled", true);
        $("#refresh").prop("disabled", false);

        $("#checkbox_index").prop("disabled", false);
        
        $("#add_white").prop("disabled", false);
        $("#edit_white").prop("disabled", true);
        if($('tr[name=row_rules_white]').length > 0)
        {
            $("#delete_white").prop("disabled", false);
            $("#checkbox_index_white").prop("disabled", false);
        }
        else
        {
            $("#delete_white").prop("disabled", true);
            $("#checkbox_index_white").prop("disabled", true);
        }

        $("#add_black").prop("disabled", false);
        $("#edit_black").prop("disabled", true);
        if($('tr[name=row_rules_black]').length > 0)
        {
            $("#delete_black").prop("disabled", false);
            $("#checkbox_index_black").prop("disabled", false);
        }
        else
        {
            $("#delete_black").prop("disabled", true);
            $("#checkbox_index_black").prop("disabled", true);
        }
        
        $("input[name='checkbox']").prop("disabled", false);

        $("input[name='checkbox_white']").prop("disabled", false);

        $("input[name='checkbox_black']").prop("disabled", false);

    }
    
    function grayout_all_items()
    {
        $(".access_rule_all").css("pointer-events", "none");
        $(".access_rule_all").css("opacity", "0.5");
        $("#allow").prop("disabled", true);
        $("#block").prop("disabled", true);
        $("#edit_attached").prop("disabled", true);
        $("#refresh").prop("disabled", true);
        
        $("#checkbox_index").prop("disabled", true);
        
        $("#add_white").prop("disabled", true);
        $("#edit_white").prop("disabled", true);

        $("#delete_white").prop("disabled", true);
        $("#checkbox_index_white").prop("disabled", true);

        $("#add_black").prop("disabled", true);
        $("#edit_black").prop("disabled", true);

        $("#delete_black").prop("disabled", true);
        $("#checkbox_index_black").prop("disabled", true);

        $("input[name='checkbox']").prop("disabled", true);

        $("input[name='checkbox_white']").prop("disabled", true);
        
        $("input[name='checkbox_black']").prop("disabled", true);

        
        $("#checkbox_index").prop("checked", false);
        $('input[name=checkbox]').prop("checked", false);
        
        $("#checkbox_index_white").prop("checked", false);
        $('input[name=checkbox_white]').prop("checked", false);
        
        $("#checkbox_index_black").prop("checked", false);
        $('input[name=checkbox_black]').prop("checked", false);
    }

    function add_rule(type)
    {
            if(type == "_white")
            {
              $("#allowOrBlockConnectDevice").val("allow");
              $("#editDiv .page-header").html(window.top.mlang["D-genie_558"]);
            }
            else if(type == "_black")
            {
              $("#allowOrBlockConnectDevice").val("deny");
              $("#editDiv .page-header").html(window.top.mlang["D-genie_559"]);
            }
            $("#ruleTypeDiv").hide();
    }

    function edit_selected(type)
    {
        $("input[name='checkbox"+type+"']:checked").closest("tr").each(function(){
            $("#mac_addr").val($(this).find("span[name='rule_mac" +type+ "']").html());
            $("#dev_name").val( decodeHtml($(this).find("span[name='rule_name" +type+ "']").html()) );
            $("#iid").val($(this).find("input[name='iid']").val());
            if(type == "")
            {
              var rule_status = ($(this).find("span[name='rule_status']").css('color')=='rgb(0, 128, 0)')? "allow" : "deny";
              $("#allowOrBlockConnectDevice").val(rule_status);
              $('select[name=allow_or_block_connect_device]')[0].selectedIndex = $('#allowOrBlockConnectDevice')[0].selectedIndex;
              $('select[name=allow_or_block_connect_device]').attr("id", "allow_or_block_connect_device");
            }
            else if(type == "_white")
            {
              $("#allowOrBlockConnectDevice").val("allow");
              $('select[name=allow_or_block_connect_device]')[0].selectedIndex = $('#allowOrBlockConnectDevice')[0].selectedIndex;
              $('select[name=allow_or_block_connect_device]').attr("id", "allow_or_block_device");
            }
            else if(type == "_black")
            {
              $("#allowOrBlockConnectDevice").val("deny");
              $('select[name=allow_or_block_connect_device]')[0].selectedIndex = $('#allowOrBlockConnectDevice')[0].selectedIndex;
              $('select[name=allow_or_block_connect_device]').attr("id", "allow_or_block_device");
            }  
        });
    }

    function removeAccessControlTable()
    {
        $("[name='row_rules']").remove();
    }

    function refreshAccessControlTable()
    {
        var new_tr ='<tr name=\"row_rules\">\r\n\
          <td nowrap align=\"center\">\r\n\
            <label class=\"checkbox-container\">\r\n\
            <input __disabled name=\"checkbox\" id=\"checkbox_index__index\" type=\"checkbox\" value=\"\" onclick=\"handle_checkboxElements(\'checkbox\');\">\r\n\
            <input type=\"hidden\" name="iid" value=\"__iid\" disabled />\r\n\
            <span class=\"checkbox-checkmark\"></span>\r\n\
            </label>\r\n\
            </td>\r\n\
          <td nowrap align=\"center\"  name=\"show_status\">\r\n\
            <span name=\"rule_status\" style="color:__color" mlang="__status"></span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span name=\"rule_name\">__name</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span name=\"rule_ip\">__ip</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span class=\"mac_column\" name=\"rule_mac\" >__mac</span>\r\n\
          </td>\r\n\
          <td nowrap align=\"center\">\r\n\
            <span mlang="__conType"></span>\r\n\
            <span>__ssid</span>\r\n\
          </td>\r\n\
          </tr>';
        fetchTableData('control_table', 'control_table', new_tr, '', '');
    }
  </script>  
</head>

<body onload="window.top.change_size($(this));loadhelp('DEV_control','');" class="page-body" onResize="window.top.change_size($(this));">
  
    <form id="target"  name="formname" method="POST" >
      <div id="primaryDiv">
        <div class="page-header" style="position: relative;" mlang="D-genie_418">Access Control</div>
        <div id="main" name="main" class="form-group" style=height:365px;overflow:auto;scrolling:auto">
          <div class="form-row">
              <b mlang="D-genie_409">You can use Access Control to allow or block computers or electronic devices from accessing your network. </b>
          </div>
          <div class="form-row">
            <label class="checkbox-container">
            <input type="checkbox" id="enable_acl" name="enableAccessCtrl" value="true">
            <a href="javascript:loadhelp('DEV_control','enable_acc_control')" tabindex="-1" mlang="D-genie_410">Turn on Access Control</a> 
            <span class="checkbox-checkmark"></span> 
            </label>
          </div>
          <div class="form-row">
            <span mlang="D-genie_411">This is a general rule. You can also allow or block individual devices.</span>
          </div>
          <div class="form-row access_rule_all" style="pointer-events:none; opacity:0.5">
            <label class="checkbox-container">
            <span mlang="D-genie_412">Allow all new devices to connect</span>
            <input type="radio" id="allow_all" name="accessRule" value="allow" readonly="readonly">
            <span class="radio-checkmark"></span> 
            </label>
          </div>
          <div class="form-row access_rule_all" style="pointer-events:none; opacity:0.5">
            <label class="checkbox-container">
            <span mlang="D-genie_413">Block all new devices from connecting</span>
            <input type="radio" id="block_all" name="accessRule" value="deny" readonly="readonly">
            <span class="radio-checkmark"></span> 
            </label>
          </div>

          <div class="space-divider">&nbsp;</div>

          <div class="form-row">
            <button type="button" value="allow" name="allow" id="allow" disabled class=button-sty1 mlang="D-genie_414">Allow</button>
            <button type="button" value="block" name="block" id="block" disabled class="button-sty1" mlang="D-genie_415">Block</button>
            <button type="button" value="edit" id="edit_attached" name="edit_attached" disabled class="button-sty1" disabled mlang="UAS011">Edit</button>
            <button type="button" value="refresh" id="refresh" name="refresh" disabled class="button-sty1" onclick="" mlang="UBS012">Refresh</button>
          </div>
          
          <div class="form-row">
            <table id="control_table" border="1" cellpadding="2" cellspacing="0" width="100%" class="tbWhite table1 cmn-table-2" style="width:97%;">
              <tr class="table_header">
                <td nowrap align="center" width="5%" class="sorttable_nosort">
                  <label class="checkbox-container"> 
                  <input type="checkbox" name="checkbox_index" id="checkbox_index" disabled>
                  <span class="checkbox-checkmark"></span> 
                  </label>
                </td>
                <td nowrap align="left" width="10%"><span class="subheadtext" mlang="UAS004">Status</span></td>
                <td nowrap align="left" width="35%"><span class="subheadtext" mlang="MAD001">Device Name</span></td>
                <td nowrap align="left" width="20%"><span class="subheadtext" mlang="SWP030">IP Address</span></td>
                <td nowrap align="left" width="20%"><span class="subheadtext" mlang="MRS015">MAC Address</span></td>
                <td nowrap align="left" width="10%"><span class="subheadtext" mlang="MRS076">Connection Type</span></td>
              </tr>
            </table>
          </div>
          
          <div class="form-row">
          <span onClick="handle_white_list_table();"  style="cursor:pointer">
            <img id="allow_pic" src="images/arrow_nobackground.gif">
            <span style="cursor:pointer" mlang="genie_191">View list of allowed devices not currently connected to the network</span>
          </span>
          </div>
          
          <div class="form-row white_list_body pb-0" style="display:none">
            <button type="button" value="Delete" id="delete_white" name="delete_white" disabled class="button-sty1" mlang="D-genie_470">Remove from the list</button>
            <button type="button" value="add" id="add_white" name="add_white" disabled class="button-sty1" onclick="" mlang="OTH012">Add</button>
            <button type="button" value="edit" id="edit_white" name="edit_white" disabled class="button-sty1" disabled mlang="UAS011">Edit</button>
          </div>
          <div class="form-row white_list_body pt-0" style="display:none">
            <table class="sortable tbWhite cmn-table-2 mt-15" id="white_control_table" border="1" cellpadding="2" cellspacing="0" width="70%">
              <tr class="table_header">
                <td nowrap align="center" width="5%" class="sorttable_nosort">
                <label class="checkbox-container"> 
                <input type="checkbox" name="checkbox_index_white" id="checkbox_index_white" disabled>
                <span class="checkbox-checkmark"></span> 
                </label>
                </td>
                <td nowrap align="left" width="50%"><span class="subheadtext" mlang="MAD001">Device Name</span></td>
                <td nowrap align="left" width="30%"><span class="subheadtext" mlang="MRS015">MAC Address</span></td>
                <td nowrap align="left" width="15%"><span class="subheadtext" mlang="MRS076">Connection Type</span></td>
              </tr>
            </table>  
          </div>

          <div class="form-row">
          <span onClick="handle_black_list_table();" style="cursor:pointer">
            <img id="block_pic" src="images/arrow_nobackground.gif">
            <span style="cursor:pointer" mlang="genie_192">View list of blocked devices not currently connected to the network</span>
          </span>
          </div>

          <div class="form-row black_list_body pb-0" style="display:none">
            <button type="button" value="Delete" id="delete_black" name="delete_black" disabled class="button-sty1" mlang="D-genie_470">Remove from the list</button>
            <button type="button" value="add" id="add_black" name="add_black" disabled class="button-sty1" onclick="" mlang="OTH012">Add</button>
            <button type="button" value="edit" id="edit_black" name="edit_black" disabled class="button-sty1" disabled mlang="UAS011">Edit</button>
          </div>
          <div class="form-row black_list_body pt-0" style="display:none">
            <table class="sortable tbWhite cmn-table-2 mt-15" id="black_control_table" border="1" cellpadding="2" cellspacing="0" width="70%">
              <tr class="table_header">
                <td nowrap align="center" width="5%" class="sorttable_nosort">
                <label class="checkbox-container"> 
                <input type="checkbox" name="checkbox_index_black" id="checkbox_index_black" disabled>
                <span class="checkbox-checkmark"></span> 
                </label>
                </td>
                <td nowrap align="left" width="50%"><span class="subheadtext" mlang="MAD001">Device Name</span></td>
                <td nowrap align="left" width="30%"><span class="subheadtext" mlang="MRS015">MAC Address</span></td>
                <td nowrap align="left" width="15%"><span class="subheadtext" mlang="MRS076">Connection Type</span></td>
              </tr>
            </table>  
          </div>
        </div><!--form-group-->
        <div id="circleMsg" name="circleMsg" class="form-group" style="display:none;">
          <div class="form-row">
            <b mlang="PCVP_115">To use Access Control, please use the Nighthwak App.</b>
          </div>
        </div>
      </div><!--primaryDiv-->
      
      <input name="client_mac" id="client_mac" type="hidden" value="" disabled>
      <input name="circleActivationStatus" id="circleActivationStatus" type="hidden" value="" disabled>
   </form>
   <form id="edit-form">
      <div id="editDiv" style="display:none;">
        <div class="page-header" style="position: relative;" mlang="D-genie_560">Edit Device Name</div>
        <div id="mainEdit" name="mainEdit" class="form-group" style=height:365px;overflow:auto;scrolling:auto">
          <div id="ruleTypeDiv">
          <div class="form-row">
            <b mlang="D-genie_418">Access Control</b>
            <input name="iid" id="iid" type="hidden" value="">
            <input name="action" id="action" type="hidden" value="add">
          </div>

          <!--PEGA JYang, sync two select list for Netgear GUI automation id (dirty solution)-->
          <div class="form-row" style="display:none">
            <select name="rule" id="allowOrBlockConnectDevice">
              <option value="allow" mlang="D-genie_414">Allow</option>
              <option value="deny" mlang="D-genie_415">Block</option>
           </select> 
          </div>
          <div class="form-row">
            <select name="allow_or_block_connect_device" id="allow_or_block_connect_device">
              <option value="allow" mlang="D-genie_414">Allow</option>
              <option value="block" mlang="D-genie_415">Block</option>
           </select> 
          </div>
          </div>

          <div class="form-row">
            <b mlang="MRS015">MAC Address</b>
          </div>
          <div class="form-row">
            <input class="input1" type="text" size="17" maxlength="17" name="macAddr" id="mac_addr" disabled="disable" value="" />
          </div>
          
          <div class="form-row">
            <b mlang="MAD001">Device Name</b>
          </div>
          <div class="form-row">
            <input class="input1" type="text" size="32" maxlength="32" name="dev_name" id="dev_name" value="">
          </div>
        </div><!--form-group-->
      </div><!--editDiv--> 
   </form>
   <div name="cancelApplyButtons" class="form-btn-row">
         <button value="Cancel" type="BUTTON" name="Cancel" id="cancel" class="button-cancel cancel_bt"  mlang="UAS021" >Cancel</button>
         <button value="Apply" type="BUTTON" name="Apply" id="apply" class="button-apply apply_bt"  mlang="LUP004" > Apply</button>
   </div>
   <? commonCfg.genHelpSection() ?>
</html>
