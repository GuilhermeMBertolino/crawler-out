<!DOCTYPE HTML>
<!-- include PHP to use php functions -->
<? include 'php/commonCfg.php';?>

<html>
<head>
  <META charset="UTF-8">
  <META http-equiv="Pragma" content="no-cache">
  <META HTTP-equiv="Cache-Control" content="no-cache">
  <META HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">

  <title>NETGEAR Router <?= getModelNameStr()?></title>

  <link rel="stylesheet" href="css/table_noh.css">
  <link rel="stylesheet" href="css/scrollbar.css">
  <link rel="stylesheet" href="css/button.css">
  <link rel="stylesheet" href="css/form.css">
  <link rel="stylesheet" href="css/settings.css<? getVer(); ?>">
  <link rel="stylesheet" href="css/custom.css">

  <script src="js/jquery.min.js"></script>
  <script src="js/jquery.mousewheel.js"></script>
  <script src="js/jquery.jscrollpane.min.js"></script>
  <script src="js/jquery.inputmask.min.js"></script>
  <script src="js/ipInput.js"></script>
  <script src="js/utils.js<? getVer(); ?>"></script>
  <script src="js/validations.js<? getVer(); ?>"></script>

  <script language="javascript" type="text/javascript">
    CSRF_TOKEN_SUB = <?= genCsrfTokenSubFilePhp('tokenNumber')?>;

    var g_intervalId = -1;
    
    $(document).ready(function()
    {
        fetchData('target', 'internetEthStatus', '', 'post_fillout_init');
    });

    
    function post_fillout_init()
    {   
        $("[mlang]").each(function(idx, obj) {
              obj.innerHTML = window.opener.top.mlang[obj.attributes.mlang.value];
        });

        //when internet connection is detected, display NETGEAR website, otherwise refresh the page
        if ($('[name=internetStatus]').val() == "up") { 
            if (g_intervalId != -1) {
                clearInterval(g_intervalId);
            }
            //goto NETGEAR website
            //Steven modify for IR-093, modify delay time from 2000ms to 5000ms
            g_intervalId = setInterval("location.href='http://www.netgear.com/success/generic.aspx';", 5000);
        }
        else if ($('[name=internetStatus]').val() == "down") { 
            if (g_intervalId != -1) {
                clearInterval(g_intervalId);
            }
            //refresh page
            g_intervalId = setInterval("fetchData('target', 'internetEthStatus', '', 'post_fillout_init')", 2500);
        }
        
    }
    
  </script>


</head>

<body bgcolor="#ffffff">
    <form id="target"  name="formname">
        <table border="0" id="internet_status_table">
            <tr>
                <td colspan="2" align="center">
                    <b mlang="SBS035">Testing Internet Connection</b>
                </td>
            </tr>
            <tr>
                <td colspan="2" height="12">
                    <div class="divider">&nbsp;</div>
                </td>
            </tr>
            <tr>
                <td colspan="2" align="left">
                    <span mlang="SBS033">This page will automatically display the NETGEAR website if a successful Internet connection is detected.</span>
                </td>
            </tr>
            <tr>
                <td colspan="2" height="12">
                    <div class="divider">&nbsp;</div>
                </td>
            </tr>       
             <tr>
                <td colspan="2" align="center"><BR>
                    <button type="button" value="Close" id="close" class="button-sty1" onClick="top.window.close();" mlang="OTH002">Close</button>
                </td>
            </tr>
        </table>
 
        <!--The disabled inputs values is gotten from fetchData(), and the input name will not be included into post parameters -->
        <input type="hidden" name="internetStatus" disabled>
    </form>
</html>
