<!DOCTYPE HTML>
<? include 'php/commonCfg.php';?>
<html>
<head>
  <META charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no">
  <META http-equiv="Pragma" content="no-cache">
  <META HTTP-equiv="Cache-Control" content="no-cache">
  <META HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">
  
  <title>NETGEAR Router <?= getModelNameStr()?></title>

  <link rel="stylesheet" href="css/scrollbar.css">
  <link rel="stylesheet" href="css/custom.css"  type="text/css">

  <script src="js/jquery.min.js"></script>
  <script src="js/jquery.jscrollpane.min.js"></script>
  <script src="js/jquery.mousewheel.js"></script>
  <script src="js/utils.js<? getVer(); ?>"></script>
  <script src="js/mlang.js<? getVer(); ?>"></script>

  <script language="javascript" type="text/javascript">
  CSRF_TOKEN = <?= genCsrfTokenFilePhp('tokenNumber')?>;
  
  function postRAopt(optSetting)
  {
      var postData = {};
      postData.function = "wizRAOpt";
      var o = {};

      if ("allow" == optSetting)
      {
        o = {"raEnable": true};
      }
      else
      {
        o = {"raEnable": false};
      }

      postData.data = o;
      raOptPost(JSON.stringify(postData));
  }

  function raOptPost(postData)
  {
      $.ajax({
        url: "/cgi-bin/rex_cgi?csrftoken=" + CSRF_TOKEN,
        type: "POST",
        data: postData,
        dataType: 'json',
        contentType: "application/json; charset=utf-8",
        success : function(data) {
            if(data.status == "error")
            {   
                window.top.backUrl = "index.html";
            }
        },
        error : function(xhr, ajaxOptions, thrownError) {
            console.log(xhr.status);
        },
        beforeSend : function(json) {
        },
        complete : function(data) {
            // Reidrect page after complete post to avoid "NS_BINDING_ABORTED" of firefox
            if  (<?= getWanLanConflictFile() ?>)
            {
              window.location.href = "/BRS_wanlan_conflict.html" + "?Page=genie_optRA";
            }
            else
            {
              window.location.href = "/genie_welcome.html";
            }
        }
      });
  }

  $(document).ready(function(){
      $("[mlang]").each(function(idx, obj) {
          obj.innerHTML = window.top.mlang[obj.attributes.mlang.value];
      });

      $("[name='Skip']").on("click",function(){
          postRAopt("skip");
      });

      $("[name='Allow']").on("click",function(){
          postRAopt("allow");
      });
  });
  
  </script>
</head>

<body>
  <form id="target" name="formname" method="POST" >
    <div align="center" style="width: 100%;">
      <div id="main" style="width: 70%;height: auto;min-height: 360px;">
        <div style="width:100%; text-align:center; padding-top:250px;">
          <div align="left" style="padding-bottom: 1em; margin: 0; font-size: 14px; font-family: system-ui;color: #2C262D;" mlang="Analytics_030">
            Allow NETGEAR to collect and use data to improve our product & services and provide you with support. Learn more: www.netgear.com/about/analyticsdatapolicy
          </div>
        </div>
      </div><!-- div main -->
      <div class="form-btn-row form-btn-row2">
        <button id="skip_opt" type="button" name="Skip" class= "button-common common_bt" mlang="Analytics_032">Skip</button>
        <button id="allow_opt" type="button" name="Allow" class= "button-common common_bt" mlang="Analytics_033">Allow</button>
        </button>
      </div>
    </div>

  </form>
</body>
</html>
