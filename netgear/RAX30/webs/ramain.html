<!DOCTYPE HTML>
<? include 'php/commonCfg.php';?>
<html>
<head>
  <META charset="UTF-8">
  <META http-equiv="Pragma" content="no-cache">
  <META HTTP-equiv="Cache-Control" content="no-cache">
  <META HTTP-EQUIV="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">
  
  <title>NETGEAR Router <?= getModelNameStr()?></title>

  <link rel="stylesheet" href="css/scrollbar.css">
  <link rel="stylesheet" href="css/button.css">
  <link rel="stylesheet" href="css/form.css">
  <link rel="stylesheet" href="css/settings.css<? getVer(); ?>">
  <link rel="stylesheet" href="css/custom.css"  type="text/css">

  <script src="js/jquery.min.js"></script>
  <script src="js/jquery.jscrollpane.min.js"></script>
  <script src="js/jquery.mousewheel.js"></script>
  <script src="js/utils.js<? getVer(); ?>"></script>
  <script src="js/mlang.js<? getVer(); ?>"></script>

  <script language="javascript" type="text/javascript">
  CSRF_TOKEN = <?= genCsrfTokenFilePhp('tokenNumber')?>;
  var sku = "<?= getNmrpSKU()?>";

  var tnc_table = [
          ["en-US","TNC/Netgear_ConSolidated_English.html"],
          ["fr","TNC/Netgear_ConSolidated_French.html"],
          ["de","TNC/Netgear_ConSolidated_German.html"],
          ["it","TNC/Netgear_ConSolidated_Italian.html"],
          ["es","TNC/Netgear_ConSolidated_Spanish.html"],
          ["ja","TNC/Netgear_ConSolidated_Japanese.html"],
          ["zh","TNC/Netgear_ConSolidated_S-Chinese.html"],
          ["nl","TNC/Netgear_ConSolidated_Dutch.html"],
          ["ko","TNC/Netgear_ConSolidated_Korean.html"],
          ["pl","TNC/Netgear_ConSolidated_Polish.html"],
          ["pt","TNC/Netgear_ConSolidated_Portuguese.html"],
          ["sv","TNC/Netgear_ConSolidated_Swedish.html"],
      ];
      
  function loadTNC()
  {
      var guiLang = undefined;
      if(false || !!document.documentMode)
        tnc_table.filter(function(e,i){return e[0] == window.navigator.userLanguage});
      else
        guiLang = tnc_table.find(function(e,i){
          if(window.navigator.language.indexOf(e[0]) >= 0)
            return true;
          else
            return false;
          });
      /*if(guiLang == undefined)
          window.top.$('#content_frame').attr("src","TNC/Netgear_ConSolidated_English.html");
      else
          window.top.$('#content_frame').attr("src",guiLang[1]);
      */
      if(guiLang == undefined)
          $("#tnc_detail").load("TNC/Netgear_ConSolidated_English.html",'',afterTNCLoad());
      else
          $("#tnc_detail").load(guiLang[1],'',afterTNCLoad());
  }
  function afterTNCLoad()
  {
      mlangInit($('#tnc-page'));
  }
  
  function postAgreeTNC()
  {
      var postData = {};
      postData.function = "wizTNC";
      var o = {};
      postData.data = o;
      //console.log(postData);
      tncPost(JSON.stringify(postData));
  }

  function tncPost(postData)
  {
      $.ajax({
        url: "/cgi-bin/rex_cgi?csrftoken=" + CSRF_TOKEN,
        type: "POST",
        data: postData,
        dataType: 'json',
        contentType: "application/json; charset=utf-8",
        success : function(data) {
            if(data.status == "error")
            {   
                window.top.backUrl = "index.html";
                //window.top.errorStr = "MBSW02";
                //location.href ="ErrorMessage.html";
            }
        },
        error : function(xhr, ajaxOptions, thrownError) {
            console.log(xhr.status);
            //console.log(thrownError);
        },
        beforeSend : function(json) {
            //setTimeout("redirectProgressBar('D-genie_377')", 100);
        },
        complete : function(data) {
            // Reidrect page after complete post to avoid "NS_BINDING_ABORTED" of firefox
            if  (<?= getWanLanConflictFile() ?>)
            {
              window.location.href = "/BRS_wanlan_conflict.html" + "?Page=remain";
            }
            else
            {
              window.location.href = "/genie_welcome.html";
            }
        }
      }); //ajax()
  }

  $(document).ready(function(){
    /*$("#content_frame").on("load",function(){alert(11);
        //$("#content_frame").contents().find("body")[0].setAttribute("align","center");
        $("#content_frame").contents().find("p").each(function(){$(this)[0].setAttribute("align","center");});
        $("#content_frame").contents().find("body")[0].style.color = "gray";
        mlangInit($('#tnc-page'));
    });*/
    loadTNC();

    if ("WW" != sku && "GR" != sku && "PR" != sku)
    {
      $("#raRowWithoutCheckBox").attr("style", "display:block");
    }

    $("[name='Apply']").on("click",function(){
      if ("WW" == sku || "GR" == sku)
      {
        window.location.href = "/genie_optRA.html";
      }
      else
      {
        postAgreeTNC();
      }
    });
    
  });
  
  function mlangInit(content) {
      if (content != undefined) {
          content.find('[mlang]').each(function(idx, obj) {
          obj.innerHTML = mlang[obj.attributes.mlang.value];    
        });
        return content;
      } else {
        $("[mlang]").each(function(idx, obj) {
          obj.innerHTML = mlang[obj.attributes.mlang.value];    
        });
      }
    }
  </script>
</head>

<body class="page-body" style="overflow: auto;">
  <form id="target" name="formname" method="POST" >
    <div class="page-group" id="tnc-page">
      <!--div class="page-header newtopframe" style="height:80px; width: 100%;margin:0;padding:0;position: relative;">
        <img src="images/NightHawk.png" style="width:216px;padding-left: 20px;"></img>
      </div-->
      <div id="main" class="form-group" style="width:100%;overflow:hidden;">
        <div class="form-row" >
          <span id="ModuleName" style="position:relative;top: 0;float:initial;"><b>Nighthawk AX5</b></span>
        </div>
        <div class="form-row" style="overflow:auto;">
          <div style="height: 400px;width: 90%;overflow:auto">
            <!--iframe id="content_frame" name="content_frame" align="center" style="width:100%;height:100%;" name="page"  frameborder="0" border="0" cellspacing="0" scrolling="yes" onFocus="this.blur()" src=""-->
            <font size="4" id="tnc_detail" color="gray" >
            </font>
            <!--</iframe>-->
          </div>
        </div>
        <div class="form-row" align="center" style="padding-top:35px;">
          <font size="4" align="center" mlang="Analytics_003" style="font-family: Arial, Helvetica, Geneva, Swiss, SunSans-Regular, sans-serif;color: #666;">
          </font>
        </div>
        <div class="form-row" align="center" id="raRowWithoutCheckBox" style="display:none">
          <font size="4" align="center" mlang="Analytics_031" style="font-family: Arial, Helvetica, Geneva, Swiss, SunSans-Regular, sans-serif;color: #666;">
          </font>
        </div>
        <div class="space-divider">&nbsp;</div>
        
      </div><!--form-group-->
      <div class="form-row" align="center" style="padding-top:0px;">
        <button value="agree"  type="button" name="Apply" id="next" style="width:100px" class="button-common common_bt" mlang="Analytics_004">I Agree</button>
      </div>
    </div><!--page-group first-page-->
    

</form>
</html>
