<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<%13%>
<title>NETGEAR   Genie</title>
<%16%>
<link rel="stylesheet" href="<%283%>">
<script language="javascript" type="text/javascript">
var DisableFixedDNS = false;
var DisableFixedMAC = false;
var MacAddress;
var DodDisable = false;

function goTestApply()
{
	var winoptions = "width=640,height=480,menubar=yes,toolbar=yes,status=yes,location=yes,resizable=yes";
	if(document.forms[0].runtest.value == "yes")
		window.open('BAS_wtest_l.htm','test_win',winoptions);
}

function loadcheck()
{
	var cf = document.forms[0];
	if(isIE()){
		cf.pptp_username.size="24";
		cf.pptp_passwd.size="24";
	}	
}

function checkData(index)
{
	var cf = document.forms[0];
	var msg = "";
	var region_gui = cf.gui_region.value;
	
	var myip = cf.myip.value.split(".");
	
	msg+= checkBlank(cf.pptp_username, "<%716%>");
	if(cf.pptp_idletime.value.length<=0)
		msg+= "<%712%>";
	else if(!_isNumeric(cf.pptp_idletime.value))
		msg+= "<%713%>";
	
	if( cf.myip.value.length > 0 )
	{
        if(isValidIPaddr(cf.myip.value)==false)
            msg+= "<%717%>";

		if (myip[0] > 191) //class C
			cf.mymask.value = "255.255.255.0";
		else if (myip[0] > 127) //class B
            cf.mymask.value = "255.255.0.0";
		else //class A
            cf.mymask.value = "255.0.0.0";

		cf.static_pptp_enable.value = 1;
	}
	else
		cf.static_pptp_enable.value = 0;

	if( cf.mygw.value.length > 0 )
	{
		if(isValidIPaddr(cf.mygw.value)==false)
			msg+= "<%648%>";
	}

	var data;
	data = cf.pptp_serv_ip.value.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/);
	if ((data && !isValidIPaddr(cf.pptp_serv_ip.value))
		|| cf.pptp_serv_ip.value == ""
		|| cf.pptp_serv_ip.value.match( /[^\x20-\x7E]/ ))
		msg+= "<%768%>";

	if (msg.length > 1)
	{
		alert(msg);
		return false;
	}

    cf.pptp_user_netmask.value = cf.mymask.value;
	cf.pptp_user_ip.value = cf.myip.value;
	cf.pptp_gateway.value = cf.mygw.value;
    
    if (index == 1)
        cf.action.value = "apply";
    else if (index == 2)
        cf.action.value = "test";
    document.forms[0].submit();
	return true;
}
function loadSettings()
{
	var cf = document.forms[0];
	var pptp_user_ip = cf.pptp_user_ip.value.split(".");
    var pptp_user_netmask = cf.pptp_user_netmask.value.split(".");
	var pptp_gateway = cf.pptp_gateway.value.split(".");
    if(cf.static_pptp_enable.value == 1)
    {
        if (cf.pptp_user_ip.value != "")
            cf.myip.value = cf.pptp_user_ip.value;

        if (cf.pptp_user_netmask.value != "")
            cf.mymask.value = cf.pptp_user_netmask.value;

        if (cf.pptp_gateway.value != "")
            cf.mygw.value = cf.pptp_gateway.value;
    }
    else
    {
        setDisabled(true, cf.mygw);
    }
    if ( cf.pptp_user_ip.value == "" )
    {
        setDisabled(true, cf.mygw);
    }

}

function myip_update()
{
    var cf = document.forms[0];

    if(cf.myip.value.length>0)
    {
        setDisabled(false, cf.mygw);
    }
    else
    {
        setDisabled(true, cf.mygw);
    } 
}
</script>
</head>

<body bgcolor="#ffffff" onload="loadSettings();loadcheck();">
<form name="formname" method="POST" action="genie_pptp.cgi"> 
<table border="0" cellpadding="0" cellspacing="3" width="99%">
<tr style="height:10px">
	<td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td class="centerTd">
		<h2><%3376%></h2>
        </td>
	<td>&nbsp;</td>

</tr>
<tr>	
	<td>&nbsp;</td>
	<td class="textRow centerTd"><p><%3364%></p></td>
	<td>&nbsp;</td>
</tr>
<tr style="height:10px">
	<td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%317%></span><input id="pptp_username" type="text" name="pptp_username" size="15" maxlength="60" value="<%769%>"></td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%3365%></span><input id="pptp_passwd" type="password" name="pptp_passwd" size="15" maxlength="50" value="<%770%>"></td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%3377%></span><input id="pptp_idletime" type="text" class="num" name="pptp_idletime" size="3" maxlength="3" value="<%771%>"></td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%3378%></span>
	    <input id="myip" type="text" name="myip" class="num" size="24" maxlength="17" onBlur="myip_update()"></td>
	<td>&nbsp;</td>
</tr>

<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%3372%></span>
	<input id="mymask" type="text" name="mymask" class="num" size="24" maxlength="17"></td>
	<td>&nbsp;</td>
</tr>

<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%3379%></span><input id="pptp_serv_ip" type="text" name="pptp_serv_ip" size="24" maxlength="63" value="<%777%>"></td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:240px;text-align:right;padding-bottom:5px;padding-right:10px"><%3380%></span>
	    <input id="mygw" type="text" name="mygw" class="num" size="24" maxlength="17"></td>
	<td>&nbsp;</td>
</tr>
<tr style="height:10px">
	<td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td NOWRAP class="inputRow centerTd" tabindex="-1" onFocus="this.blur()"><span style="display:-moz-inline-box;display:inline-block;width:390px;text-align:right;padding-bottom:5px"></span>
			<button id="pptp_next" value="submit" class="purpleBtn" name="Next" onClick="return checkData(1)" type="submit"><span><%328%></span></button>
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<input type="hidden" name="runtest" value="no">
<INPUT name=pptp_user_ip type=hidden value= "<%765%>">
<INPUT name=pptp_gateway type=hidden value="<%778%>">
<INPUT name=pptp_user_netmask type=hidden value="<%779%>">
<INPUT name=static_pptp_enable type=hidden value= "<%780%>">
<INPUT name=gui_region type=hidden value="<%9%>">
<INPUT name=action type=hidden value="">
</form>
</body>
</html>
