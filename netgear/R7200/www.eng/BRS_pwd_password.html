<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><HEAD><TITLE>NETGEAR Router @model_name#</TITLE>
<meta http-equiv="Pragma" CONTENT="no-cache">
<meta http-equiv="Cache-Control" CONTENT="no-cache">
<meta http-equiv="Expires" CONTENT="Mon, 06 Jan 1990 00:00:01 GMT">
<META http-equiv=content-type content="text/html; charset=UTF-8">
<LINK href="style/hijack_style.css" type=text/css rel=stylesheet>
<LINK href="style/hijack_02_genieHelp.css" type=text/css rel=stylesheet>
<SCRIPT language=javascript src="script/brs_hijack.js" type=text/javascript></SCRIPT>
<SCRIPT language=javascript src="language/English.js" type=text/javascript></SCRIPT>
<script language="javascript" type="text/javascript" src="string.js"></script>
<link rel="stylesheet" href="style/form.css">
<script language="javascript" type="text/javascript" src="funcs.js"></script>
<script language="javascript" type="text/javascript" src="linux.js"></script>
<SCRIPT language=javascript type=text/javascript>


var lastkeypressed;
var keyTooBig = false;
var mustbeHEX = false;
var keysize=32;
var lastObj;
if (document.layers) document.captureEvents(Event.KEYPRESS);
document.onkeypress = checkKey;
function checkKey(evt)
{
  evt = (evt) ? evt : ((window.event) ? window.event : null)
  if (evt)
            lastkeypressed = (evt.keyCode) ? evt.keyCode : (evt.which ) ? evt.which : null;
//  window.status = lastkeypressed;
  if ( (lastkeypressed != 13) && (lastkeypressed != 8) && ( keyTooBig ))
  {
        keyTooBig = false;
    alert(getErrorMsgByVar("gsm_msg_wls_max_pw_1") + " " + keysize + " " + getErrorMsgByVar("gsm_msg_wls_max_pw_2"));
        chkSize(lastObj); // for NS 6/7
        return false;
  }
  else if (mustbeHEX)  // not used here, don't know which input is being used
  {
    mustbeHEX = false;
        if ( ((lastkeypressed > 47) && (lastkeypressed< 58 ))
          || ((lastkeypressed > 96) && (lastkeypressed< 103))
          || ((lastkeypressed > 64) && (lastkeypressed< 71 ))
          || (lastkeypressed ==  8)
          || (lastkeypressed == 13) )
                 return true;   // OK
        else return false;
  }
  return true;
}
function chkSize(fobj)
{
        if(fobj.value.length > keysize)
                fobj.value = fobj.value.substr(0,keysize);
}
function keyCheck(fobj)
{
  lastObj = fobj;
  keyTooBig = (fobj.value.length >= keysize ) ? true : false;
//  mustbeHEX = true;
}
//----------------------end of check password size
function getQueryString(name)
{
    var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');
    //var r = window.location.search.substr(1).match(reg);
    var r = window.location.href.match(reg);
    if (r != null) {
        return unescape(r[2]);
    }
    return null;
}
var timer_id;
var rule1 = 0;
var rule2 = 0;

function CheckPasswordStrength() {

		clearTimeout(timer_id);
		document.getElementById("password_check").style.display="none";

		timer_id = setTimeout(function () {

		var fobj = document.getElementById("sysNewPasswd");
		var password = fobj.value;
        var password_strength = document.getElementById("password_strength");
		
		var img_ok = '<img src="OK1.png" style="width:18px; height:18px" align="bottom">';		
		var img_ng = '<img src="NG1.png" style="width:18px; height:18px" align="bottom">';
		
		var img_ok2 = '<img src="OK2.png" style="width:18px; height:18px" align="bottom">';		
		var img_ng2 = '<img src="NG2.png" style="width:18px; height:18px" align="bottom">';

		rule1 = 0;
		rule2 = 0;
		
		if (password.length > 0)
		{
			document.getElementById("rule1").style.display="";
			document.getElementById("password_check").style.display="";

			document.getElementById("NextStep").disabled=false;
			document.getElementById("NextStep").className="common_bt";
		}
		else
		{
			document.getElementById("NextStep").disabled=true;
			document.getElementById("NextStep").className="common_gray_bt";
		}
		
		if (password.length >= 6 && password.length <= 32)
		{
			document.getElementById("rule1_1").innerHTML = img_ok;
			rule1++;
		}
		else 
		{
			document.getElementById("rule1_1").innerHTML = img_ng;
        }
		
		if (password.length < 3)
		{
			document.getElementById("rule1_2").innerHTML = img_ok;
			rule1++;
		}
		else 
		{
			var i = 0;
			for (i=0; i<password.length-1; i++)
			{
				var ch = password.charAt(i);
				var count = 1;
				for(k=i+1; k<password.length && count < 3; k++)
				{
					if(ch == password.charAt(k))
						count++;
				}
				if(count >= 3)
					break;
			}
			if(i >= password.length-1)
			{
				document.getElementById("rule1_2").innerHTML = img_ok;
				rule1++;
			}
			else
				document.getElementById("rule1_2").innerHTML = img_ng;
        }
		
		if(rule1 >= 2)
		{
		}
 
        var regex = new Array();
        regex.push("[A-Z]");
        regex.push("[a-z]");
        regex.push("[0-9]");
		regex.push("[!\"#$%&'()*+,-./:;<=>?\[\\\]^_`{|}~\x40\x5c\x5c]"); /* "at" and "backsplash" */
 		
		if (new RegExp(regex[0]).test(password))
		{
			document.getElementById("rule2_1").innerHTML = img_ok;
			rule2++;
		}
		else
		{
			document.getElementById("rule2_1").innerHTML = img_ng;
		}
		
		if (new RegExp(regex[1]).test(password))
		{
			document.getElementById("rule2_2").innerHTML = img_ok;
			rule2++;
		}
		else
		{
			document.getElementById("rule2_2").innerHTML = img_ng;
		}
		
		if (new RegExp(regex[2]).test(password))
		{
			document.getElementById("rule2_3").innerHTML = img_ok;
			rule2++;
		}
		else
		{
			document.getElementById("rule2_3").innerHTML = img_ng;
		}
		
		if (new RegExp(regex[3]).test(password))
		{
			document.getElementById("rule2_4").innerHTML = img_ok;
			rule2++;
		}
		else
		{
			document.getElementById("rule2_4").innerHTML = img_ng;
		}
		
		if(rule2 >= 3)
		{
			document.getElementById("rule2").innerHTML = img_ok;
		}
		else
		{
			document.getElementById("rule2").innerHTML = img_ng;
		}
		
		if(rule1 >=2 && rule2 >=3)
		{
			document.getElementById("password_check").style.display="none";
			document.getElementById("rule1").innerHTML = img_ok2;
		}
		else
		{
			document.getElementById("password_check").style.display="";
			document.getElementById("rule1").innerHTML = img_ng2;
		}

	}, 1000);
}

function checkData()
{
 	var cf = document.forms[0];
	var msg = "";
	var msg_rec = "";
	
	if(cf.sysNewPasswd.value == "password")
	{
        	msg+= getErrorMsgByVar("gsm_msg_change_default_password");
		alert(msg);	
		cf.sysNewPasswd.focus();
		return false;
	}
	
	if (cf.sysNewPasswd.value.length == 0)
	{
        	msg+= getErrorMsgByVar("gsm_msg_enter_password");
		alert(msg);	
		cf.sysNewPasswd.focus();
		return false;
	}
	
	if (cf.sysNewPasswd.value.length < 6)
	{
        	msg+= getErrorMsgByVar("gsm_msg_enter_secure_password");
		alert(msg);	
		cf.sysNewPasswd.focus();
		return false;
	}
	
	if (cf.sysNewPasswd.value.length == 0)
	{
    	msg+= document.getElementById("NewPwd").innerHTML + " " + getErrorMsgByVar("gsm_msg_blank");
    	cf.sysNewPasswd.focus();
    	alert(msg);
		return false;
	}
    if (cf.sysConfirmPasswd.value.length == 0)
	{
    	msg+=  document.getElementById("CfmPwd").innerHTML + " " + getErrorMsgByVar("gsm_msg_blank");
    	cf.sysConfirmPasswd.focus();
    	
	}
    /* the new password is different cofnirm password */
    if(cf.sysNewPasswd.value != cf.sysConfirmPasswd.value)
    {
        msg+= getErrorMsgByVar("gsm_msg_pw_not_match_password");
        cf.sysConfirmPasswd.focus();
        alert(msg);
		return false;
    }
    
	if(cf.enable_recovery.checked)
	{
		var q1 = getSelected(cf.question1);
		var q2 = getSelected(cf.question2);
		var a1 = cf.answer1.value;
		var a2 = cf.answer2.value;

		if (q1 != "0")
		{
			if(a1 == "")
			{
				msg+= getErrorMsgByVar("gsm_msg_pwd_sec_ans");
			}
			if(a1.match(/[^(\x30-\x39\x41-\x5A\x61-\x7A\x20\xA0)]/))
				msg+=getErrorMsgByVar("gsm_msg_answer_invalid");
		}
		else
		{
			msg+= getErrorMsgByVar("gsm_msg_pwd_sec_sel");
		}
		
		if (q2 != "0")
		{
			if(a2 == "")
			{
				msg+= getErrorMsgByVar("gsm_msg_pwd_sec_ans");
			}
			if(a2.match(/[^(\x30-\x39\x41-\x5A\x61-\x7A\x20\xA0)]/))
				msg+=getErrorMsgByVar("gsm_msg_answer_invalid");
		}
		else
		{
			msg+= getErrorMsgByVar("gsm_msg_pwd_sec_sel");
		}
	}
	
	if (msg.length > 1)
	{
		alert(msg);
		return false;
	}
    dataToHidden(cf);
	if(!cf.enable_recovery.checked) {
		msg_rec+= getErrorMsgByVar("gsm_msg_pwd_rec_war");
		msg_rec+= "\n";
		msg_rec+= getErrorMsgByVar("gsm_msg_pwd_rec_chk");
		return confirm(msg_rec);
	}
	else
	{
		var state = getQueryString("state");
		if( state == "unconfig")
		{
			cf.passwd_unconfig.value = "1";
			//top.location.href="BRS_start.htm";
		}
	    cf.submit();
		return true;
	}
}

function initPage()
{
}

function set_password_recovery()
{   
    var cf = document.forms[0];  
    cf.enable_recovery.checked = true;    
    document.getElementById("q1").style.display="";
    document.getElementById("a1").style.display="";
    document.getElementById("q2").style.display="";
    document.getElementById("a2").style.display="";
    document.getElementById("req").style.display="";
}

//addLoadEvent(initPage);

</SCRIPT>
</HEAD>
<BODY onLoad="dataToVisible(document.forms[0]);document.forms[0].elements[0].focus();set_password_recovery();initPage();">
<FORM action="setup.cgi@post_par#" method=post>
 
<DIV class=wizard_content_div>
<DIV class=wizard_words_div id=choices_div>

<H1><span languageCode = "10716">Admin Account Settings</span></H1>
<P><span languageCode = "10717">The admin password is used to log in to your router’s web interface. Secure your Network by changing the admin password.</span></P>
<table border="0" cellpadding="0" cellspacing="2" width="100%">

	<tr><td><span nowrap languageCode = "3168">User Name</span>:</td>
		<td>admin</td>
			</tr><tr><td><span id="NewPwd" nowrap width="15%" languageCode = "10718">New Password</span>*:</td>
		<td nowrap width="85%" ><input type="password" autocomplete="off" name="sysNewPasswd" id="sysNewPasswd" size="18" maxlength="32" value="" onkeyup="CheckPasswordStrength()"><span name="rule1" id="rule1" style="display: none"><img src="NG2.png" style="width:18px; height:18px" align="bottom"></span></td>
	</tr>
	<tr name="password_check" id="password_check" style="display: none"><td nowrap width="15%" align="left"> </td> <td width="85%" align="left">
	<p class="p_password_check">
		<span languageCode="11030">We recommend that your password meets the following conditions:</span><br><br>
        
        <span name="rule1_1" id="rule1_1"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11031">Contains 6 to 32 characters</span><br>
        <span name="rule1_2" id="rule1_2"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11032">Contains no more than two identical characters in a row</span><br><br>
		<span name="rule2" id="rule2"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11033">In addition, we recommend that your password meets three of the following four conditions: </span><br><br>
        
        <span name="rule2_1" id="rule2_1"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11034">At least one uppercase character </span><br>
        <span name="rule2_2" id="rule2_2"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11035">At least one lowercase character </span><br>
        <span name="rule2_3" id="rule2_3"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11036">At least one number</span><br>
        <span name="rule2_4" id="rule2_4"><img src="NG1.png" style="width:18px; height:18px" align="bottom"></span><span languageCode="11037">At least one special character, such as &#64;&#35;&amp;…		</span><br>
	</p>
	</td></tr>	
	
	<tr><td><span id="CfmPwd" nowrap languageCode = "10719">Confirm New Password</span>*:</td>
		<td nowrap><input type="password" autocomplete="off" name="sysConfirmPasswd" size="18" maxlength="32" value="" onKeyDown="keyCheck(this)"></td>
	</tr>
<TR>
	<TD nowrap colspan=2 style="display: none">
	<input type="checkbox" name="enable_recovery" value="enable" > <span languageCode = "11038">Enable Password Reset</span>
	</TD>
</TR>
<TR id="q1">
	<TD nowrap ><br><br><span languageCode = "3141">Security Question #1</span>*:</TD>
	<TD nowrap align="left"><br><br>
	<select  name="question1" size=1>
		<option value="0" languageCode = "3143">Select a question</option>
		<option value="1" languageCode = "3183">What was the name of the first NETGEAR product you purchased?</option>
		<option value="2" languageCode = "3184">What was the name of the first school you attended?</option>
                <option value="3" languageCode = "3179">What is your oldest sister's first name?</option>
                <option value="4" languageCode = "3180">What is your oldest brother's first name?</option>
                <option value="5" languageCode = "3071">In what city were you born?</option>
                <option value="6" languageCode = "3176">What is your grandmother's first name?</option>
                <option value="7" languageCode = "3175">What is your grandfather's first name?</option>
                <option value="8" languageCode = "3072">In what year (YYYY) did you graduate from high school?</option>
                <option value="9" languageCode = "3172">What is the name of your first employer?</option>
	</select>
	</TD>
</TR>
<TR id="a1">
	<TD nowrap ><span languageCode = "3016">Answer</span>*:</TD>
	<TD nowrap  align="left">
	<input type="text" maxLength="64" size="30" name="answer1" onFocus="this.select();" value="@htpwd_answer1#">
	</TD>
</TR>
<TR id="q2">
	<TD nowrap ><span languageCode = "3142">Security Question #2</span>*:</TD>
	<TD nowrap align="left">
	<select  name="question2" size=1>
		<option value="0" languageCode = "3143">Select a question</option>
                <option value="1" languageCode = "3181">What is your youngest sister's first name?</option>
                <option value="2" languageCode = "3180">What is your youngest brother's first name?</option>
                <option value="3" languageCode = "3174">What is your father's middle name?</option>
                <option value="4" languageCode = "3177">What is your mother's middle name?</option>
                <option value="5" languageCode = "3182">What was the first name of your first manager?</option>
                <option value="6" languageCode = "3070">In what city was your mother born?</option>
                <option value="7" languageCode = "3069">In what city was your father born?</option>
                <option value="8" languageCode = "3173">What is your best friend's first name?</option>
	</select>
	</TD>
</TR>
<TR id="a2">
	<TD nowrap ><span languageCode = "3016">Answer</span>*:</TD>
	<TD nowrap  align="left">
	<input type="text" maxLength="64" size="30" name="answer2" onFocus="this.select();" value="@htpwd_answer2#">
	</TD>
</TR>
<TR id="req">
        <TD nowrap ><span languageCode = "3005">*=required information</span></TD>
        <TD nowrap  align="left">
        </TD>
</TR>
</table>
</DIV>
<br><br>
<DIV class=wizard_buttons_div id=buttons_div_02 align=center>
<input class="common_gray_bt" disabled=true type="button" name="NextStep" id="NextStep" languageCode="25" value="Next" onclick="checkData();">
</DIV></DIV>
    
<input type="hidden" name="todo" value="set_admin_passwd">
<input type="hidden" name="this_file" value="BRS_pwd_password.html">
<input type="hidden" name="next_file" value="BRS_success.html">
<input type="hidden" name="h_enable_recovery" value="1">
<input type="hidden" name="passwd_unconfig" value="0">
<input type="hidden" name="h_question1" value="@h_htpwd_question1#">
<input type="hidden" name="h_question2" value="@h_htpwd_question2#">
    
</FORM>
<script language="javascript" type="text/javascript" src="langs.js"></script>
</BODY></HTML>
