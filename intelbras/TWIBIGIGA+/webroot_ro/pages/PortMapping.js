(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"2FSu":function(t,e,r){"use strict";r("RujJ")},"4aDx":function(t,e,r){"use strict";r.r(e);r("bWfx"),r("KKXr"),r("xfY5"),r("I78e"),r("RW0V"),r("ioFf"),r("0l/t"),r("mYba"),r("jm62");var o=r("L2JU"),n=r("kP5/");function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l={intranet_ip:"",intranet_port:"",extranet_port:"",protocol:"TCP&UDP"},p={data:function(){return{helpText:_("Format: XXX or XXX-XXX"),editIndex:-1,formOption:{intranet_ip:{maxlength:15,valid:[{type:"ipAll"}],show:!0},intranet_port:{maxlength:11,placeholder:_("Enter port number or port range."),valid:[{type:"port"}],show:!0},extranet_port:{maxlength:11,placeholder:_("Enter port number or port range."),valid:[{type:"port"}],show:!0},protocol:{sortArray:[{value:"TCP",title:"TCP"},{value:"UDP",title:"UDP"},{value:"TCP&UDP",title:"TCP&UDP"}]}},dialog:{title:"",show:!1,closeOnClickModal:!0},dialogStatus:"add"}},computed:a(a(a(a({},Object(o.e)("portmapping",["port_list","lan_info"])),Object(o.e)("remoteweb",["remote_web"])),Object(o.c)(["active_route"])),{},{saveText:function(){return-1==this.editIndex?_("Add"):_("save")}}),methods:a(a(a({},Object(o.b)("portmapping",["getData","setData"])),Object(o.b)("remoteweb",["getRemoteweb"])),{},{showAddRow:function(){this.dialog.show=!0,this.dialog.title=_("New port mapping"),this.editIndex=-1,this.reset(),this.dialogStatus="add"},reset:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;this.formOption.intranet_ip.val=t.intranet_ip,this.formOption.intranet_port.val=t.intranet_port,this.formOption.extranet_port.val=t.extranet_port,this.formOption.protocol.val=t.protocol,this.clear()},clear:function(){this.formOption.intranet_ip.error="",this.formOption.intranet_port.error="",this.formOption.extranet_port.error=""},showEdit:function(t,e){this.dialog.show=!0,this.dialog.title=_("Edit port mapping"),this.editIndex=e,this.reset(t),this.dialogStatus="edit"},deleteRow:function(t){this.port_list.splice(t,1),this.saveData()},saveData:function(){var t=this;this.setData(this.port_list).then((function(){t.dialog.show=!1}))},beforeSubmit:function(){var t,e=null,r=this.formOption.intranet_ip.val,o=this.lan_info.lan_ip,i=(this.formOption.intranet_port.val+"").split("-").map(Number),a=(this.formOption.extranet_port.val+"").split("-").map(Number),s=this.remote_web.remote_port,l=this.remote_web.remote_en;if(!Object(n.c)(r,o,this.lan_info.lan_mask))return this.$toast(_("The internal network IP address must be in the same network segment as the LAN IP")),!1;if(r==o)return this.$toast(_("The LAN IP address must not be the same as the login IP address (%s) of the router.",[o])),!1;if(this.conflictMesh(r,o))return this.$toast(_("Conflicts with the reserved address for mesh network")),!1;if(i.length!=a.length)return this.$toast(_("Port format and range should be consistent")),!1;if(1==l&&1==i.length&&(i[0]==s||a[0]==s))return this.$toast(_("Conflict with remote management IP port")),!1;if(2==i.length){if(i[1]-i[0]!=a[1]-a[0])return this.$toast(_("Port format and range should be consistent")),!1;if(1==l&&(s>=i[0]&&s<=i[1]||s>=a[0]&&s<=a[1]))return this.$toast(_("Conflict with remote management IP port")),!1}for(t in this.port_list)if(("edit"!==this.dialogStatus||this.editIndex!=t)&&(e=(this.port_list[t].extranet_port+"").split("-").map(Number),this.repeatPort(a,e)))return this.$toast(_("WAN port conflict. One WAN port can be mapped only once.")),!1;return!0},conflictMesh:function(t,e){if(t.slice(0,t.lastIndexOf("."))==e.slice(0,e.lastIndexOf(".")))return t.split(".")[3]>=2&&t.split(".")[3]<=30},repeatPort:function(t,e){return 1==t.length?t[0]==e[0]||t[0]>e[0]&&t[0]<=e[1]:t[0]<=e[0]&&e[0]<=t[1]||t[0]<=e[1]&&t[1]>=e[0]},submit:function(){if(this.beforeSubmit()){var t={intranet_ip:this.formOption.intranet_ip.val,intranet_port:this.formOption.intranet_port.val,extranet_port:this.formOption.extranet_port.val,protocol:this.formOption.protocol.val};-1==this.editIndex?this.port_list.push(t):this.port_list.splice(this.editIndex,1,t),this.saveData()}},cancel:function(){this.dialog.show=!1}}),created:function(){this.getData(),this.getRemoteweb()}},c=(r("2FSu"),r("KHd+")),u=Object(c.a)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"port-mapping"},[r("div",{staticClass:"tool-bar"},[r("v-button",{attrs:{title:t._("Add"),disabled:t.port_list.length>=t.active_route.maxRules,css:"btn-add icon-add"},on:{callback:t.showAddRow}})],1),t._v(" "),r("table",{staticClass:"form-table"},[r("thead",[r("tr",[r("th",{attrs:{width:"24%"}},[t._v(t._s(t._("Intranet IP address")))]),t._v(" "),r("th",{staticClass:"center",attrs:{width:"20%"}},[t._v(t._s(t._("Intranet port")))]),t._v(" "),r("th",{staticClass:"center",attrs:{width:"20%"}},[t._v(t._s(t._("External network port")))]),t._v(" "),r("th",{staticClass:"center",attrs:{width:"16%"}},[t._v(t._s(t._("protocol")))]),t._v(" "),r("th",{staticClass:"center",attrs:{width:"20%"}},[t._v(t._s(t._("operation")))])])]),t._v(" "),t.port_list.length>0?r("tbody",t._l(t.port_list,(function(e,o){return r("tr",{key:e.intranet_ip},[r("td",[t._v(t._s(e.intranet_ip))]),t._v(" "),r("td",{staticClass:"center"},[t._v(t._s(e.intranet_port))]),t._v(" "),r("td",{staticClass:"center"},[t._v(t._s(e.extranet_port))]),t._v(" "),r("td",{staticClass:"center"},[t._v(t._s(e.protocol))]),t._v(" "),r("td",{staticClass:"tool"},[r("i",{staticClass:"table-icon icon-edit1",on:{click:function(r){return t.showEdit(e,o)}}}),t._v(" "),r("i",{staticClass:"table-icon icon-delete",on:{click:function(e){return t.deleteRow(o)}}})])])})),0):r("tbody",[r("tr",[r("td",{staticClass:"no-data",attrs:{colspan:"5"}},[r("div",[t._v(t._s(t._("No data")))])])])])]),t._v(" "),r("v-pop",{attrs:{option:t.dialog},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[r("v-form",{staticClass:"port-mapping-form",attrs:{showCancel:!0,saveText:t.saveText,disabled:t.disabled,formData:t.formOption},on:{submit:t.submit,cancel:t.cancel}},[r("v-group",{attrs:{title:t._("Intranet IP"),vname:"v-input",dataKey:t.formOption.intranet_ip}}),t._v(" "),r("v-group",{attrs:{vname:"v-input",dataKey:t.formOption.intranet_port},scopedSlots:t._u([{key:"title",fn:function(){return[r("div",{staticClass:"form-title"},[r("label",{staticClass:"led-row-title"},[t._v("\n              "+t._s(t._("Intranet port"))+"\n              "),r("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.helpText,expression:"helpText"}],staticClass:"icon-help",attrs:{"parse-html":"true"}})])])]},proxy:!0}])}),t._v(" "),r("v-group",{attrs:{vname:"v-input",dataKey:t.formOption.extranet_port},scopedSlots:t._u([{key:"title",fn:function(){return[r("div",{staticClass:"form-title"},[r("label",{staticClass:"led-row-title"},[t._v("\n              "+t._s(t._("External network port"))+"\n              "),r("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.helpText,expression:"helpText"}],staticClass:"icon-help",attrs:{"parse-html":"true"}})])])]},proxy:!0}])}),t._v(" "),r("v-group",{attrs:{title:t._("protocol"),vname:"v-select",dataKey:t.formOption.protocol}})],1)],1)],1)}),[],!1,null,"6ef81358",null);e.default=u.exports},RujJ:function(t,e,r){},"kP5/":function(t,e,r){"use strict";r.d(e,"d",(function(){return i})),r.d(e,"c",(function(){return n})),r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return a}));r("pIFo"),r("I78e"),r("Btvt"),r("bWfx"),r("KKXr"),r("Vd3H"),r("xfY5"),r("ioFf"),r("XfO3"),r("yt8O"),r("rGqo");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e,r,o){if(""===t||""===e||""===r||""===o)return!1;var n,i=t.split("."),a=e.split("."),s=r.split("."),l=o?o.split("."):s,p=s;for(n=0;n<4;n++)if(s[n]!=l[n]){p=s[n]&l[n]==s[n]?s:l;break}for(n=0;n<4;n++)if((i[n]&p[n])!=(a[n]&p[n]))return!1;return!0}function i(t,e,r,o,i){return n(t,r,e)?t===r||t===o||t===i?_("The WAN port gateway or DNS cannot be the same as the WAN port IP address"):void 0:_("The WAN port IP address and the default gateway must be on the same network segment")}function a(t,e){var r,o=e.split(".").map((function(t){return parseInt(t,10)})),n=t.split(".").map((function(t){return parseInt(t,10)})),i=[],a=0,s=0,l=0,p=0;if(127==n[0])return _("IP address could not start with 127");if(0==n[0]||n[0]>=224)return _("Wrong IP address");for(p=0;p<4;p++)0==(n[p]&o[p])?s+=0:s+=1;for(p=0;p<o.length;p++)r=255-o[p],i.push(r);for(var c=0;c<4;c++)0==(n[c]&i[c])?a+=0:a+=1;if(0==a||0==s)return _("IP address is a network number, please enter it again.");for(var u=0;u<4;u++)255==(n[u]|o[u])?l+=0:l+=1;return 0==l?_("IP address is a broadcast address, please enter it again."):void 0}function s(t,e,r,n){var i,a,s,l="",p="",c=0;if(l=(o(t),t.split(".")),p=(o(e),e.split(".")),""==r&&""==n)return!1;for(i=r.split("."),s=a=n.split("."),c=0;c<4;c++)if(p[c]!=a[c]){if(p[c]>a[c]){s=a;break}s=p;break}for(c=0;c<4;c++)if((l[c]&s[c])!=(i[c]&s[c]))return!1;return!0}}}]);