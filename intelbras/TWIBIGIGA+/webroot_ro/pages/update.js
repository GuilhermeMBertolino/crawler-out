(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"3GIC":function(t,e,s){"use strict";s("eSVy")},"3MKE":function(t,e,s){"use strict";s("lW1M")},FV5a:function(t,e,s){"use strict";s("GF3u")},GF3u:function(t,e,s){},OwN7:function(t,e,s){"use strict";s("xfY5");var i={data:function(){return{hasReboot:!1,interval:0,percent:0}},props:{hasPercent:{type:Boolean,default:!0},hasFooterTip:{type:Boolean,default:!1},desc:{type:String},status:{type:String,default:"#57bf13"},time:{type:Number,default:90}},watch:{status:{immediate:!0,handler:function(t,e){"red"===t&&(this.hasPercent=!1,this.percent=100)}}},methods:{runProgress:function(){var t=this;this.$toast({isShow:!1});var e=parseInt(this.time/200*1e3);this.interval=setInterval((function(){if(t.hasReboot)t.percent+=3;else if(t.percent<95){var e=Math.random();t.percent+=e>.35?.7:e<.4?.3:.5}t.percent>66&&t.confirm(),t.percent>=100&&(t.percent=100,t.upStatusText=_("Upgrade successfully."),t.interval&&clearInterval(t.interval),t.interval=null,t.$nextTick((function(){location.href="login.html"})))}),e)},confirm:function(){var t=this;this.hasReboot||this.$http.getModule("wan_info").then((function(e){t.hasReboot=!0}))}}},n=(s("3MKE"),s("KHd+")),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-bar"},[s("div",{staticClass:"progress-text"},[s("span",[t._v(t._s(t.desc))]),t._v(" "),t.hasPercent?s("span",[t._v(t._s(t.percent.toFixed(1))+"%")]):t._e()]),t._v(" "),s("div",{staticClass:"out-bar"},[s("div",{staticClass:"inner-bar",style:{width:t.percent.toFixed(1)+"%",backgroundColor:t.status}})])]),t._v(" "),t.hasFooterTip?s("div",{staticClass:"progress-tip"},[t._t("default")],2):t._e()])}),[],!1,null,null,null);e.a=r.exports},XBEx:function(t,e,s){"use strict";s.r(e);s("I78e"),s("KKXr"),s("0l/t"),s("RW0V"),s("ioFf"),s("mYba"),s("jm62");var i=s("L2JU");s("Oyvg"),s("pIFo"),s("XfO3"),s("Btvt"),s("yt8O"),s("rGqo");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r={data:function(){return this.init=!0,{target:"iframe"+(1e5*Math.random()).toFixed(0),fileName:"",disabled:!1}},props:{title:{type:String},name:{type:String,default:"upgradeFile"},type:{type:String,default:""},action:{type:String,required:!0},method:{type:String,default:"POST"},showFile:{type:Boolean,default:!0},uploadText:{type:String,default:_("Select the file")},beforeUpload:{type:Function},success:{type:Function},btnText:{default:_("Upload")}},computed:{typeRe:function(){if(this.type)return n(this.type)!==Object?new RegExp(this.type.replace(/\./g,"\\.")):this.type}},filters:{file:function(t){return(t+="").split(/\/|\\/).pop()}},methods:{change:function(t){if(this.typeRe&&!this.typeRe.test(t.target.value))return this.$toast(_("Only support [%s] file.",this.type)),void this.reset();this.fileName=t.target.value},submit:function(){""!==this.fileName?this.beforeUpload&&!1===this.beforeUpload()||(this.disabled=!0,this.$refs.form.submit()):this.$toast(_("Please select a file."))},load:function(){this.disabled=!1;var t=this.$refs.frame.contentWindow.document.body,e=t.innerText||t.textContent;if(!e)return!1;try{var s=JSON.parse(e);this.success&&this.success(s)}catch(t){}},reset:function(){this.$refs.form.reset(),this.fileName=""}}},a=(s("FV5a"),s("KHd+")),o=Object(a.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{ref:"form",attrs:{action:t.action,method:t.method,target:t.target,enctype:"multipart/form-data"}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-title"},[t._v(t._s(t.title))]),t._v(" "),s("div",{staticClass:"form-upload form-content"},[s("a",{staticClass:"form-upload-btn form-btn-br",on:{click:function(e){return t.$refs.file.click()}}},[s("i",{staticClass:"icon-upgrade1"}),t._v("\n          "+t._s(t.uploadText)+"\n        ")]),t._v(" "),s("input",{ref:"file",staticClass:"form-upload-file",attrs:{type:"file",id:t.name,name:t.name},on:{change:t.change}}),t._v(" "),t.fileName?s("div",{staticClass:"file-tips"},[s("span",{staticClass:"v-icon-file"}),t._v(" "),s("span",{attrs:{title:t.fileName.split("\\").slice(-1)[0]}},[t._v(t._s(t.fileName.split("\\").slice(-1)[0]))])]):s("div",{staticClass:"file-tips"},[s("span",[t._v(t._s(t._("No files selected.")))])])])]),t._v(" "),s("div",{staticClass:"form-toolbar"},[s("v-btn",{staticClass:"button",attrs:{disabled:t.disabled,title:t.btnText,type:"submit"},on:{click:t.submit}})],1)]),t._v(" "),s("iframe",{ref:"frame",staticClass:"frame",attrs:{name:t.target},on:{load:t.load}})])}),[],!1,null,null,null).exports,u=s("OwN7"),c=s("BM65");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function p(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){f(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function f(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var d={data:function(){return{progress:{css:"",title:_("software upgrade"),closeOnClickModal:!1,show:!1},systemVersion:"",currentVersion:"",hideClose:!0,isDetecting:!0,updateContent:[],hasNewSoftVersion:!1,upgradeType:{val:1,sortArray:[{title:_("Online upgrade"),value:0},{title:_("Manual upgrade"),value:1}]},newVersionTip:"",downStatus:"down-status",upStatusText:"",upstatus:"#57bf13"}},computed:p(p({},Object(i.e)("update",["version_info","upgrade_status"])),Object(i.e)("sysinfo",["node_info"])),methods:p(p(p({},Object(i.b)("update",["getVersionInfo","getUpgradeStatus","startupgrade","notupgrade"])),Object(i.b)("sysinfo",["getSysInfo"])),{},{getData:function(){var t=this;this.isDetecting&&this.getVersionInfo().then((function(){t.systemVersion=t.version_info.version,t.currentVersion=t.version_info.current_version,t.isDetecting=!1,t.hasNewSoftVersion=1==t.version_info.hasNew,t.hasNewSoftVersion&&(t.updateContent=t.version_info.changelog.split("\n").slice(0,-1))})),this.getSysInfo()},success:function(t){var e=this;switch(t.errcode){case c.t.TYPE:case c.t.FILE:case c.t.LARGE:return this.$toast(c.u[t.errcode]),void this.$refs.update.reset()}this.upStatusText=_("Upgrading…"),this.$nextTick((function(){e.progress.show=!0,e.$refs.progress.runProgress()}))},showToast:function(){this.$toast({text:_("Uploading upgrade file"),duration:0})},onlineUpdate:function(){var t=this,e={node_info:this.node_info.filter((function(t){return t.net_status===c.i.ON_LINE}))};this.startupgrade(e).then((function(){t.getStatus()}))},getStatus:function(){var t=this;this.getUpgradeStatus().then((function(){switch(t.upgrade_status){case"0":t.newVersionTip=_("Downloading"),t.downStatus="down-status",setTimeout((function(){t.getStatus()}),1e3);break;case"1":t.newVersionTip=_("Connecting to the server…"),t.downStatus="down-status",setTimeout((function(){t.getStatus()}),1e3);break;case"2":t.newVersionTip=_("Not enough storage"),t.downStatus="err-down-status";break;case"3":t.upStatusText=_("Upgrading…"),t.$nextTick((function(){t.progress.show=!0,t.$refs.progress.runProgress()}));break;case"4":t.upStatusText=_("Upgrade failed…"),t.$nextTick((function(){t.upstatus="red",t.progress.show=!0}))}}))}}),components:{Upload:o,vProgress:u.a},created:function(){this.getData()}},v=(s("3GIC"),s("uEzv"),Object(a.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upgrade form-wrapper"},[i("div",{staticClass:"form-group"},[i("label",{staticClass:"form-title"},[t._v(t._s(t._("Current version")))]),t._v(" "),i("div",{staticStyle:{"line-height":"32px"}},[t._v(t._s(t.currentVersion))])]),t._v(" "),i("div",{staticClass:"form-group v-switch"},[i("label",{staticClass:"form-title"},[t._v(t._s(t._("New version")))]),t._v(" "),i("div",{staticClass:"form-content"},[i("div",[t._v(t._s(t.systemVersion))]),t._v(" "),t.isDetecting?i("div",[i("div",{staticClass:"version-title"},[i("img",{staticClass:"loading",attrs:{src:s("sQSC")}}),t._v("\n          "+t._s(t._("Checking updates, please wait…"))+"\n        ")])]):i("div",{staticClass:"version"},[t.hasNewSoftVersion?[i("div",{staticClass:"version-title"},[t._v(t._s(t._("Found a new version, please upgrade immediately")))]),t._v(" "),i("ul",{staticClass:"version-ul"},t._l(t.updateContent,(function(e){return i("li",{key:e,staticClass:"version-li"},[t._v(t._s(e))])})),0)]:i("div",{staticClass:"version-title"},[t._v(t._s(t._("The current version is the latest one")))])],2)])]),t._v(" "),i("v-group",{attrs:{title:t._("Upgrade method"),vname:"v-radio",dataKey:t.upgradeType}}),t._v(" "),0===t.upgradeType.val?i("v-group",{attrs:{title:""}},[i("div",{class:t.downStatus},[t._v(t._s(t.newVersionTip))])]):t._e(),t._v(" "),i("upload",{directives:[{name:"show",rawName:"v-show",value:1===t.upgradeType.val,expression:"upgradeType.val === 1"}],ref:"update",staticClass:"form-wrapper normal-input",attrs:{action:"goform/upgrade",success:t.success,title:t._("Upgrade file"),"btn-text":t._("Upgrade now"),vname:"v-upload",beforeUpload:t.showToast}}),t._v(" "),i("div",{staticClass:"form-group v-switch"},[i("label",{staticClass:"form-title"}),t._v(" "),i("div",{staticClass:"form-content"},[i("v-btn",{directives:[{name:"show",rawName:"v-show",value:0===t.upgradeType.val,expression:"upgradeType.val === 0"}],staticClass:"button",attrs:{disabled:!t.hasNewSoftVersion,title:t._("Upgrade now"),type:"submit"},on:{click:t.onlineUpdate}})],1)]),t._v(" "),i("v-pop",{attrs:{option:t.progress,hideClose:t.hideClose},model:{value:t.progress.show,callback:function(e){t.$set(t.progress,"show",e)},expression:"progress.show"}},[i("v-progress",{ref:"progress",attrs:{desc:t.upStatusText,time:"250",status:t.upstatus}})],1)],1)}),[],!1,null,"38c5e0c3",null));e.default=v.exports},eSVy:function(t,e,s){},gK9F:function(t,e,s){},lW1M:function(t,e,s){},sQSC:function(t,e,s){t.exports=s.p+"assets/images/loading_d7913.png"},uEzv:function(t,e,s){"use strict";s("gK9F")}}]);