#!/bin/ash

case "$1" in

	start)
		TARGET=`rdcsman 0x80150005 str`
		ping -c 4 "$TARGET" > /var/run/ping_result  &
		PID=$!
		wrcsman "0x80150003 $PID && 0x80150004 1"		
		;;
		
	startv6)
		TARGET=`rdcsman 0x80150005 str`
		ping6 -c 4 "$TARGET" > /var/run/ping_result  &
		PID=$!
		wrcsman "0x80150003 $PID && 0x80150004 1"
		;;

	status)
		PID=`rdcsman 0x80150003 u32`
		if [ ! -d "/proc/$PID" ] ; then
			wrcsman "0x80150004 0"
		fi	
		;;
	
	show)	
		cat /var/run/ping_result
		;;
	
	*)
		exit 1
		;;
esac

exit 0

