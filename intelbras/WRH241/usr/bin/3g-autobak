#!/bin/sh
SCRIPT=$0

EXEC=/usr/sbin/autobak
PIDFILE=/var/run/autobak.pid

# routines ######################################################
start() {
	local err; err=0
	$EXEC &
	return $err
}


stop() {
	local err; err=0
	if [ -e "$PIDFILE" ] ; then
		PID=`cat "$PIDFILE"`
		echo "Killing autobak ($PID)"
		kill $PID > /dev/null 2>&1
	else
		echo "$PIDFILE not exit!"
		err=1
	fi
	
	return $err
}

usage() {
	echo "$0 [start|stop|restart|reload|config]"
	exit 1
}

# main ##########################################################
[ -z "$1" ] && usage;

err=0

for action in $*; do
	case $action in
		config)		;;
		start)		start;;
		stop)		stop;;
		reload)		;;
		restart)	stop; sleep 6; start;;
		*)			usage;;
	esac
	if [ $? = "0" ] ; then
		echo $SCRIPT $action ok
	else
		echo $SCRIPT $action error
		err=1
	fi
done

exit $err
